OBJECT Table 11148589 IN - ConnectIT Setup
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    OnModify=VAR
               Mgt@1000000 : Codeunit 11148589;
             BEGIN
               Mgt.ResetSetup;
             END;

    CaptionML=[ENU=ConnectIT Setup;
               NLD=ConnectIT-instellingen];
  }
  FIELDS
  {
    { 1   ;   ;Primary Key         ;Code20        ;CaptionML=[ENU=Primary Key;
                                                              NLD=Primaire sleutel] }
    { 2   ;   ;Confirm Overwrite   ;Boolean       ;CaptionML=[ENU=Confirm Overwrite;
                                                              NLD=Overschrijven bevestigen] }
    { 3   ;   ;Captions of Fields and Tables;Boolean;
                                                   CaptionML=[ENU=Captions of Fields and Tables;
                                                              NLD=Captions van velden en tabellen] }
    { 7   ;   ;XML Declaration     ;Text250       ;CaptionML=[ENU=XML Declaration;
                                                              NLD=XML Declaratie] }
    { 8   ;   ;FTP Executable      ;Text100       ;CaptionML=[ENU=FTP Executable;
                                                              NLD=FTP Programma] }
    { 9   ;   ;Document Id Node    ;Text250       ;CaptionML=[ENU=Document Id Node;
                                                              NLD=Document Id Node] }
    { 10  ;   ;Request Queue       ;Text250       ;CaptionML=[ENU=Request Queue;
                                                              NLD=Aanvraagwachtrij] }
    { 11  ;   ;Reply Queue         ;Text250       ;CaptionML=[ENU=Reply Queue;
                                                              NLD=Antwoordenwachtrij] }
    { 12  ;   ;Version No.         ;Code10        ;CaptionML=[ENU=Version No.;
                                                              NLD=Versienr.] }
    { 13  ;   ;Seconds Between Execute Task;Integer;
                                                   InitValue=1;
                                                   CaptionML=[ENU=Seconds Between Execute Task;
                                                              NLD=Seconden tussen taken uitvoeren] }
    { 14  ;   ;Seconds Between Inbox Exec.;Integer;InitValue=1;
                                                   CaptionML=[ENU=Seconds Between Inbox Exec.;
                                                              NLD=Seconden tussen inbox verwerken] }
    { 15  ;   ;Temp Directory      ;Text250       ;OnValidate=BEGIN
                                                                "Temp Directory" := DELCHR("Temp Directory", '<>', '<>');
                                                              END;

                                                   CaptionML=[ENU=Temp Directory;
                                                              NLD=Tempmap] }
    { 16  ;   ;Use Captions in Tag Names;Boolean  ;CaptionML=[ENU=Use Captions in Tag Names;
                                                              NLD=Gebruik captions in tagnamen] }
    { 17  ;   ;Use Error Handling  ;Boolean       ;InitValue=Yes;
                                                   CaptionML=[ENU=Use Error Handling;
                                                              NLD=Foutafhandeling gebruiken] }
    { 18  ;   ;Default Export Location;Text250    ;CaptionML=[ENU=Default Export Location;
                                                              NLD=Standaard exportlokatie] }
    { 19  ;   ;Field19             ;Boolean       ;CaptionML=[ENU=Field19;
                                                              NLD=Field19] }
    { 20  ;   ;Field20             ;Boolean       ;CaptionML=[ENU=Field20;
                                                              NLD=Field20] }
    { 21  ;   ;Seconds Betw. Check Conn. Han.;Integer;
                                                   InitValue=1;
                                                   CaptionML=[ENU=Seconds Between Check Connector Handler;
                                                              NLD=Seconden tussen contr. conn. verw.] }
    { 22  ;   ;Save Trace Entries  ;Boolean       ;CaptionML=[ENU=Save Trace Entries;
                                                              NLD=Traceerposten opslaan] }
    { 23  ;   ;Default Import Location;Text250    ;CaptionML=[ENU=Default Import Location;
                                                              NLD=Standaard importlokatie] }
    { 24  ;   ;Custom Function Codeunit;Integer   ;TableRelation=Object.ID WHERE (Type=CONST(Codeunit));
                                                   CaptionML=[ENU=Custom Function Codeunit;
                                                              NLD=Functie codeunit] }
    { 25  ;   ;Default Processed Path;Text250     ;CaptionML=[ENU=Default Processed Path;
                                                              NLD=Standaard verwerkt map] }
    { 26  ;   ;Default Error Path  ;Text250       ;CaptionML=[ENU=Default Error Path;
                                                              NLD=Standaard error map] }
    { 27  ;   ;Default Log Path    ;Text250       ;CaptionML=[ENU=Default Log Path;
                                                              NLD=Standaard log map] }
    { 50  ;   ;Debugging Entries in Event Log;Boolean;
                                                   CaptionML=[ENU=Debugging Entries in Event Log;
                                                              NLD=Foutopsporingsposten in Gebeurtenislogboek];
                                                   Description=CI-163 }
  }
  KEYS
  {
    {    ;Primary Key                             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148590 IN - Transport
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    DataPerCompany=No;
    OnInsert=BEGIN
               TESTFIELD(Code);

               "Created On" := CURRENTDATETIME;
               "Created By" := USERID;
               "Modified On" := CURRENTDATETIME;
               "Modified By" := USERID;
             END;

    OnModify=BEGIN
               "Modified On" := CURRENTDATETIME;
               "Modified By" := USERID;
             END;

    CaptionML=[ENU=Transport;
               NLD=Transport];
    LookupPageID=Page11116998;
    DrillDownPageID=Page11116998;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code20        ;OnValidate=VAR
                                                                ctRecordAlreadyPresent@1100531000 : TextConst 'ENU="The record already exist.\\Code=''%1'', File Format=''%2''.";NLD="Het record is reeds aanwezig.\\Code=''%1'', Bestandsformaat=''%2''."';
                                                              BEGIN
                                                                IF GET(Code) THEN
                                                                  ERROR(ctRecordAlreadyPresent, Code, Type);
                                                              END;

                                                   CaptionML=[ENU=Code;
                                                              NLD=Code];
                                                   NotBlank=Yes }
    { 2   ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              NLD=Omschrijving];
                                                   NotBlank=Yes }
    { 3   ;   ;Status              ;Option        ;CaptionML=[ENU=Status;
                                                              NLD=Status];
                                                   OptionCaptionML=[ENU=Edit,Manual,Automated,Blocked;
                                                                    NLD=Bewerken,Handmatig,Geautomatiseerd,Geblokkeerd];
                                                   OptionString=Edit,Manual,Automated,Blocked }
    { 4   ;   ;Type                ;Option        ;CaptionML=[ENU=Type;
                                                              NLD=Soort];
                                                   OptionCaptionML=[ENU=FTP Download,FTP Upload,Move,Executable;
                                                                    NLD=FTP Downloaden,FTP Uploaden,Verplaatsen,Executable];
                                                   OptionString=FTP Download,FTP Upload,Move,Executable }
    { 5   ;   ;Address             ;Text250       ;CaptionML=[ENU=Address;
                                                              NLD=Adres] }
    { 6   ;   ;Account             ;Text30        ;CaptionML=[ENU=Account;
                                                              NLD=Account] }
    { 7   ;   ;Password            ;Text30        ;CaptionML=[ENU=Password;
                                                              NLD=Wachtwoord] }
    { 8   ;   ;From Location       ;Text250       ;CaptionML=[ENU=From Location;
                                                              NLD=Vanaf locatie] }
    { 9   ;   ;To Location         ;Text250       ;CaptionML=[ENU=To Location;
                                                              NLD=Naar locatie] }
    { 10  ;   ;Archive Location    ;Text250       ;CaptionML=[ENU=Archive Location;
                                                              NLD=Archief locatie] }
    { 11  ;   ;Transfer Mode       ;Option        ;CaptionML=[ENU=Transfer Mode;
                                                              NLD=Transfermodus];
                                                   OptionCaptionML=[ENU=Bin,Ascii;
                                                                    NLD=Bin,Ascii];
                                                   OptionString=Bin,Ascii }
    { 12  ;   ;Executable          ;Text250       ;CaptionML=[ENU=Executable;
                                                              NLD=Exe-bestand] }
    { 13  ;   ;Filename            ;Text250       ;CaptionML=[ENU=Filename;
                                                              NLD=Bestandsnaam] }
    { 14  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("IN - Comment Line" WHERE (Table Name=CONST(Transport),
                                                                                                Code=FIELD(Code)));
                                                   CaptionML=[ENU=Comment;
                                                              NLD=Opmerking];
                                                   Editable=No }
    { 15  ;   ;Project Code        ;Code20        ;TableRelation="IN - Project";
                                                   OnValidate=VAR
                                                                Project@1000000 : Record 11148620;
                                                              BEGIN
                                                                IF Project.GET("Project Code") THEN
                                                                  Project.TESTFIELD(Blocked, FALSE);
                                                              END;

                                                   CaptionML=[ENU=Project;
                                                              NLD=Project] }
    { 16  ;   ;Created On          ;DateTime      ;CaptionML=[ENU=Created On;
                                                              NLD=Gemaakt op];
                                                   Editable=No }
    { 17  ;   ;Created By          ;Code50        ;CaptionML=[ENU=Created By;
                                                              NLD=Gemaakt door];
                                                   Description=CI-129: was: Code[20];
                                                   Editable=No }
    { 18  ;   ;Modified On         ;DateTime      ;CaptionML=[ENU=Modified On;
                                                              NLD=Gewijzigd op];
                                                   Editable=No }
    { 19  ;   ;Modified By         ;Code50        ;CaptionML=[ENU=Modified By;
                                                              NLD=Gewijzigd door];
                                                   Description=CI-129: was: Code[20];
                                                   Editable=No }
    { 20  ;   ;Original Status     ;Option        ;CaptionML=[ENU=Original Status;
                                                              NLD=Originele status];
                                                   OptionCaptionML=[ENU=Edit,Manual,Automated,Blocked;
                                                                    NLD=Bewerken,Handmatig,Geautomatiseerd,Geblokkeerd];
                                                   OptionString=Edit,Manual,Automated,Blocked }
    { 21  ;   ;Archive add YYYYMMDD;Boolean       ;CaptionML=[ENU=Archive add YYYYMMDD;
                                                              NLD=YYYMMDD toevoegen bij archiveren] }
    { 22  ;   ;FTP Type            ;Option        ;CaptionML=[ENU=FTP Type;
                                                              NLD=FTP-Type];
                                                   OptionCaptionML=[ENU=FTP,SFTP (ssl),SFTP (ssh),Windows EXE;
                                                                    NLD=FTP,SFTP (ssl),SFTP (ssh),Windows EXE];
                                                   OptionString=FTP,SFTP (ssl),SFTP (ssh),Windows EXE }
    { 23  ;   ;Custom Port         ;Integer       ;CaptionML=[ENU=Custom Port;
                                                              NLD=Niet-standaard poort];
                                                   MinValue=0;
                                                   BlankZero=Yes;
                                                   Description=CI-173 }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
    {    ;Project Code                             }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE Process@1000000(DoMessage@1000001 : Boolean);
    VAR
      ProcessTransport@1000000 : Codeunit 11148590;
      ctFileProcessed@1000004 : TextConst 'ENU=1 file transported.;NLD=1 bestand getransporteerd.';
      ctFilesProcessed@1000003 : TextConst 'ENU=%1 files transported.;NLD=%1 bestanden getransporteerd.';
      ctProcessed@1000002 : TextConst 'ENU=Transport processed.;NLD=Transport uitgevoerd.';
    BEGIN
      IF Status = Status::Blocked THEN
        FIELDERROR(Status);

      ProcessTransport.RUN(Rec);

      IF DoMessage THEN
        CASE ProcessTransport.GetNoOfFilesTransported OF
          -1 :
            MESSAGE(ctProcessed);
          1 :
            MESSAGE(ctFileProcessed);
          ELSE
            MESSAGE(ctFilesProcessed, ProcessTransport.GetNoOfFilesTransported);
        END;

      AddTraceEntry(FALSE, '', ProcessTransport.GetNoOfFilesTransported);
    END;

    PROCEDURE ShowCard@1000013();
    VAR
      TransportFTPDownload@1000000 : Page 11117091;
      TransportFTPUpload@1000001 : Page 11117092;
      TransportMovement@1000002 : Page 11117093;
      TransportExecutable@1000003 : Page 11117094;
    BEGIN
      CASE Type OF
        Type::"FTP Download" :
          BEGIN
            TransportFTPDownload.SETRECORD(Rec);
            TransportFTPDownload.RUNMODAL;
          END;

        Type::"FTP Upload" :
          BEGIN
            TransportFTPUpload.SETRECORD(Rec);
            TransportFTPUpload.RUNMODAL;
          END;

        Type::Move :
          BEGIN
            TransportMovement.SETRECORD(Rec);
            TransportMovement.RUNMODAL;
          END;

        Type::Executable :
          BEGIN
            TransportExecutable.SETRECORD(Rec);
            TransportExecutable.RUNMODAL;
          END;

      END;
    END;

    LOCAL PROCEDURE AddTraceEntry@1100531000(Error@1100531003 : Boolean;ErrorMessage@1100531004 : Text[1024];NoOfRecordsProcessed@1100531000 : Integer);
    VAR
      TraceLine@1100531001 : Record 11148630;
      TraceMgt@1100531002 : Codeunit 11148642;
    BEGIN
      TraceMgt.AddTrace(
        TraceLine.Type::Transport, Code, Error, COPYSTR(ErrorMessage, 1, 250), NoOfRecordsProcessed);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148591 IN - Import Definition
{
  OBJECT-PROPERTIES
  {
    Date=14-07-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.1;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               TESTFIELD(Code);

               "Created On" := CURRENTDATETIME;
               "Created By" := USERID;
               "Modified On" := CURRENTDATETIME;
               "Modified By" := USERID;
             END;

    OnModify=BEGIN
               "Modified On" := CURRENTDATETIME;
               "Modified By" := USERID;
             END;

    OnDelete=VAR
               ImportDefinitionLine@1000000 : Record 11148592;
               ImportDefTableLink@1000001 : Record 11148593;
               CommentLine@1000003 : Record 11148613;
             BEGIN
               ImportDefinitionLine.SETRANGE("Import Definition", Code);
               ImportDefinitionLine.DELETEALL(TRUE);

               ImportDefTableLink.SETRANGE("Import Definition", Code);
               ImportDefTableLink.DELETEALL(TRUE);

               CommentLine.SETRANGE("Table Name", CommentLine."Table Name"::"Import Definition");
               CommentLine.SETRANGE(Code, Code);
               CommentLine.DELETEALL(TRUE);
             END;

    CaptionML=[ENU=Import Definition;
               NLD=Importdefinitie];
    LookupPageID=Page11117000;
    DrillDownPageID=Page11117000;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code20        ;OnValidate=VAR
                                                                ctRecordAlreadyPresent@1000000 : TextConst 'ENU="The record already exist.\\Code=''%1'', File Format=''%2''.";NLD="Het record is reeds aanwezig.\\Code=''%1'', Bestandsformaat=''%2''."';
                                                              BEGIN
                                                                IF GET(Code) THEN
                                                                  ERROR(ctRecordAlreadyPresent, Code, "File Format");
                                                              END;

                                                   CaptionML=[ENU=Code;
                                                              NLD=Code];
                                                   NotBlank=Yes }
    { 2   ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              NLD=Omschrijving] }
    { 3   ;   ;Location            ;Text250       ;OnValidate=VAR
                                                                Setup@1000000000 : Record 11148589;
                                                                Mgt@1000000001 : Codeunit 11148589;
                                                              BEGIN
                                                                Location := Mgt.CompletePath(Location);
                                                                Setup.GET;
                                                                IF (Setup."Default Processed Path" <> '') AND ((STRPOS("Processed Location", xRec.Location) > 0) OR ("Processed Location" = ''))
                                                                THEN
                                                                  "Processed Location" := Mgt.BuildPath(Location, Setup."Default Processed Path");
                                                                IF (Setup."Default Error Path" <> '') AND ((STRPOS("Error Location", xRec.Location) > 0) OR ("Error Location" = '')) THEN
                                                                  "Error Location" := Mgt.BuildPath(Location, Setup."Default Error Path");
                                                                IF (Setup."Default Log Path" <> '') AND ((STRPOS("Log Location", xRec.Location) > 0) OR ("Log Location" = '')) THEN
                                                                  "Log Location" := Mgt.BuildPath(Location, Setup."Default Log Path");
                                                              END;

                                                   CaptionML=[ENU=Location;
                                                              NLD=Locatie] }
    { 4   ;   ;Filename            ;Text30        ;CaptionML=[ENU=Filename;
                                                              NLD=Bestandsnaam] }
    { 5   ;   ;Processed Location  ;Text250       ;OnValidate=VAR
                                                                Mgt@1000000000 : Codeunit 11148589;
                                                              BEGIN
                                                                "Processed Location" := Mgt.CompletePath("Processed Location");
                                                              END;

                                                   CaptionML=[ENU=Processed Location;
                                                              NLD=Verwerkt locatie] }
    { 6   ;   ;Log Location        ;Text250       ;OnValidate=VAR
                                                                Mgt@1000000000 : Codeunit 11148589;
                                                              BEGIN
                                                                "Log Location" := Mgt.CompletePath("Log Location");
                                                              END;

                                                   CaptionML=[ENU=Log Location;
                                                              NLD=Log locatie] }
    { 8   ;   ;Run Codeunit No.    ;Integer       ;CaptionML=[ENU=Run Codeunit;
                                                              NLD=Codeunit starten];
                                                   BlankZero=Yes }
    { 9   ;   ;Status              ;Option        ;OnValidate=BEGIN
                                                                IF Status = Status::"Web Service" THEN
                                                                  TESTFIELD("File Format", "File Format"::XML);
                                                              END;

                                                   CaptionML=[ENU=Status;
                                                              NLD=Status];
                                                   OptionCaptionML=[ENU=Edit,Manual,Automated,Blocked,Web Service;
                                                                    NLD=Bewerken,Handmatig,Geautomatiseerd,Geblokkeerd,Web Service];
                                                   OptionString=Edit,Manual,Automated,Blocked,Web Service }
    { 10  ;   ;File Format         ;Option        ;OnValidate=VAR
                                                                RecExtension@1000001 : Text[30];
                                                                xRecExtension@1000000 : Text[30];
                                                              BEGIN
                                                                IF (xRec."File Format" = "File Format"::XML) <> ("File Format" = "File Format"::XML) THEN
                                                                  ConfirmExistingLinesDeleted;

                                                                RecExtension := Extension("File Format");
                                                                xRecExtension := Extension(xRec."File Format");

                                                                IF STRLEN(xRec.Filename) > STRLEN(xRecExtension) THEN
                                                                  IF xRecExtension = COPYSTR(xRec.Filename, STRLEN(xRec.Filename) - STRLEN(xRecExtension) + 1) THEN
                                                                    Filename := COPYSTR(xRec.Filename, 1, STRLEN(xRec.Filename) - STRLEN(xRecExtension) - 1) + '.' + RecExtension;
                                                              END;

                                                   CaptionML=[ENU=File Format;
                                                              NLD=Bestandsformaat];
                                                   OptionCaptionML=[ENU=XML,CSV,Fixed Width,Excel,ADO;
                                                                    NLD=XML,CSV,Fixed Width,Excel,ADO];
                                                   OptionString=XML,CSV,Fixed Width,Excel,ADO }
    { 12  ;   ;Headers             ;Boolean       ;OnValidate=BEGIN
                                                                IF Headers THEN
                                                                  "Start at Line No." := 2
                                                                ELSE
                                                                  "Start at Line No." := 1;
                                                              END;

                                                   CaptionML=[ENU=Headers;
                                                              NLD=Koppen] }
    { 13  ;   ;Field Delimiter     ;Text1         ;InitValue=";
                                                   CaptionML=[ENU=Field Delimiter;
                                                              NLD=Tekstindicator] }
    { 14  ;   ;Field Separator     ;Text1         ;InitValue=,;
                                                   CaptionML=[ENU=Field Separator;
                                                              NLD=Scheidingsteken] }
    { 15  ;   ;Save to Messages    ;Boolean       ;CaptionML=[ENU=Save to Messages;
                                                              NLD=Opslaan in berichten] }
    { 16  ;   ;Main Table No.      ;Integer       ;TableRelation=Object.ID WHERE (Type=CONST(Table),
                                                                                  Company Name=CONST());
                                                   OnValidate=BEGIN
                                                                CALCFIELDS("Main Table Name");
                                                                CALCFIELDS("Main Table No. of Fields");
                                                              END;

                                                   CaptionML=[ENU=Main Table;
                                                              NLD=Hoofdtabel];
                                                   BlankZero=Yes }
    { 19  ;   ;Sub Table No.       ;Integer       ;TableRelation=Object.ID WHERE (Type=CONST(Table),
                                                                                  Company Name=CONST());
                                                   OnValidate=BEGIN
                                                                CALCFIELDS("Sub Table Name");
                                                                CALCFIELDS("Sub Table No. of Fields");
                                                              END;

                                                   CaptionML=[ENU=Sub Table;
                                                              NLD=Subtabel];
                                                   BlankZero=Yes }
    { 24  ;   ;Error Notific. E-Mail Address;Text80;
                                                   CaptionML=[ENU=Error Notification E-Mail Address;
                                                              NLD=Foutmeldingnotificatie e-mailadres] }
    { 25  ;   ;Main Table Name     ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Object.Name WHERE (Type=CONST(Table),
                                                                                         Company Name=CONST(),
                                                                                         ID=FIELD(Main Table No.)));
                                                   CaptionML=[ENU=Main Table Name;
                                                              NLD=Hoofdtabelnaam];
                                                   Editable=No }
    { 26  ;   ;Main Table No. of Fields;Integer   ;FieldClass=FlowField;
                                                   CalcFormula=Count("IN - Import Definition Line" WHERE (Import Definition=FIELD(Code),
                                                                                                          Table No.=FIELD(Main Table No.),
                                                                                                          Field No.=FILTER(<>0)));
                                                   CaptionML=[ENU=Main Table No. of Fields;
                                                              NLD=Hoofdtabel aantal velden];
                                                   Editable=No }
    { 27  ;   ;Sub Table Name      ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Object.Name WHERE (Type=CONST(Table),
                                                                                         Company Name=CONST(),
                                                                                         ID=FIELD(Sub Table No.)));
                                                   CaptionML=[ENU=Sub Table Name;
                                                              NLD=Subtabelnaam];
                                                   Editable=No }
    { 28  ;   ;Sub Table No. of Fields;Integer    ;FieldClass=FlowField;
                                                   CalcFormula=Count("IN - Import Definition Line" WHERE (Import Definition=FIELD(Code),
                                                                                                          Table No.=FIELD(Sub Table No.),
                                                                                                          Field No.=FILTER(<>0)));
                                                   CaptionML=[ENU=Sub Table No. of Fields;
                                                              NLD=Subtabel aantal velden];
                                                   Editable=No }
    { 30  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("IN - Comment Line" WHERE (Table Name=CONST(Import Definition),
                                                                                                Code=FIELD(Code)));
                                                   CaptionML=[ENU=Comment;
                                                              NLD=Opmerking];
                                                   Editable=No }
    { 31  ;   ;Company Name        ;Text30        ;TableRelation=Company;
                                                   CaptionML=[ENU=Company Name;
                                                              NLD=Bedrijfsnaam] }
    { 32  ;   ;Project Code        ;Code20        ;TableRelation="IN - Project";
                                                   OnValidate=VAR
                                                                Project@1000000 : Record 11148620;
                                                              BEGIN
                                                                IF Project.GET("Project Code") THEN
                                                                  Project.TESTFIELD(Blocked, FALSE);
                                                              END;

                                                   CaptionML=[ENU=Project;
                                                              NLD=Project] }
    { 33  ;   ;Start at Line No.   ;Integer       ;InitValue=1;
                                                   CaptionML=[ENU=Start at Line No.;
                                                              NLD=Starten op regelnr.] }
    { 34  ;   ;Error Location      ;Text250       ;OnValidate=VAR
                                                                Mgt@1000000000 : Codeunit 11148589;
                                                              BEGIN
                                                                "Error Location" := Mgt.CompletePath("Error Location");
                                                              END;

                                                   CaptionML=[ENU=Error Location;
                                                              NLD=Foutlocatie] }
    { 35  ;   ;Created On          ;DateTime      ;CaptionML=[ENU=Created On;
                                                              NLD=Gemaakt op];
                                                   Editable=No }
    { 36  ;   ;Created By          ;Code50        ;CaptionML=[ENU=Created By;
                                                              NLD=Gemaakt door];
                                                   Description=CI-129: was: Code[20];
                                                   Editable=No }
    { 37  ;   ;Modified On         ;DateTime      ;CaptionML=[ENU=Modified On;
                                                              NLD=Gewijzigd op];
                                                   Editable=No }
    { 38  ;   ;Modified By         ;Code50        ;CaptionML=[ENU=Modified By;
                                                              NLD=Gewijzigd door];
                                                   Description=CI-129: was: Code[20];
                                                   Editable=No }
    { 39  ;   ;Original Status     ;Option        ;CaptionML=[ENU=Original Status;
                                                              NLD=Originele status];
                                                   OptionCaptionML=[ENU=Edit,Manual,Automated,Blocked,Web Service;
                                                                    NLD=Bewerken,Handmatig,Geautomatiseerd,Geblokkeerd,Web Service];
                                                   OptionString=Edit,Manual,Automated,Blocked,Web Service }
    { 40  ;   ;Archive add YYYYMMDD;Boolean       ;CaptionML=[ENU=Archive add YYYYMMDD;
                                                              NLD=YYYMMDD toevoegen bij archiveren] }
    { 41  ;   ;Connection String   ;Text250       ;CaptionML=[ENU=Connection String;
                                                              NLD=Connectiestring] }
    { 42  ;   ;SQL String          ;Text250       ;CaptionML=[ENU=SQL String;
                                                              NLD=SQL String] }
    { 43  ;   ;Error Notific. Include File;Boolean;CaptionML=[ENU=Error Notific. Include File;
                                                              NLD=Fout. notificatie bestand meesturen] }
    { 44  ;   ;Monitor Modifications;Boolean      ;InitValue=Yes;
                                                   CaptionML=[ENU=Monitor Modifications;
                                                              NLD=Wijzigingen monitoren] }
    { 45  ;   ;Run Task            ;Code20        ;TableRelation="IN - Task";
                                                   CaptionML=[ENU=Run Task;
                                                              NLD=Taak uitvoeren] }
    { 46  ;   ;Version No.         ;Integer       ;CaptionML=[ENU=Version No.;
                                                              NLD=Versienr.] }
    { 47  ;   ;Version Date        ;Date          ;CaptionML=[ENU=Version Date;
                                                              NLD=Versiedatum] }
    { 48  ;   ;Version Time        ;Time          ;CaptionML=[ENU=Version Time;
                                                              NLD=Versietijd] }
    { 50  ;   ;Key                 ;Text50        ;CaptionML=[ENU=Key;
                                                              NLD=Sleutel] }
    { 100 ;   ;Validate XML on Parse;Boolean      ;InitValue=Yes;
                                                   CaptionML=[ENU=Validate XML on Parse;
                                                              NLD=XML valideren bij parseren];
                                                   Description=CI-210 }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
    {    ;Project Code                             }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      HideMessage@1000000 : Boolean;

    PROCEDURE Extension@1000003(FileFormat@1000000 : Option) : Text[30];
    BEGIN
      CASE FileFormat OF
        "File Format"::XML :
          EXIT('xml');

        "File Format"::CSV :
          EXIT('csv');

        "File Format"::"Fixed Width" :
          EXIT('txt');

        "File Format"::Excel :
          EXIT('xlsx');

        "File Format"::ADO :
          EXIT('');

      END;
    END;

    PROCEDURE GetFileName@1000000002(FullName@1000000000 : Text[260]) : Text[260];
    VAR
      Pos@1000000001 : Integer;
    BEGIN
      Pos := STRPOS(FullName, '\');
      IF Pos = 0 THEN
        EXIT(FullName);
      Pos := STRLEN(FullName);
      WHILE (FullName[Pos] <> '\') DO BEGIN
        Pos := Pos -1;
      END;
      EXIT(COPYSTR(FullName, Pos+1));
    END;

    PROCEDURE Process@1100496001();
    VAR
      FindCount@1000000000 : Integer;
      TmpBlob@11154640 : TEMPORARY Record 11148609;
      Directory@1000 : Codeunit 11148652;
      Mgt@1000011 : Codeunit 11148589;
      ImportDefMgt@1000006 : Codeunit 11148591;
      ImportXMLFile@1000000 : Codeunit 11148595;
      ImportFile@1000001 : Codeunit 11148596;
      ImportADO@1000003 : Codeunit 11148599;
      CommentMgt@1000005 : Codeunit 11148622;
      LogMgt@11154639 : Codeunit 11148623;
      Progressbar@1000013 : Codeunit 11148624;
      FormatLocation@1000014 : Text[1024];
      FileName@1001 : Text[260];
      NoOfRecordsProcessed@1100531000 : Integer;
      ctSubject@1000017 : TextConst 'ENU=ConnectIT - Import Definition Error - %1: %2;NLD=ConnectIT - Import Definition Error - %1: %2';
      tBackSlash@1000012 : TextConst 'ENU=\;NLD=\';
      tNoFilesFound@1000009 : TextConst 'ENU=No files found.;NLD=Geen bestanden gevonden.';
      tProcessed@1000008 : TextConst 'ENU=Processed;NLD=Verwerkt';
      tSkipped@1000007 : TextConst 'ENU=Skipped;NLD=Overgeslagen.';
      aFile@11154641 : File;
      InStr@11154642 : InStream;
      OutStr@11154643 : OutStream;
    BEGIN
      IF Status = Status::Blocked THEN
        FIELDERROR(Status);

      CommentMgt.Reset;

      IF "File Format" = "File Format"::ADO THEN BEGIN
        ImportADO.RUN(Rec);

        IF CommentMgt.ErrorOccured THEN
          CommentMgt.AddComment(tSkipped)
        ELSE
          CommentMgt.AddComment(tProcessed);

        IF CommentMgt.ErrorOccured THEN
          IF "Error Notific. E-Mail Address" <> '' THEN
            Mgt.SendEmail("Error Notific. E-Mail Address", STRSUBSTNO(ctSubject, Code, Description), '', '');

        IF NOT HideMessage THEN
          MESSAGE(CommentMgt.MessageText, tBackSlash);

      END ELSE BEGIN
        TESTFIELD(Location);
        FormatLocation := FORMAT(TODAY, 0, Location);
        Mgt.CheckCreateDirectory(FormatLocation);

        CASE Rec.Filename = '' OF
          TRUE: Directory.FindFiles(FALSE, FormatLocation, '*.' + Extension("File Format"));
          FALSE: Directory.FindFiles(FALSE, FormatLocation, Rec.Filename);
        END;

        FindCount := 0;
        WHILE Directory.FindNextFile(FileName) DO BEGIN
          FindCount := FindCount + 1;
          Progressbar.SetText(2, FileName);
          Progressbar.AddRecordCounter(2, 1, '');

          CommentMgt.ResetError;
          CommentMgt.SetFilename(FileName);

          CASE "File Format" OF

            "File Format"::XML :
              BEGIN
                ImportXMLFile.SetFilename(FormatLocation, FileName);
                IF ImportXMLFile.RUN(Rec) THEN
                  NoOfRecordsProcessed := ImportXMLFile.NoOfRecordsProcessed;
              END;

            "File Format"::CSV,
            "File Format"::"Fixed Width",
            "File Format"::Excel :
              BEGIN
                ImportFile.SetFilename(FormatLocation, FileName);
                IF ImportFile.RUN(Rec) THEN
                  NoOfRecordsProcessed := ImportFile.NoOfRecordsProcessed;
              END;

          END;

          AddTraceEntry(FALSE, '', NoOfRecordsProcessed);

          IF "Run Codeunit No." <> 0 THEN
            IF NOT CommentMgt.ErrorOccured THEN
              IF NOT CODEUNIT.RUN("Run Codeunit No.", Rec) THEN
                CommentMgt.AddError(0, 0, GETLASTERRORTEXT);

          IF CommentMgt.ErrorOccured THEN BEGIN
            CommentMgt.AddComment(tSkipped);
          END ELSE BEGIN
            CommentMgt.AddComment(tProcessed);
          END;

          IF CommentMgt.ErrorOccured THEN
            IF "Error Notific. E-Mail Address" <> '' THEN
              IF "Error Notific. Include File" THEN
                Mgt.SendEmail(
                  "Error Notific. E-Mail Address",
                  STRSUBSTNO(ctSubject, Code, Description), CommentMgt.BodyText, FormatLocation + '\' + FileName)
              ELSE
                Mgt.SendEmail("Error Notific. E-Mail Address", STRSUBSTNO(ctSubject, Code, Description), CommentMgt.BodyText, '');

          aFile.OPEN(FormatLocation + '\' + FileName);
          aFile.CREATEINSTREAM(InStr);
          TmpBlob.BLOB.CREATEOUTSTREAM(OutStr);
          COPYSTREAM(OutStr,InStr);
          aFile.CLOSE;

          // KS 17-03-2014 - CI-174, Check Save to Messages flag
          IF "Save to Messages" THEN
            LogMgt.SaveMessageToLog(0, Code, FormatLocation, FileName, TmpBlob, "File Format" = "File Format"::Excel, TRUE);
          // KS CI-174 End.

          IF CommentMgt.ErrorOccured THEN BEGIN
            ImportDefMgt.MoveErrorFile(Rec, FormatLocation, FileName);
          END ELSE BEGIN
            ImportDefMgt.MoveProcessedFile(Rec, FormatLocation, FileName);
          END;

          COMMIT;
        END;
        CommentMgt.WriteLogFile(Rec);
        IF NOT HideMessage THEN
          IF CommentMgt.MessageText <> '' THEN
            MESSAGE(CommentMgt.MessageText, tBackSlash);
      END;

      IF FindCount = 0 THEN
        IF NOT HideMessage THEN
          MESSAGE(tNoFilesFound);
    END;

    PROCEDURE ProcessADO@1000006();
    VAR
      rFile@1000004 : Record 2000000022;
      Mgt@1000011 : Codeunit 11148589;
      ImportDefMgt@1000006 : Codeunit 11148591;
      ImportXMLFile@1000000 : Codeunit 11148595;
      ImportFile@1000001 : Codeunit 11148596;
      CommentMgt@1000005 : Codeunit 11148622;
      Progressbar@1000013 : Codeunit 11148624;
      FormatLocation@1000014 : Text[1024];
      ctSubject@1000017 : TextConst 'ENU=ConnectIT - Import Definition Error - %1: %2;NLD=ConnectIT - Import Definition Error - %1: %2';
      tBackSlash@1000012 : TextConst 'ENU=\;NLD=\';
      tNoFilesFound@1000009 : TextConst 'ENU=No files found.;NLD=Geen bestanden gevonden.';
      tProcessed@1000008 : TextConst 'ENU=Processed;NLD=Verwerkt';
      tSkipped@1000007 : TextConst 'ENU=Skipped;NLD=Overgeslagen.';
    BEGIN
      IF Status = Status::Blocked THEN
        FIELDERROR(Status);

      TESTFIELD(Location);
      FormatLocation := FORMAT(TODAY, 0, Location);
      Mgt.CheckCreateDirectory(FormatLocation);

      rFile.SETRANGE(Path, 'c:\');
      rFile.FINDFIRST;

      rFile.SETRANGE(Path, FormatLocation);

      IF Filename = '' THEN
        rFile.SETFILTER(Name, '@*.' + Extension("File Format"))
      ELSE
        rFile.SETFILTER(Name, '@' + Filename);

      CommentMgt.Reset;

      rFile.SETRANGE("Is a file", TRUE);

      Progressbar.InitializeBar(2, rFile.COUNT);

      IF rFile.FINDSET THEN BEGIN
        REPEAT

          Progressbar.SetText(2, rFile.Name);
          Progressbar.AddRecordCounter(2, 1, '');

          CommentMgt.ResetError;
          CommentMgt.SetFilename(rFile.Name);

          CASE "File Format" OF

            "File Format"::XML :
              BEGIN
                CLEAR(ImportXMLFile);
                ImportXMLFile.SetFilename(FormatLocation, rFile.Name);
                ImportXMLFile.RUN(Rec);
              END;

            "File Format"::CSV,
            "File Format"::"Fixed Width",
            "File Format"::Excel :
              BEGIN
                CLEAR(ImportFile);
                ImportFile.SetFilename(FormatLocation, rFile.Name);
                ImportFile.RUN(Rec);
              END;

          END;

          IF "Run Codeunit No." <> 0 THEN
            IF NOT CommentMgt.ErrorOccured THEN
              IF NOT CODEUNIT.RUN("Run Codeunit No.", Rec) THEN
                CommentMgt.AddError(0, 0, GETLASTERRORTEXT);

          IF CommentMgt.ErrorOccured THEN BEGIN
            CommentMgt.AddComment(tSkipped);
            ImportDefMgt.MoveErrorFile(Rec, rFile.Path, rFile.Name);
          END ELSE BEGIN
            CommentMgt.AddComment(tProcessed);
            ImportDefMgt.MoveProcessedFile(Rec, rFile.Path, rFile.Name);
          END;

          IF CommentMgt.ErrorOccured THEN
            IF "Error Notific. E-Mail Address" <> '' THEN
              Mgt.SendEmail("Error Notific. E-Mail Address", STRSUBSTNO(ctSubject, Code, Description), CommentMgt.BodyText, '');

        UNTIL rFile.NEXT = 0;

        CommentMgt.WriteLogFile(Rec);
        IF NOT HideMessage THEN
          MESSAGE(CommentMgt.MessageText, tBackSlash);
      END ELSE
        IF NOT HideMessage THEN
          MESSAGE(tNoFilesFound);
    END;

    PROCEDURE ProcessWithInstream@1000002(VAR InStr@1000017 : InStream;MessageEntryNo@1000018 : Integer);
    VAR
      rFile@1000004 : Record 2000000022;
      ImportDefMgt@1000006 : Codeunit 11148591;
      ImportXMLFile@1000000 : Codeunit 11148595;
      CommentMgt@1000005 : Codeunit 11148622;
      Progressbar@1000013 : Codeunit 11148624;
      tBackSlash@1000012 : TextConst 'ENU=\;NLD=\';
      tProcessed@1000007 : TextConst 'ENU=Processed;NLD=Verwerkt';
      tSkipped@1000008 : TextConst 'ENU=Skipped;NLD=Overgeslagen.';
    BEGIN
      IF Status = Status::Blocked THEN
        FIELDERROR(Status);

      CommentMgt.Reset;

      Progressbar.InitializeBar(2, rFile.COUNT);

      Progressbar.SetText(2, Filename);
      Progressbar.AddRecordCounter(2, 1, '');

      CommentMgt.ResetError;
      CommentMgt.SetFilename('');

      CASE "File Format" OF

        "File Format"::XML :
          BEGIN
            ImportXMLFile.SetMessageEntryNo(MessageEntryNo);
            ImportXMLFile.SetInstream(InStr);
            ImportXMLFile.RUN(Rec);
          END;

        "File Format"::CSV :
          FIELDERROR("File Format");

        "File Format"::"Fixed Width" :
          FIELDERROR("File Format");

        "File Format"::ADO :
          FIELDERROR("File Format");

      END;

      IF CommentMgt.ErrorOccured THEN
        CommentMgt.AddComment(tSkipped)
      ELSE BEGIN
        CommentMgt.AddComment(tProcessed);
        ImportDefMgt.MoveProcessedFile(Rec, rFile.Path, rFile.Name);
      END;

      CommentMgt.WriteLogFile(Rec);
      IF NOT HideMessage THEN
        MESSAGE(CommentMgt.MessageText, tBackSlash);
    END;

    PROCEDURE SetHideMessage@1000000(NewValue@1000000 : Boolean);
    BEGIN
      HideMessage := NewValue;
    END;

    PROCEDURE Copy@1000000000();
    VAR
      CopyImportDef@1000000000 : Report 11117001;
    BEGIN
      CopyImportDef.SetImportDef(Rec);
      CopyImportDef.RUNMODAL;
    END;

    PROCEDURE CopyTo@1000000001();
    VAR
      CopyRules@1000000000 : Record 11148643;
    BEGIN
      TESTFIELD(Code);
      CopyRules.SetupCopy(0, Code);
      CopyRules.SETRANGE("Definition Type", CopyRules."Definition Type"::Import);
      CopyRules.SETRANGE("Definition Code", Code);
      PAGE.RUN(0, CopyRules);
    END;

    PROCEDURE TestFile@1000004();
    VAR
      ImportXMLFile@1000004 : Codeunit 11148595;
      ImportFile@1000012 : Codeunit 11148596;
      CommentMgt@1000003 : Codeunit 11148622;
      LogMgt@1000000 : Codeunit 11148623;
      FileName2@1000013 : Text[1024];
      FilePath@1000005 : Text[1024];
      BackSlashPos@1000009 : Integer;
      i@1000010 : Integer;
      ctExtensions@1000002 : TextConst 'ENU=Interface Files (*.%1)|*.%1|All Files (*.*)|*.*;NLD=Interface Files (*.%1)|*.%1|All Files (*.*)|*.*';
      ctFileValid@1000007 : TextConst 'ENU=File is valid.;NLD=Bestand is geldig.';
      ctTitleText@1000001 : TextConst 'ENU=Test File...;NLD=Bestand controleren...';
      tBackSlash@1000008 : TextConst 'ENU=\;NLD=\';
    BEGIN
      LogMgt.SetDialogProperties(FORMAT(ctTitleText), STRSUBSTNO(ctExtensions, Extension("File Format")), '', 1);
      IF NOT LogMgt.RUN THEN
        EXIT;

      FileName2 := LogMgt.GetDialogFilename;
      IF FileName2 = '' THEN
        EXIT;

      i := 1;
      WHILE i <= STRLEN(FileName2) DO BEGIN
        IF FileName2[i] = '\' THEN
          BackSlashPos := i;
        i += 1;
      END;

      IF BackSlashPos > 0 THEN BEGIN
        FilePath := COPYSTR(FileName2, 1, BackSlashPos);
        FileName2 := COPYSTR(FileName2, BackSlashPos + 1);
      END;

      CommentMgt.Reset;
      CommentMgt.SetFilename(FileName2);

      CASE "File Format" OF

        "File Format"::XML :
          BEGIN
            ImportXMLFile.SetFilename(FilePath, FileName2);
            ImportXMLFile.TestFile(Rec);
          END;

        "File Format"::CSV,
        "File Format"::"Fixed Width",
        "File Format"::Excel :
          BEGIN
            ImportFile.SetFilename(FilePath, FileName2);
            ImportFile.TestFile(Rec);
          END;

      END;

      IF NOT CommentMgt.ErrorOccured THEN
        CommentMgt.AddComment(ctFileValid);

      MESSAGE(CommentMgt.MessageText, tBackSlash);
    END;

    PROCEDURE UpdateTableFields@1000005(MainTable@1000007 : Boolean;TableNo@1000004 : Integer;VAR Fld@1000000 : Record 2000000041);
    VAR
      ImportDefinitionLine@1000001 : Record 11148592;
      ImportDefinitionLine2@1000002 : Record 11148592;
      ImportDefinitionLine3@1000006 : Record 11148592;
      Mgt@1000005 : Codeunit 11148589;
    BEGIN
      ImportDefinitionLine.SETRANGE("Import Definition", Code);
      ImportDefinitionLine.SETRANGE("Table No.", TableNo);
      ImportDefinitionLine.SETFILTER("Field No.", '<>0');
      IF ImportDefinitionLine.FINDSET THEN
        REPEAT
          IF NOT Fld.GET(ImportDefinitionLine."Table No.", ImportDefinitionLine."Field No.") THEN
            ImportDefinitionLine.DELETE(TRUE);
        UNTIL ImportDefinitionLine.NEXT = 0;

      IF Fld.FINDSET THEN
        REPEAT
          ImportDefinitionLine.SETRANGE("Field No.", Fld."No.");
          IF NOT ImportDefinitionLine.FINDFIRST THEN BEGIN

            ImportDefinitionLine2.SETCURRENTKEY("Import Definition", "Line No.");
            ImportDefinitionLine2.SETRANGE("Import Definition", Code);
            ImportDefinitionLine2.SETRANGE("Table No.", TableNo);
            ImportDefinitionLine2.SETFILTER("Field No.", '<>0');
            IF ImportDefinitionLine2.FINDLAST THEN BEGIN
              ImportDefinitionLine2.SetupNewLine(ImportDefinitionLine2, TRUE);
              ImportDefinitionLine2.VALIDATE(Type, ImportDefinitionLine2.Type::Value);
              ImportDefinitionLine2.VALIDATE("Table No.", TableNo);
              ImportDefinitionLine2.VALIDATE("Field No.", Fld."No.");
              ImportDefinitionLine2.INSERT(TRUE);
            END ELSE

              CASE "File Format" OF

                "File Format"::XML :
                  BEGIN
                    ImportDefinitionLine2.RESET;
                    ImportDefinitionLine2.SETCURRENTKEY("Import Definition", "Line No.");
                    ImportDefinitionLine2.SETRANGE("Import Definition", Code);
                    ImportDefinitionLine2.SETRANGE(Type, ImportDefinitionLine2.Type::Table);
                    ImportDefinitionLine2.SETRANGE("Table No.", TableNo);
                    IF ImportDefinitionLine2.FINDFIRST THEN BEGIN
                      ImportDefinitionLine2.SetupNewLine(ImportDefinitionLine2, TRUE);
                      ImportDefinitionLine2.VALIDATE(Type, ImportDefinitionLine2.Type::Value);
                      ImportDefinitionLine2.VALIDATE("Table No.", TableNo);
                      ImportDefinitionLine2.VALIDATE("Field No.", Fld."No.");
                      ImportDefinitionLine2.INSERT(TRUE);
                    END ELSE BEGIN

                      ImportDefinitionLine2.RESET;
                      ImportDefinitionLine2.SETCURRENTKEY("Import Definition", "Line No.");
                      ImportDefinitionLine2.SETRANGE("Import Definition", Code);
                      IF ImportDefinitionLine2.FINDLAST THEN
                        ImportDefinitionLine2.SetupNewLine(ImportDefinitionLine2, TRUE)
                      ELSE BEGIN
                        ImportDefinitionLine2."Import Definition" := Code;
                        ImportDefinitionLine2."Entry No." := 1;
                        ImportDefinitionLine2."Line No." := 10000;
                      END;
                      ImportDefinitionLine2.VALIDATE(Type, ImportDefinitionLine2.Type::Tag);
                      ImportDefinitionLine2."Tag Name" := Mgt.TableTagName(TableNo) + 's';
                      ImportDefinitionLine2.INSERT(TRUE);

                      ImportDefinitionLine2.SetupNewLine(ImportDefinitionLine2, TRUE);
                      ImportDefinitionLine2.VALIDATE(Type, ImportDefinitionLine2.Type::Table);
                      ImportDefinitionLine2.VALIDATE("Table No.", TableNo);
                      ImportDefinitionLine2."Tag Name" := Mgt.TableTagName(TableNo);

                      IF NOT MainTable THEN BEGIN
                        ImportDefinitionLine3.SETCURRENTKEY("Import Definition", "Line No.");
                        ImportDefinitionLine3.SETRANGE("Import Definition", Code);
                        ImportDefinitionLine3.SETRANGE(Type, ImportDefinitionLine3.Type::Table);
                        ImportDefinitionLine3.SETRANGE("Table No.", "Main Table No.");
                        IF ImportDefinitionLine3.FINDFIRST THEN
                          ImportDefinitionLine2.VALIDATE("Link to Table (Tag Name)", ImportDefinitionLine3."Tag Name");
                      END;

                      ImportDefinitionLine2.INSERT(TRUE);

                      ImportDefinitionLine2.SetupNewLine(ImportDefinitionLine2, TRUE);
                      ImportDefinitionLine2.VALIDATE(Type, ImportDefinitionLine2.Type::Value);
                      ImportDefinitionLine2.VALIDATE("Table No.", TableNo);
                      ImportDefinitionLine2.VALIDATE("Field No.", Fld."No.");
                      ImportDefinitionLine2.INSERT(TRUE);
                    END;

                  END;

                "File Format"::CSV, "File Format"::"Fixed Width", "File Format"::Excel, "File Format"::ADO :
                  BEGIN
                    ImportDefinitionLine2.RESET;
                    ImportDefinitionLine2.SETCURRENTKEY("Import Definition", "Line No.");
                    ImportDefinitionLine2.SETRANGE("Import Definition", Code);
                    ImportDefinitionLine2.SETRANGE(Type, ImportDefinitionLine2.Type::Table);
                    ImportDefinitionLine2.SETRANGE("Table No.", TableNo);
                    IF ImportDefinitionLine2.FINDFIRST THEN BEGIN
                      ImportDefinitionLine2.SetupNewLine(ImportDefinitionLine2, TRUE);
                      ImportDefinitionLine2.VALIDATE(Type, ImportDefinitionLine2.Type::Value);
                      ImportDefinitionLine2.VALIDATE("Table No.", TableNo);
                      ImportDefinitionLine2.VALIDATE("Field No.", Fld."No.");
                      ImportDefinitionLine2.INSERT(TRUE);
                    END ELSE BEGIN

                      ImportDefinitionLine2.RESET;
                      ImportDefinitionLine2.SETCURRENTKEY("Import Definition", "Line No.");
                      ImportDefinitionLine2.SETRANGE("Import Definition", Code);
                      IF ImportDefinitionLine2.FINDLAST THEN
                        ImportDefinitionLine2.SetupNewLine(ImportDefinitionLine2, TRUE)
                      ELSE BEGIN
                        ImportDefinitionLine2."Import Definition" := Code;
                        ImportDefinitionLine2."Entry No." := 1;
                        ImportDefinitionLine2."Line No." := 10000;
                      END;
                      ImportDefinitionLine2.VALIDATE(Type, ImportDefinitionLine2.Type::Table);
                      ImportDefinitionLine2.VALIDATE("Table No.", TableNo);
                      ImportDefinitionLine2."Tag Name" := Mgt.TableTagName(TableNo);

                      IF NOT MainTable THEN BEGIN
                        ImportDefinitionLine3.SETCURRENTKEY("Import Definition", "Line No.");
                        ImportDefinitionLine3.SETRANGE("Import Definition", Code);
                        ImportDefinitionLine3.SETRANGE(Type, ImportDefinitionLine3.Type::Table);
                        ImportDefinitionLine3.SETRANGE("Table No.", "Main Table No.");
                        IF ImportDefinitionLine3.FINDFIRST THEN
                          ImportDefinitionLine2.VALIDATE("Link to Table (Tag Name)", ImportDefinitionLine3."Tag Name");
                      END;

                      ImportDefinitionLine2.INSERT(TRUE);

                      ImportDefinitionLine2.SetupNewLine(ImportDefinitionLine2, TRUE);
                      ImportDefinitionLine2.VALIDATE(Type, ImportDefinitionLine2.Type::Value);
                      ImportDefinitionLine2.VALIDATE("Table No.", TableNo);
                      ImportDefinitionLine2.VALIDATE("Field No.", Fld."No.");
                      ImportDefinitionLine2.INSERT(TRUE);
                    END;
                  END;

              END;

          END;
        UNTIL Fld.NEXT = 0;

      RenumberLines;
    END;

    PROCEDURE RenumberLines@1000009();
    VAR
      ImportDefinitionLine@1000000 : Record 11148592;
      TmpImportDefinitionLine@1000003 : TEMPORARY Record 11148592;
      LineCounter@1000002 : Integer;
      NoOfLines@1000001 : Integer;
    BEGIN
      ImportDefinitionLine.SETCURRENTKEY("Import Definition", "Line No.");
      ImportDefinitionLine.SETRANGE("Import Definition", Code);
      NoOfLines := ImportDefinitionLine.COUNT;
      IF ImportDefinitionLine.FINDLAST THEN
        REPEAT
          LineCounter += 1;
          TmpImportDefinitionLine := ImportDefinitionLine;
          TmpImportDefinitionLine."Line No." := (NoOfLines - LineCounter + 1) * 10000;
          TmpImportDefinitionLine.INSERT;
        UNTIL ImportDefinitionLine.NEXT(-1) = 0;

      IF TmpImportDefinitionLine.FINDSET THEN
        REPEAT
          ImportDefinitionLine := TmpImportDefinitionLine;
          ImportDefinitionLine.MODIFY;
        UNTIL TmpImportDefinitionLine.NEXT = 0;
    END;

    PROCEDURE ReversedDataMapping@1000001();
    VAR
      ReversedDataMapping@1100531000 : Codeunit 11148607;
    BEGIN
      ReversedDataMapping.ImportDef(Rec);
    END;

    PROCEDURE ShowCard@1000013();
    VAR
      XMLExportCard@1000000 : Page 11117069;
      CSVExportCard@1000001 : Page 11117071;
      FixedWidthExportCard@1000002 : Page 11117073;
      ExcelExportCard@1000003 : Page 11117075;
      ADOExportCard@1000004 : Page 11117077;
    BEGIN
      CASE "File Format" OF
        "File Format"::XML :
          BEGIN
            XMLExportCard.SETRECORD(Rec);
            XMLExportCard.RUNMODAL;
          END;

        "File Format"::CSV :
          BEGIN
            CSVExportCard.SETRECORD(Rec);
            CSVExportCard.RUNMODAL;
          END;

        "File Format"::"Fixed Width" :
          BEGIN
            FixedWidthExportCard.SETRECORD(Rec);
            FixedWidthExportCard.RUNMODAL;
          END;

        "File Format"::Excel :
          BEGIN
            ExcelExportCard.SETRECORD(Rec);
            ExcelExportCard.RUNMODAL;
          END;

        "File Format"::ADO :
          BEGIN
            ADOExportCard.SETRECORD(Rec);
            ADOExportCard.RUNMODAL;
          END;
      END;
    END;

    PROCEDURE ConfirmExistingLinesDeleted@1100531002();
    VAR
      ExportDefinitionLine@1100531001 : Record 11148600;
      ctConfirm@1100531000 : TextConst 'ENU=Existing lines wil be deleted.\Are you sure?;NLD=De bestaande regels zullen worden verwijderd.\Weet u het zeker?';
    BEGIN
      ExportDefinitionLine.SETRANGE("Export Definition", Code);
      IF NOT ExportDefinitionLine.ISEMPTY THEN BEGIN
        IF NOT CONFIRM(ctConfirm, TRUE) THEN
          ERROR('');
        ExportDefinitionLine.DELETEALL(TRUE);
      END;
    END;

    LOCAL PROCEDURE AddTraceEntry@1100531000(Error@1100531003 : Boolean;ErrorMessage@1100531004 : Text[1024];NoOfRecordsProcessed@1100531000 : Integer);
    VAR
      TraceLine@1100531001 : Record 11148630;
      TraceMgt@1100531002 : Codeunit 11148642;
    BEGIN
      TraceMgt.AddTrace(
        TraceLine.Type::"Import Definition", Code, Error, COPYSTR(ErrorMessage, 1, 250), NoOfRecordsProcessed);
    END;

    PROCEDURE SaveNewVersion@1100531001();
    VAR
      VersionMgt@1100531000 : Codeunit 11148644;
    BEGIN
      VersionMgt.ImportAddNewVersion(Rec);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148592 IN - Import Definition Line
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    OnDelete=VAR
               ImportDefTableLink@1000000 : Record 11148593;
               ImportDefFunction@1100531000 : Record 11148594;
               ImportRestriction@1000001 : Record 11148596;
             BEGIN
               ImportDefTableLink.SETRANGE("Import Definition", "Import Definition");
               ImportDefTableLink.SETRANGE("Import Def. Entry No.", "Entry No.");
               ImportDefTableLink.DELETEALL(TRUE);

               ImportRestriction.SETRANGE("Import Definition", "Import Definition");
               ImportRestriction.SETRANGE("Import Def. Entry No.", "Entry No.");
               ImportRestriction.DELETEALL(TRUE);

               ImportDefFunction.SETRANGE("Import Definition", "Import Definition");
               ImportDefFunction.SETRANGE("Import Def. Entry No.", "Entry No.");
               ImportDefFunction.DELETEALL(TRUE);
             END;

    CaptionML=[ENU=Import Definition Line;
               NLD=Importdefinitieregel];
  }
  FIELDS
  {
    { 1   ;   ;Import Definition   ;Code20        ;TableRelation="IN - Import Definition";
                                                   CaptionML=[ENU=Import Definition;
                                                              NLD=Importdefinitie] }
    { 2   ;   ;Entry No.           ;Integer       ;CaptionML=[ENU=Entry No.;
                                                              NLD=Volgnummer] }
    { 3   ;   ;Line No.            ;Integer       ;CaptionML=[ENU=Line No.;
                                                              NLD=Regelnr.] }
    { 4   ;   ;Indent              ;Integer       ;CaptionML=[ENU=Indent;
                                                              NLD=Inspringen] }
    { 5   ;   ;Tag Name            ;Text50        ;CaptionML=[ENU=Tag Name;
                                                              NLD=Tagnaam] }
    { 6   ;   ;Type                ;Option        ;OnValidate=VAR
                                                                ImportDefinition@1000000 : Record 11148591;
                                                              BEGIN
                                                                IF Type = Type::Tag THEN BEGIN
                                                                  ImportDefinition.GET("Import Definition");
                                                                  ImportDefinition.TESTFIELD("File Format", ImportDefinition."File Format"::XML);
                                                                END;

                                                                Width := 30;
                                                              END;

                                                   CaptionML=[ENU=Type;
                                                              NLD=Soort];
                                                   OptionCaptionML=[ENU=" ,Tag,Table,Value,Const,Variable,Skip";
                                                                    NLD=" ,Tag,Tabel,Waarde,Constante,Variabele,Overslaan"];
                                                   OptionString=[ ,Tag,Table,Value,Const,Variable,Skip] }
    { 7   ;   ;Code                ;Text250       ;TableRelation=IF (Type=CONST(Variable)) "IN - Variable";
                                                   CaptionML=[ENU=Code;
                                                              NLD=Code] }
    { 8   ;   ;No. of Functions    ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("IN - Import Def. Function" WHERE (Import Definition=FIELD(Import Definition),
                                                                                                        Import Def. Entry No.=FIELD(Entry No.)));
                                                   CaptionML=[ENU=No. of Functions;
                                                              NLD=Aantal functies];
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 9   ;   ;Functions           ;Boolean       ;CaptionML=[ENU=Functions;
                                                              NLD=Functies];
                                                   Editable=No }
    { 10  ;   ;Table No.           ;Integer       ;TableRelation=Object.ID WHERE (Type=CONST(Table),
                                                                                  Company Name=CONST());
                                                   OnValidate=VAR
                                                                ImportRestriction@1000000 : Record 11148596;
                                                                Mgt@1000001 : Codeunit 11148589;
                                                              BEGIN
                                                                CALCFIELDS("Table Name");
                                                                VALIDATE("Field No.", 0);

                                                                VALIDATE("Link to Table (Tag Name)", '');
                                                                VALIDATE("Conversion Code", '');

                                                                ImportRestriction.SETRANGE("Import Definition", "Import Definition");
                                                                ImportRestriction.SETRANGE("Import Def. Entry No.", "Entry No.");
                                                                ImportRestriction.DELETEALL(TRUE);

                                                                IF Type = Type::Table THEN
                                                                  IF "Table No." <> 0 THEN
                                                                    IF ("Tag Name" = '') OR (xRec."Tag Name" = Mgt.TableTagName(xRec."Table No.")) THEN
                                                                      "Tag Name" := Mgt.TableTagName("Table No.");
                                                              END;

                                                   CaptionML=[ENU=Table;
                                                              NLD=Tabel];
                                                   BlankZero=Yes }
    { 11  ;   ;Field No.           ;Integer       ;TableRelation=Field.No. WHERE (TableNo=FIELD(Table No.),
                                                                                  Type=FILTER(RecordID|Text|Code|GUID|Date|Time|DateFormula|Decimal|Integer|Option|Boolean|BigInteger|Duration|DateTime),
                                                                                  Class=CONST(Normal));
                                                   OnValidate=VAR
                                                                Fld@1000002 : Record 2000000041;
                                                                Mgt@1000000 : Codeunit 11148589;
                                                              BEGIN
                                                                IF "Tag Name" = '' THEN
                                                                  "Tag Name" := Mgt.FieldTagName("Table No.", "Field No.");

                                                                IF Fld.GET("Table No.", "Field No.") THEN
                                                                  Width := Mgt.GetWidth(Fld);
                                                              END;

                                                   CaptionML=[ENU=Field;
                                                              NLD=Veld];
                                                   BlankZero=Yes }
    { 12  ;   ;Data Format         ;Option        ;InitValue=XML;
                                                   CaptionML=[ENU=Format;
                                                              NLD=Formaat];
                                                   OptionCaptionML=[ENU=" ,Navision,XML,Custom";
                                                                    NLD=" ,Navision,XML,Aangepast"];
                                                   OptionString=[ ,Navision,XML,Custom] }
    { 13  ;   ;Conversion Code     ;Code20        ;TableRelation="IN - Conversion";
                                                   CaptionML=[ENU=Conversion Code;
                                                              NLD=Conversie] }
    { 14  ;   ;Mandatory           ;Boolean       ;CaptionML=[ENU=Mandatory;
                                                              NLD=Verplicht] }
    { 15  ;   ;Error No. Field Mandatory;Integer  ;CaptionML=[ENU=Error No. Field Mandatory;
                                                              NLD=Foutnummer veld verplicht];
                                                   BlankZero=Yes }
    { 16  ;   ;Skip If Empty       ;Boolean       ;CaptionML=[ENU=Skip If Empty;
                                                              NLD=Als leeg overslaan] }
    { 17  ;   ;Validate Field      ;Boolean       ;InitValue=Yes;
                                                   CaptionML=[ENU=Validate;
                                                              NLD=Valideren] }
    { 18  ;   ;Save Record         ;Boolean       ;CaptionML=[ENU=Save Record;
                                                              NLD=Record opslaan] }
    { 19  ;   ;Existing Record     ;Option        ;CaptionML=[ENU=Existing Record;
                                                              NLD=Bestaand record];
                                                   OptionCaptionML=[ENU=Update,Create,Delete,Error,Nothing;
                                                                    NLD=Wijzigen,Aanmaken,Verwijderen,Foutmelding,Niets];
                                                   OptionString=Update,Create,Delete,Error,Nothing }
    { 20  ;   ;Error No. Existing Record;Integer  ;CaptionML=[ENU=Error No. Existing Record;
                                                              NLD=Foutnummer bestaand record];
                                                   BlankZero=Yes }
    { 21  ;   ;New Record          ;Option        ;CaptionML=[ENU=New Record;
                                                              NLD=Nieuw record];
                                                   OptionCaptionML=[ENU=Create,Skip,Error;
                                                                    NLD=Aanmaken,Overslaan,Foutmelding];
                                                   OptionString=Create,Skip,Error }
    { 22  ;   ;Error No. New Record;Integer       ;CaptionML=[ENU=Error No. New Record;
                                                              NLD=Foutnummer nieuw record];
                                                   BlankZero=Yes }
    { 23  ;   ;Dest. Variable      ;Code20        ;TableRelation="IN - Variable";
                                                   CaptionML=[ENU=Dest. Variable;
                                                              NLD=Doelvariabele] }
    { 24  ;   ;As Attribute        ;Boolean       ;CaptionML=[ENU=As Attribute;
                                                              NLD=Als attribuut] }
    { 25  ;   ;Width               ;Integer       ;CaptionML=[ENU=Width;
                                                              NLD=Breedte];
                                                   BlankZero=Yes }
    { 26  ;   ;Link to Table (Tag Name);Text50    ;OnValidate=VAR
                                                                ImportDefinitionLine@1100531001 : Record 11148592;
                                                                ImportDefTableLink@1000000 : Record 11148593;
                                                                Relation@1100531003 : Record 11148625;
                                                                RelationFilter@1100531002 : Record 11148627;
                                                                FieldNo@1100531000 : Integer;
                                                              BEGIN
                                                                ImportDefTableLink.SETRANGE("Import Definition", "Import Definition");
                                                                ImportDefTableLink.SETRANGE("Import Def. Entry No.", "Entry No.");
                                                                ImportDefTableLink.DELETEALL;

                                                                ImportDefinitionLine.SETCURRENTKEY("Import Definition", "Line No.");
                                                                ImportDefinitionLine.SETRANGE("Import Definition", "Import Definition");
                                                                ImportDefinitionLine.SETFILTER("Line No.", '<%1', "Line No.");
                                                                ImportDefinitionLine.SETRANGE("Tag Name", "Link to Table (Tag Name)");
                                                                ImportDefinitionLine.SETRANGE(Type, ImportDefinitionLine.Type::Table);
                                                                IF ImportDefinitionLine.FINDLAST THEN BEGIN
                                                                  Relation.SETCURRENTKEY("Table No.");
                                                                  Relation.SETRANGE("Table No.", ImportDefinitionLine."Table No.");
                                                                  Relation.SETRANGE("Relation Table No.", "Table No.");
                                                                  IF Relation.FINDFIRST THEN BEGIN
                                                                    ImportDefTableLink."Import Definition" := "Import Definition";
                                                                    ImportDefTableLink."Import Def. Entry No." := "Entry No.";
                                                                    ImportDefTableLink."Main Table No." := Relation."Table No.";
                                                                    ImportDefTableLink."Main Field No." := Relation."Field No.";
                                                                    ImportDefTableLink."Sub Table No." := Relation."Relation Table No.";
                                                                    ImportDefTableLink."Sub Field No." := Relation."Relation Field No.";
                                                                    ImportDefTableLink.INSERT;

                                                                    RelationFilter.SETCURRENTKEY("Relation Entry No.");
                                                                    RelationFilter.SETRANGE("Relation Entry No.", Relation."Entry No.");
                                                                    RelationFilter.SETRANGE(Type, RelationFilter.Type::Field);
                                                                    IF RelationFilter.FINDSET THEN
                                                                      REPEAT
                                                                        EVALUATE(FieldNo, RelationFilter.Value);
                                                                        ImportDefTableLink."Main Field No." := FieldNo;
                                                                        ImportDefTableLink."Sub Field No." := RelationFilter."Field No.";
                                                                        ImportDefTableLink.INSERT;
                                                                      UNTIL RelationFilter.NEXT = 0;

                                                                  END ELSE BEGIN
                                                                    Relation.SETCURRENTKEY("Relation Table No.");
                                                                    Relation.SETRANGE("Relation Table No.", ImportDefinitionLine."Table No.");
                                                                    Relation.SETRANGE("Table No.", "Table No.");
                                                                    IF Relation.FINDFIRST THEN BEGIN
                                                                      ImportDefTableLink."Import Definition" := "Import Definition";
                                                                      ImportDefTableLink."Import Def. Entry No." := "Entry No.";
                                                                      ImportDefTableLink."Main Table No." := Relation."Relation Table No.";
                                                                      ImportDefTableLink."Main Field No." := Relation."Relation Field No.";
                                                                      ImportDefTableLink."Sub Table No." := Relation."Table No.";
                                                                      ImportDefTableLink."Sub Field No." := Relation."Field No.";
                                                                      ImportDefTableLink.INSERT;

                                                                      RelationFilter.SETCURRENTKEY("Relation Entry No.");
                                                                      RelationFilter.SETRANGE("Relation Entry No.", Relation."Entry No.");
                                                                      RelationFilter.SETRANGE(Type, RelationFilter.Type::Field);
                                                                      IF RelationFilter.FINDSET THEN
                                                                        REPEAT
                                                                          EVALUATE(FieldNo, RelationFilter.Value);
                                                                          ImportDefTableLink."Main Field No." := RelationFilter."Field No.";
                                                                          ImportDefTableLink."Sub Field No." := FieldNo;
                                                                          ImportDefTableLink.INSERT;
                                                                        UNTIL RelationFilter.NEXT = 0;

                                                                    END;
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Link to Table (Tag Name);
                                                              NLD=Linken aan tabel (tagnaam)] }
    { 27  ;   ;Table Name          ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Object.Name WHERE (Type=CONST(Table),
                                                                                         Company Name=CONST(),
                                                                                         ID=FIELD(Table No.)));
                                                   CaptionML=[ENU=Table Name;
                                                              NLD=Tabelnaam];
                                                   Editable=No }
    { 28  ;   ;Field Name          ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Field.FieldName WHERE (TableNo=FIELD(Table No.),
                                                                                             No.=FIELD(Field No.)));
                                                   CaptionML=[ENU=Field Name;
                                                              NLD=Veldnaam];
                                                   Editable=No }
    { 29  ;   ;No. of Restrictions ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("IN - Import Restriction" WHERE (Import Definition=FIELD(Import Definition),
                                                                                                      Import Def. Entry No.=FIELD(Entry No.)));
                                                   CaptionML=[ENU=No. of Restrictions;
                                                              NLD=Aantal restricties];
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 30  ;   ;Increment Method    ;Option        ;CaptionML=[ENU=Increment Method;
                                                              NLD=Ophoogmethode];
                                                   OptionCaptionML=[ENU=" ,1,10000,Max. + 1,Max. + 10000";
                                                                    NLD=" ,1,10000,Max. + 1,Max. + 10000"];
                                                   OptionString=[ ,1,10000,Max. + 1,Max. + 10000] }
    { 31  ;   ;Original Value      ;Boolean       ;OnValidate=VAR
                                                                ImportDefinition@1000000 : Record 11148591;
                                                              BEGIN
                                                                IF "Original Value" THEN BEGIN
                                                                  ImportDefinition.GET("Import Definition");
                                                                  ImportDefinition.TESTFIELD("File Format", ImportDefinition."File Format"::XML);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Original Value;
                                                              NLD=Originele waarde] }
    { 32  ;   ;Clear Every Record  ;Boolean       ;InitValue=Yes;
                                                   CaptionML=[ENU=Clear Every Record;
                                                              NLD=Ieder record schonen] }
    { 33  ;   ;Option Type         ;Option        ;CaptionML=[ENU=Option Type;
                                                              NLD=Optietype];
                                                   OptionCaptionML=[ENU=Value,Name,Caption;
                                                                    NLD=Waarde,Naam,Caption];
                                                   OptionString=Value,Name,Caption }
    { 34  ;   ;Identifier          ;Boolean       ;CaptionML=[ENU=Identifier;
                                                              NLD=Identificatie] }
    { 35  ;   ;Version No.         ;Integer       ;CaptionML=[ENU=Version No.;
                                                              NLD=Versienr.] }
    { 36  ;   ;No. Series          ;Boolean       ;CaptionML=[ENU=Uses No. Series;
                                                              NLD=Gebruikt Nr. Reeks] }
    { 37  ;   ;XML Namespace       ;Text80        ;CaptionML=[ENU=XML Namespace;
                                                              NLD=XML Namespace];
                                                   Description=CI-140 }
    { 38  ;   ;XML Namespace Prefix;Text30        ;CaptionML=[ENU=XML Namespace Prefix;
                                                              NLD=XML Namespace Prefix];
                                                   Description=CI-140 }
    { 40  ;   ;Custom Date Order   ;Option        ;CaptionML=[ENU=Custom Date Order;
                                                              NLD=Aangepaste datumvolgorde];
                                                   OptionCaptionML=[ENU=YMD,DMY,MDY;
                                                                    NLD=JMD,DMJ,MDJ];
                                                   OptionString=YMD,DMY,MDY;
                                                   Description=CI-133 }
    { 41  ;   ;Custom Date Separator;Text1        ;CaptionML=[ENU=Custom Date Separator;
                                                              NLD=Aangepast datumscheidingsteken];
                                                   Description=CI-133 }
  }
  KEYS
  {
    {    ;Import Definition,Entry No.             ;Clustered=Yes }
    {    ;Import Definition,Line No.               }
    {    ;Import Definition,Tag Name               }
    {    ;XML Namespace Prefix                     }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE ClearFields@1000001();
    BEGIN
      "As Attribute" := FALSE;
      "Table No." := 0;
      "Field No." := 0;
      "Data Format" := "Data Format"::" ";
      // CI-133.begin
      "Custom Date Order" := 0;
      "Custom Date Separator" := '';
      // CI-133.end
      "Conversion Code" := '';
      "Link to Table (Tag Name)" := '';
      "Validate Field" := FALSE;
      Width := 0;
    END;

    PROCEDURE LookupLinkToTable@1000003();
    BEGIN
    END;

    PROCEDURE SetupLinkToTable@1000005();
    VAR
      ImportDefinition@1000002 : Record 11148591;
      ImportDefinitionLine@1000001 : Record 11148592;
      ImportDefTableLink@1000000 : Page 11148604;
    BEGIN
      TESTFIELD("Link to Table (Tag Name)");

      ImportDefinitionLine.SETCURRENTKEY("Import Definition", "Line No.");
      ImportDefinitionLine.SETRANGE("Import Definition", "Import Definition");
      ImportDefinitionLine.SETRANGE("Tag Name", "Link to Table (Tag Name)");
      ImportDefinitionLine.FINDFIRST;
      ImportDefinition.GET("Import Definition");
      IF ImportDefinition."File Format" = ImportDefinition."File Format"::XML THEN
        ImportDefinitionLine.TESTFIELD(Type, ImportDefinitionLine.Type::Table);

      ImportDefTableLink.SetMainTable(ImportDefinitionLine);
      ImportDefTableLink.SetSubTable(Rec);
      ImportDefTableLink.RUN;
    END;

    PROCEDURE SetupNewLine@1000015(xRec2@1000001 : Record 11148592;BelowxRec@1000000 : Boolean) : Code[20];
    VAR
      ImportDefinition@1000003 : Record 11148591;
      ImportDefinitionLine@1000005 : Record 11148592;
      SkipIndent@1000002 : Boolean;
    BEGIN
      Indent := 0;
      "Tag Name" := '';

      ImportDefinitionLine.SETRANGE("Import Definition", "Import Definition");
      IF ImportDefinitionLine.FINDLAST THEN
        "Entry No." := ImportDefinitionLine."Entry No." + 1
      ELSE BEGIN
        "Entry No." := 1;
        "Line No." := 10000;
        EXIT;
      END;

      IF ImportDefinition.GET("Import Definition") THEN
        ;

      ImportDefinitionLine.SETCURRENTKEY("Import Definition", "Line No.");
      ImportDefinitionLine := xRec2;

      IF NOT BelowxRec THEN
        IF ImportDefinitionLine.NEXT(-1) = 0 THEN BEGIN
          Indent := 0;
          SkipIndent := TRUE;
        END;

      IF NOT SkipIndent THEN
        IF (ImportDefinitionLine.Type IN [Type::Tag, Type::Table]) THEN
          Indent := ImportDefinitionLine.Indent + 1
        ELSE
          Indent := ImportDefinitionLine.Indent;

      ImportDefinitionLine := xRec2;

      IF BelowxRec THEN

        IF ImportDefinitionLine.NEXT = 0 THEN
          "Line No." := xRec2."Line No." + 10000
        ELSE
          "Line No." := ROUND((xRec2."Line No." + ImportDefinitionLine."Line No.") / 2, 1)

      ELSE

        IF ImportDefinitionLine.NEXT(-1) = 0 THEN
          "Line No." := ROUND(xRec2."Line No." / 2, 1)
        ELSE
          "Line No." := ROUND((xRec2."Line No." + ImportDefinitionLine."Line No.") / 2, 1);
    END;

    PROCEDURE OpenRestrictions@1000002();
    VAR
      ImportRestriction@1000000 : Record 11148596;
      ImportRestrictions@1000001 : Page 11148606;
    BEGIN
      ImportRestriction.FILTERGROUP(10);
      ImportRestriction.SETRANGE("Import Definition", "Import Definition");
      ImportRestriction.SETRANGE("Import Def. Entry No.", "Entry No.");
      ImportRestriction.FILTERGROUP(0);

      ImportRestrictions.SETTABLEVIEW(ImportRestriction);
      ImportRestrictions.RUN;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148593 IN - Import Def. Table Link
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Import Def. Table Link;
               NLD=Importdefinitie tabellink];
  }
  FIELDS
  {
    { 1   ;   ;Import Definition   ;Code20        ;TableRelation="IN - Import Definition";
                                                   OnValidate=VAR
                                                                ImportDefinition@1000000 : Record 11148591;
                                                              BEGIN
                                                                IF "Import Def. Entry No." = 0 THEN BEGIN
                                                                  ImportDefinition.GET("Import Definition");
                                                                  VALIDATE("Main Table No.", ImportDefinition."Main Table No.");
                                                                  VALIDATE("Sub Table No.", ImportDefinition."Sub Table No.");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Import Definition;
                                                              NLD=Importdefinitie] }
    { 2   ;   ;Import Def. Entry No.;Integer      ;TableRelation="IN - Import Definition Line"."Entry No." WHERE (Import Definition=FIELD(Import Definition));
                                                   CaptionML=[ENU=Import Def. Entry No.;
                                                              NLD=Importdefinitieregelvolgnr.] }
    { 3   ;   ;Main Table No.      ;Integer       ;TableRelation=Object.ID WHERE (Type=CONST(Table),
                                                                                  Company Name=CONST());
                                                   CaptionML=[ENU=Main Table;
                                                              NLD=Hoofdtabel] }
    { 4   ;   ;Main Field No.      ;Integer       ;TableRelation=Field.No. WHERE (TableNo=FIELD(Main Table No.),
                                                                                  Type=FILTER(RecordID|Text|Code|GUID|Date|Time|DateFormula|Decimal|Integer|Option|Boolean|BigInteger|Duration|DateTime),
                                                                                  Class=CONST(Normal));
                                                   OnValidate=BEGIN
                                                                CALCFIELDS("Main Field Name");
                                                              END;

                                                   CaptionML=[ENU=Main Field;
                                                              NLD=Hoofdveld];
                                                   BlankZero=Yes }
    { 5   ;   ;Sub Table No.       ;Integer       ;TableRelation=Object.ID WHERE (Type=CONST(Table),
                                                                                  Company Name=CONST());
                                                   CaptionML=[ENU=Sub Table;
                                                              NLD=Subtabel] }
    { 6   ;   ;Sub Field No.       ;Integer       ;TableRelation=Field.No. WHERE (TableNo=FIELD(Sub Table No.),
                                                                                  Type=FILTER(RecordID|Text|Code|GUID|Date|Time|DateFormula|Decimal|Integer|Option|Boolean|BigInteger|Duration|DateTime),
                                                                                  Class=CONST(Normal));
                                                   OnValidate=BEGIN
                                                                CALCFIELDS("Sub Field Name");
                                                              END;

                                                   CaptionML=[ENU=Sub Field;
                                                              NLD=Subveld];
                                                   BlankZero=Yes }
    { 7   ;   ;Main Field Name     ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Field.FieldName WHERE (TableNo=FIELD(Main Table No.),
                                                                                             No.=FIELD(Main Field No.)));
                                                   CaptionML=[ENU=Main Field Name;
                                                              NLD=Hoofdveldnaam];
                                                   Editable=No }
    { 8   ;   ;Sub Field Name      ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Field.FieldName WHERE (TableNo=FIELD(Sub Table No.),
                                                                                             No.=FIELD(Sub Field No.)));
                                                   CaptionML=[ENU=Sub Field Name;
                                                              NLD=Subveldnaam];
                                                   Editable=No }
    { 9   ;   ;Version No.         ;Integer       ;CaptionML=[ENU=Version No.;
                                                              NLD=Versienr.] }
  }
  KEYS
  {
    {    ;Import Definition,Import Def. Entry No.,Main Field No.;
                                                   Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148594 IN - Import Def. Function
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               TESTFIELD(Code);
             END;

    CaptionML=[ENU=Import Def. Function;
               NLD=Importdefinitie functie];
    LookupPageID=Page11117015;
    DrillDownPageID=Page11117015;
  }
  FIELDS
  {
    { 1   ;   ;Import Definition   ;Code20        ;TableRelation="IN - Import Definition";
                                                   CaptionML=[ENU=Import Definition;
                                                              NLD=Importdefinitie] }
    { 2   ;   ;Import Def. Entry No.;Integer      ;TableRelation="IN - Import Definition Line"."Entry No." WHERE (Import Definition=FIELD(Import Definition));
                                                   CaptionML=[ENU=Import Def. Entry No.;
                                                              NLD=Importdefinitieregelvolgnr.] }
    { 3   ;   ;Line No.            ;Integer       ;CaptionML=[ENU=Line No.;
                                                              NLD=Regelnr.] }
    { 4   ;   ;Code                ;Code20        ;TableRelation="IN - Function";
                                                   OnValidate=BEGIN
                                                                CALCFIELDS(Description, "Description 2");
                                                              END;

                                                   CaptionML=[ENU=Code;
                                                              NLD=Code] }
    { 5   ;   ;Description         ;Text250       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("IN - Function".Description WHERE (Code=FIELD(Code)));
                                                   CaptionML=[ENU=Description;
                                                              NLD=Omschrijving];
                                                   Editable=No }
    { 6   ;   ;Description 2       ;Text250       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("IN - Function"."Description 2" WHERE (Code=FIELD(Code)));
                                                   CaptionML=[ENU=Description 2;
                                                              NLD=Omschrijving 2];
                                                   Editable=No }
    { 7   ;   ;Parameter 1         ;Text50        ;CaptionML=[ENU=Parameter 1;
                                                              NLD=Parameter 1];
                                                   CaptionClass=ColumnHeader(1) }
    { 8   ;   ;Parameter 2         ;Text50        ;CaptionML=[ENU=Parameter 2;
                                                              NLD=Parameter 2];
                                                   CaptionClass=ColumnHeader(2) }
    { 9   ;   ;Parameter 3         ;Text50        ;CaptionML=[ENU=Parameter 3;
                                                              NLD=Parameter 3];
                                                   CaptionClass=ColumnHeader(3) }
    { 10  ;   ;Source Variable     ;Code20        ;TableRelation="IN - Variable";
                                                   CaptionML=[ENU=Source Variable;
                                                              NLD=Bronvariabele] }
    { 11  ;   ;Dest. Variable      ;Code20        ;TableRelation="IN - Variable";
                                                   CaptionML=[ENU=Dest. Variable;
                                                              NLD=Doelvariabele] }
  }
  KEYS
  {
    {    ;Import Definition,Import Def. Entry No.,Line No.;
                                                   Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    LOCAL PROCEDURE ColumnHeader@1100531000(ColumnNo@1100531000 : Integer) : Text[30];
    VAR
      INFunction@1100531001 : Record 11148595;
      ParameterDescription@1100531002 : Text[250];
    BEGIN
      IF INFunction.GET(Code) THEN
        CASE ColumnNo OF
          1 : ParameterDescription := INFunction."Parameter 1";
          2 : ParameterDescription := INFunction."Parameter 2";
          3 : ParameterDescription := INFunction."Parameter 3";
        END
      ELSE
        ParameterDescription := 'Parameter ' + FORMAT(ColumnNo);

      EXIT('3,' + ParameterDescription);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148595 IN - Function
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               TESTFIELD(Code);
             END;

    CaptionML=[ENU=Function;
               NLD=Functie];
    LookupPageID=Page11148591;
    DrillDownPageID=Page11148591;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code20        ;CaptionML=[ENU=Code;
                                                              NLD=Code];
                                                   NotBlank=Yes }
    { 2   ;   ;Description         ;Text250       ;CaptionML=[ENU=Description;
                                                              NLD=Omschrijving] }
    { 3   ;   ;Description 2       ;Text250       ;CaptionML=[ENU=Description 2;
                                                              NLD=Omschrijving 2] }
    { 4   ;   ;Parameter 1         ;Text50        ;CaptionML=[ENU=Parameter 1;
                                                              NLD=Parameter 1] }
    { 5   ;   ;Parameter 2         ;Text50        ;CaptionML=[ENU=Parameter 2;
                                                              NLD=Parameter 2] }
    { 6   ;   ;Parameter 3         ;Text50        ;CaptionML=[ENU=Parameter 3;
                                                              NLD=Parameter 3] }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148596 IN - Import Restriction
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    OnDelete=VAR
               ImportRestrictionValue@1000000 : Record 11148597;
             BEGIN
               ImportRestrictionValue.SETRANGE("Import Definition", "Import Definition");
               ImportRestrictionValue.SETRANGE("Import Def. Entry No.", "Import Def. Entry No.");
               ImportRestrictionValue.SETRANGE("Import Restriction Entry No.", "Entry No.");
               ImportRestrictionValue.DELETEALL(TRUE);

               DeleteImportRestrVarFilters;
             END;

    CaptionML=[ENU=Import Restriction;
               NLD=Importrestrictie];
    LookupPageID=Page11148606;
    DrillDownPageID=Page11148606;
  }
  FIELDS
  {
    { 1   ;   ;Import Definition   ;Code20        ;TableRelation="IN - Import Definition";
                                                   CaptionML=[ENU=Import Definition;
                                                              NLD=Importdefinitie] }
    { 2   ;   ;Import Def. Entry No.;Integer      ;TableRelation="IN - Import Definition Line"."Entry No." WHERE (Import Definition=FIELD(Import Definition));
                                                   CaptionML=[ENU=Import Def. Entry No.;
                                                              NLD=Importdefinitieregelvolgnr.] }
    { 3   ;   ;Entry No.           ;Integer       ;CaptionML=[ENU=Entry No.;
                                                              NLD=Volgnummer] }
    { 4   ;   ;Type                ;Option        ;OnValidate=VAR
                                                                ImportDefinitionLine@1000000 : Record 11148592;
                                                                Fld@1000001 : Record 2000000041;
                                                                RecRef@1000002 : RecordRef;
                                                                FldRef@1000004 : FieldRef;
                                                                KeyRef@1000003 : KeyRef;
                                                              BEGIN
                                                                IF Type = Type::"Table Relation" THEN BEGIN
                                                                  IF ImportDefinitionLine.GET("Import Definition", "Import Def. Entry No.") THEN
                                                                    IF Fld.GET(ImportDefinitionLine."Table No.", ImportDefinitionLine."Field No.") THEN
                                                                      IF Fld.RelationTableNo <> 0 THEN BEGIN
                                                                        "Table No." := Fld.RelationTableNo;
                                                                        IF Fld.RelationFieldNo = 0 THEN BEGIN
                                                                          RecRef.OPEN(Fld.RelationTableNo);
                                                                          KeyRef := RecRef.KEYINDEX(1);
                                                                          FldRef := KeyRef.FIELDINDEX(1);
                                                                          "Field No." := FldRef.NUMBER;;
                                                                        END ELSE
                                                                          "Field No." := Fld.RelationFieldNo;
                                                                      END;
                                                                END ELSE
                                                                  VALIDATE("Table No.", 0);
                                                              END;

                                                   CaptionML=[ENU=Type;
                                                              NLD=Soort];
                                                   OptionCaptionML=[ENU=Table Relation,Option,Min/Max,Max. Length;
                                                                    NLD=Tabelrelatie,Opties,Min/max,Max. lengte];
                                                   OptionString=Table Relation,Option,Min/Max,Max. Length }
    { 5   ;   ;Table No.           ;Integer       ;TableRelation=Object.ID WHERE (Type=CONST(Table),
                                                                                  Company Name=CONST());
                                                   OnValidate=VAR
                                                                Mgt@1000000 : Codeunit 11148589;
                                                              BEGIN
                                                                CALCFIELDS("Table Name");
                                                                EVALUATE("Table Filter", Mgt.EmptyTableFilter("Table No."));
                                                                VALIDATE("Field No.", 0);

                                                                DeleteImportRestrVarFilters;
                                                              END;

                                                   CaptionML=[ENU=Table;
                                                              NLD=Tabel];
                                                   BlankZero=Yes }
    { 6   ;   ;Field No.           ;Integer       ;TableRelation=Field.No. WHERE (TableNo=FIELD(Table No.),
                                                                                  Type=FILTER(RecordID|Text|Code|GUID|Date|Time|DateFormula|Decimal|Integer|Option|Boolean|BigInteger|Duration|DateTime),
                                                                                  Class=CONST(Normal));
                                                   OnValidate=BEGIN
                                                                CALCFIELDS("Field Name");
                                                              END;

                                                   CaptionML=[ENU=Field;
                                                              NLD=Veld];
                                                   BlankZero=Yes }
    { 7   ;   ;Table Filter        ;TableFilter   ;CaptionML=[ENU=Table Filter;
                                                              NLD=Tabelfilter] }
    { 8   ;   ;Alternative Value   ;Text250       ;CaptionML=[ENU=Alternative Value;
                                                              NLD=Alternatieve waarde] }
    { 9   ;   ;Error No.           ;Integer       ;CaptionML=[ENU=Error No.;
                                                              NLD=Foutnummer];
                                                   BlankZero=Yes }
    { 10  ;   ;Table Name          ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Object.Name WHERE (Type=CONST(Table),
                                                                                         Company Name=CONST(),
                                                                                         ID=FIELD(Table No.)));
                                                   CaptionML=[ENU=Table Name;
                                                              NLD=Tabelnaam];
                                                   Editable=No }
    { 11  ;   ;Field Name          ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Field.FieldName WHERE (TableNo=FIELD(Table No.),
                                                                                             No.=FIELD(Field No.)));
                                                   CaptionML=[ENU=Field Name;
                                                              NLD=Veldnaam];
                                                   Editable=No }
    { 12  ;   ;No. of Values       ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("IN - Import Restriction Value" WHERE (Import Definition=FIELD(Import Definition),
                                                                                                            Import Def. Entry No.=FIELD(Import Def. Entry No.),
                                                                                                            Import Restriction Entry No.=FIELD(Entry No.)));
                                                   CaptionML=[ENU=No. of Values;
                                                              NLD=Aantal waarden];
                                                   Editable=No }
    { 13  ;   ;No. of Variable Filters;Integer    ;FieldClass=FlowField;
                                                   CalcFormula=Count("IN - Import Restr. Var. Filter" WHERE (Import Definition=FIELD(Import Definition),
                                                                                                             Import Def. Entry No.=FIELD(Import Def. Entry No.),
                                                                                                             Import Restriction Entry No.=FIELD(Entry No.)));
                                                   CaptionML=[ENU=No. of Variable Filters;
                                                              NLD=Aantal variabele filters];
                                                   Editable=No }
    { 14  ;   ;Max. Length         ;Integer       ;CaptionML=[ENU=Max. Length;
                                                              NLD=Maximale lengte];
                                                   BlankZero=Yes }
    { 15  ;   ;Min. Value          ;Decimal       ;CaptionML=[ENU=Min. Value;
                                                              NLD=Minimale waarde];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes }
    { 16  ;   ;Max. Value          ;Decimal       ;CaptionML=[ENU=Max. Value;
                                                              NLD=Maximale waarde];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes }
  }
  KEYS
  {
    {    ;Import Definition,Import Def. Entry No.,Entry No.;
                                                   Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE GetNewEntryNo@1000000() : Integer;
    VAR
      ImportRestriction@1000000 : Record 11148596;
    BEGIN
      ImportRestriction.SETRANGE("Import Definition", "Import Definition");
      ImportRestriction.SETRANGE("Import Def. Entry No.", "Import Def. Entry No.");
      IF ImportRestriction.FINDLAST THEN
        EXIT(ImportRestriction."Entry No." + 1)
      ELSE
        EXIT(1);
    END;

    LOCAL PROCEDURE DeleteImportRestrVarFilters@1000000000();
    VAR
      ImportRestrVarFilter@1000000000 : Record 11148598;
    BEGIN
      ImportRestrVarFilter.SETRANGE("Import Definition", "Import Definition");
      ImportRestrVarFilter.SETRANGE("Import Def. Entry No.", "Import Def. Entry No.");
      ImportRestrVarFilter.SETRANGE("Import Restriction Entry No.", "Entry No.");
      ImportRestrVarFilter.DELETEALL(TRUE);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148597 IN - Import Restriction Value
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Import Restriction Value;
               NLD=Importrestrictiewaarde];
    LookupPageID=Page11117010;
    DrillDownPageID=Page11117010;
  }
  FIELDS
  {
    { 1   ;   ;Import Definition   ;Code20        ;TableRelation="IN - Import Definition";
                                                   CaptionML=[ENU=Import Definition;
                                                              NLD=Importdefinitie] }
    { 2   ;   ;Import Def. Entry No.;Integer      ;TableRelation="IN - Import Definition Line"."Entry No." WHERE (Import Definition=FIELD(Import Definition));
                                                   CaptionML=[ENU=Import Def. Entry No.;
                                                              NLD=Importdefinitieregelvolgnr.] }
    { 3   ;   ;Import Restriction Entry No.;Integer;
                                                   TableRelation="IN - Import Restriction"."Entry No." WHERE (Import Definition=FIELD(Import Definition),
                                                                                                              Import Def. Entry No.=FIELD(Import Def. Entry No.));
                                                   CaptionML=[ENU=Import Restriction Entry No.;
                                                              NLD=Importrestrictievolgnr.] }
    { 4   ;   ;Line No.            ;Integer       ;CaptionML=[ENU=Line No.;
                                                              NLD=Regelnr.] }
    { 10  ;   ;Value               ;Text250       ;CaptionML=[ENU=Value;
                                                              NLD=Waarde] }
  }
  KEYS
  {
    {    ;Import Definition,Import Def. Entry No.,Import Restriction Entry No.,Line No.;
                                                   Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148598 IN - Import Restr. Var. Filter
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Import Restriction Variable Filter;
               NLD=Importrestrictievariabelefilter];
    LookupPageID=Page11117011;
    DrillDownPageID=Page11117011;
  }
  FIELDS
  {
    { 1   ;   ;Import Definition   ;Code20        ;TableRelation="IN - Import Definition";
                                                   CaptionML=[ENU=Import Definition;
                                                              NLD=Importdefinitie] }
    { 2   ;   ;Import Def. Entry No.;Integer      ;TableRelation="IN - Import Definition Line"."Entry No." WHERE (Import Definition=FIELD(Import Definition));
                                                   CaptionML=[ENU=Import Def. Entry No.;
                                                              NLD=Importdefinitieregelvolgnr.] }
    { 3   ;   ;Import Restriction Entry No.;Integer;
                                                   TableRelation="IN - Import Restriction"."Entry No." WHERE (Import Definition=FIELD(Import Definition),
                                                                                                              Import Def. Entry No.=FIELD(Import Def. Entry No.));
                                                   CaptionML=[ENU=Import Restriction Entry No.;
                                                              NLD=Importrestrictievolgnr.] }
    { 4   ;   ;Table No.           ;Integer       ;TableRelation=Object.ID WHERE (Type=CONST(Table),
                                                                                  Company Name=CONST());
                                                   CaptionML=[ENU=Table No.;
                                                              NLD=Tablenr.] }
    { 5   ;   ;Field No.           ;Integer       ;TableRelation=Field.No. WHERE (TableNo=FIELD(Table No.),
                                                                                  Type=FILTER(RecordID|Text|Code|GUID|Date|Time|DateFormula|Decimal|Integer|Option|Boolean|BigInteger|Duration|DateTime),
                                                                                  Class=CONST(Normal));
                                                   CaptionML=[ENU=Sub Field;
                                                              NLD=Subveld];
                                                   BlankZero=Yes }
    { 6   ;   ;Variable            ;Code20        ;TableRelation="IN - Variable";
                                                   CaptionML=[ENU=Variable;
                                                              NLD=Variabele] }
  }
  KEYS
  {
    {    ;Import Definition,Import Def. Entry No.,Import Restriction Entry No.,Field No.;
                                                   Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148599 IN - Export Definition
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    OnInsert=VAR
               Setup@1000000 : Record 11148589;
             BEGIN
               TESTFIELD(Code);

               "Created On" := CURRENTDATETIME;
               "Created By" := USERID;
               "Modified On" := CURRENTDATETIME;
               "Modified By" := USERID;

               IF "XML Declaration" = '' THEN BEGIN
                 Setup.GET;
                 "XML Declaration" := Setup."XML Declaration";
               END;

               IF ("File Format" = "File Format"::Excel) AND ("Worksheet Name" = '') THEN
                 "Worksheet Name" := Text001;
             END;

    OnModify=BEGIN
               "Modified On" := CURRENTDATETIME;
               "Modified By" := USERID;

               IF ("File Format" = "File Format"::Excel) AND ("Worksheet Name" = '') THEN
                 "Worksheet Name" := Text001;
             END;

    OnDelete=VAR
               ExportDefLine@1000002 : Record 11148600;
               ExportDefTableLink@1000001 : Record 11148601;
               CommentLine@1000003 : Record 11148613;
               MonSetup@1000000000 : Record 11148607;
             BEGIN
               ExportDefLine.SETRANGE("Export Definition", Code);
               ExportDefLine.DELETEALL(TRUE);

               ExportDefTableLink.SETRANGE("Export Definition", Code);
               ExportDefTableLink.DELETEALL(TRUE);

               MonSetup.SETRANGE("Export Definition",Code);
               MonSetup.DELETEALL(TRUE);

               CommentLine.SETRANGE("Table Name", CommentLine."Table Name"::"Import Definition");
               CommentLine.SETRANGE(Code, Code);
               CommentLine.DELETEALL(TRUE);
             END;

    CaptionML=[ENU=Export Definition;
               NLD=Exportdefinitie];
    LookupPageID=Page11117013;
    DrillDownPageID=Page11117013;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code20        ;OnValidate=VAR
                                                                ctRecordAlreadyPresent@1000001 : TextConst 'ENU="The record already exist.\\Code=''%1'', File Format=''%2''.";NLD="Het record is reeds aanwezig.\\Code=''%1'', Bestandsformaat=''%2''."';
                                                              BEGIN
                                                                IF GET(Code) THEN
                                                                  ERROR(ctRecordAlreadyPresent, Code, "File Format");
                                                              END;

                                                   CaptionML=[ENU=Code;
                                                              NLD=Code];
                                                   NotBlank=Yes }
    { 2   ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              NLD=Omschrijving] }
    { 3   ;   ;Location            ;Text250       ;OnValidate=VAR
                                                                Mgt@1000000000 : Codeunit 11148589;
                                                              BEGIN
                                                                Location := Mgt.CompletePath(Location);
                                                              END;

                                                   CaptionML=[ENU=Location;
                                                              NLD=Locatie] }
    { 4   ;   ;Filename            ;Text250       ;CaptionML=[ENU=Filename;
                                                              NLD=Bestandsnaam] }
    { 5   ;   ;Run Codeunit No.    ;Integer       ;CaptionML=[ENU=Run Codeunit;
                                                              NLD=Codeunit starten];
                                                   BlankZero=Yes }
    { 6   ;   ;XML Declaration     ;Text250       ;CaptionML=[ENU=XML Declaration;
                                                              NLD=XML Declaratie] }
    { 7   ;   ;Status              ;Option        ;OnValidate=BEGIN
                                                                IF Status = Status::"Web Service" THEN
                                                                  TESTFIELD("File Format", "File Format"::XML);
                                                              END;

                                                   CaptionML=[ENU=Status;
                                                              NLD=Status];
                                                   OptionCaptionML=[ENU=Edit,Manual,Automated,Blocked,Web Service;
                                                                    NLD=Bewerken,Handmatig,Geautomatiseerd,Geblokkeerd,Web Service];
                                                   OptionString=Edit,Manual,Automated,Blocked,Web Service }
    { 8   ;   ;File Format         ;Option        ;OnValidate=VAR
                                                                RecExtension@1000000 : Text[30];
                                                                xRecExtension@1000001 : Text[30];
                                                              BEGIN
                                                                IF (xRec."File Format" = "File Format"::XML) <> ("File Format" = "File Format"::XML) THEN
                                                                  ConfirmExistingLinesDeleted;

                                                                RecExtension := Extension(Rec);
                                                                xRecExtension := Extension(xRec);

                                                                IF STRLEN(xRec.Filename) > STRLEN(xRecExtension) THEN
                                                                  IF xRecExtension = COPYSTR(xRec.Filename, STRLEN(xRec.Filename) - STRLEN(xRecExtension) + 1) THEN
                                                                    Filename := COPYSTR(xRec.Filename, 1, STRLEN(xRec.Filename) - STRLEN(xRecExtension) - 1) + '.' + RecExtension;

                                                                CALCFIELDS("Main Table No. of Fields");
                                                                CALCFIELDS("Sub Table No. of Fields");
                                                              END;

                                                   CaptionML=[ENU=File Format;
                                                              NLD=Bestandsformaat];
                                                   OptionCaptionML=[ENU=XML,CSV,Fixed Width,Excel,ADO;
                                                                    NLD=XML,CSV,Fixed Width,Excel,ADO];
                                                   OptionString=XML,CSV,Fixed Width,Excel,ADO }
    { 10  ;   ;Headers             ;Boolean       ;CaptionML=[ENU=Headers;
                                                              NLD=Koppen] }
    { 11  ;   ;One File per Record ;Boolean       ;CaptionML=[ENU=One File per Record;
                                                              NLD=En bestand per record] }
    { 12  ;   ;Field Delimiter     ;Text1         ;InitValue=";
                                                   CaptionML=[ENU=Field Delimiter;
                                                              NLD=Tekstindicator] }
    { 13  ;   ;Field Separator     ;Text1         ;InitValue=,;
                                                   CaptionML=[ENU=Field Separator;
                                                              NLD=Scheidingsteken] }
    { 14  ;   ;Save to Messages    ;Boolean       ;OnValidate=BEGIN
                                                                IF "Save to Messages" THEN
                                                                  IF NOT "Use Inbox" THEN
                                                                    TESTFIELD(Synchronize, FALSE);
                                                              END;

                                                   CaptionML=[ENU=Save to Messages;
                                                              NLD=Opslaan in berichten] }
    { 15  ;   ;Main Table No.      ;Integer       ;TableRelation=Object.ID WHERE (Type=CONST(Table),
                                                                                  Company Name=CONST());
                                                   OnValidate=VAR
                                                                Mgt@1000000 : Codeunit 11148589;
                                                              BEGIN
                                                                CLEAR("Main Table Filter");
                                                                EVALUATE("Main Table Filter", Mgt.EmptyTableFilter("Main Table No."));

                                                                CALCFIELDS("Main Table No. of Fields");
                                                              END;

                                                   CaptionML=[ENU=Main Table;
                                                              NLD=Hoofdtabel];
                                                   BlankZero=Yes }
    { 16  ;   ;Main Table Filter   ;TableFilter   ;OnValidate=VAR
                                                                ExportDefinitionLine@1000000 : Record 11148600;
                                                              BEGIN
                                                                ExportDefinitionLine.SETCURRENTKEY("Export Definition", "Line No.");
                                                                ExportDefinitionLine.SETRANGE("Export Definition", Code);
                                                                ExportDefinitionLine.SETRANGE(Type, ExportDefinitionLine.Type::Table);
                                                                ExportDefinitionLine.SETRANGE("Table No.", "Main Table No.");
                                                                IF ExportDefinitionLine.FINDFIRST THEN BEGIN
                                                                  ExportDefinitionLine."Table Filter" := "Main Table Filter";
                                                                  ExportDefinitionLine."Temp. Table Filter" := FORMAT("Main Table Filter");
                                                                  ExportDefinitionLine.MODIFY;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Main Table Filter;
                                                              NLD=Hoofdtabelfilter] }
    { 19  ;   ;Sub Table No.       ;Integer       ;TableRelation=Object.ID WHERE (Type=CONST(Table),
                                                                                  Company Name=CONST());
                                                   OnValidate=VAR
                                                                Mgt@1000002 : Codeunit 11148589;
                                                              BEGIN
                                                                CLEAR("Sub Table Filter");
                                                                EVALUATE("Sub Table Filter", Mgt.EmptyTableFilter("Sub Table No."));

                                                                CALCFIELDS("Sub Table No. of Fields");
                                                              END;

                                                   CaptionML=[ENU=Sub Table;
                                                              NLD=Subtabel];
                                                   BlankZero=Yes }
    { 20  ;   ;Sub Table Filter    ;TableFilter   ;OnValidate=VAR
                                                                ExportDefinitionLine@1000000 : Record 11148600;
                                                              BEGIN
                                                                ExportDefinitionLine.SETCURRENTKEY("Export Definition", "Line No.");
                                                                ExportDefinitionLine.SETRANGE("Export Definition", Code);
                                                                ExportDefinitionLine.SETRANGE(Type, ExportDefinitionLine.Type::Table);
                                                                ExportDefinitionLine.SETRANGE("Table No.", "Sub Table No.");
                                                                IF ExportDefinitionLine.FINDFIRST THEN BEGIN
                                                                  ExportDefinitionLine."Table Filter" := "Sub Table Filter";
                                                                  ExportDefinitionLine."Temp. Table Filter" := FORMAT("Sub Table Filter");
                                                                  ExportDefinitionLine.MODIFY;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Sub Table Filter;
                                                              NLD=Subtabelfilter] }
    { 24  ;   ;Main Table No. of Fields;Integer   ;FieldClass=FlowField;
                                                   CalcFormula=Count("IN - Export Definition Line" WHERE (Export Definition=FIELD(Code),
                                                                                                          Table No.=FIELD(Main Table No.),
                                                                                                          Field No.=FILTER(<>0)));
                                                   CaptionML=[ENU=Main Table No. of Fields;
                                                              NLD=Hoofdtabel aantal velden];
                                                   Editable=No }
    { 26  ;   ;Sub Table No. of Fields;Integer    ;FieldClass=FlowField;
                                                   CalcFormula=Count("IN - Export Definition Line" WHERE (Export Definition=FIELD(Code),
                                                                                                          Table No.=FIELD(Sub Table No.),
                                                                                                          Field No.=FILTER(<>0)));
                                                   CaptionML=[ENU=Sub Table No. of Fields;
                                                              NLD=Subtabel aantal velden];
                                                   Editable=No }
    { 27  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("IN - Comment Line" WHERE (Table Name=CONST(Export Definition),
                                                                                                Code=FIELD(Code)));
                                                   CaptionML=[ENU=Comment;
                                                              NLD=Opmerking];
                                                   Editable=No }
    { 28  ;   ;Run Task            ;Code20        ;TableRelation="IN - Task";
                                                   CaptionML=[ENU=Run Task;
                                                              NLD=Taak uitvoeren] }
    { 29  ;   ;Synchronize         ;Boolean       ;OnValidate=BEGIN
                                                                IF Synchronize THEN
                                                                  "Save to Messages" := FALSE;
                                                              END;

                                                   CaptionML=[ENU=Synchronize;
                                                              NLD=Synchroniseren] }
    { 30  ;   ;Destination Company ;Text30        ;TableRelation=Company;
                                                   CaptionML=[ENU=Destination Company;
                                                              NLD=Doelbedrijf] }
    { 31  ;   ;Import Code         ;Code20        ;CaptionML=[ENU=Import Code;
                                                              NLD=Importdefinitie] }
    { 32  ;   ;Use Inbox           ;Boolean       ;CaptionML=[ENU=Use Inbox;
                                                              NLD=Inbox gebruiken] }
    { 33  ;   ;Export Entry No.    ;Integer       ;CaptionML=[ENU=Export Entry No.;
                                                              NLD=Exportvolgnr.] }
    { 34  ;   ;Filename Type       ;Option        ;CaptionML=[ENU=Filename Type;
                                                              NLD=Bestandsnaammethode];
                                                   OptionCaptionML=[ENU=" ,YYYYMMDDHHMMSS,YYYYMMDD,Dest. Variable,Key,Entry No.,Project Entry No.,Trigger,Companyname,Table No.,Exp. Job Entry. No.";
                                                                    NLD=" ,YYYYMMDDHHMMSS,YYYYMMDD,Doelvariabele,Sleutel,Volgnr.,Projectvolgnr.,Trigger,Bedrijfsnaam,Tabelnr.,Exporteeropdr. volgnr."];
                                                   OptionString=[ ,YYYYMMDDHHMMSS,YYYYMMDD,Dest. Variable,Key,Entry No.,Project Entry No.,Trigger,Companyname,Table No.,Exp. Job Entry. No.] }
    { 35  ;   ;Project Code        ;Code20        ;TableRelation="IN - Project";
                                                   OnValidate=VAR
                                                                Project@1000000 : Record 11148620;
                                                              BEGIN
                                                                IF Project.GET("Project Code") THEN
                                                                  Project.TESTFIELD(Blocked, FALSE);
                                                              END;

                                                   CaptionML=[ENU=Project;
                                                              NLD=Project] }
    { 36  ;   ;Company Name        ;Text30        ;TableRelation=Company;
                                                   CaptionML=[ENU=Company Name;
                                                              NLD=Bedrijfsnaam] }
    { 37  ;   ;No. of Monitoring Lines;Integer    ;FieldClass=FlowField;
                                                   CalcFormula=Count("IN - Monitoring Setup" WHERE (Export Definition=FIELD(Code)));
                                                   CaptionML=[ENU=No. of Monitoring Lines;
                                                              NLD=Aantal monitoringregels];
                                                   Editable=No }
    { 38  ;   ;No. of Export Jobs  ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("IN - Export Job" WHERE (Export Definition=FIELD(Code),
                                                                                              Status=FILTER(<>Exported)));
                                                   CaptionML=[ENU=No. of Export Jobs;
                                                              NLD=Aantal exporteeropdrachten];
                                                   Editable=No }
    { 39  ;   ;Created On          ;DateTime      ;CaptionML=[ENU=Created On;
                                                              NLD=Gemaakt op];
                                                   Editable=No }
    { 40  ;   ;Created By          ;Code50        ;CaptionML=[ENU=Created By;
                                                              NLD=Gemaakt door];
                                                   Description=CI-129: was: Code[20];
                                                   Editable=No }
    { 41  ;   ;Modified On         ;DateTime      ;CaptionML=[ENU=Modified On;
                                                              NLD=Gewijzigd op];
                                                   Editable=No }
    { 42  ;   ;Modified By         ;Code50        ;CaptionML=[ENU=Modified By;
                                                              NLD=Gewijzigd door];
                                                   Description=CI-129: was: Code[20];
                                                   Editable=No }
    { 43  ;   ;Original Status     ;Option        ;CaptionML=[ENU=Original Status;
                                                              NLD=Originele status];
                                                   OptionCaptionML=[ENU=Edit,Manual,Automated,Blocked,Web Service;
                                                                    NLD=Bewerken,Handmatig,Geautomatiseerd,Geblokkeerd,Web Service];
                                                   OptionString=Edit,Manual,Automated,Blocked,Web Service }
    { 44  ;   ;Connection String   ;Text250       ;CaptionML=[ENU=Connection String;
                                                              NLD=Connectiestring] }
    { 45  ;   ;SQL String          ;Text250       ;CaptionML=[ENU=SQL String;
                                                              NLD=SQL String] }
    { 46  ;   ;Execute in ADO Database;Text30     ;CaptionML=[ENU=Execute in ADO Database;
                                                              NLD=Uitvoeren in ADO database] }
    { 47  ;   ;Version No.         ;Integer       ;CaptionML=[ENU=Version No.;
                                                              NLD=Versienr.] }
    { 48  ;   ;Version Date        ;Date          ;CaptionML=[ENU=Version Date;
                                                              NLD=Versiedatum] }
    { 49  ;   ;Version Time        ;Time          ;CaptionML=[ENU=Version Time;
                                                              NLD=Versietijd] }
    { 50  ;   ;Key                 ;Text50        ;CaptionML=[ENU=Key;
                                                              NLD=Sleutel] }
    { 51  ;   ;Delimiter Method    ;Option        ;CaptionML=[ENU=Delimiter Method;
                                                              NLD=Tekstindicatormethode];
                                                   OptionCaptionML=[ENU=When used in text,Always;
                                                                    NLD=Als gebruikt in tekst,Altijd];
                                                   OptionString=When used in text,Always }
    { 52  ;   ;Worksheet Name      ;Text50        ;CaptionML=[ENU=Worksheet Name;
                                                              NLD=Naam werkblad] }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
    {    ;Project Code                             }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text001@1000000000 : TextConst 'ENU=Sheet 1;NLD=Blad 1';

    PROCEDURE Process@1100496001();
    VAR
      ExportXMLFile@1000000 : Codeunit 11148609;
      ExportFile@1000001 : Codeunit 11148610;
      ExportADO@1000005 : Codeunit 11148613;
      NoOfRecordsProcessed@1100531000 : Integer;
    BEGIN
      IF Status = Status::Blocked THEN
        FIELDERROR(Status);

      IF "Run Codeunit No." <> 0 THEN
        CODEUNIT.RUN("Run Codeunit No.", Rec)
      ELSE
        CASE "File Format" OF

          "File Format"::XML:
            BEGIN
              ExportXMLFile.RUN(Rec);
              NoOfRecordsProcessed := ExportXMLFile.NoOfRecordsProcessed;
            END;

          "File Format"::CSV,
          "File Format"::"Fixed Width",
          "File Format"::Excel :
            BEGIN
              ExportFile.RUN(Rec);
              NoOfRecordsProcessed := ExportFile.NoOfRecordsProcessed;
            END;

          "File Format"::ADO :
            BEGIN
              ExportADO.RUN(Rec);
              NoOfRecordsProcessed := ExportADO.NoOfRecordsProcessed;
            END;

        END;

      AddTraceEntry(FALSE, '', NoOfRecordsProcessed);
    END;

    PROCEDURE Extension@1000001(VAR ExportDefinition@1000000 : Record 11148599) : Text[30];
    BEGIN
      WITH ExportDefinition DO
        CASE "File Format" OF
          "File Format"::XML :
            EXIT('xml');

          "File Format"::CSV :
            EXIT('csv');

          "File Format"::"Fixed Width" :
            EXIT('txt');

          "File Format"::Excel :
            EXIT('xlsx');

        END;
    END;

    PROCEDURE FillReplyOutstream@1000003(VAR OutStr@1000007 : OutStream);
    VAR
      ExportXMLFile@1000004 : Codeunit 11148609;
    BEGIN
      ExportXMLFile.SetKeepDocumentOpen(TRUE);
      ExportXMLFile.RUN(Rec);
      ExportXMLFile.FillOutStream(OutStr);
    END;

    PROCEDURE FillReplyErrorMessage@1000002(VAR OutStr@1000007 : OutStream);
    VAR
      TmpMessageHistory@1000002 : TEMPORARY Record 11148611;
      TmpMessageHistComment@1000003 : TEMPORARY Record 11148612;
      ExportDefinitionLine@1100531000 : Record 11148600;
      ExportXMLFile@1000004 : Codeunit 11148609;
      CommentMgt@1000001 : Codeunit 11148622;
      RecRef@1000005 : RecordRef;
      RecRef2@1000006 : RecordRef;
    BEGIN
      CommentMgt.FillHistoryRecords(TmpMessageHistory, TmpMessageHistComment);

      TmpMessageHistory.Type := TmpMessageHistory.Type::Export;
      TmpMessageHistory.Code := Code;
      TmpMessageHistory."Executed By" := USERID;
      TmpMessageHistory.Date := TODAY;
      TmpMessageHistory.Time := TIME;
      TmpMessageHistory.MODIFY;

      RecRef.GETTABLE(TmpMessageHistory);

      ExportDefinitionLine.SETRANGE("Export Definition", Code);
      ExportDefinitionLine.SETRANGE(Type, ExportDefinitionLine.Type::Table);
      ExportDefinitionLine.SETRANGE("Table No.", DATABASE::"IN - Message History");
      IF ExportDefinitionLine.FINDSET THEN
        REPEAT
          ExportXMLFile.SetRecRef(RecRef, ExportDefinitionLine."Entry No.");
        UNTIL ExportDefinitionLine.NEXT = 0;

      RecRef2.GETTABLE(TmpMessageHistComment);

      ExportDefinitionLine.SETRANGE("Export Definition", Code);
      ExportDefinitionLine.SETRANGE(Type, ExportDefinitionLine.Type::Table);
      ExportDefinitionLine.SETRANGE("Table No.", DATABASE::"IN - Message Hist. Comment");
      IF ExportDefinitionLine.FINDSET THEN
        REPEAT
          ExportXMLFile.SetRecRef(RecRef2, ExportDefinitionLine."Entry No.");
        UNTIL ExportDefinitionLine.NEXT = 0;

      ExportXMLFile.SetKeepDocumentOpen(TRUE);
      ExportXMLFile.RUN(Rec);
      ExportXMLFile.FillOutStream(OutStr);
    END;

    PROCEDURE ProcessReply@1000000();
    VAR
      ExportXMLFile@1000000 : Codeunit 11148609;
    BEGIN
      ExportXMLFile.RUN(Rec);
    END;

    PROCEDURE ProcessErrorReply@1000005();
    VAR
      TmpMessageHistory@1000002 : TEMPORARY Record 11148611;
      TmpMessageHistComment@1000003 : TEMPORARY Record 11148612;
      ExportDefinitionLine@1100531000 : Record 11148600;
      ExportXMLFile@1000004 : Codeunit 11148609;
      CommentMgt@1000001 : Codeunit 11148622;
      RecRef@1000005 : RecordRef;
      RecRef2@1000006 : RecordRef;
    BEGIN
      CommentMgt.FillHistoryRecords(TmpMessageHistory, TmpMessageHistComment);

      RecRef.GETTABLE(TmpMessageHistory);

      ExportDefinitionLine.SETRANGE("Export Definition", Code);
      ExportDefinitionLine.SETRANGE(Type, ExportDefinitionLine.Type::Table);
      ExportDefinitionLine.SETRANGE("Table No.", DATABASE::"IN - Message History");
      IF ExportDefinitionLine.FINDSET THEN
        REPEAT
          ExportXMLFile.SetRecRef(RecRef, ExportDefinitionLine."Entry No.");
        UNTIL ExportDefinitionLine.NEXT = 0;

      RecRef2.GETTABLE(TmpMessageHistComment);

      ExportDefinitionLine.SETRANGE("Export Definition", Code);
      ExportDefinitionLine.SETRANGE(Type, ExportDefinitionLine.Type::Table);
      ExportDefinitionLine.SETRANGE("Table No.", DATABASE::"IN - Message Hist. Comment");
      IF ExportDefinitionLine.FINDSET THEN
        REPEAT
          ExportXMLFile.SetRecRef(RecRef2, ExportDefinitionLine."Entry No.");
        UNTIL ExportDefinitionLine.NEXT = 0;

      ExportXMLFile.RUN(Rec);
    END;

    PROCEDURE CreateMonitoringLine@1000006();
    VAR
      ExportDefLine@1000001 : Record 11148600;
      MonitoringSetup@1000000 : Record 11148607;
      MonitoringSetupForm@1000002 : Page 11117027;
    BEGIN
      ExportDefLine.SETCURRENTKEY("Export Definition", "Line No.");
      ExportDefLine.SETRANGE("Export Definition", Code);
      ExportDefLine.SETFILTER("Table No.", '<>0');
      ExportDefLine.FINDFIRST;
      MonitoringSetup."Table No." := ExportDefLine."Table No.";
      EVALUATE(MonitoringSetup."Table Filter", FORMAT(ExportDefLine."Table Filter"));
      MonitoringSetup."Export Definition" := Code;
      MonitoringSetup."Export Modify" := FALSE;
      MonitoringSetup."Export Insert" := FALSE;
      MonitoringSetup."Export Delete" := FALSE;
      MonitoringSetup."Export Rename" := FALSE;
      MonitoringSetup.INSERT(TRUE);

      MonitoringSetupForm.SETRECORD(MonitoringSetup);
      MonitoringSetupForm.RUN;
    END;

    PROCEDURE Copy@1000000000();
    VAR
      CopyExportDef@1000000000 : Report 11117002;
    BEGIN
      CopyExportDef.SetExportDef(Rec);
      CopyExportDef.RUNMODAL;
    END;

    PROCEDURE CopyTo@1000000001();
    VAR
      CopyRules@1000000000 : Record 11148643;
    BEGIN
      TESTFIELD(Code);
      CopyRules.SetupCopy(1, Code);
      CopyRules.SETRANGE("Definition Type", CopyRules."Definition Type"::Export);
      CopyRules.SETRANGE("Definition Code", Code);
      PAGE.RUN(0, CopyRules);
    END;

    PROCEDURE LookupImportCode@1100512000(VAR LookupText@1100512003 : Text[1024]) : Boolean;
    VAR
      ImportDefinition@1100512000 : Record 11148591;
    BEGIN
      IF "Destination Company" <> '' THEN
        ImportDefinition.CHANGECOMPANY("Destination Company");

      IF ImportDefinition.GET(LookupText) THEN
        ;

      IF PAGE.RUNMODAL(0, ImportDefinition) = ACTION::LookupOK THEN BEGIN
        LookupText := ImportDefinition.Code;
        EXIT(TRUE);
      END;
    END;

    PROCEDURE FormatCompanyName@1000008(VAR Text@1000000 : Text[1024]);
    BEGIN
      IF Text = '' THEN
        Text := AllCompaniesText;
    END;

    PROCEDURE LookupCompanyName@1100496000(VAR Text@1100496000 : Text[1024]) : Boolean;
    VAR
      Company@1100496001 : Record 2000000006;
      TmpCompany@1100496002 : TEMPORARY Record 2000000006;
    BEGIN
      IF Company.FINDSET THEN
        REPEAT
          TmpCompany := Company;
          TmpCompany.INSERT;
        UNTIL Company.NEXT = 0;

      IF NOT TmpCompany.GET(' ' + AllCompaniesText) THEN BEGIN
        TmpCompany.Name := ' ' + AllCompaniesText;
        TmpCompany.INSERT;
      END;

      IF PAGE.RUNMODAL(PAGE::"CI - Companies", TmpCompany) = ACTION::LookupOK THEN BEGIN
        Text := FORMAT(TmpCompany.Name);
        IF Text = ' ' + AllCompaniesText THEN
          Text := AllCompaniesText;
        EXIT(TRUE);
      END;
    END;

    PROCEDURE AfterInputCompanyName@1100496003(VAR Text@1100496000 : Text[1024]);
    VAR
      Company@1100496001 : Record 2000000006;
    BEGIN
      IF Company.GET(Text) THEN BEGIN
        Text := Company.Name;
        EXIT;
      END;

      IF Company.FINDSET THEN
        REPEAT
          IF STRPOS(LOWERCASE(Company.Name), LOWERCASE(Text)) = 1 THEN BEGIN
            Text := Company.Name;
            EXIT;
          END;
        UNTIL Company.NEXT = 0;

      IF STRPOS(LOWERCASE(AllCompaniesText), LOWERCASE(Text)) = 1 THEN BEGIN
        Text := '';
        EXIT;
      END;
    END;

    LOCAL PROCEDURE AllCompaniesText@1100496006() : Text[30];
    VAR
      ctAllCompanies@1100496000 : TextConst 'ENU=<All companies>;NLD=<Alle bedrijven>';
    BEGIN
      EXIT(ctAllCompanies);
    END;

    PROCEDURE MainTableTagname@1000007() : Text[1024];
    VAR
      Setup@1000000 : Record 11148589;
      Object@1000001 : Record 2000000001;
      Mgt@1000002 : Codeunit 11148589;
    BEGIN
      IF NOT Object.GET(Object.Type::Table, '', "Main Table No.") THEN
        EXIT;

      Setup.GET;
      IF Setup."Use Captions in Tag Names" THEN BEGIN
        Object.CALCFIELDS(Caption);
        EXIT(Mgt.Capitalize(Object.Caption));
      END ELSE
        EXIT(Mgt.Capitalize(Object.Name));
    END;

    PROCEDURE SubTableTagname@1000004() : Text[1024];
    VAR
      Setup@1000000 : Record 11148589;
      Object@1000001 : Record 2000000001;
      Mgt@1000002 : Codeunit 11148589;
    BEGIN
      IF NOT Object.GET(Object.Type::Table, '', "Sub Table No.") THEN
        EXIT;

      Setup.GET;
      IF Setup."Use Captions in Tag Names" THEN BEGIN
        Object.CALCFIELDS(Caption);
        EXIT(Mgt.Capitalize(Object.Caption));
      END ELSE
        EXIT(Mgt.Capitalize(Object.Name));
    END;

    PROCEDURE UpdateTableFields@1000010(MainTable@1000006 : Boolean;TableNo@1000004 : Integer;VAR Fld@1000000 : Record 2000000041);
    VAR
      ExportDefinitionLine@1000001 : Record 11148600;
      ExportDefinitionLine2@1000002 : Record 11148600;
      ExportDefinitionLine3@1000007 : Record 11148600;
      Mgt@1000005 : Codeunit 11148589;
    BEGIN
      ExportDefinitionLine.SETRANGE("Export Definition", Code);
      ExportDefinitionLine.SETRANGE("Table No.", TableNo);
      ExportDefinitionLine.SETFILTER("Field No.", '<>0');
      IF ExportDefinitionLine.FINDSET THEN
        REPEAT
          IF NOT Fld.GET(ExportDefinitionLine."Table No.", ExportDefinitionLine."Field No.") THEN
            ExportDefinitionLine.DELETE(TRUE);
        UNTIL ExportDefinitionLine.NEXT = 0;

      IF Fld.FINDSET THEN
        REPEAT
          ExportDefinitionLine.SETRANGE("Field No.", Fld."No.");
          IF NOT ExportDefinitionLine.FINDFIRST THEN BEGIN

            ExportDefinitionLine2.SETCURRENTKEY("Export Definition", "Line No.");
            ExportDefinitionLine2.SETRANGE("Export Definition", Code);
            ExportDefinitionLine2.SETRANGE("Table No.", TableNo);
            ExportDefinitionLine2.SETFILTER("Field No.", '<>0');
            IF ExportDefinitionLine2.FINDLAST THEN BEGIN
              ExportDefinitionLine2.SetupNewLine(ExportDefinitionLine2, TRUE);
              ExportDefinitionLine2."Tag Name" := '';
              ExportDefinitionLine2.VALIDATE(Type, ExportDefinitionLine2.Type::Field);
              ExportDefinitionLine2.VALIDATE("Table No.", TableNo);
              ExportDefinitionLine2.VALIDATE("Field No.", Fld."No.");
              ExportDefinitionLine2.INSERT(TRUE);
            END ELSE

              CASE "File Format" OF

                "File Format"::XML :
                  BEGIN
                    ExportDefinitionLine2.RESET;
                    ExportDefinitionLine2.SETCURRENTKEY("Export Definition", "Line No.");
                    ExportDefinitionLine2.SETRANGE("Export Definition", Code);
                    ExportDefinitionLine2.SETRANGE(Type, ExportDefinitionLine2.Type::Table);
                    ExportDefinitionLine2.SETRANGE("Table No.", TableNo);
                    IF ExportDefinitionLine2.FINDFIRST THEN BEGIN
                      ExportDefinitionLine2.SetupNewLine(ExportDefinitionLine2, TRUE);
                      ExportDefinitionLine2."Tag Name" := '';
                      ExportDefinitionLine2.VALIDATE(Type, ExportDefinitionLine2.Type::Field);
                      ExportDefinitionLine2.VALIDATE("Table No.", TableNo);
                      ExportDefinitionLine2.VALIDATE("Field No.", Fld."No.");
                      ExportDefinitionLine2.INSERT(TRUE);
                    END ELSE BEGIN

                      ExportDefinitionLine2.RESET;
                      ExportDefinitionLine2.SETCURRENTKEY("Export Definition", "Line No.");
                      ExportDefinitionLine2.SETRANGE("Export Definition", Code);
                      IF ExportDefinitionLine2.FINDLAST THEN
                        ExportDefinitionLine2.SetupNewLine(ExportDefinitionLine2, TRUE)
                      ELSE BEGIN
                        ExportDefinitionLine2."Export Definition" := Code;
                        ExportDefinitionLine2."Entry No." := 1;
                        ExportDefinitionLine2."Line No." := 10000;
                      END;
                      ExportDefinitionLine2.VALIDATE(Type, ExportDefinitionLine2.Type::Tag);
                      ExportDefinitionLine2."Tag Name" := Mgt.TableTagName(TableNo) + 's';
                      ExportDefinitionLine2.INSERT(TRUE);

                      ExportDefinitionLine2.SetupNewLine(ExportDefinitionLine2, TRUE);
                      ExportDefinitionLine2.VALIDATE(Type, ExportDefinitionLine2.Type::Table);
                      ExportDefinitionLine2.VALIDATE("Table No.", TableNo);
                      ExportDefinitionLine2."Tag Name" := Mgt.TableTagName(TableNo);

                      IF MainTable THEN
                        ExportDefinitionLine2."Table Filter" := "Main Table Filter"
                      ELSE BEGIN
                        ExportDefinitionLine2."Table Filter" := "Sub Table Filter";
                        ExportDefinitionLine3.SETCURRENTKEY("Export Definition", "Line No.");
                        ExportDefinitionLine3.SETRANGE("Export Definition", Code);
                        ExportDefinitionLine3.SETRANGE(Type, ExportDefinitionLine3.Type::Table);
                        ExportDefinitionLine3.SETRANGE("Table No.", "Main Table No.");
                        IF ExportDefinitionLine3.FINDFIRST THEN
                          ExportDefinitionLine2.VALIDATE("Link to Table (Tag Name)", ExportDefinitionLine3."Tag Name");
                      END;

                      ExportDefinitionLine2.INSERT(TRUE);

                      ExportDefinitionLine2.SetupNewLine(ExportDefinitionLine2, TRUE);
                      ExportDefinitionLine2.VALIDATE(Type, ExportDefinitionLine2.Type::Field);
                      ExportDefinitionLine2."Tag Name" := '';
                      ExportDefinitionLine2.VALIDATE("Table No.", TableNo);
                      ExportDefinitionLine2.VALIDATE("Field No.", Fld."No.");
                      ExportDefinitionLine2.INSERT(TRUE);
                    END;

                  END;

                "File Format"::CSV, "File Format"::"Fixed Width", "File Format"::Excel :
                  BEGIN
                    ExportDefinitionLine2.RESET;
                    ExportDefinitionLine2.SETCURRENTKEY("Export Definition", "Line No.");
                    ExportDefinitionLine2.SETRANGE("Export Definition", Code);
                    ExportDefinitionLine2.SETRANGE(Type, ExportDefinitionLine2.Type::Table);
                    ExportDefinitionLine2.SETRANGE("Table No.", TableNo);
                    IF ExportDefinitionLine2.FINDFIRST THEN BEGIN
                      ExportDefinitionLine2.SetupNewLine(ExportDefinitionLine2, TRUE);
                      ExportDefinitionLine2."Tag Name" := '';
                      ExportDefinitionLine2.VALIDATE(Type, ExportDefinitionLine2.Type::Field);
                      ExportDefinitionLine2.VALIDATE("Table No.", TableNo);
                      ExportDefinitionLine2.VALIDATE("Field No.", Fld."No.");
                      ExportDefinitionLine2.INSERT(TRUE);
                    END ELSE BEGIN

                      ExportDefinitionLine2.RESET;
                      ExportDefinitionLine2.SETCURRENTKEY("Export Definition", "Line No.");
                      ExportDefinitionLine2.SETRANGE("Export Definition", Code);
                      IF ExportDefinitionLine2.FINDLAST THEN
                        ExportDefinitionLine2.SetupNewLine(ExportDefinitionLine2, TRUE)
                      ELSE BEGIN
                        ExportDefinitionLine2."Export Definition" := Code;
                        ExportDefinitionLine2."Entry No." := 1;
                        ExportDefinitionLine2."Line No." := 10000;
                      END;
                      ExportDefinitionLine2.VALIDATE(Type, ExportDefinitionLine2.Type::Table);
                      ExportDefinitionLine2.VALIDATE("Table No.", TableNo);
                      ExportDefinitionLine2."Tag Name" := Mgt.TableTagName(TableNo);

                      IF MainTable THEN
                        ExportDefinitionLine2."Table Filter" := "Main Table Filter"
                      ELSE BEGIN
                        ExportDefinitionLine2."Table Filter" := "Sub Table Filter";
                        ExportDefinitionLine3.SETCURRENTKEY("Export Definition", "Line No.");
                        ExportDefinitionLine3.SETRANGE("Export Definition", Code);
                        ExportDefinitionLine3.SETRANGE(Type, ExportDefinitionLine3.Type::Table);
                        ExportDefinitionLine3.SETRANGE("Table No.", "Main Table No.");
                        IF ExportDefinitionLine3.FINDFIRST THEN
                          ExportDefinitionLine2.VALIDATE("Link to Table (Tag Name)", ExportDefinitionLine3."Tag Name");
                      END;

                      ExportDefinitionLine2.INSERT(TRUE);

                      ExportDefinitionLine2.SetupNewLine(ExportDefinitionLine2, TRUE);
                      ExportDefinitionLine2.VALIDATE(Type, ExportDefinitionLine2.Type::Field);
                      ExportDefinitionLine2."Tag Name" := '';
                      ExportDefinitionLine2.VALIDATE("Table No.", TableNo);
                      ExportDefinitionLine2.VALIDATE("Field No.", Fld."No.");
                      ExportDefinitionLine2.INSERT(TRUE);
                    END;
                  END;
              END;

          END;
        UNTIL Fld.NEXT = 0;

      RenumberLines;
    END;

    PROCEDURE RenumberLines@1000009();
    VAR
      ExportDefinitionLine@1000000 : Record 11148600;
      TmpExportDefinitionLine@1000003 : TEMPORARY Record 11148600;
      LineCounter@1000002 : Integer;
      NoOfLines@1000001 : Integer;
    BEGIN
      ExportDefinitionLine.SETCURRENTKEY("Export Definition", "Line No.");
      ExportDefinitionLine.SETRANGE("Export Definition", Code);
      NoOfLines := ExportDefinitionLine.COUNT;
      IF ExportDefinitionLine.FINDLAST THEN
        REPEAT
          LineCounter += 1;
          TmpExportDefinitionLine := ExportDefinitionLine;
          TmpExportDefinitionLine."Line No." := (NoOfLines - LineCounter + 1) * 10000;
          TmpExportDefinitionLine.INSERT;
        UNTIL ExportDefinitionLine.NEXT(-1) = 0;

      IF TmpExportDefinitionLine.FINDSET THEN
        REPEAT
          ExportDefinitionLine := TmpExportDefinitionLine;
          ExportDefinitionLine.MODIFY;
        UNTIL TmpExportDefinitionLine.NEXT = 0;
    END;

    PROCEDURE ReversedDataMapping@1000011();
    VAR
      ReversedDataMapping@1100531000 : Codeunit 11148607;
    BEGIN
      ReversedDataMapping.ExportDef(Rec);
    END;

    PROCEDURE TestRecordSet@1000012();
    VAR
      ExportDefinitionLine@1000000 : Record 11148600;
      Mgt@1000002 : Codeunit 11148589;
      RecRef@1000001 : RecordRef;
    BEGIN
      ExportDefinitionLine.SETCURRENTKEY("Export Definition", "Line No.");
      ExportDefinitionLine.SETRANGE("Export Definition", Code);
      ExportDefinitionLine.SETFILTER("Table No.", '<>0');
      IF ExportDefinitionLine.FINDFIRST THEN BEGIN
        RecRef.OPEN(ExportDefinitionLine."Table No.");
        IF FORMAT(ExportDefinitionLine."Table Filter") <> '' THEN
          Mgt.SetFilterOnRecordRef(RecRef, FORMAT(ExportDefinitionLine."Table Filter"));
        RecRef.FINDFIRST;
      END;
    END;

    PROCEDURE ShowCard@1000013();
    VAR
      XMLExportCard@1000000 : Page 11117079;
      CSVExportCard@1000001 : Page 11117081;
      FixedWidthExportCard@1000002 : Page 11117083;
      ExcelExportCard@1000003 : Page 11117085;
      ADOExportCard@1000004 : Page 11117087;
    BEGIN
      CASE "File Format" OF
        "File Format"::XML :
          BEGIN
            XMLExportCard.SETRECORD(Rec);
            XMLExportCard.RUNMODAL;
          END;

        "File Format"::CSV :
          BEGIN
            CSVExportCard.SETRECORD(Rec);
            CSVExportCard.RUNMODAL;
          END;

        "File Format"::"Fixed Width" :
          BEGIN
            FixedWidthExportCard.SETRECORD(Rec);
            FixedWidthExportCard.RUNMODAL;
          END;

        "File Format"::Excel :
          BEGIN
            ExcelExportCard.SETRECORD(Rec);
            ExcelExportCard.RUNMODAL;
          END;

        "File Format"::ADO :
          BEGIN
            ADOExportCard.SETRECORD(Rec);
            ADOExportCard.RUNMODAL;
          END;
      END;
    END;

    PROCEDURE AddTraceEntry@1100531000(Error@1100531003 : Boolean;ErrorMessage@1100531004 : Text[1024];NoOfRecordsProcessed@1100531000 : Integer);
    VAR
      TraceLine@1100531001 : Record 11148630;
      TraceMgt@1100531002 : Codeunit 11148642;
    BEGIN
      TraceMgt.AddTrace(
        TraceLine.Type::"Export Definition", Code, Error, COPYSTR(ErrorMessage, 1, 250), NoOfRecordsProcessed);
    END;

    PROCEDURE SaveNewVersion@1100531001();
    VAR
      VersionMgt@1100531000 : Codeunit 11148644;
    BEGIN
      VersionMgt.ExportAddNewVersion(Rec);
    END;

    PROCEDURE ConfirmExistingLinesDeleted@1100531002();
    VAR
      ExportDefinitionLine@1100531001 : Record 11148600;
      ctConfirm@1100531000 : TextConst 'ENU=Existing lines wil be deleted.\Are you sure?;NLD=De bestaande regels zullen worden verwijderd.\Weet u het zeker?';
    BEGIN
      ExportDefinitionLine.SETRANGE("Export Definition", Code);
      IF NOT ExportDefinitionLine.ISEMPTY THEN BEGIN
        IF NOT CONFIRM(ctConfirm, TRUE) THEN
          ERROR('');
        ExportDefinitionLine.DELETEALL(TRUE);
      END;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148600 IN - Export Definition Line
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    OnDelete=VAR
               ExportDefTableLink@1000000 : Record 11148601;
               ExportDefFunction@1100531000 : Record 11148602;
             BEGIN
               ExportDefTableLink.SETRANGE("Export Definition", "Export Definition");
               ExportDefTableLink.SETRANGE("Export Def. Entry No.", "Entry No.");
               ExportDefTableLink.DELETEALL(TRUE);

               ExportDefFunction.SETRANGE("Export Definition", "Export Definition");
               ExportDefFunction.SETRANGE("Export Def. Entry No.", "Entry No.");
               ExportDefFunction.DELETEALL(TRUE);
             END;

    CaptionML=[ENU=Export Definition Line;
               NLD=Exportdefinitieregel];
  }
  FIELDS
  {
    { 1   ;   ;Export Definition   ;Code20        ;TableRelation="IN - Export Definition";
                                                   CaptionML=[ENU=Export Definition;
                                                              NLD=Exportdefinitie] }
    { 2   ;   ;Entry No.           ;Integer       ;CaptionML=[ENU=Entry No.;
                                                              NLD=Volgnummer] }
    { 3   ;   ;Line No.            ;Integer       ;CaptionML=[ENU=Line No.;
                                                              NLD=Regelnr.] }
    { 5   ;   ;Indent              ;Integer       ;CaptionML=[ENU=Indent;
                                                              NLD=Inspringen] }
    { 6   ;   ;Tag Name            ;Text50        ;CaptionML=[ENU=Tag Name;
                                                              NLD=Tagnaam] }
    { 7   ;   ;Type                ;Option        ;OnValidate=BEGIN
                                                                VALIDATE("Table No.", 0);
                                                                VALIDATE(Code, '');

                                                                Width := 30;
                                                              END;

                                                   CaptionML=[ENU=Type;
                                                              NLD=Soort];
                                                   OptionCaptionML=[ENU=" ,Tag,Table,Field,Const,Variable";
                                                                    NLD=" ,Tag,Tabel,Veld,Constante,Variabele"];
                                                   OptionString=[ ,Tag,Table,Field,Const,Variable] }
    { 8   ;   ;Code                ;Text250       ;TableRelation=IF (Type=CONST(Variable)) "IN - Variable";
                                                   CaptionML=[ENU=Code;
                                                              NLD=Code] }
    { 9   ;   ;No. of Functions    ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("IN - Export Def. Function" WHERE (Export Definition=FIELD(Export Definition),
                                                                                                        Export Def. Entry No.=FIELD(Entry No.)));
                                                   CaptionML=[ENU=No. of Functions;
                                                              NLD=Aantal functies];
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 10  ;   ;Functions           ;Boolean       ;CaptionML=[ENU=Functions;
                                                              NLD=Functies];
                                                   Editable=No }
    { 11  ;   ;Table No.           ;Integer       ;TableRelation=Object.ID WHERE (Type=CONST(Table),
                                                                                  Company Name=CONST());
                                                   OnValidate=VAR
                                                                Mgt@1000000 : Codeunit 11148589;
                                                              BEGIN
                                                                CALCFIELDS("Table Name");
                                                                EVALUATE("Table Filter", Mgt.EmptyTableFilter("Table No."));
                                                                VALIDATE("Field No.", 0);

                                                                "Link to Table (Tag Name)" := '';

                                                                IF Type = Type::Table THEN
                                                                  IF "Table No." <> 0 THEN
                                                                    IF ("Tag Name" = '') OR (xRec."Tag Name" = Mgt.TableTagName(xRec."Table No.")) THEN
                                                                      "Tag Name" := Mgt.TableTagName("Table No.");
                                                              END;

                                                   CaptionML=[ENU=Table;
                                                              NLD=Tabel];
                                                   BlankZero=Yes }
    { 12  ;   ;Field No.           ;Integer       ;TableRelation=Field.No. WHERE (TableNo=FIELD(Table No.),
                                                                                  Type=FILTER(RecordID|Text|Code|GUID|Date|Time|DateFormula|Decimal|Integer|Option|Boolean|BigInteger|Duration|DateTime),
                                                                                  Class=FILTER(Normal|FlowField));
                                                   OnValidate=VAR
                                                                Fld@1100531000 : Record 2000000041;
                                                                Mgt@1000000 : Codeunit 11148589;
                                                              BEGIN
                                                                IF "Tag Name" = '' THEN
                                                                  "Tag Name" := Mgt.FieldTagName("Table No.", "Field No.");

                                                                IF Fld.GET("Table No.", "Field No.") THEN
                                                                  Width := Mgt.GetWidth(Fld);
                                                              END;

                                                   CaptionML=[ENU=Field;
                                                              NLD=Veld];
                                                   BlankZero=Yes }
    { 13  ;   ;Data Format         ;Text250       ;CaptionML=[ENU=Format;
                                                              NLD=Formaat] }
    { 15  ;   ;Conversion Code     ;Code20        ;TableRelation="IN - Conversion";
                                                   CaptionML=[ENU=Conversion Code;
                                                              NLD=Conversie] }
    { 16  ;   ;As Attribute        ;Boolean       ;CaptionML=[ENU=As Attribute;
                                                              NLD=Als attribuut] }
    { 17  ;   ;Width               ;Integer       ;CaptionML=[ENU=Width;
                                                              NLD=Breedte];
                                                   BlankZero=Yes }
    { 18  ;   ;Alignment           ;Option        ;CaptionML=[ENU=Alignment;
                                                              NLD=Uitlijning];
                                                   OptionCaptionML=[ENU=Left,Right;
                                                                    NLD=Links,Rechts];
                                                   OptionString=Left,Right }
    { 19  ;   ;Table Filter        ;TableFilter   ;OnValidate=VAR
                                                                ExportDefinition@1000000 : Record 11148599;
                                                              BEGIN
                                                                ExportDefinition.GET("Export Definition");

                                                                IF "Table No." = ExportDefinition."Main Table No." THEN BEGIN
                                                                  ExportDefinition."Main Table Filter" := "Table Filter";
                                                                  ExportDefinition.MODIFY;
                                                                END;
                                                                IF "Table No." = ExportDefinition."Sub Table No." THEN BEGIN
                                                                  ExportDefinition."Sub Table Filter" := "Table Filter";
                                                                  ExportDefinition.MODIFY;
                                                                END;

                                                                "Temp. Table Filter" := FORMAT("Table Filter");
                                                              END;

                                                   CaptionML=[ENU=Table Filter;
                                                              NLD=Tabelfilter] }
    { 20  ;   ;Link to Table (Tag Name);Text50    ;OnValidate=VAR
                                                                ExportDefinitionLine@1100531001 : Record 11148600;
                                                                ExportDefTableLink@1000000 : Record 11148601;
                                                                Relation@1100531000 : Record 11148625;
                                                                RelationFilter@1100531002 : Record 11148627;
                                                                FieldNo@1100531003 : Integer;
                                                              BEGIN
                                                                ExportDefTableLink.SETRANGE("Export Definition", "Export Definition");
                                                                ExportDefTableLink.SETRANGE("Export Def. Entry No.", "Entry No.");
                                                                ExportDefTableLink.DELETEALL;

                                                                ExportDefinitionLine.SETCURRENTKEY("Export Definition", "Line No.");
                                                                ExportDefinitionLine.SETRANGE("Export Definition", "Export Definition");
                                                                ExportDefinitionLine.SETFILTER("Line No.", '<%1', "Line No.");
                                                                ExportDefinitionLine.SETRANGE("Tag Name", "Link to Table (Tag Name)");
                                                                ExportDefinitionLine.SETRANGE(Type, ExportDefinitionLine.Type::Table);
                                                                IF ExportDefinitionLine.FINDLAST THEN BEGIN
                                                                  Relation.SETCURRENTKEY("Table No.");
                                                                  Relation.SETRANGE("Table No.", ExportDefinitionLine."Table No.");
                                                                  Relation.SETRANGE("Relation Table No.", "Table No.");
                                                                  IF Relation.FINDFIRST THEN BEGIN
                                                                    ExportDefTableLink."Export Definition" := "Export Definition";
                                                                    ExportDefTableLink."Export Def. Entry No." := "Entry No.";
                                                                    ExportDefTableLink."Main Table No." := Relation."Table No.";
                                                                    ExportDefTableLink."Main Field No." := Relation."Field No.";
                                                                    ExportDefTableLink."Sub Table No." := Relation."Relation Table No.";
                                                                    ExportDefTableLink."Sub Field No." := Relation."Relation Field No.";
                                                                    ExportDefTableLink.INSERT;

                                                                    RelationFilter.SETCURRENTKEY("Relation Entry No.");
                                                                    RelationFilter.SETRANGE("Relation Entry No.", Relation."Entry No.");
                                                                    RelationFilter.SETRANGE(Type, RelationFilter.Type::Field);
                                                                    IF RelationFilter.FINDSET THEN
                                                                      REPEAT
                                                                        EVALUATE(FieldNo, RelationFilter.Value);
                                                                        ExportDefTableLink."Main Field No." := FieldNo;
                                                                        ExportDefTableLink."Sub Field No." := RelationFilter."Field No.";
                                                                        ExportDefTableLink.INSERT;
                                                                      UNTIL RelationFilter.NEXT = 0;

                                                                  END ELSE BEGIN
                                                                    Relation.SETCURRENTKEY("Relation Table No.");
                                                                    Relation.SETRANGE("Relation Table No.", ExportDefinitionLine."Table No.");
                                                                    Relation.SETRANGE("Table No.", "Table No.");
                                                                    IF Relation.FINDFIRST THEN BEGIN
                                                                      ExportDefTableLink."Export Definition" := "Export Definition";
                                                                      ExportDefTableLink."Export Def. Entry No." := "Entry No.";
                                                                      ExportDefTableLink."Main Table No." := Relation."Relation Table No.";
                                                                      ExportDefTableLink."Main Field No." := Relation."Relation Field No.";
                                                                      ExportDefTableLink."Sub Table No." := Relation."Table No.";
                                                                      ExportDefTableLink."Sub Field No." := Relation."Field No.";
                                                                      ExportDefTableLink.INSERT;

                                                                      RelationFilter.SETCURRENTKEY("Relation Entry No.");
                                                                      RelationFilter.SETRANGE("Relation Entry No.", Relation."Entry No.");
                                                                      RelationFilter.SETRANGE(Type, RelationFilter.Type::Field);
                                                                      IF RelationFilter.FINDSET THEN
                                                                        REPEAT
                                                                          EVALUATE(FieldNo, RelationFilter.Value);
                                                                          ExportDefTableLink."Main Field No." := RelationFilter."Field No.";
                                                                          ExportDefTableLink."Sub Field No." := FieldNo;
                                                                          ExportDefTableLink.INSERT;
                                                                        UNTIL RelationFilter.NEXT = 0;

                                                                    END;
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Link to Table (Tag Name);
                                                              NLD=Linken aan tabel (tagnaam)] }
    { 21  ;   ;Table Name          ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Object.Name WHERE (Type=CONST(Table),
                                                                                         Company Name=CONST(),
                                                                                         ID=FIELD(Table No.)));
                                                   CaptionML=[ENU=Table Name;
                                                              NLD=Tabelnaam];
                                                   Editable=No }
    { 22  ;   ;Field Name          ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Field.FieldName WHERE (TableNo=FIELD(Table No.),
                                                                                             No.=FIELD(Field No.)));
                                                   CaptionML=[ENU=Field Name;
                                                              NLD=Veldnaam];
                                                   Editable=No }
    { 23  ;   ;Before Field        ;Text30        ;CaptionML=[ENU=Before Field;
                                                              NLD=Voorloop] }
    { 24  ;   ;After Field         ;Text30        ;CaptionML=[ENU=After Field;
                                                              NLD=Naloop] }
    { 25  ;   ;Dest. Variable      ;Code20        ;TableRelation="IN - Variable";
                                                   CaptionML=[ENU=Dest. Variable;
                                                              NLD=Doelvariabele] }
    { 26  ;   ;Original Value      ;Boolean       ;OnValidate=BEGIN
                                                                TESTFIELD(Type, Type::Field);
                                                              END;

                                                   CaptionML=[ENU=Original Value;
                                                              NLD=Originele waarde] }
    { 27  ;   ;Option Type         ;Option        ;CaptionML=[ENU=Option Type;
                                                              NLD=Optietype];
                                                   OptionCaptionML=[ENU=Value,Name,Caption;
                                                                    NLD=Waarde,Naam,Caption];
                                                   OptionString=Value,Name,Caption }
    { 35  ;   ;Skip If Empty       ;Boolean       ;CaptionML=[ENU=Skip If Empty;
                                                              NLD=Overslaan als leeg] }
    { 36  ;   ;Version No.         ;Integer       ;CaptionML=[ENU=Version No.;
                                                              NLD=Versienr.] }
    { 37  ;   ;XML Namespace       ;Text50        ;CaptionML=[ENU=XML Namespace;
                                                              NLD=XML Namespace] }
    { 38  ;   ;XML Namespace Prefix;Text30        ;CaptionML=[ENU=XML Namespace Prefix;
                                                              NLD=XML Namespace Prefix] }
    { 39  ;   ;Temp. Table Filter  ;Text250       ;OnValidate=BEGIN
                                                                EVALUATE("Table Filter", "Temp. Table Filter");
                                                              END;

                                                   CaptionML=[ENU=Temp. Table Filter;
                                                              NLD=Tijdelijk tabelfilter] }
    { 50  ;   ;Skip                ;Boolean       ;CaptionML=[ENU=Skip;
                                                              NLD=Overslaan] }
  }
  KEYS
  {
    {    ;Export Definition,Entry No.             ;Clustered=Yes }
    {    ;Export Definition,Line No.               }
    {    ;Export Definition,Link to Table (Tag Name) }
    {    ;Export Definition,Tag Name               }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE ClearFields@1000001();
    BEGIN
      "As Attribute" := FALSE;
      "Table No." := 0;
      "Field No." := 0;
      CLEAR("Table Filter");
      "Data Format" := '';
      "Before Field" := '';
      "After Field" := '';
      "Link to Table (Tag Name)" := '';
    END;

    PROCEDURE LookupLinkToTable@1000003();
    BEGIN
    END;

    PROCEDURE SetupLinkToTable@1000005();
    VAR
      ExportDefinition@1000002 : Record 11148599;
      ExportDefLine@1000001 : Record 11148600;
      ExportDefTableLink@1000000 : Page 11148605;
    BEGIN
      TESTFIELD("Link to Table (Tag Name)");

      ExportDefLine.SETCURRENTKEY("Export Definition", "Line No.");
      ExportDefLine.SETRANGE("Export Definition", "Export Definition");
      ExportDefLine.SETRANGE("Tag Name", "Link to Table (Tag Name)");
      ExportDefLine.SETFILTER("Line No.", '<%1', "Line No.");
      ExportDefLine.FINDLAST;
      ExportDefinition.GET("Export Definition");
      IF ExportDefinition."File Format" = ExportDefinition."File Format"::XML THEN
        ExportDefLine.TESTFIELD(Type, ExportDefLine.Type::Table);

      ExportDefTableLink.SetMainTable(ExportDefLine);
      ExportDefTableLink.SetSubTable(Rec);
      ExportDefTableLink.RUN;
    END;

    PROCEDURE SetupNewLine@1000000(xRec2@1000001 : Record 11148600;BelowxRec@1000000 : Boolean) : Code[20];
    VAR
      ExportDefinition@1000003 : Record 11148599;
      ExportDefinitionLine@1000005 : Record 11148600;
      SkipIndent@1000002 : Boolean;
    BEGIN
      Indent := 0;
      "Tag Name" := '';

      ExportDefinitionLine.SETRANGE("Export Definition", "Export Definition");
      IF ExportDefinitionLine.FINDLAST THEN
        "Entry No." := ExportDefinitionLine."Entry No." + 1
      ELSE BEGIN
        "Entry No." := 1;
        "Line No." := 10000;
        EXIT;
      END;

      IF ExportDefinition.GET("Export Definition") THEN
        ;

      ExportDefinitionLine.SETCURRENTKEY("Export Definition", "Line No.");
      ExportDefinitionLine := xRec2;

      IF NOT BelowxRec THEN
        IF ExportDefinitionLine.NEXT(-1) = 0 THEN BEGIN
          Indent := 0;
          SkipIndent := TRUE;
        END;

      IF NOT SkipIndent THEN
        IF (ExportDefinitionLine.Type IN [Type::Tag, Type::Table]) THEN
          Indent := ExportDefinitionLine.Indent + 1
        ELSE
          Indent := ExportDefinitionLine.Indent;

      ExportDefinitionLine := xRec2;

      IF BelowxRec THEN

        IF ExportDefinitionLine.NEXT = 0 THEN
          "Line No." := xRec2."Line No." + 10000
        ELSE
          "Line No." := ROUND((xRec2."Line No." + ExportDefinitionLine."Line No.") / 2, 1)

      ELSE

        IF ExportDefinitionLine.NEXT(-1) = 0 THEN
          "Line No." := ROUND(xRec2."Line No." / 2, 1)
        ELSE
          "Line No." := ROUND((xRec2."Line No." + ExportDefinitionLine."Line No.") / 2, 1);
    END;

    PROCEDURE SetFilterWithVariables@1000002();
    VAR
      ExportDefinition@1000001 : Record 11148599;
      ExportDefVariableFilter@1000000 : Page 11148607;
    BEGIN
      ExportDefinition.GET("Export Definition");
      IF ExportDefinition."File Format" = ExportDefinition."File Format"::XML THEN
        TESTFIELD(Type, Type::Table)
      ELSE
        TESTFIELD(Type, Type::Field);

      ExportDefVariableFilter.SetSubTable(Rec);
      ExportDefVariableFilter.RUN;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148601 IN - Export Def. Table Link
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Export Def. Table Link;
               NLD=Exportdefinitie tabellink];
  }
  FIELDS
  {
    { 1   ;   ;Export Definition   ;Code20        ;TableRelation="IN - Export Definition";
                                                   OnValidate=VAR
                                                                ExportDefinition@1000000 : Record 11148599;
                                                              BEGIN
                                                                IF "Export Def. Entry No." = 0 THEN BEGIN
                                                                  ExportDefinition.GET("Export Definition");
                                                                  VALIDATE("Main Table No.", ExportDefinition."Main Table No.");
                                                                  VALIDATE("Sub Table No.", ExportDefinition."Sub Table No.");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Export Definition;
                                                              NLD=Exportdefinitie] }
    { 2   ;   ;Export Def. Entry No.;Integer      ;TableRelation="IN - Export Definition Line"."Entry No." WHERE (Export Definition=FIELD(Export Definition));
                                                   CaptionML=[ENU=Export Def. Entry No.;
                                                              NLD=Exportdefinitieregelvolgnr.] }
    { 3   ;   ;Main Table No.      ;Integer       ;TableRelation=Object.ID WHERE (Type=CONST(Table),
                                                                                  Company Name=CONST());
                                                   CaptionML=[ENU=Main Table;
                                                              NLD=Hoofdtabel] }
    { 4   ;   ;Main Field No.      ;Integer       ;TableRelation=Field.No. WHERE (TableNo=FIELD(Main Table No.),
                                                                                  Type=FILTER(RecordID|Text|Code|GUID|Date|Time|DateFormula|Decimal|Integer|Option|Boolean|BigInteger|Duration|DateTime),
                                                                                  Class=FILTER(Normal|FlowField));
                                                   OnValidate=BEGIN
                                                                CALCFIELDS("Main Field Name");
                                                              END;

                                                   CaptionML=[ENU=Main Field;
                                                              NLD=Hoofdveld];
                                                   BlankZero=Yes }
    { 5   ;   ;Sub Table No.       ;Integer       ;TableRelation=Object.ID WHERE (Type=CONST(Table),
                                                                                  Company Name=CONST());
                                                   CaptionML=[ENU=Sub Table;
                                                              NLD=Subtabel] }
    { 6   ;   ;Sub Field No.       ;Integer       ;TableRelation=Field.No. WHERE (TableNo=FIELD(Sub Table No.),
                                                                                  Type=FILTER(RecordID|Text|Code|GUID|Date|Time|DateFormula|Decimal|Integer|Option|Boolean|BigInteger|Duration|DateTime),
                                                                                  Class=FILTER(Normal|FlowField));
                                                   OnValidate=BEGIN
                                                                CALCFIELDS("Sub Field Name");
                                                              END;

                                                   CaptionML=[ENU=Sub Field;
                                                              NLD=Subveld];
                                                   BlankZero=Yes }
    { 7   ;   ;Variable            ;Code20        ;TableRelation="IN - Variable";
                                                   CaptionML=[ENU=Variable;
                                                              NLD=Variabele] }
    { 8   ;   ;Main Field Name     ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Field.FieldName WHERE (TableNo=FIELD(Main Table No.),
                                                                                             No.=FIELD(Main Field No.)));
                                                   CaptionML=[ENU=Main Field Name;
                                                              NLD=Hoofdveldnaam];
                                                   Editable=No }
    { 9   ;   ;Sub Field Name      ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Field.FieldName WHERE (TableNo=FIELD(Sub Table No.),
                                                                                             No.=FIELD(Sub Field No.)));
                                                   CaptionML=[ENU=Sub Field Name;
                                                              NLD=Subveldnaam];
                                                   Editable=No }
    { 10  ;   ;Version No.         ;Integer       ;CaptionML=[ENU=Version No.;
                                                              NLD=Versienr.] }
  }
  KEYS
  {
    {    ;Export Definition,Export Def. Entry No.,Main Field No.;
                                                   Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148602 IN - Export Def. Function
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               TESTFIELD(Code);
             END;

    CaptionML=[ENU=Export Def. Function;
               NLD=Exportdefinitie functie];
    LookupPageID=Page11117022;
    DrillDownPageID=Page11117022;
  }
  FIELDS
  {
    { 1   ;   ;Export Definition   ;Code20        ;TableRelation="IN - Export Definition";
                                                   CaptionML=[ENU=Export Definition;
                                                              NLD=Exportdefinitie] }
    { 2   ;   ;Export Def. Entry No.;Integer      ;TableRelation="IN - Export Definition Line"."Entry No." WHERE (Export Definition=FIELD(Export Definition));
                                                   CaptionML=[ENU=Export Def. Entry No.;
                                                              NLD=Exportdefinitieregelvolgnr.] }
    { 3   ;   ;Line No.            ;Integer       ;CaptionML=[ENU=Line No.;
                                                              NLD=Regelnr.] }
    { 4   ;   ;Code                ;Code20        ;TableRelation="IN - Function";
                                                   OnValidate=BEGIN
                                                                CALCFIELDS(Description, "Description 2");
                                                              END;

                                                   CaptionML=[ENU=Code;
                                                              NLD=Code] }
    { 5   ;   ;Description         ;Text250       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("IN - Function".Description WHERE (Code=FIELD(Code)));
                                                   CaptionML=[ENU=Description;
                                                              NLD=Omschrijving];
                                                   Editable=No }
    { 6   ;   ;Description 2       ;Text250       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("IN - Function"."Description 2" WHERE (Code=FIELD(Code)));
                                                   CaptionML=[ENU=Description 2;
                                                              NLD=Omschrijving 2];
                                                   Editable=No }
    { 7   ;   ;Parameter 1         ;Text50        ;CaptionML=[ENU=Parameter 1;
                                                              NLD=Parameter 1];
                                                   CaptionClass=ColumnHeader(1) }
    { 8   ;   ;Parameter 2         ;Text50        ;CaptionML=[ENU=Parameter 2;
                                                              NLD=Parameter 2];
                                                   CaptionClass=ColumnHeader(2) }
    { 9   ;   ;Parameter 3         ;Text50        ;CaptionML=[ENU=Parameter 3;
                                                              NLD=Parameter 3];
                                                   CaptionClass=ColumnHeader(3) }
    { 10  ;   ;Source Variable     ;Code20        ;TableRelation="IN - Variable";
                                                   CaptionML=[ENU=Source Variable;
                                                              NLD=Bronvariabele] }
    { 11  ;   ;Dest. Variable      ;Code20        ;TableRelation="IN - Variable";
                                                   CaptionML=[ENU=Dest. Variable;
                                                              NLD=Doelvariabele] }
  }
  KEYS
  {
    {    ;Export Definition,Export Def. Entry No.,Line No.;
                                                   Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    LOCAL PROCEDURE ColumnHeader@1100531000(ColumnNo@1100531000 : Integer) : Text[30];
    VAR
      INFunction@1100531001 : Record 11148595;
      ParameterDescription@1100531002 : Text[250];
    BEGIN
      IF INFunction.GET(Code) THEN
        CASE ColumnNo OF
          1 : ParameterDescription := INFunction."Parameter 1";
          2 : ParameterDescription := INFunction."Parameter 2";
          3 : ParameterDescription := INFunction."Parameter 3";
        END
      ELSE
        ParameterDescription := 'Parameter ' + FORMAT(ColumnNo);

      EXIT('3,' + ParameterDescription);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148603 IN - Function Temp. Table
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Function Temp. Table;
               NLD=Functie tijdelijke tabel];
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code20        ;TableRelation="IN - Function";
                                                   CaptionML=[ENU=Code;
                                                              NLD=Code] }
    { 2   ;   ;Parameter 1         ;Text50        ;CaptionML=[ENU=Parameter 1;
                                                              NLD=Parameter 1] }
    { 3   ;   ;Parameter 2         ;Text50        ;CaptionML=[ENU=Parameter 2;
                                                              NLD=Parameter 2] }
    { 4   ;   ;Parameter 3         ;Text50        ;CaptionML=[ENU=Parameter 3;
                                                              NLD=Parameter 3] }
    { 5   ;   ;Source Variable     ;Code20        ;TableRelation="IN - Variable";
                                                   CaptionML=[ENU=Source Variable;
                                                              NLD=Bronvariabele] }
    { 6   ;   ;Dest. Variable      ;Code20        ;TableRelation="IN - Variable";
                                                   CaptionML=[ENU=Dest. Variable;
                                                              NLD=Doelvariabele] }
    { 7   ;   ;FieldValue          ;Text250       ;CaptionML=[ENU=Field Value;
                                                              NLD=Veldwaarde] }
    { 8   ;   ;Description         ;Text250       ;CaptionML=[ENU=Description;
                                                              NLD=Omschrijving] }
    { 9   ;   ;Description 2       ;Text250       ;CaptionML=[ENU=Description 2;
                                                              NLD=Omschrijving 2] }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148604 IN - Variable
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               TESTFIELD(Code);
             END;

    CaptionML=[ENU=Variable;
               NLD=Variabele];
    LookupPageID=Page11148595;
    DrillDownPageID=Page11148595;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code20        ;CaptionML=[ENU=Code;
                                                              NLD=Code];
                                                   NotBlank=Yes }
    { 2   ;   ;Description         ;Text30        ;CaptionML=[ENU=Description;
                                                              NLD=Omschrijving] }
    { 3   ;   ;Type                ;Option        ;CaptionML=[ENU=Type;
                                                              NLD=Soort];
                                                   OptionCaptionML=[ENU=Code,Boolean;
                                                                    NLD=Code,Boolean];
                                                   OptionString=Code,Boolean }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148605 IN - Conversion
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               TESTFIELD(Code);
             END;

    OnDelete=BEGIN
               ConversionLine.SETRANGE("Conversion Code", Code);
               ConversionLine.DELETEALL(TRUE);
             END;

    CaptionML=[ENU=Conversion;
               NLD=Conversie];
    LookupPageID=Page11148596;
    DrillDownPageID=Page11148596;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code20        ;CaptionML=[ENU=Code;
                                                              NLD=Code];
                                                   NotBlank=Yes }
    { 2   ;   ;Description         ;Text30        ;CaptionML=[ENU=Description;
                                                              NLD=Omschrijving] }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      ConversionLine@1000000 : Record 11148606;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148606 IN - Conversion Line
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Conversion Line;
               NLD=Conversieregel];
  }
  FIELDS
  {
    { 1   ;   ;Conversion Code     ;Code20        ;TableRelation="IN - Conversion";
                                                   CaptionML=[ENU=Conversion Code;
                                                              NLD=Conversie] }
    { 2   ;   ;Entry No.           ;Integer       ;CaptionML=[ENU=Entry No.;
                                                              NLD=Volgnummer] }
    { 3   ;   ;NAV Value           ;Text100       ;CaptionML=[ENU=NAV Value;
                                                              NLD=NAV waarde] }
    { 4   ;   ;Extern Value        ;Text100       ;CaptionML=[ENU=Extern Value;
                                                              NLD=Externe waarde] }
  }
  KEYS
  {
    {    ;Conversion Code,Entry No.               ;Clustered=Yes }
    {    ;Conversion Code,NAV Value                }
    {    ;Conversion Code,Extern Value             }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE GetNewEntryNo@1000000() : Integer;
    VAR
      ConversionLine@1000000 : Record 11148606;
    BEGIN
      ConversionLine.SETRANGE("Conversion Code", "Conversion Code");
      IF ConversionLine.FINDLAST THEN
        EXIT(ConversionLine."Entry No." + 1)
      ELSE
        EXIT(1);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148607 IN - Monitoring Setup
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               IF RecCopy.FINDLAST THEN
                 "Entry No." := RecCopy."Entry No." + 1
               ELSE
                 "Entry No." := 1;

               VALIDATE("Table Filter");
             END;

    OnModify=BEGIN
               VALIDATE("Table Filter");
             END;

    OnRename=BEGIN
               VALIDATE("Table Filter");
             END;

    CaptionML=[DEU=Monitoring Setup;
               ENU=Monitoring Setup;
               NLD=Monitorinstellingen];
    DrillDownPageID=Page11117027;
  }
  FIELDS
  {
    { 1   ;   ;Entry No.           ;Integer       ;CaptionML=[ENU=Entry No.;
                                                              NLD=Volgnummer] }
    { 2   ;   ;Table No.           ;Integer       ;TableRelation=Object.ID WHERE (Type=CONST(Table),
                                                                                  Company Name=CONST());
                                                   OnValidate=VAR
                                                                Mgt@1000000 : Codeunit 11148589;
                                                              BEGIN
                                                                CALCFIELDS("Table Name");
                                                                EVALUATE("Table Filter", Mgt.EmptyTableFilter("Table No."));
                                                              END;

                                                   CaptionML=[ENU=Table;
                                                              NLD=Tabel];
                                                   BlankZero=Yes }
    { 3   ;   ;Table Filter        ;TableFilter   ;OnValidate=BEGIN
                                                                "Temp. Table Filter" := FORMAT("Table Filter");
                                                              END;

                                                   CaptionML=[ENU=Table Filter;
                                                              NLD=Tabelfilter] }
    { 4   ;   ;Export Definition   ;Code20        ;TableRelation="IN - Export Definition";
                                                   OnValidate=VAR
                                                                ExportDefinition@1000001 : Record 11148599;
                                                              BEGIN
                                                                IF ExportDefinition.GET("Export Definition") THEN BEGIN
                                                                  //IF NOT ExportDefinition.Synchronize THEN
                                                                  //  IF STRPOS(ExportDefinition.Filename, '#') = 0 THEN
                                                                  //    MESSAGE(ctNoHashInFilename);
                                                                  VALIDATE("Table No.", ExportDefinition."Main Table No.");
                                                                  EVALUATE("Table Filter", FORMAT(ExportDefinition."Main Table Filter"));
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Export Definition;
                                                              NLD=Exportdefinitie] }
    { 5   ;   ;Export Moment       ;Option        ;OnValidate=BEGIN
                                                                IF "Export Moment" = "Export Moment"::Live THEN
                                                                  "Group per" := "Group per"::Record;
                                                              END;

                                                   CaptionML=[ENU=Export Moment;
                                                              NLD=Exportmoment];
                                                   OptionCaptionML=[ENU=Live,Periodic;
                                                                    NLD=Live,Periodiek];
                                                   OptionString=Live,Periodic }
    { 6   ;   ;Export Modify       ;Boolean       ;CaptionML=[ENU=Export Modify;
                                                              NLD=Wijzigingen exporteren] }
    { 7   ;   ;Export Insert       ;Boolean       ;CaptionML=[ENU=Export Insert;
                                                              NLD=Toevoegingen exporteren] }
    { 8   ;   ;Export Delete       ;Boolean       ;CaptionML=[ENU=Export Delete;
                                                              NLD=Verwijderingen exporteren] }
    { 9   ;   ;Export Rename       ;Boolean       ;CaptionML=[ENU=Export Rename;
                                                              NLD=Hernoemingen exporteren] }
    { 10  ;   ;Group per           ;Option        ;InitValue=Record;
                                                   OnValidate=BEGIN
                                                                IF ("Group per" = "Group per"::Table) AND
                                                                   ("Export Moment" = "Export Moment"::Live)
                                                                THEN
                                                                  FIELDERROR("Export Moment");
                                                              END;

                                                   CaptionML=[ENU=Group per;
                                                              NLD=Groeperen per];
                                                   OptionCaptionML=[ENU=" ,Record,Table";
                                                                    NLD=" ,Record,Tabel"];
                                                   OptionString=[ ,Record,Table] }
    { 11  ;   ;Export from all Companies;Boolean  ;CaptionML=[ENU=Export from all Companies;
                                                              NLD=Exporteer uit alle bedrijven] }
    { 12  ;   ;Table Name          ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Object.Name WHERE (Type=CONST(Table),
                                                                                         Company Name=CONST(),
                                                                                         ID=FIELD(Table No.)));
                                                   CaptionML=[ENU=Table Name;
                                                              NLD=Tabelnaam];
                                                   Editable=No }
    { 13  ;   ;Trigger Dest. Variable;Code20      ;TableRelation="IN - Variable";
                                                   CaptionML=[ENU=Trigger Dest. Variable;
                                                              NLD=Trigger doelvariabele] }
    { 14  ;   ;Job Entry No. Dest. Variable;Code20;TableRelation="IN - Variable";
                                                   CaptionML=[ENU=Job Entry No. Dest. Variable;
                                                              NLD=Opdrachtvolgnr. doelvariabele] }
    { 15  ;   ;Processing Codeunit ;Integer       ;CaptionML=[ENU=Processing Codeunit;
                                                              NLD=Verwerkingscodeunit] }
    { 16  ;   ;Temp. Table Filter  ;Text250       ;OnValidate=BEGIN
                                                                EVALUATE("Table Filter", "Temp. Table Filter");
                                                              END;

                                                   CaptionML=[ENU=Temp. Table Filter;
                                                              NLD=Tijdelijk tabelfilter] }
  }
  KEYS
  {
    {    ;Entry No.                               ;Clustered=Yes }
    {    ;Table No.                                }
    {    ;Export Definition                        }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      RecCopy@1000000000 : Record 11148607;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148608 IN - Export Job
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    OnDelete=VAR
               RecordValue@1100512000 : Record 11148619;
             BEGIN
               RecordValue.SETRANGE(Type, RecordValue.Type::"Export Job");
               RecordValue.SETRANGE("Entry No.", "Entry No.");
               RecordValue.DELETEALL(TRUE);
             END;

    CaptionML=[ENU=Export Job;
               NLD=Exporteeropdracht];
    DrillDownPageID=Page11117028;
  }
  FIELDS
  {
    { 1   ;   ;Entry No.           ;Integer       ;AutoIncrement=Yes;
                                                   CaptionML=[ENU=Entry No.;
                                                              NLD=Volgnummer] }
    { 2   ;   ;Setup Entry No.     ;Integer       ;CaptionML=[ENU=Setup Entry No.;
                                                              NLD=Setup volgnr.] }
    { 3   ;   ;Table No.           ;Integer       ;TableRelation=Object.ID WHERE (Type=CONST(Table),
                                                                                  Company Name=CONST());
                                                   OnValidate=VAR
                                                                Mgt@1000000 : Codeunit 11148589;
                                                              BEGIN
                                                                CALCFIELDS("Table Name");
                                                                EVALUATE("Table Filter", Mgt.EmptyTableFilter("Table No."));
                                                              END;

                                                   CaptionML=[ENU=Table;
                                                              NLD=Tabel];
                                                   BlankZero=Yes }
    { 4   ;   ;Table Filter        ;TableFilter   ;CaptionML=[ENU=Table Filter;
                                                              NLD=Tabelfilter] }
    { 5   ;   ;Export Definition   ;Code20        ;TableRelation="IN - Export Definition";
                                                   OnValidate=BEGIN
                                                                CALCFIELDS("Export Definition Location");
                                                              END;

                                                   CaptionML=[ENU=Export Definition;
                                                              NLD=Exportdefinitie] }
    { 6   ;   ;Export Moment       ;Option        ;CaptionML=[ENU=Export Moment;
                                                              NLD=Exportmoment];
                                                   OptionCaptionML=[ENU=Live,Periodic;
                                                                    NLD=Live,Periodiek];
                                                   OptionString=Live,Periodic }
    { 7   ;   ;Group per           ;Option        ;InitValue=Record;
                                                   CaptionML=[ENU=Group per;
                                                              NLD=Groeperen per];
                                                   OptionCaptionML=[ENU=" ,Record,Table";
                                                                    NLD=" ,Record,Tabel"];
                                                   OptionString=[ ,Record,Table] }
    { 8   ;   ;Export in all Companies;Boolean    ;CaptionML=[ENU=Export in all Companies;
                                                              NLD=Exporteer in alle bedrijven] }
    { 9   ;   ;Trigger             ;Option        ;CaptionML=[ENU=Trigger;
                                                              NLD=Trigger];
                                                   OptionCaptionML=[ENU=Insert,Modify,Delete,Rename;
                                                                    NLD=Insert,Modify,Verwijderen,Rename];
                                                   OptionString=Insert,Modify,Delete,Rename }
    { 10  ;   ;Record Filter       ;TableFilter   ;CaptionML=[ENU=Record Filter;
                                                              NLD=Recordfilter] }
    { 11  ;   ;Status              ;Option        ;CaptionML=[ENU=Status;
                                                              NLD=Status];
                                                   OptionCaptionML=[ENU=New,In Process,Error,Exported;
                                                                    NLD=Nieuw,In verwerking,Fout,Gexporteerd];
                                                   OptionString=New,In Process,Error,Exported }
    { 12  ;   ;DateTime Exported   ;DateTime      ;CaptionML=[ENU=DateTime Exported;
                                                              NLD=Datumtijd gexporteerd] }
    { 13  ;   ;Table Name          ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Object.Name WHERE (Type=CONST(Table),
                                                                                         Company Name=CONST(),
                                                                                         ID=FIELD(Table No.)));
                                                   CaptionML=[ENU=Table Name;
                                                              NLD=Tabelnaam];
                                                   Editable=No }
    { 14  ;   ;Original Record Filter;TableFilter ;CaptionML=[ENU=Original Record Filter;
                                                              NLD=Orignele recordfilter] }
    { 15  ;   ;DateTime Inserted   ;DateTime      ;CaptionML=[ENU=DateTime Inserted;
                                                              NLD=Datumtijd toegevoegd] }
    { 17  ;   ;Export Definition Location;Text250 ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("IN - Export Definition".Location WHERE (Code=FIELD(Export Definition)));
                                                   CaptionML=[ENU=Export Definition Location;
                                                              NLD=Exportdefinitielocatie];
                                                   Editable=No }
    { 18  ;   ;Trigger Dest. Variable;Code20      ;TableRelation="IN - Variable";
                                                   CaptionML=[ENU=Trigger Dest. Variable;
                                                              NLD=Trigger doelvariabele] }
    { 19  ;   ;Job Entry No. Dest. Variable;Code20;TableRelation="IN - Variable";
                                                   CaptionML=[ENU=Job Entry No. Dest. Variable;
                                                              NLD=Opdrachtvolgnr. doelvariabele] }
    { 20  ;   ;Processing Codeunit ;Integer       ;CaptionML=[ENU=Processing Codeunit;
                                                              NLD=Verwerkingscodeunit] }
  }
  KEYS
  {
    {    ;Entry No.                               ;Clustered=Yes }
    {    ;Status,Export Definition                 }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE Process@1000000();
    VAR
      ProcessExportJob@1000000 : Codeunit 11148621;
      Progressbar@1100512000 : Codeunit 11148624;
    BEGIN
      Progressbar.Close;

      ProcessExportJob.RUN(Rec);
      IF FIND('=') THEN
        ;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148609 IN - Message
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               "Logged By" := USERID;
               Date := TODAY;
               Time := SYSTEM.TIME;
             END;

    OnDelete=VAR
               MessageLine@1000000 : Record 11148610;
               MessageHistory@1000001 : Record 11148611;
             BEGIN
               MessageLine.SETRANGE("Message Entry No.", "Entry No.");
               MessageLine.DELETEALL;

               MessageHistory.SETCURRENTKEY("Message Entry No.");
               MessageHistory.SETRANGE("Message Entry No.", "Entry No.");
               MessageHistory.DELETEALL(TRUE);
             END;

    CaptionML=[ENU=Message;
               NLD=Bericht];
    LookupPageID=Page11117032;
    DrillDownPageID=Page11117032;
  }
  FIELDS
  {
    { 1   ;   ;Entry No.           ;Integer       ;AutoIncrement=Yes;
                                                   CaptionML=[ENU=Entry No.;
                                                              NLD=Volgnummer];
                                                   Editable=No }
    { 2   ;   ;Type                ;Option        ;CaptionML=[ENU=Type;
                                                              NLD=Soort];
                                                   OptionCaptionML=[ENU=Import,Export;
                                                                    NLD=Import,Export];
                                                   OptionString=Import,Export;
                                                   Editable=No }
    { 3   ;   ;Code                ;Code20        ;TableRelation=IF (Type=CONST(Import)) "IN - Import Definition"
                                                                 ELSE IF (Type=CONST(Export)) "IN - Export Definition";
                                                   CaptionML=[ENU=Code;
                                                              NLD=Code];
                                                   Editable=No }
    { 4   ;   ;Path                ;Text250       ;CaptionML=[ENU=Path;
                                                              NLD=Map];
                                                   Editable=No }
    { 5   ;   ;File                ;Text250       ;CaptionML=[ENU=File;
                                                              NLD=Bestandsnaam];
                                                   Editable=No }
    { 6   ;   ;Logged By           ;Text250       ;CaptionML=[ENU=Logged By;
                                                              NLD=Gelogd door];
                                                   Editable=No }
    { 7   ;   ;Date                ;Date          ;CaptionML=[ENU=Date;
                                                              NLD=Datum];
                                                   Editable=No }
    { 8   ;   ;Time                ;Time          ;CaptionML=[ENU=Time;
                                                              NLD=Tijd];
                                                   Editable=No }
    { 9   ;   ;Status              ;Option        ;CaptionML=[ENU=Status;
                                                              NLD=Status];
                                                   OptionCaptionML=[ENU=,Error,Processed;
                                                                    NLD=,Fout,Verwerkt];
                                                   OptionString=,Error,Processed;
                                                   Editable=No }
    { 10  ;   ;BLOB                ;BLOB          ;CaptionML=[ENU=BLOB;
                                                              NLD=BLOB] }
    { 11  ;   ;No. of History Lines;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("IN - Message History" WHERE (Message Entry No.=FIELD(Entry No.)));
                                                   CaptionML=[ENU=No. of History Lines;
                                                              NLD=Aantal historieregels];
                                                   Editable=No }
    { 12  ;   ;No. of Comments     ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("IN - Message Hist. Comment" WHERE (Message Entry No.=FIELD(Entry No.)));
                                                   CaptionML=[ENU=No. of Comments;
                                                              NLD=Aantal opmerkingen];
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Entry No.                               ;Clustered=Yes }
    {    ;Type,Code                                }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE Process@1000000();
    VAR
      ImportDefinition@1000003 : Record 11148591;
      Instr@1000000 : InStream;
    BEGIN
      TESTFIELD(Type, Type::Import);
      ImportDefinition.GET(Code);

      CALCFIELDS(BLOB);
      BLOB.CREATEINSTREAM(Instr);

      ImportDefinition.ProcessWithInstream(Instr, "Entry No.");
    END;

    PROCEDURE Export@1000001();
    VAR
      ImportDefinition@1000008 : Record 11148591;
      ExportDefinition@1000007 : Record 11148599;
      LogMgt@1000006 : Codeunit 11148623;
      oFile@1000000 : File;
      Instr@1000002 : InStream;
      OutStr@1000001 : OutStream;
      Extension@1000004 : Text[30];
      Filename@1000005 : Text[1024];
      FileFormat@1000012 : 'XML,CSV,Fixed Width,Excel,Broker';
      ctExtensions@1000010 : TextConst 'ENU=Interface Files (*.%1)|*.%1|All Files (*.*)|*.*;NLD=Interface Files (*.%1)|*.%1|All Files (*.*)|*.*';
      ctTitleText@1000009 : TextConst 'ENU=Export as...;NLD=Exporteren als...';
    BEGIN
      CASE Type OF

        Type::Import :
          IF ImportDefinition.GET(Code) THEN BEGIN
            Extension := ImportDefinition.Extension(ImportDefinition."File Format");
            FileFormat := ImportDefinition."File Format";
          END;

        Type::Export :
          IF ExportDefinition.GET(Code) THEN BEGIN
            Extension := ExportDefinition.Extension(ExportDefinition);
            FileFormat := ExportDefinition."File Format";
          END;

      END;

      LogMgt.SetDialogProperties(FORMAT(ctTitleText), STRSUBSTNO(ctExtensions, Extension), File, 2);
      IF NOT LogMgt.RUN THEN
        EXIT;

      Filename := LogMgt.GetDialogFilename;

      IF Filename = '' THEN
        EXIT;

      oFile.CREATE(Filename);
      oFile.CREATEOUTSTREAM(OutStr);

      CALCFIELDS(BLOB);
      BLOB.CREATEINSTREAM(Instr);

      COPYSTREAM(OutStr, Instr);
      oFile.CLOSE;
    END;

    PROCEDURE Import@1000002();
    VAR
      ImportDefinition@1000008 : Record 11148591;
      ExportDefinition@1000007 : Record 11148599;
      MessageLine@1000012 : Record 11148610;
      LogMgt@1000006 : Codeunit 11148623;
      oFile@1000000 : File;
      Instr@1000002 : InStream;
      OutStr@1000001 : OutStream;
      Extension@1000004 : Text[30];
      Filename@1000005 : Text[1024];
      FileFormat@1000011 : 'XML,CSV,Fixed Width,Excel,Broker';
      ctExtensions@1000010 : TextConst 'ENU=Interface Files (*.%1)|*.%1|All Files (*.*)|*.*;NLD=Interface Files (*.%1)|*.%1|All Files (*.*)|*.*';
      ctTitleText@1000009 : TextConst 'ENU=Import...;NLD=Importeren...';
    BEGIN
      CASE Type OF

        Type::Import :
          IF ImportDefinition.GET(Code) THEN BEGIN
            Extension := ImportDefinition.Extension(ImportDefinition."File Format");
            FileFormat := ImportDefinition."File Format";
          END;

        Type::Export :
          IF ExportDefinition.GET(Code) THEN BEGIN
            Extension := ExportDefinition.Extension(ExportDefinition);
            FileFormat := ExportDefinition."File Format";
          END;

      END;

      LogMgt.SetDialogProperties(FORMAT(ctTitleText), STRSUBSTNO(ctExtensions, Extension), File, 1);
      IF NOT LogMgt.RUN THEN
        EXIT;

      Filename := LogMgt.GetDialogFilename;

      IF Filename = '' THEN
        EXIT;

      oFile.OPEN(Filename);
      oFile.CREATEINSTREAM(Instr);
      BLOB.CREATEOUTSTREAM(OutStr);

      COPYSTREAM(OutStr, Instr);
      oFile.CLOSE;

      MODIFY(TRUE);

      IF FileFormat IN [FileFormat::XML, FileFormat::CSV, FileFormat::"Fixed Width", FileFormat::Broker] THEN
        LogMgt.BlobToMessageLines(Rec, MessageLine, "Entry No.", TRUE);
    END;

    PROCEDURE Show@11154639();
    VAR
      ImportDefinition@1000008 : Record 11148591;
      ExportDefinition@1000007 : Record 11148599;
      LogMgt@1000006 : Codeunit 11148623;
      Mgt@11154639 : Codeunit 11148589;
      oFile@1000000 : File;
      Instr@1000002 : InStream;
      OutStr@1000001 : OutStream;
      Extension@1000004 : Text[30];
      Filename@1000005 : Text[1024];
      FileFormat@1000012 : 'XML,CSV,Fixed Width,Excel,Broker';
      ctExtensions@1000010 : TextConst 'DEU=Interface Files (*.%1)|*.%1|All Files (*.*)|*.*;ENU=Interface Files (*.%1)|*.%1|All Files (*.*)|*.*;NLD=Interface Files (*.%1)|*.%1|All Files (*.*)|*.*';
      ctTitleText@1000009 : TextConst 'DEU=Export as...;ENU=Export as...;NLD=Exporteren als...';
    BEGIN
      CASE Type OF

        Type::Import :
          IF ImportDefinition.GET(Code) THEN BEGIN
            Extension := ImportDefinition.Extension(ImportDefinition."File Format");
            FileFormat := ImportDefinition."File Format";
          END;

        Type::Export :
          IF ExportDefinition.GET(Code) THEN BEGIN
            Extension := ExportDefinition.Extension(ExportDefinition);
            FileFormat := ExportDefinition."File Format";
          END;

      END;

      Filename := Mgt.TmpDir + '\' + File;

      IF Filename = '' THEN
        EXIT;

      oFile.CREATE(Filename);
      oFile.CREATEOUTSTREAM(OutStr);

      CALCFIELDS(BLOB);
      BLOB.CREATEINSTREAM(Instr);

      COPYSTREAM(OutStr, Instr);
      oFile.CLOSE;

      HYPERLINK(Filename);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148610 IN - Message Line
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               INSERT;
               SaveToBlob;
               DELETE;
             END;

    OnModify=BEGIN
               MODIFY;
               SaveToBlob;
             END;

    OnDelete=BEGIN
               DELETE;
               SaveToBlob;
               INSERT;
             END;

    CaptionML=[ENU=Message Line;
               NLD=Berichtregel];
  }
  FIELDS
  {
    { 1   ;   ;Message Entry No.   ;Integer       ;TableRelation="IN - Message";
                                                   CaptionML=[ENU=Message Entry No.;
                                                              NLD=Berichtvolgnr.] }
    { 2   ;   ;Line No.            ;Integer       ;CaptionML=[ENU=Line No.;
                                                              NLD=Regelnr.] }
    { 3   ;   ;Sub Line No.        ;Integer       ;CaptionML=[ENU=Sub Line No.;
                                                              NLD=Subregelnr.] }
    { 4   ;   ;Text                ;Text250       ;CaptionML=[ENU=Text;
                                                              NLD=Tekst] }
  }
  KEYS
  {
    {    ;Message Entry No.,Line No.,Sub Line No. ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    LOCAL PROCEDURE SaveToBlob@1000000();
    VAR
      Message@1000001 : Record 11148609;
      MessageLine@1000000 : Record 11148610;
      Outstr@1000002 : OutStream;
    BEGIN
      Message.GET("Message Entry No.");
      CLEAR(Message.BLOB);

      Message.BLOB.CREATEOUTSTREAM(Outstr);
      MessageLine.SETRANGE("Message Entry No.", "Message Entry No.");
      IF MessageLine.FINDSET THEN
        REPEAT
          Outstr.WRITETEXT(MessageLine.Text);
        UNTIL MessageLine.NEXT = 0;

      Message.MODIFY;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148611 IN - Message History
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               "Executed By" := USERID;
               Date := TODAY;
               Time := SYSTEM.TIME;
             END;

    OnDelete=VAR
               MessageHistComment@1000000 : Record 11148612;
             BEGIN
               MessageHistComment.SETRANGE("History Entry No.", "Entry No.");
               MessageHistComment.DELETEALL(TRUE);
             END;

    CaptionML=[ENU=Message History;
               NLD=Berichthistorie];
    LookupPageID=Page11117034;
    DrillDownPageID=Page11117034;
  }
  FIELDS
  {
    { 1   ;   ;Entry No.           ;Integer       ;AutoIncrement=Yes;
                                                   CaptionML=[ENU=Entry No.;
                                                              NLD=Volgnummer] }
    { 2   ;   ;Message Entry No.   ;Integer       ;TableRelation="IN - Message";
                                                   CaptionML=[ENU=Message Entry No.;
                                                              NLD=Berichtvolgnr.] }
    { 3   ;   ;Type                ;Option        ;CaptionML=[ENU=Type;
                                                              NLD=Soort];
                                                   OptionCaptionML=[ENU=Import,Export;
                                                                    NLD=Import,Export];
                                                   OptionString=Import,Export }
    { 4   ;   ;Code                ;Code20        ;TableRelation=IF (Type=CONST(Import)) "IN - Import Definition"
                                                                 ELSE IF (Type=CONST(Export)) "IN - Export Definition";
                                                   CaptionML=[ENU=Code;
                                                              NLD=Code] }
    { 5   ;   ;Executed By         ;Text250       ;CaptionML=[ENU=Executed By;
                                                              NLD=Uitgevoerd door] }
    { 6   ;   ;Date                ;Date          ;CaptionML=[ENU=Date;
                                                              NLD=Datum];
                                                   Editable=No }
    { 7   ;   ;Time                ;Time          ;CaptionML=[ENU=Time;
                                                              NLD=Tijd];
                                                   Editable=No }
    { 8   ;   ;Error               ;Boolean       ;CaptionML=[ENU=Error;
                                                              NLD=Foutmelding] }
    { 9   ;   ;No. of Comments     ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("IN - Message Hist. Comment" WHERE (History Entry No.=FIELD(Entry No.)));
                                                   CaptionML=[ENU=No. of Comments;
                                                              NLD=Aantal opmerkingen];
                                                   Editable=No }
    { 10  ;   ;Path                ;Text250       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("IN - Message".Path WHERE (Entry No.=FIELD(Message Entry No.)));
                                                   CaptionML=[ENU=Path;
                                                              NLD=Map];
                                                   Editable=No }
    { 11  ;   ;File                ;Text250       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("IN - Message".File WHERE (Entry No.=FIELD(Message Entry No.)));
                                                   CaptionML=[ENU=File;
                                                              NLD=Bestandsnaam];
                                                   Editable=No }
    { 12  ;   ;Status              ;Option        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("IN - Message".Status WHERE (Entry No.=FIELD(Message Entry No.)));
                                                   CaptionML=[ENU=Status;
                                                              NLD=Status];
                                                   OptionCaptionML=[ENU=,Error,Processed;
                                                                    NLD=,Fout,Verwerkt];
                                                   OptionString=,Error,Processed;
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Entry No.                               ;Clustered=Yes }
    {    ;Message Entry No.                        }
    {    ;Type,Code                                }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148612 IN - Message Hist. Comment
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Message Hist. Comment;
               NLD=Berichthist. opmerking];
    LookupPageID=Page11117035;
    DrillDownPageID=Page11117035;
  }
  FIELDS
  {
    { 1   ;   ;History Entry No.   ;Integer       ;CaptionML=[ENU=History Entry No.;
                                                              NLD=Historievolgnr.] }
    { 2   ;   ;Line No.            ;Integer       ;CaptionML=[ENU=Line No.;
                                                              NLD=Regelnr.] }
    { 3   ;   ;Message Entry No.   ;Integer       ;TableRelation="IN - Message";
                                                   CaptionML=[ENU=Message Entry No.;
                                                              NLD=Berichtvolgnr.] }
    { 4   ;   ;File                ;Text250       ;CaptionML=[ENU=File;
                                                              NLD=Bestand] }
    { 5   ;   ;Key                 ;Text250       ;CaptionML=[ENU=Key;
                                                              NLD=Sleutel] }
    { 6   ;   ;Error               ;Boolean       ;CaptionML=[ENU=Error;
                                                              NLD=Foutmelding] }
    { 7   ;   ;Error No.           ;Integer       ;CaptionML=[ENU=Error No.;
                                                              NLD=Foutnummer];
                                                   BlankZero=Yes }
    { 8   ;   ;Comment             ;Text250       ;CaptionML=[ENU=Comment;
                                                              NLD=Opmerking] }
    { 9   ;   ;Comment 2           ;Text250       ;CaptionML=[ENU=Comment 2;
                                                              NLD=Opmerking 2] }
    { 10  ;   ;Error Type          ;Option        ;CaptionML=[ENU=Error Type;
                                                              NLD=Errorsoort];
                                                   OptionCaptionML=[ENU=" ,Table Relation,Option,Min/Max,Max. Length,,,,Field Mandatory,Existing Record,New Record";
                                                                    NLD=" ,Tabelrelatie,Opties,Min/max,Max. lengte,,,,Veld verplicht,Bestaand record,Nieuw record"];
                                                   OptionString=[ ,Table Relation,Option,Min/Max,Max. Length,,,,Field Mandatory,Existing Record,New Record] }
    { 11  ;   ;Type                ;Option        ;CaptionML=[ENU=Type;
                                                              NLD=Soort];
                                                   OptionCaptionML=[ENU=Import,Export;
                                                                    NLD=Import,Export];
                                                   OptionString=Import,Export }
    { 12  ;   ;Code                ;Code20        ;TableRelation=IF (Type=CONST(Import)) "IN - Import Definition"
                                                                 ELSE IF (Type=CONST(Export)) "IN - Export Definition";
                                                   CaptionML=[ENU=Code;
                                                              NLD=Code] }
  }
  KEYS
  {
    {    ;History Entry No.,Line No.              ;Clustered=Yes }
    {    ;Message Entry No.                        }
    {    ;Type,Code                                }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148613 IN - Comment Line
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=IN - Comment Line;
               NLD=IN - Opmerkingsregel];
    LookupPageID=Page11117040;
    DrillDownPageID=Page11117040;
  }
  FIELDS
  {
    { 1   ;   ;Table Name          ;Option        ;CaptionML=[ENU=Table Name;
                                                              NLD=Tabelnaam];
                                                   OptionCaptionML=[ENU=Import Definition,Export Definition,Task,Transport,Project,Connector;
                                                                    NLD=Importdefinitie,Exportdefinitie,Taak,Transport,Project,Connectrr];
                                                   OptionString=Import Definition,Export Definition,Task,Transport,Project,Connector }
    { 2   ;   ;Code                ;Code20        ;TableRelation=IF (Table Name=CONST(Import Definition)) "IN - Import Definition"
                                                                 ELSE IF (Table Name=CONST(Export Definition)) "IN - Export Definition"
                                                                 ELSE IF (Table Name=CONST(Task)) "IN - Task"
                                                                 ELSE IF (Table Name=CONST(Connector)) "IN - Connector";
                                                   CaptionML=[ENU=Code;
                                                              NLD=Code] }
    { 3   ;   ;Line No.            ;Integer       ;CaptionML=[ENU=Line No.;
                                                              NLD=Regelnr.] }
    { 4   ;   ;Date                ;Date          ;CaptionML=[ENU=Date;
                                                              NLD=Datum] }
    { 5   ;   ;Comment             ;Text80        ;CaptionML=[ENU=Comment;
                                                              NLD=Opmerking] }
  }
  KEYS
  {
    {    ;Table Name,Code,Line No.                ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE SetUpNewLine@1();
    VAR
      CommentLine@1000 : Record 11148613;
    BEGIN
      CommentLine.SETRANGE("Table Name", "Table Name");
      CommentLine.SETRANGE(Code, Code);
      CommentLine.SETRANGE(Date, WORKDATE);
      IF NOT CommentLine.FINDFIRST THEN
        Date := WORKDATE;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148614 IN - Task
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               TESTFIELD(Code);

               "Created On" := CURRENTDATETIME;
               "Created By" := USERID;
               "Modified On" := CURRENTDATETIME;
               "Modified By" := USERID;
             END;

    OnModify=BEGIN
               "Modified On" := CURRENTDATETIME;
               "Modified By" := USERID;
             END;

    OnDelete=VAR
               CommentLine@1000002 : Record 11148613;
               TaskObject@1000001 : Record 11148615;
               TaskPlanning@1000000 : Record 11148616;
             BEGIN
               TaskPlanning.SETRANGE("Task Code", Code);
               TaskPlanning.DELETEALL(TRUE);

               TaskObject.SETRANGE("Task Code", Code);
               TaskObject.DELETEALL(TRUE);

               CommentLine.SETRANGE("Table Name", CommentLine."Table Name"::"Import Definition");
               CommentLine.SETRANGE(Code, Code);
               CommentLine.DELETEALL(TRUE);
             END;

    CaptionML=[ENU=Task;
               NLD=Taak];
    LookupPageID=Page11117042;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code20        ;CaptionML=[ENU=Code;
                                                              NLD=Code];
                                                   NotBlank=Yes }
    { 2   ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              NLD=Omschrijving] }
    { 3   ;   ;Single Object       ;Boolean       ;InitValue=Yes;
                                                   CaptionML=[ENU=Single Object;
                                                              NLD=Enkelvoudig object] }
    { 4   ;   ;Object Type         ;Option        ;InitValue=Transport;
                                                   OnValidate=BEGIN
                                                                "Object No." := 0;
                                                                "Table No." := 0;
                                                                EVALUATE("Table Filter", '');

                                                                CASE "Object Type" OF
                                                                  "Object Type"::Transport :
                                                                    VALIDATE("Table No.", DATABASE::"IN - Transport");

                                                                  "Object Type"::Import :
                                                                    VALIDATE("Table No.", DATABASE::"IN - Import Definition");

                                                                  "Object Type"::Export :
                                                                    VALIDATE("Table No.", DATABASE::"IN - Export Definition");

                                                                  "Object Type"::"Export Job" :
                                                                    VALIDATE("Table No.", DATABASE::"IN - Export Job");

                                                                  "Object Type"::"Trace Rules" :
                                                                    VALIDATE("Table No.", DATABASE::"IN - Trace Rule");

                                                                  "Object Type"::"Trace Messages" :
                                                                    VALIDATE("Table No.", DATABASE::"IN - Trace Rule");

                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Object Type;
                                                              NLD=Object type];
                                                   OptionCaptionML=[ENU=,Transport,Import,Export,Export Job,Task,Trace Rules,Trace Messages,,Report,Dataport,Codeunit;
                                                                    NLD=,Transport,Import,Export,Exporteeropdracht,Taak,Traceerregels,Traceerberichten,,Rapport,Dataport,Codeunit];
                                                   OptionString=,Transport,Import,Export,Export Job,Task,Trace Rules,Trace Messages,,Report,Dataport,Codeunit }
    { 5   ;   ;Field5              ;Option        ;CaptionML=[ENU=Field5;
                                                              NLD=Field5];
                                                   OptionCaptionML=[ENU=1;
                                                                    NLD=1];
                                                   OptionString=1 }
    { 6   ;   ;Object No.          ;Integer       ;TableRelation=IF (Object Type=CONST(Report)) Object.ID WHERE (Type=CONST(Report))
                                                                 ELSE IF (Object Type=CONST(Codeunit)) Object.ID WHERE (Type=CONST(Codeunit));
                                                   CaptionML=[ENU=Object;
                                                              NLD=Object] }
    { 7   ;   ;Table No.           ;Integer       ;OnValidate=VAR
                                                                Mgt@1000000 : Codeunit 11148589;
                                                              BEGIN
                                                                EVALUATE("Table Filter", Mgt.EmptyTableFilter("Table No."));
                                                              END;

                                                   CaptionML=[ENU=Table No.;
                                                              NLD=Tabelnr.] }
    { 8   ;   ;Table Filter        ;TableFilter   ;CaptionML=[ENU=Filter;
                                                              NLD=Filter] }
    { 9   ;   ;Field9              ;Boolean       ;CaptionML=[ENU=Field9;
                                                              NLD=Field9] }
    { 10  ;   ;Start Next Time     ;DateTime      ;FieldClass=FlowField;
                                                   CalcFormula=Min("IN - Task Planning"."Start Next Time" WHERE (Task Code=FIELD(Code)));
                                                   CaptionML=[ENU=Start Next Time;
                                                              NLD=Volgende keer starten];
                                                   Editable=No }
    { 11  ;   ;Result              ;Option        ;CaptionML=[ENU=Result;
                                                              NLD=Resultaat];
                                                   OptionCaptionML=[ENU=" ,Started,Ready,Failed";
                                                                    NLD=" ,Gestart,Klaar,Mislukt"];
                                                   OptionString=[ ,Started,Ready,Failed];
                                                   Editable=No }
    { 12  ;   ;Last Time Started   ;DateTime      ;CaptionML=[ENU=Last Time Started;
                                                              NLD=Laatst gestart];
                                                   Editable=No }
    { 13  ;   ;Last Time Ended     ;DateTime      ;CaptionML=[ENU=Last Time Ended;
                                                              NLD=Laatst geindigd];
                                                   Editable=No }
    { 14  ;   ;Error Text          ;Text250       ;CaptionML=[ENU=Error Text;
                                                              NLD=Foutmelding];
                                                   Editable=No }
    { 15  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("IN - Comment Line" WHERE (Table Name=CONST(Task),
                                                                                                Code=FIELD(Code)));
                                                   CaptionML=[ENU=Comment;
                                                              NLD=Opmerking];
                                                   Editable=No }
    { 16  ;   ;Wait After Run Object (s.);Decimal ;CaptionML=[ENU=Wait After Run Object (s.);
                                                              NLD=Pauze na runnen object (sec.)];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes }
    { 17  ;   ;Project Code        ;Code20        ;TableRelation="IN - Project";
                                                   OnValidate=VAR
                                                                Project@1000000 : Record 11148620;
                                                              BEGIN
                                                                IF Project.GET("Project Code") THEN
                                                                  Project.TESTFIELD(Blocked, FALSE);
                                                              END;

                                                   CaptionML=[ENU=Project;
                                                              NLD=Project] }
    { 18  ;   ;Status              ;Option        ;CaptionML=[ENU=Status;
                                                              NLD=Status];
                                                   OptionCaptionML=[ENU=Edit,Manual,Automated,Blocked;
                                                                    NLD=Bewerken,Handmatig,Geautomatiseerd,Geblokkeerd];
                                                   OptionString=Edit,Manual,Automated,Blocked }
    { 19  ;   ;Created On          ;DateTime      ;CaptionML=[ENU=Created On;
                                                              NLD=Gemaakt op];
                                                   Editable=No }
    { 20  ;   ;Created By          ;Code50        ;CaptionML=[ENU=Created By;
                                                              NLD=Gemaakt door];
                                                   Description=CI-129: was: Code[20];
                                                   Editable=No }
    { 21  ;   ;Modified On         ;DateTime      ;CaptionML=[ENU=Modified On;
                                                              NLD=Gewijzigd op];
                                                   Editable=No }
    { 22  ;   ;Modified By         ;Code50        ;CaptionML=[ENU=Modified By;
                                                              NLD=Gewijzigd door];
                                                   Description=CI-129: was: Code[20];
                                                   Editable=No }
    { 23  ;   ;Original Status     ;Option        ;CaptionML=[ENU=Original Status;
                                                              NLD=Originele status];
                                                   OptionCaptionML=[ENU=Edit,Manual,Automated,Blocked;
                                                                    NLD=Bewerken,Handmatig,Geautomatiseerd,Geblokkeerd];
                                                   OptionString=Edit,Manual,Automated,Blocked }
    { 30  ;   ;Continue on Failure ;Boolean       ;CaptionML=[ENU=Continue on Failure;
                                                              NLD=Doorgaan bij falen];
                                                   Description=CI-136 }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
    {    ;Project Code                             }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE Process@1000001();
    VAR
      ExecuteTask@1000000 : Codeunit 11148627;
    BEGIN
      ExecuteTask.RUN(Rec);
    END;

    PROCEDURE ShowObjects@1000002();
    VAR
      TaskObject@1000000 : Record 11148615;
      TaskObjects@1000001 : Page 11117046;
    BEGIN
      TESTFIELD("Single Object", FALSE);

      TaskObject.FILTERGROUP(10);
      TaskObject.SETRANGE("Task Code", Code);
      TaskObject.FILTERGROUP(0);

      TaskObjects.SETTABLEVIEW(TaskObject);
      TaskObjects.RUNMODAL;
    END;

    PROCEDURE ResetStatus@1000000();
    BEGIN
      Result := Result::" ";
      MODIFY;
    END;

    PROCEDURE AddTraceEntry@1100531000(Error@1100531003 : Boolean;ErrorMessage@1100531004 : Text[1024];NoOfRecordsProcessed@1100531000 : Integer);
    VAR
      TraceLine@1100531001 : Record 11148630;
      TraceMgt@1100531002 : Codeunit 11148642;
    BEGIN
      TraceMgt.AddTrace(
        TraceLine.Type::Task, Code, Error, COPYSTR(ErrorMessage, 1, 250), NoOfRecordsProcessed);
    END;

    PROCEDURE CopyTo@1000000001();
    VAR
      CopyRules@1000000000 : Record 11148643;
    BEGIN
      TESTFIELD(Code);
      CopyRules.SetupCopy(2, Code);
      CopyRules.SETRANGE("Definition Type", CopyRules."Definition Type"::Task);
      CopyRules.SETRANGE("Definition Code", Code);
      PAGE.RUN(0, CopyRules);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148615 IN - Task Object
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Task Object;
               NLD=Taakobject];
  }
  FIELDS
  {
    { 1   ;   ;Task Code           ;Code20        ;TableRelation="IN - Task";
                                                   CaptionML=[ENU=Task Code;
                                                              NLD=Taak] }
    { 2   ;   ;Line No.            ;Integer       ;CaptionML=[ENU=Line No.;
                                                              NLD=Regelnr.] }
    { 3   ;   ;Type                ;Option        ;InitValue=Transport;
                                                   OnValidate=BEGIN
                                                                "Object No." := 0;
                                                                "Table No." := 0;
                                                                EVALUATE("Table Filter", '');

                                                                CASE Type OF
                                                                  Type::Transport :
                                                                    VALIDATE("Table No.", DATABASE::"IN - Transport");

                                                                  Type::Import :
                                                                    VALIDATE("Table No.", DATABASE::"IN - Import Definition");

                                                                  Type::Export :
                                                                    VALIDATE("Table No.", DATABASE::"IN - Export Definition");

                                                                  Type::"Export Job" :
                                                                    VALIDATE("Table No.", DATABASE::"IN - Export Job");

                                                                  Type::"Apply Trace Rules" :
                                                                    VALIDATE("Table No.", DATABASE::"IN - Trace Rule");

                                                                  Type::"Send Trace Messages" :
                                                                    VALIDATE("Table No.", DATABASE::"IN - Trace Rule");

                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Type;
                                                              NLD=Soort];
                                                   OptionCaptionML=[ENU=,Transport,Import,Export,Export Job,Task,Apply Trace Rules,Send Trace Messages,,Report,Dataport,Codeunit;
                                                                    NLD=,Transport,Import,Export,Exporteeropdracht,Taak,Traceerregels toepassen,Traceerberichten verzenden,,Rapport,Dataport,Codeunit];
                                                   OptionString=,Transport,Import,Export,Export Job,Task,Apply Trace Rules,Send Trace Messages,,Report,Dataport,Codeunit }
    { 4   ;   ;Field4              ;Option        ;CaptionML=[ENU=Field4;
                                                              NLD=Field4];
                                                   OptionCaptionML=[ENU=1;
                                                                    NLD=1];
                                                   OptionString=1 }
    { 5   ;   ;Object No.          ;Integer       ;TableRelation=IF (Type=CONST(Report)) Object.ID WHERE (Type=CONST(Report))
                                                                 ELSE IF (Type=CONST(Codeunit)) Object.ID WHERE (Type=CONST(Codeunit));
                                                   CaptionML=[ENU=Object No.;
                                                              NLD=Objectnr.] }
    { 6   ;   ;Table No.           ;Integer       ;OnValidate=VAR
                                                                Mgt@1000000 : Codeunit 11148589;
                                                              BEGIN
                                                                EVALUATE("Table Filter", Mgt.EmptyTableFilter("Table No."));
                                                              END;

                                                   CaptionML=[ENU=Table No.;
                                                              NLD=Tabelnr.] }
    { 7   ;   ;Table Filter        ;TableFilter   ;CaptionML=[ENU=Filter;
                                                              NLD=Filter] }
    { 10  ;   ;Continue on Failure ;Boolean       ;CaptionML=[ENU=Continue on Failure;
                                                              NLD=Doorgaan bij falen];
                                                   Description=CI-136 }
  }
  KEYS
  {
    {    ;Task Code,Line No.                      ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148616 IN - Task Planning
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Task Planning;
               NLD=Taakplanning];
  }
  FIELDS
  {
    { 1   ;   ;Task Code           ;Code20        ;TableRelation="IN - Task";
                                                   CaptionML=[ENU=Task Code;
                                                              NLD=Taak] }
    { 2   ;   ;Line No.            ;Integer       ;CaptionML=[ENU=Line No.;
                                                              NLD=Regelnr.] }
    { 3   ;   ;Cycle               ;Option        ;InitValue=Hour;
                                                   OnValidate=BEGIN
                                                                Interval := 1;
                                                                Moment := '';
                                                                "Moment Time" := 0T;
                                                                "Active From" := 0T;
                                                                "Active Till" := 0T;
                                                                Monday := TRUE;
                                                                Tuesday := TRUE;
                                                                Wednesday := TRUE;
                                                                Thursday := TRUE;
                                                                Friday := TRUE;
                                                                Saturday := TRUE;
                                                                Sunday := TRUE;

                                                                CalcStartNextTime;
                                                              END;

                                                   CaptionML=[ENU=Cycle;
                                                              NLD=Cyclus];
                                                   OptionCaptionML=[ENU=,Second,Minute,Hour,Day,Week,Month,Year;
                                                                    NLD=,Seconde,Minuut,Uur,Dag,Week,Maand,Jaar];
                                                   OptionString=,Second,Minute,Hour,Day,Week,Month,Year }
    { 4   ;   ;Interval            ;Integer       ;InitValue=1;
                                                   OnValidate=BEGIN
                                                                CalcStartNextTime;
                                                              END;

                                                   CaptionML=[ENU=Interval;
                                                              NLD=Interval];
                                                   MinValue=1 }
    { 5   ;   ;Moment              ;Text30        ;OnValidate=BEGIN
                                                                CalcStartNextTime;
                                                              END;

                                                   CaptionML=[ENU=Moment;
                                                              NLD=Moment] }
    { 6   ;   ;Moment Time         ;Time          ;OnValidate=BEGIN
                                                                CalcStartNextTime;
                                                              END;

                                                   CaptionML=[ENU=Moment Time;
                                                              NLD=Moment tijd] }
    { 7   ;   ;Active From         ;Time          ;OnValidate=BEGIN
                                                                CheckActiveFromTill;
                                                                CalcStartNextTime;
                                                              END;

                                                   CaptionML=[ENU=Active From;
                                                              NLD=Aktief vanaf] }
    { 8   ;   ;Active Till         ;Time          ;OnValidate=BEGIN
                                                                CheckActiveFromTill;
                                                                CalcStartNextTime;
                                                              END;

                                                   CaptionML=[ENU=Active Till;
                                                              NLD=Aktief tot] }
    { 9   ;   ;Monday              ;Boolean       ;InitValue=Yes;
                                                   OnValidate=BEGIN
                                                                CalcStartNextTime;
                                                              END;

                                                   CaptionML=[ENU=Monday;
                                                              NLD=Maandag] }
    { 10  ;   ;Tuesday             ;Boolean       ;InitValue=Yes;
                                                   OnValidate=BEGIN
                                                                CalcStartNextTime;
                                                              END;

                                                   CaptionML=[ENU=Tuesday;
                                                              NLD=Dinsdag] }
    { 11  ;   ;Wednesday           ;Boolean       ;InitValue=Yes;
                                                   OnValidate=BEGIN
                                                                CalcStartNextTime;
                                                              END;

                                                   CaptionML=[ENU=Wednesday;
                                                              NLD=Woensdag] }
    { 12  ;   ;Thursday            ;Boolean       ;InitValue=Yes;
                                                   OnValidate=BEGIN
                                                                CalcStartNextTime;
                                                              END;

                                                   CaptionML=[ENU=Thursday;
                                                              NLD=Donderdag] }
    { 13  ;   ;Friday              ;Boolean       ;InitValue=Yes;
                                                   OnValidate=BEGIN
                                                                CalcStartNextTime;
                                                              END;

                                                   CaptionML=[ENU=Friday;
                                                              NLD=Vrijdag] }
    { 14  ;   ;Saturday            ;Boolean       ;InitValue=Yes;
                                                   OnValidate=BEGIN
                                                                CalcStartNextTime;
                                                              END;

                                                   CaptionML=[ENU=Saturday;
                                                              NLD=Zaterdag] }
    { 15  ;   ;Sunday              ;Boolean       ;InitValue=Yes;
                                                   OnValidate=BEGIN
                                                                CalcStartNextTime;
                                                              END;

                                                   CaptionML=[ENU=Sunday;
                                                              NLD=Zondag] }
    { 16  ;   ;Active              ;Boolean       ;CaptionML=[ENU=Active;
                                                              NLD=Actief] }
    { 20  ;   ;Last Time Started   ;DateTime      ;OnValidate=BEGIN
                                                                CalcStartNextTime;
                                                              END;

                                                   CaptionML=[ENU=Last Time Started;
                                                              NLD=Laatste keer uitgevoerd] }
    { 21  ;   ;Last Time Ended     ;DateTime      ;OnValidate=BEGIN
                                                                CalcStartNextTime;
                                                              END;

                                                   CaptionML=[ENU=Last Time Ended;
                                                              NLD=Laatste keer voltooid] }
    { 22  ;   ;Start Next Time     ;DateTime      ;CaptionML=[ENU=Start Next Time;
                                                              NLD=Volgende keer starten];
                                                   Editable=No }
    { 23  ;   ;Task Group Code     ;Code10        ;TableRelation="IN - Task Group";
                                                   CaptionML=[ENU=Task Group;
                                                              NLD=Taakgroep] }
  }
  KEYS
  {
    {    ;Task Code,Line No.                      ;Clustered=Yes }
    {    ;Start Next Time                          }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE SetupNewLine@1000015(xRec2@1000001 : Record 11148616;BelowxRec@1000000 : Boolean) : Code[20];
    VAR
      TaskPlanning@1000005 : Record 11148616;
    BEGIN
      TaskPlanning := Rec;
      TaskPlanning.SETRANGE("Task Code", "Task Code");

      IF BelowxRec THEN

        IF TaskPlanning.ISEMPTY THEN
          "Line No." := 10000
        ELSE
          "Line No." := xRec2."Line No." + 10000

      ELSE

        IF TaskPlanning.NEXT(-1) = 0 THEN
          "Line No." := ROUND(xRec2."Line No." / 2, 1)
        ELSE
          "Line No." := ROUND((xRec2."Line No." + TaskPlanning."Line No.") / 2, 1);
    END;

    PROCEDURE ShowProperties@1000000();
    VAR
      TaskPlanning@1000001 : Record 11148616;
      TaskPlanningCard@1000000 : Page 11117045;
    BEGIN
      TaskPlanning := Rec;
      TaskPlanning.FILTERGROUP(10);
      TaskPlanning.SETRECFILTER;
      TaskPlanning.FILTERGROUP(0);
      TaskPlanningCard.SETTABLEVIEW(TaskPlanning);
      TaskPlanningCard.RUNMODAL;
    END;

    PROCEDURE FormatMoment@1000009(VAR Text@1000001 : Text[1024]);
    VAR
      Date@1000000 : Record 2000000007;
      Number@1000002 : Integer;
    BEGIN
      CASE Cycle OF

        Cycle::Second :
          Text := Moment;

        Cycle::Minute :
          Text := Moment;

        Cycle::Hour :
          Text := Moment;

        Cycle::Day :
          Text := Moment;

        Cycle::Week :
          IF NOT EVALUATE(Number, Moment) THEN
            Text := ''
          ELSE BEGIN
            Date.GET(Date."Period Type"::Date, DMY2DATE(Number, 1, 1900));
            Text := Date."Period Name";
            Text := UPPERCASE(COPYSTR(Text, 1, 1)) + COPYSTR(Text, 2);
          END;

        Cycle::Month :
          Text := Moment;

        Cycle::Year :
          Text := Moment;

      END;
    END;

    PROCEDURE AfterInputMoment@1000005(VAR Text@1000000 : Text[1024]);
    VAR
      Date@1000003 : Record 2000000007;
      Time@1000002 : Time;
      Number@1000001 : Integer;
    BEGIN
      CASE Cycle OF

        Cycle::Second :
          IF EVALUATE(Number, Text) THEN
            Text := FORMAT(Number);

        Cycle::Minute :
          IF EVALUATE(Number, Text) THEN
            Text := FORMAT(Number);

        Cycle::Hour :
          IF EVALUATE(Number, Text) THEN
            Text := FORMAT(Number);

        Cycle::Day :
          IF Text <> '' THEN BEGIN
            EVALUATE(Time, Text);
            Text := FORMAT(Time);
          END;

        Cycle::Week :
          BEGIN
            IF EVALUATE(Number, Text) THEN
              ;
            IF (Number >= 1) AND (Number <= 7) THEN
              Text := FORMAT(Number)
            ELSE BEGIN
              Date.SETRANGE("Period Type", Date."Period Type"::Date);
              Date.SETRANGE("Period Start", 01011900D, 07011900D);
              Date.SETFILTER("Period Name", '@' + Text + '*');
              Date.FINDFIRST;
              Text := FORMAT(DATE2DMY(Date."Period Start", 1));
            END;
          END;

        Cycle::Month :
          IF EVALUATE(Number, Text) THEN
            Text := FORMAT(Number);

        Cycle::Year :
          IF EVALUATE(Number, Text) THEN
            Text := FORMAT(Number);

      END;
    END;

    PROCEDURE CalcStartNextTime@1000001();
    VAR
      TaskMgt@1000000 : Codeunit 11148626;
    BEGIN
      "Start Next Time" := TaskMgt.GetNextDateTime(Rec, FALSE);
    END;

    LOCAL PROCEDURE CheckActiveFromTill@1000002();
    VAR
      ctError@1000000 : TextConst 'ENU=%1 must be higher then %2.;NLD=%1 moet hoger zijn dan %2.';
    BEGIN
      IF ("Active From" <> 0T) AND ("Active Till" <> 0T) THEN
        IF "Active From" > "Active Till" THEN
          ERROR(ctError, FIELDCAPTION("Active Till"), FIELDCAPTION("Active From"));
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148617 IN - Task Log
{
  OBJECT-PROPERTIES
  {
    Date=05-11-13;
    Time=13:00:00;
    Version List=IDYN-CE5.50.8;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Task Log;
               NLD=Taakhistorie];
  }
  FIELDS
  {
    { 1   ;   ;Entry No.           ;Integer       ;AutoIncrement=Yes;
                                                   CaptionML=[ENU=Entry No.;
                                                              NLD=Volgnummer];
                                                   Editable=No }
    { 2   ;   ;Task Code           ;Code20        ;TableRelation="IN - Task";
                                                   CaptionML=[ENU=Task Code;
                                                              NLD=Taak];
                                                   Editable=No }
    { 3   ;   ;Executed By         ;Code50        ;CaptionML=[ENU=Executed By;
                                                              NLD=Uitgevoerd door];
                                                   Description=CI-129: was: Code[20];
                                                   Editable=No }
    { 4   ;   ;Type                ;Option        ;InitValue=Transport;
                                                   OnValidate=BEGIN
                                                                CASE Type OF
                                                                  Type::Transport :
                                                                    BEGIN
                                                                      "Object Type" := "Object Type"::Report;
                                                                      "Object No." := REPORT::"CI - Process Transports";
                                                                      VALIDATE("Table No.", DATABASE::"IN - Transport");
                                                                    END;

                                                                  Type::Import :
                                                                    BEGIN
                                                                      "Object Type" := "Object Type"::Report;
                                                                      "Object No." := REPORT::"CI - Process Import Definition";
                                                                      VALIDATE("Table No.", DATABASE::"IN - Import Definition");
                                                                    END;

                                                                  Type::Export :
                                                                    BEGIN
                                                                      "Object Type" := "Object Type"::Report;
                                                                      "Object No." := REPORT::"CI - Process Export Definition";
                                                                      VALIDATE("Table No.", DATABASE::"IN - Export Definition");
                                                                    END;

                                                                  Type::"Export Job" :
                                                                    BEGIN
                                                                      "Object Type" := "Object Type"::Report;
                                                                      "Object No." := REPORT::"CI - Process Export Jobs";
                                                                      VALIDATE("Table No.", DATABASE::"IN - Export Job");
                                                                    END;

                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Type;
                                                              NLD=Soort];
                                                   OptionCaptionML=[ENU=,Transport,Import,Export,Export Job;
                                                                    NLD=,Transport,Import,Export,Exporteeropdracht];
                                                   OptionString=,Transport,Import,Export,Export Job;
                                                   Editable=No }
    { 5   ;   ;Object Type         ;Option        ;CaptionML=[ENU=Object Type;
                                                              NLD=Objecttype];
                                                   OptionCaptionML=[ENU=,,,Report,Dataport,Codeunit;
                                                                    NLD=,,,Report,Dataport,Codeunit];
                                                   OptionString=,,,Report,Dataport,Codeunit;
                                                   Editable=No }
    { 6   ;   ;Object No.          ;Integer       ;CaptionML=[ENU=Object No.;
                                                              NLD=Objectnr.];
                                                   Editable=No }
    { 7   ;   ;Table No.           ;Integer       ;OnValidate=VAR
                                                                Mgt@1000000 : Codeunit 11148589;
                                                              BEGIN
                                                                EVALUATE("Table Filter", Mgt.EmptyTableFilter("Table No."));
                                                              END;

                                                   CaptionML=[ENU=Table No.;
                                                              NLD=Tabelnr.];
                                                   Editable=No }
    { 8   ;   ;Table Filter        ;TableFilter   ;CaptionML=[ENU=Filter;
                                                              NLD=Filter] }
    { 11  ;   ;Started             ;DateTime      ;CaptionML=[ENU=Started;
                                                              NLD=Gestart];
                                                   Editable=No }
    { 12  ;   ;Ended               ;DateTime      ;CaptionML=[ENU=Ended;
                                                              NLD=Geindigd];
                                                   Editable=No }
    { 13  ;   ;Error Text          ;Text250       ;CaptionML=[ENU=Error Text;
                                                              NLD=Foutmelding];
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Entry No.                               ;Clustered=Yes }
    {    ;Task Code                                }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148618 IN - Synchonization Inbox
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Synchonization Inbox;
               NLD=Synchronisatie inbox];
  }
  FIELDS
  {
    { 1   ;   ;Entry No.           ;Integer       ;CaptionML=[ENU=Entry No.;
                                                              NLD=Volgnummer];
                                                   Editable=No }
    { 2   ;   ;Import Definition   ;Code20        ;TableRelation="IN - Import Definition";
                                                   CaptionML=[ENU=Import Definition;
                                                              NLD=Importdefinitie];
                                                   Editable=No }
    { 3   ;   ;Date Time Inserted  ;DateTime      ;CaptionML=[ENU=Date Time Inserted;
                                                              NLD=Datumtijd toegevoegd];
                                                   Editable=No }
    { 4   ;   ;Source Company      ;Text30        ;TableRelation=Company;
                                                   CaptionML=[ENU=Source Company;
                                                              NLD=Bronbedrijf];
                                                   Editable=No }
    { 5   ;   ;Document            ;BLOB          ;CaptionML=[ENU=Document;
                                                              NLD=Document] }
    { 6   ;   ;Status              ;Option        ;CaptionML=[ENU=Status;
                                                              NLD=Status];
                                                   OptionCaptionML=[ENU=New,In progress,Error;
                                                                    NLD=Nieuw,In uitvoering,Fout];
                                                   OptionString=New,In progress,Error;
                                                   Editable=No }
    { 7   ;   ;Error Text          ;Text250       ;CaptionML=[ENU=Error Text;
                                                              NLD=Foutmelding];
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Entry No.                               ;Clustered=Yes }
    {    ;Status                                   }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE ShowDocument@1000000();
    VAR
      Message@1000001 : Record 11148609;
      TmpMessageLine@1000002 : TEMPORARY Record 11148610;
      LogMgt@1000000 : Codeunit 11148623;
    BEGIN
      CALCFIELDS(Document);
      Message.BLOB := Document;

      LogMgt.BlobToMessageLines(Message, TmpMessageLine, "Entry No.", TRUE);
      PAGE.RUN(PAGE::"CI - Show Inbox Message", TmpMessageLine);
    END;

    PROCEDURE Process@1000001();
    VAR
      ImportDefinition@1000001 : Record 11148591;
      ImportXMLFile@1000003 : Codeunit 11148595;
      ErrorMgt@1000004 : Codeunit 11148630;
      InStr@1000000 : InStream;
      ErrorText@1000006 : Text[1024];
      ctUnknownError@1000007 : TextConst 'ENU=Unkown error.;NLD=Onbekende fout.';
      tRecordNotExist@1000005 : TextConst 'ENU="%1 %2=''%3'' does not exist";NLD="%1 %2=''%3'' is niet aanwezig"';
    BEGIN
      Status := Status::"In progress";
      "Error Text" := '';
      MODIFY;
      COMMIT;

      IF NOT ImportDefinition.GET("Import Definition") THEN BEGIN
        Status := Status::Error;
        "Error Text" :=
          STRSUBSTNO(tRecordNotExist, ImportDefinition.TABLECAPTION, ImportDefinition.FIELDCAPTION(Code), "Import Definition");
        MODIFY;
        COMMIT;
      END ELSE BEGIN

        CALCFIELDS(Document);
        Document.CREATEINSTREAM(InStr);

        ImportXMLFile.SetInstream(InStr);
        IF ImportXMLFile.RUN(ImportDefinition) THEN BEGIN
          DELETE;
          COMMIT;
        END ELSE BEGIN
          Status := Status::Error;
          ErrorText := ErrorMgt.GetError;
          IF ErrorText = '' THEN
            ErrorText := ctUnknownError;
          "Error Text" := COPYSTR(ErrorText, 1, MAXSTRLEN("Error Text"));
          MODIFY;
          COMMIT;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148619 IN - Record Value
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Record Value;
               NLD=Recordwaarde];
  }
  FIELDS
  {
    { 1   ;   ;Type                ;Option        ;CaptionML=[ENU=Type;
                                                              NLD=Soort];
                                                   OptionCaptionML=[ENU=Export Job;
                                                                    NLD=Exporteeropdracht];
                                                   OptionString=Export Job }
    { 2   ;   ;Entry No.           ;Integer       ;TableRelation=IF (Type=CONST(Export Job)) "IN - Export Job";
                                                   CaptionML=[ENU=Entry No.;
                                                              NLD=Volgnummer] }
    { 3   ;   ;Table No.           ;Integer       ;TableRelation=Object.ID WHERE (Type=CONST(Table),
                                                                                  Company Name=CONST());
                                                   CaptionML=[ENU=Table;
                                                              NLD=Tabel] }
    { 4   ;   ;Field No.           ;Integer       ;TableRelation=Field.No. WHERE (TableNo=FIELD(Table No.),
                                                                                  Type=FILTER(RecordID|Text|Code|GUID|Date|Time|DateFormula|Decimal|Integer|Option|Boolean|BigInteger|Duration|DateTime),
                                                                                  Class=CONST(Normal));
                                                   CaptionML=[ENU=Field;
                                                              NLD=Veld] }
    { 5   ;   ;Value               ;Text250       ;CaptionML=[ENU=Value;
                                                              NLD=Waarde] }
    { 6   ;   ;Original Value      ;Text250       ;CaptionML=[ENU=Original Value;
                                                              NLD=Originele waarde] }
  }
  KEYS
  {
    {    ;Type,Entry No.,Table No.,Field No.      ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148620 IN - Project
{
  OBJECT-PROPERTIES
  {
    Date=05-11-13;
    Time=13:00:00;
    Version List=IDYN-CE5.50.8;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               TESTFIELD(Code);

               "Created On" := CURRENTDATETIME;
               "Created By" := USERID;
               "Modified On" := CURRENTDATETIME;
               "Modified By" := USERID;
             END;

    OnModify=BEGIN
               "Modified On" := CURRENTDATETIME;
               "Modified By" := USERID;
             END;

    CaptionML=[ENU=Project;
               NLD=Project];
    LookupPageID=Page11117056;
    DrillDownPageID=Page11117056;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code20        ;CaptionML=[ENU=Code;
                                                              NLD=Code];
                                                   NotBlank=Yes }
    { 2   ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              NLD=Omschrijving] }
    { 3   ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("IN - Comment Line" WHERE (Table Name=CONST(Project),
                                                                                                Code=FIELD(Code)));
                                                   CaptionML=[ENU=Comment;
                                                              NLD=Opmerking];
                                                   Editable=No }
    { 4   ;   ;Export Entry No.    ;Integer       ;CaptionML=[ENU=Export Entry No.;
                                                              NLD=Exportvolgnr.] }
    { 5   ;   ;Created On          ;DateTime      ;CaptionML=[ENU=Created On;
                                                              NLD=Gemaakt op];
                                                   Editable=No }
    { 6   ;   ;Created By          ;Code50        ;CaptionML=[ENU=Created By;
                                                              NLD=Gemaakt door];
                                                   Description=CI-129: was: Code[20];
                                                   Editable=No }
    { 7   ;   ;Modified On         ;DateTime      ;CaptionML=[ENU=Modified On;
                                                              NLD=Gewijzigd op];
                                                   Editable=No }
    { 8   ;   ;Modified By         ;Code50        ;CaptionML=[ENU=Modified By;
                                                              NLD=Gewijzigd door];
                                                   Description=CI-129: was: Code[20];
                                                   Editable=No }
    { 9   ;   ;Blocked             ;Boolean       ;OnValidate=VAR
                                                                Transport@1000001 : Record 11148590;
                                                                ImportDefinition@1000004 : Record 11148591;
                                                                ExportDefinition@1000003 : Record 11148599;
                                                                Task@1000002 : Record 11148614;
                                                                Connector@1000000 : Record 11148623;
                                                              BEGIN
                                                                IF Blocked THEN BEGIN
                                                                  Transport.SETCURRENTKEY("Project Code");
                                                                  Transport.SETRANGE("Project Code", Code);
                                                                  IF Transport.FINDSET THEN
                                                                    REPEAT
                                                                      Transport."Original Status" := Transport.Status;
                                                                      Transport.Status := Transport.Status::Blocked;
                                                                      Transport.MODIFY;
                                                                    UNTIL Transport.NEXT = 0;
                                                                  ImportDefinition.SETCURRENTKEY("Project Code");
                                                                  ImportDefinition.SETRANGE("Project Code", Code);
                                                                  IF ImportDefinition.FINDSET THEN
                                                                    REPEAT
                                                                      ImportDefinition."Original Status" := ImportDefinition.Status;
                                                                      ImportDefinition.Status := ImportDefinition.Status::Blocked;
                                                                      ImportDefinition.MODIFY;
                                                                    UNTIL ImportDefinition.NEXT = 0;
                                                                  ExportDefinition.SETCURRENTKEY("Project Code");
                                                                  ExportDefinition.SETRANGE("Project Code", Code);
                                                                  IF ExportDefinition.FINDSET THEN
                                                                    REPEAT
                                                                      ExportDefinition."Original Status" := ExportDefinition.Status;
                                                                      ExportDefinition.Status := ExportDefinition.Status::Blocked;
                                                                      ExportDefinition.MODIFY;
                                                                    UNTIL ExportDefinition.NEXT = 0;
                                                                  Task.SETCURRENTKEY("Project Code");
                                                                  Task.SETRANGE("Project Code", Code);
                                                                  IF Task.FINDSET THEN
                                                                    REPEAT
                                                                      Task."Original Status" := Task.Status;
                                                                      Task.Status := Task.Status::Blocked;
                                                                      Task.MODIFY;
                                                                    UNTIL Task.NEXT = 0;
                                                                  Connector.SETCURRENTKEY("Project Code");
                                                                  Connector.SETRANGE("Project Code", Code);
                                                                  IF Connector.FINDSET THEN
                                                                    REPEAT
                                                                      Connector."Original Status" := Connector.Status;
                                                                      Connector.Status := Connector.Status::Blocked;
                                                                      Connector.MODIFY;
                                                                    UNTIL Connector.NEXT = 0;

                                                                END ELSE BEGIN

                                                                  Transport.SETCURRENTKEY("Project Code");
                                                                  Transport.SETRANGE("Project Code", Code);
                                                                  IF Transport.FINDSET THEN
                                                                    REPEAT
                                                                      Transport.Status := Transport."Original Status";
                                                                      Transport.MODIFY;
                                                                    UNTIL Transport.NEXT = 0;
                                                                  ImportDefinition.SETCURRENTKEY("Project Code");
                                                                  ImportDefinition.SETRANGE("Project Code", Code);
                                                                  IF ImportDefinition.FINDSET THEN
                                                                    REPEAT
                                                                      ImportDefinition.Status := ImportDefinition."Original Status";
                                                                      ImportDefinition.MODIFY;
                                                                    UNTIL ImportDefinition.NEXT = 0;
                                                                  ExportDefinition.SETCURRENTKEY("Project Code");
                                                                  ExportDefinition.SETRANGE("Project Code", Code);
                                                                  IF ExportDefinition.FINDSET THEN
                                                                    REPEAT
                                                                      ExportDefinition.Status := ExportDefinition."Original Status";
                                                                      ExportDefinition.MODIFY;
                                                                    UNTIL ExportDefinition.NEXT = 0;
                                                                  Task.SETCURRENTKEY("Project Code");
                                                                  Task.SETRANGE("Project Code", Code);
                                                                  IF Task.FINDSET THEN
                                                                    REPEAT
                                                                      Task.Status := Task."Original Status";
                                                                      Task.MODIFY;
                                                                    UNTIL Task.NEXT = 0;
                                                                  Connector.SETCURRENTKEY("Project Code");
                                                                  Connector.SETRANGE("Project Code", Code);
                                                                  IF Connector.FINDSET THEN
                                                                    REPEAT
                                                                      Connector.Status := Connector."Original Status";
                                                                      Connector.MODIFY;
                                                                    UNTIL Connector.NEXT = 0;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Blocked;
                                                              NLD=Geblokkeerd] }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148621 IN - Project Line
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Project Line;
               NLD=Projectregel];
  }
  FIELDS
  {
    { 1   ;   ;Project             ;Code20        ;TableRelation="IN - Project";
                                                   CaptionML=[ENU=Project;
                                                              NLD=Project] }
    { 2   ;   ;Line No.            ;Integer       ;CaptionML=[ENU=Line No.;
                                                              NLD=Regelnr.] }
    { 3   ;   ;Type                ;Option        ;CaptionML=[ENU=Type;
                                                              NLD=Soort];
                                                   OptionCaptionML=[ENU=" ,Export Definition,Import Definition,Task,Transport,Connector";
                                                                    NLD=" ,Exportdefinitie,Importdefinitie,Task,Transport,Connecter"];
                                                   OptionString=[ ,Export Definition,Import Definition,Task,Transport,Connector] }
    { 4   ;   ;Code                ;Code20        ;TableRelation=IF (Type=CONST(Export Definition)) "IN - Export Definition"
                                                                 ELSE IF (Type=CONST(Import Definition)) "IN - Import Definition"
                                                                 ELSE IF (Type=CONST(Task)) "IN - Task"
                                                                 ELSE IF (Type=CONST(Transport)) "IN - Transport"
                                                                 ELSE IF (Type=CONST(Connector)) "IN - Connector";
                                                   CaptionML=[ENU=Code;
                                                              NLD=Code] }
    { 5   ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              NLD=Omschrijving] }
    { 6   ;   ;Status              ;Option        ;CaptionML=[ENU=Status;
                                                              NLD=Status];
                                                   OptionCaptionML=[ENU="Edit,Manual,Automated,Blocked, ";
                                                                    NLD="Wijzigen,Handmatig,Geautomatiseerd,Geblokkeerd, "];
                                                   OptionString=[Edit,Manual,Automated,Blocked, ];
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Project,Line No.                        ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE ShowCard@1000000();
    VAR
      Transport@1000003 : Record 11148590;
      ImportFile@1000000 : Record 11148591;
      ExportFile@1000001 : Record 11148599;
      Task@1000002 : Record 11148614;
      Connector@1000008 : Record 11148623;
      TaskCard@1000006 : Page 11117043;
    BEGIN
      CASE Type OF

        Type::"Export Definition" :
          BEGIN
            ExportFile.GET(Code);
            ExportFile.ShowCard;
          END;

        Type::"Import Definition" :
          BEGIN
            ImportFile.GET(Code);
            ImportFile.ShowCard;

          END;

        Type::Task :
          BEGIN
            Task.GET(Code);
            TaskCard.SETRECORD(Task);
            TaskCard.RUN;
          END;

        Type::Transport :
          BEGIN
            Transport.GET(Code);
            Transport.ShowCard;
          END;

        Type::Connector :
          BEGIN
            Connector.GET(Code);
            Connector.ShowCard;
          END;

      END;
    END;

    PROCEDURE Process@1000001();
    VAR
      Transport@1000000 : Record 11148590;
      ImportFile@1000002 : Record 11148591;
      ExportFile@1000003 : Record 11148599;
      Task@1000001 : Record 11148614;
    BEGIN
      CASE Type OF

        Type::"Export Definition" :
          BEGIN
            ExportFile.GET(Code);
            ExportFile.Process;
          END;

        Type::"Import Definition" :
          BEGIN
            ImportFile.GET(Code);
            ImportFile.Process;
          END;

        Type::Task :
          BEGIN
            Task.GET(Code);
            Task.Process;
          END;

        Type::Transport :
          BEGIN
            Transport.GET(Code);
            Transport.Process(TRUE);
          END;

      END;
    END;

    PROCEDURE NoOfMessages@1000002() : Integer;
    VAR
      Message@1000000 : Record 11148609;
    BEGIN
      CASE Type OF
        Type::"Import Definition" :
          BEGIN
            Message.SETCURRENTKEY(Type, Code);
            Message.SETRANGE(Type, Message.Type::Import);
            Message.SETRANGE(Code, Code);
            EXIT(Message.COUNT);
          END;
        Type::"Export Definition" :
          BEGIN
            Message.SETCURRENTKEY(Type, Code);
            Message.SETRANGE(Type, Message.Type::Export);
            Message.SETRANGE(Code, Code);
            EXIT(Message.COUNT);
          END;
      END;
    END;

    PROCEDURE NoOfComments@1000003() : Integer;
    VAR
      MessageHistComment@1000000 : Record 11148612;
    BEGIN
      CASE Type OF
        Type::"Import Definition" :
          BEGIN
            MessageHistComment.SETCURRENTKEY(Type, Code);
            MessageHistComment.SETRANGE(Type, MessageHistComment.Type::Import);
            MessageHistComment.SETRANGE(Code, Code);
            EXIT(MessageHistComment.COUNT);
          END;
      END;
    END;

    PROCEDURE MonitoringSetup@1000004() : Integer;
    VAR
      MonitoringSetup@1000000 : Record 11148607;
    BEGIN
      CASE Type OF
        Type::"Export Definition" :
          BEGIN
            MonitoringSetup.SETCURRENTKEY("Export Definition");
            MonitoringSetup.SETRANGE("Export Definition", Code);
            EXIT(MonitoringSetup.COUNT);
          END;
      END;
    END;

    PROCEDURE NoOfExportJobs@1000005() : Integer;
    VAR
      ExportJob@1000000 : Record 11148608;
    BEGIN
      CASE Type OF
        Type::"Export Definition" :
          BEGIN
            ExportJob.SETCURRENTKEY(Status, "Export Definition");
            ExportJob.SETFILTER(Status, '<>%1', ExportJob.Status::Exported);
            ExportJob.SETRANGE("Export Definition", Code);
            EXIT(ExportJob.COUNT);
          END;
      END;
    END;

    PROCEDURE DrillDownNoOfMessages@1000009() : Integer;
    VAR
      Message@1000000 : Record 11148609;
      MessageList@1000001 : Page 11117032;
    BEGIN
      CASE Type OF
        Type::"Import Definition" :
          BEGIN
            Message.SETCURRENTKEY(Type, Code);
            Message.SETRANGE(Type, Message.Type::Import);
            Message.SETRANGE(Code, Code);
            MessageList.SETTABLEVIEW(Message);
            MessageList.RUNMODAL;
          END;
        Type::"Export Definition" :
          BEGIN
            Message.SETCURRENTKEY(Type, Code);
            Message.SETRANGE(Type, Message.Type::Export);
            Message.SETRANGE(Code, Code);
            MessageList.SETTABLEVIEW(Message);
            MessageList.RUNMODAL;
          END;
      END;
    END;

    PROCEDURE DrillDownNoOfComments@1000008() : Integer;
    VAR
      MessageHistComment@1000000 : Record 11148612;
      HistoryComments@1000001 : Page 11117035;
    BEGIN
      CASE Type OF
        Type::"Import Definition" :
          BEGIN
            MessageHistComment.SETCURRENTKEY(Type, Code);
            MessageHistComment.SETRANGE(Type, MessageHistComment.Type::Import);
            MessageHistComment.SETRANGE(Code, Code);

            HistoryComments.SETTABLEVIEW(MessageHistComment);
            HistoryComments.RUNMODAL;

          END;
      END;
    END;

    PROCEDURE DrillDownMonitoringSetup@1000007() : Integer;
    VAR
      MonitoringSetup@1000000 : Record 11148607;
      MonitoringSetupForm@1000001 : Page 11117027;
    BEGIN
      CASE Type OF
        Type::"Export Definition" :
          BEGIN
            MonitoringSetup.SETCURRENTKEY("Export Definition");
            MonitoringSetup.SETRANGE("Export Definition", Code);

            MonitoringSetupForm.SETTABLEVIEW(MonitoringSetup);
            MonitoringSetupForm.RUNMODAL;
          END;
      END;
    END;

    PROCEDURE DrillDownNoOfExportJobs@1000006() : Integer;
    VAR
      ExportJob@1000000 : Record 11148608;
      ExportJobs@1000001 : Page 11117028;
    BEGIN
      CASE Type OF
        Type::"Export Definition" :
          BEGIN
            ExportJob.SETCURRENTKEY(Status, "Export Definition");
            ExportJob.SETFILTER(Status, '<>%1', ExportJob.Status::Exported);
            ExportJob.SETRANGE("Export Definition", Code);

            ExportJobs.SETTABLEVIEW(ExportJob);
            ExportJobs.RUNMODAL;
          END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148622 IN - Monitoring Excluded Table
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               IF RecCopy.FINDLAST THEN
                 "Entry No." := RecCopy."Entry No." + 1
               ELSE
                 "Entry No." := 1;
             END;

    CaptionML=[ENU=Monitoring Excluded Table;
               NLD=Monitoren uitgesloten tabel];
  }
  FIELDS
  {
    { 1   ;   ;Entry No.           ;Integer       ;CaptionML=[ENU=Entry No.;
                                                              NLD=Volgnummer] }
    { 2   ;   ;Table No.           ;Integer       ;TableRelation=Object.ID WHERE (Type=CONST(Table),
                                                                                  Company Name=CONST());
                                                   CaptionML=[ENU=Table;
                                                              NLD=Tabel];
                                                   BlankZero=Yes }
  }
  KEYS
  {
    {    ;Entry No.                               ;Clustered=Yes }
    {    ;Table No.                                }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      RecCopy@1000000000 : Record 11148622;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148623 IN - Connector
{
  OBJECT-PROPERTIES
  {
    Date=05-11-13;
    Time=13:00:00;
    Version List=IDYN-CE5.50.8;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               TESTFIELD(Code);

               "Created On" := CURRENTDATETIME;
               "Created By" := USERID;
               "Modified On" := CURRENTDATETIME;
               "Modified By" := USERID;
             END;

    OnModify=BEGIN
               "Modified On" := CURRENTDATETIME;
               "Modified By" := USERID;
             END;

    CaptionML=[ENU=Connector;
               NLD=Connecter];
    LookupPageID=Page11117062;
    DrillDownPageID=Page11117062;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code20        ;OnValidate=VAR
                                                                ctRecordAlreadyPresent@1000000 : TextConst 'ENU="The record already exist.\\Code=''%1'', Type=''%2''.";NLD="Het record is reeds aanwezig.\\Code=''%1'', Type=''%2''."';
                                                              BEGIN
                                                                IF GET(Code) THEN
                                                                  ERROR(ctRecordAlreadyPresent, Code, Type);
                                                              END;

                                                   CaptionML=[ENU=Code;
                                                              NLD=Code];
                                                   NotBlank=Yes }
    { 2   ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              NLD=Omschrijving] }
    { 3   ;   ;Type                ;Option        ;CaptionML=[ENU=Type;
                                                              NLD=Soort];
                                                   OptionCaptionML=[ENU=File System,Message Queue,Web Service,Port Connector;
                                                                    NLD=File System,Message Queue,Webservice,Poortconnecter];
                                                   OptionString=File System,Message Queue,Web Service,Port Connector }
    { 4   ;   ;Status              ;Option        ;CaptionML=[ENU=Status;
                                                              NLD=Status];
                                                   OptionCaptionML=[ENU=Edit,Manual,Automated,Blocked;
                                                                    NLD=Bewerken,Handmatig,Geautomatiseerd,Geblokkeerd];
                                                   OptionString=Edit,Manual,Automated,Blocked }
    { 5   ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("IN - Comment Line" WHERE (Table Name=CONST(Connector),
                                                                                                Code=FIELD(Code)));
                                                   CaptionML=[ENU=Comment;
                                                              NLD=Opmerking];
                                                   Editable=No }
    { 6   ;   ;Project Code        ;Code20        ;TableRelation="IN - Project";
                                                   OnValidate=VAR
                                                                Project@1000000 : Record 11148620;
                                                              BEGIN
                                                                IF Project.GET("Project Code") THEN
                                                                  Project.TESTFIELD(Blocked, FALSE);
                                                              END;

                                                   CaptionML=[ENU=Project;
                                                              NLD=Project] }
    { 7   ;   ;Created On          ;DateTime      ;CaptionML=[ENU=Created On;
                                                              NLD=Gemaakt op];
                                                   Editable=No }
    { 8   ;   ;Created By          ;Code50        ;CaptionML=[ENU=Created By;
                                                              NLD=Gemaakt door];
                                                   Description=CI-129: was: Code[20];
                                                   Editable=No }
    { 9   ;   ;Modified On         ;DateTime      ;CaptionML=[ENU=Modified On;
                                                              NLD=Gewijzigd op];
                                                   Editable=No }
    { 10  ;   ;Modified By         ;Code50        ;CaptionML=[ENU=Modified By;
                                                              NLD=Gewijzigd door];
                                                   Description=CI-129: was: Code[20];
                                                   Editable=No }
    { 11  ;   ;Original Status     ;Option        ;CaptionML=[ENU=Original Status;
                                                              NLD=Originele status];
                                                   OptionCaptionML=[ENU=Edit,Manual,Automated,Blocked;
                                                                    NLD=Bewerken,Handmatig,Geautomatiseerd,Geblokkeerd];
                                                   OptionString=Edit,Manual,Automated,Blocked }
    { 12  ;   ;Folder              ;Text100       ;CaptionML=[ENU=Folder;
                                                              NLD=Map] }
    { 13  ;   ;Request Queue       ;Text100       ;CaptionML=[ENU=Request Queue;
                                                              NLD=Aanvraagwachtrij] }
    { 14  ;   ;Reply Queue         ;Text100       ;CaptionML=[ENU=Reply Queue;
                                                              NLD=Antwoordenwachtrij] }
    { 15  ;   ;Port                ;Integer       ;CaptionML=[ENU=Port;
                                                              NLD=Poort] }
    { 20  ;   ;Run Import Def.     ;Code20        ;TableRelation="IN - Import Definition";
                                                   CaptionML=[ENU=Run Import Def.;
                                                              NLD=Start importdefinitie] }
    { 21  ;   ;Run Export Def. Ok  ;Code20        ;TableRelation="IN - Export Definition";
                                                   CaptionML=[ENU=Run Export Def.;
                                                              NLD=Start exportdef.] }
    { 22  ;   ;Run Export Def. Error;Code20       ;TableRelation="IN - Export Definition";
                                                   CaptionML=[ENU=Run Export Def. if Error;
                                                              NLD=Start exportdef. bij fout] }
    { 23  ;   ;Run Task            ;Code20        ;TableRelation="IN - Task";
                                                   CaptionML=[ENU=Run Task;
                                                              NLD=Taak uitvoeren] }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
    {    ;Project Code                             }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE IsActive@1000000() : Boolean;
    VAR
      ConnectorMgt@1000000 : Codeunit 11148638;
    BEGIN
      IF Code = '' THEN
        EXIT;
      EXIT(ConnectorMgt.ConnectorActive(Rec));
    END;

    PROCEDURE Start@1000001();
    VAR
      ConnectorMgt@1000000 : Codeunit 11148638;
    BEGIN
      ConnectorMgt.Start(Rec);
    END;

    PROCEDURE Stop@1000003();
    VAR
      ConnectorMgt@1000000 : Codeunit 11148638;
    BEGIN
      ConnectorMgt.Stop(Rec);
    END;

    PROCEDURE ShowCard@1000013();
    VAR
      FolderMonitoringCard@1100531000 : Page 11117063;
      MessageQueueCard@1100531001 : Page 11117065;
      WebServiceCard@1100531002 : Page 11117067;
      PortConnectorCard@1100531003 : Page 11117089;
    BEGIN
      CASE Type OF
        Type::"File System" :
          BEGIN
            FolderMonitoringCard.SETRECORD(Rec);
            FolderMonitoringCard.RUNMODAL;
          END;

        Type::"Message Queue" :
          BEGIN
            MessageQueueCard.SETRECORD(Rec);
            MessageQueueCard.RUNMODAL;
          END;

        Type::"Web Service" :
          BEGIN
            WebServiceCard.SETRECORD(Rec);
            WebServiceCard.RUNMODAL;
          END;

        Type::"Port Connector" :
          BEGIN
            PortConnectorCard.SETRECORD(Rec);
            PortConnectorCard.RUNMODAL;
          END;

      END;
    END;

    PROCEDURE AddTraceEntry@1100531000(Error@1100531003 : Boolean;ErrorMessage@1100531004 : Text[1024];NoOfRecordsProcessed@1100531000 : Integer);
    VAR
      TraceLine@1100531001 : Record 11148630;
      TraceMgt@1100531002 : Codeunit 11148642;
    BEGIN
      TraceMgt.AddTrace(
        TraceLine.Type::Connector, Code, Error, COPYSTR(ErrorMessage, 1, 250), NoOfRecordsProcessed);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148624 IN - Connector Line
{
  OBJECT-PROPERTIES
  {
    Date=09-11-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.1;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Connector Line;
               NLD=Connectorregel];
  }
  FIELDS
  {
    { 1   ;   ;Connector Code      ;Code20        ;TableRelation="IN - Connector";
                                                   CaptionML=[ENU=Connector Code;
                                                              NLD=Connector] }
    { 2   ;   ;Line No.            ;Integer       ;CaptionML=[ENU=Line No.;
                                                              NLD=Regelnr.] }
    { 3   ;   ;Type                ;Option        ;CaptionML=[ENU=Type;
                                                              NLD=Soort];
                                                   OptionCaptionML=[ENU=Filename,Filename Contains,Element Value,Page Name,Has Request,Request Value;
                                                                    NLD=Bestandnaam,Bestandnaam bevat,Elementwaarde,Paginanaam,Heeft request,Requestwaarde];
                                                   OptionString=Filename,Filename Contains,Element Value,Page Name,Has Request,Request Value }
    { 4   ;   ;Element             ;Text100       ;CaptionML=[ENU=Element;
                                                              NLD=Element] }
    { 5   ;   ;Value               ;Text100       ;CaptionML=[ENU=Value;
                                                              NLD=Waarde] }
    { 6   ;   ;Run Import Def.     ;Code20        ;TableRelation="IN - Import Definition";
                                                   CaptionML=[ENU=Run Import Def.;
                                                              NLD=Start importdefinitie] }
    { 7   ;   ;Run Export Def. Ok  ;Code20        ;TableRelation="IN - Export Definition";
                                                   CaptionML=[ENU=Run Export Def.;
                                                              NLD=Start exportdef.] }
    { 8   ;   ;Run Export Def. Error;Code20       ;TableRelation="IN - Export Definition";
                                                   CaptionML=[ENU=Run Export Def. if Error;
                                                              NLD=Start exportdef. bij fout] }
    { 9   ;   ;Run Task            ;Code20        ;TableRelation="IN - Task";
                                                   CaptionML=[ENU=Run Task;
                                                              NLD=Taak uitvoeren] }
  }
  KEYS
  {
    {    ;Connector Code,Line No.                 ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148625 IN - Relation
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    OnDelete=VAR
               RelationCondition@1100531000 : Record 11148626;
               RelationFilter@1100531001 : Record 11148627;
             BEGIN
               RelationCondition.SETCURRENTKEY("Relation Entry No.");
               RelationCondition.SETRANGE("Relation Entry No.", "Entry No.");
               RelationCondition.DELETEALL;

               RelationFilter.SETCURRENTKEY("Relation Entry No.");
               RelationFilter.SETRANGE("Relation Entry No.", "Entry No.");
               RelationFilter.DELETEALL;
             END;

    CaptionML=[ENU=Relation;
               NLD=Relatie];
  }
  FIELDS
  {
    { 1   ;   ;Entry No.           ;Integer       ;AutoIncrement=Yes;
                                                   CaptionML=[ENU=Entry No.;
                                                              NLD=Volgnummer] }
    { 2   ;   ;Table No.           ;Integer       ;CaptionML=[ENU=Table;
                                                              NLD=Tabel];
                                                   Editable=No }
    { 3   ;   ;Field No.           ;Integer       ;CaptionML=[ENU=Field;
                                                              NLD=Veld] }
    { 4   ;   ;Relation Table No.  ;Integer       ;CaptionML=[ENU=Relation Table;
                                                              NLD=Relatietabel] }
    { 5   ;   ;Relation Field No.  ;Integer       ;CaptionML=[ENU=Relation Field;
                                                              NLD=Relatieveld] }
    { 6   ;   ;No. of Conditions   ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("IN - Relation Condition" WHERE (Relation Entry No.=FIELD(Entry No.)));
                                                   CaptionML=[ENU=No. of Conditions;
                                                              NLD=Aantal voorwaarden];
                                                   Editable=No }
    { 7   ;   ;No. of Filters      ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("IN - Relation Filter" WHERE (Relation Entry No.=FIELD(Entry No.)));
                                                   CaptionML=[ENU=No. of Filters;
                                                              NLD=Aantal filters];
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Entry No.                               ;Clustered=Yes }
    {    ;Table No.,Field No.                      }
    {    ;Relation Table No.,Relation Field No.    }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Mgt@1000000000 : Codeunit 11148589;

    PROCEDURE TableNoText@1000000000() Result : Text[1024];
    BEGIN
      Mgt.FormatTableNo(Result, "Table No.");
    END;

    PROCEDURE FieldNoText@1000000001() Result : Text[1024];
    BEGIN
      Mgt.FormatFieldNo(Result, "Table No.", "Field No.");
    END;

    PROCEDURE RelTableNoText@1000000002() Result : Text[1024];
    BEGIN
      Mgt.FormatTableNo(Result, "Relation Table No.");
    END;

    PROCEDURE RelFieldNoText@1000000003() Result : Text[1024];
    BEGIN
      Mgt.FormatFieldNo(Result, "Relation Table No.", "Relation Field No.");
    END;

    PROCEDURE ConditionText@1100531000() ReturnValue : Text[1024];
    VAR
      RelationCondition@1100531000 : Record 11148626;
      Field@1100531001 : Record 2000000041;
      ctCondition@1100531002 : TextConst 'ENU="%1=%2(%3)";NLD="%1=%2(%3)"';
    BEGIN
      RelationCondition.SETCURRENTKEY("Relation Entry No.");
      RelationCondition.SETRANGE("Relation Entry No.", "Entry No.");
      IF RelationCondition.FINDSET THEN
        REPEAT
          IF NOT Field.GET("Table No.", RelationCondition."Field No.") THEN
            Field.FieldName := '';

          IF ReturnValue <> '' THEN
            ReturnValue += ', ';

          ReturnValue += STRSUBSTNO(ctCondition, Field.FieldName, UPPERCASE(FORMAT(RelationCondition.Type)), RelationCondition.Value);
        UNTIL RelationCondition.NEXT = 0;
    END;

    PROCEDURE FilterText@1100531003() ReturnValue : Text[1024];
    VAR
      RelationFilter@1100531000 : Record 11148627;
      Field@1100531001 : Record 2000000041;
      RelationValue@1100531003 : Text[1024];
      FieldNo@1100531004 : Integer;
      ctFilter@1100531002 : TextConst 'ENU="%1=%2(%3)";NLD="%1=%2(%3)"';
    BEGIN
      RelationFilter.SETCURRENTKEY("Relation Entry No.");
      RelationFilter.SETRANGE("Relation Entry No.", "Entry No.");
      IF RelationFilter.FINDSET THEN
        REPEAT
          IF NOT Field.GET("Relation Table No.", RelationFilter."Field No.") THEN
            Field.FieldName := '';

          IF ReturnValue <> '' THEN
            ReturnValue += ', ';

          RelationValue := RelationFilter.Value;
          IF RelationFilter.Type = RelationFilter.Type::Field THEN
            IF EVALUATE(FieldNo, RelationFilter.Value) THEN
              IF Field.GET("Table No.", FieldNo) THEN
                RelationValue := Field.FieldName;

          ReturnValue += STRSUBSTNO(ctFilter, Field.FieldName, UPPERCASE(FORMAT(RelationFilter.Type)), RelationValue);

        UNTIL RelationFilter.NEXT = 0;
    END;

    PROCEDURE ConditionDrilldown@1000000007() ReturnValue : Text[1024];
    VAR
      RelationCondition@1100531000 : Record 11148626;
      ctCondition@1100531002 : TextConst 'ENU="%1=%2(%3)";NLD="%1=%2(%3)"';
    BEGIN
      RelationCondition.SETCURRENTKEY("Relation Entry No.");
      RelationCondition.SETRANGE("Relation Entry No.", "Entry No.");
      PAGE.RUNMODAL(0, RelationCondition);
    END;

    PROCEDURE FilterDrilldown@1000000006() ReturnValue : Text[1024];
    VAR
      RelationFilter@1100531000 : Record 11148627;
      ctFilter@1100531002 : TextConst 'ENU="%1=%2(%3)";NLD="%1=%2(%3)"';
    BEGIN
      RelationFilter.SETCURRENTKEY("Relation Entry No.");
      RelationFilter.SETRANGE("Relation Entry No.", "Entry No.");
      PAGE.RUNMODAL(0, RelationFilter);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148626 IN - Relation Condition
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Relation Condition;
               NLD=Relatievoorwaarde];
    LookupPageID=Page11117030;
    DrillDownPageID=Page11117030;
  }
  FIELDS
  {
    { 1   ;   ;Entry No.           ;Integer       ;AutoIncrement=Yes;
                                                   CaptionML=[ENU=Entry No.;
                                                              NLD=Volgnummer] }
    { 2   ;   ;Relation Entry No.  ;Integer       ;CaptionML=[ENU=Relation Entry No.;
                                                              NLD=Relatievolgnr.] }
    { 3   ;   ;Field No.           ;Integer       ;CaptionML=[ENU=Field;
                                                              NLD=Veld] }
    { 4   ;   ;Type                ;Option        ;CaptionML=[ENU=Type;
                                                              NLD=Soort];
                                                   OptionCaptionML=[ENU=Const,Filter;
                                                                    NLD=Const,Filter];
                                                   OptionString=Const,Filter }
    { 5   ;   ;Value               ;Text250       ;CaptionML=[ENU=Value;
                                                              NLD=Waarde] }
  }
  KEYS
  {
    {    ;Entry No.                               ;Clustered=Yes }
    {    ;Relation Entry No.                       }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Mgt@1000000000 : Codeunit 11148589;

    PROCEDURE FieldNoText@1000000001() Result : Text[1024];
    VAR
      Relation@1000000000 : Record 11148625;
    BEGIN
      IF Relation.GET("Relation Entry No.") THEN
        Mgt.FormatFieldNo(Result, Relation."Table No.", "Field No.");
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148627 IN - Relation Filter
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Relation Filter;
               NLD=Relatiefilter];
    LookupPageID=Page11117031;
    DrillDownPageID=Page11117031;
  }
  FIELDS
  {
    { 1   ;   ;Entry No.           ;Integer       ;AutoIncrement=Yes;
                                                   CaptionML=[ENU=Entry No.;
                                                              NLD=Volgnummer] }
    { 2   ;   ;Relation Entry No.  ;Integer       ;CaptionML=[ENU=Relation Entry No.;
                                                              NLD=Relatievolgnr.] }
    { 3   ;   ;Field No.           ;Integer       ;CaptionML=[ENU=Field;
                                                              NLD=Veld] }
    { 4   ;   ;Type                ;Option        ;CaptionML=[ENU=Type;
                                                              NLD=Soort];
                                                   OptionCaptionML=[ENU=Const,Filter,Field;
                                                                    NLD=Const,Filter,Field];
                                                   OptionString=Const,Filter,Field }
    { 5   ;   ;Value               ;Text250       ;CaptionML=[ENU=Value;
                                                              NLD=Waarde] }
  }
  KEYS
  {
    {    ;Entry No.                               ;Clustered=Yes }
    {    ;Relation Entry No.                       }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Mgt@1000000000 : Codeunit 11148589;

    PROCEDURE FieldNoText@1000000001() Result : Text[1024];
    VAR
      Relation@1000000000 : Record 11148625;
    BEGIN
      IF Relation.GET("Relation Entry No.") THEN
        Mgt.FormatFieldNo(Result, Relation."Table No.", "Field No.");
    END;

    PROCEDURE ValueText@1000000000() Result : Text[1024];
    VAR
      Relation@1000000001 : Record 11148625;
      FieldNo@1000000000 : Integer;
    BEGIN
      IF Type = Type::Field THEN
        IF Relation.GET("Relation Entry No.") THEN
          IF EVALUATE(FieldNo, Value) THEN
            Mgt.FormatFieldNo(Result, Relation."Table No.", FieldNo);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148628 IN - Trace Rule
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    OnInsert=VAR
               Mgt@1100531000 : Codeunit 11148589;
             BEGIN
               TESTFIELD(Code);

               EVALUATE("Table Filter", Mgt.EmptyTableFilter(DATABASE::"IN - Trace Entry"));
             END;

    CaptionML=[ENU=Trace Rule;
               NLD=Traceerreger];
    LookupPageID=Page11117017;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code10        ;CaptionML=[ENU=Code;
                                                              NLD=Code];
                                                   NotBlank=Yes }
    { 2   ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              NLD=Omschrijving] }
    { 4   ;   ;Rule Type           ;Option        ;OnValidate=BEGIN
                                                                IF "Rule Type" = "Rule Type"::"Missing Trace" THEN BEGIN
                                                                  "Apply Method" := "Apply Method"::"By Task Handler";
                                                                  "Send E-Mail Method" := "Send E-Mail Method"::"By Task Handler";
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Rule Type;
                                                              NLD=Regeltype];
                                                   OptionCaptionML=[ENU=Existing Trace,Missing Trace;
                                                                    NLD=Bestaande post,Ontbrekende post];
                                                   OptionString=Existing Trace,Missing Trace }
    { 5   ;   ;Measure Period (minutes);Decimal   ;CaptionML=[ENU=Measure Period (minutes);
                                                              NLD=Meetperiode (minuten)];
                                                   DecimalPlaces=0:5 }
    { 6   ;   ;Message Interval (minutes);Decimal ;CaptionML=[ENU=Message Interval (minutes);
                                                              NLD=Berichtinterval (minuten)];
                                                   DecimalPlaces=0:5;
                                                   BlankZero=Yes }
    { 7   ;   ;Table Filter        ;TableFilter   ;CaptionML=[ENU=Filter;
                                                              NLD=Filter] }
    { 10  ;   ;Apply Method        ;Option        ;OnValidate=BEGIN
                                                                IF "Apply Method" = "Apply Method"::"In proces" THEN
                                                                  TESTFIELD("Rule Type", "Rule Type"::"Existing Trace");
                                                              END;

                                                   CaptionML=[ENU=Apply Method;
                                                              NLD=Verwerkingsmethode];
                                                   OptionCaptionML=[ENU=In proces,By Task Handler;
                                                                    NLD=In proces,Door taakverwerker];
                                                   OptionString=In proces,By Task Handler }
    { 11  ;   ;Send E-Mail         ;Boolean       ;CaptionML=[ENU=Send E-Mail;
                                                              NLD=E-mail verzenden] }
    { 12  ;   ;Send E-Mail Method  ;Option        ;OnValidate=BEGIN
                                                                IF "Send E-Mail Method" = "Send E-Mail Method"::"In proces" THEN
                                                                  TESTFIELD("Rule Type", "Rule Type"::"Existing Trace");
                                                              END;

                                                   CaptionML=[ENU=Send E-Mail Method;
                                                              NLD=E-mailverzendmethode];
                                                   OptionCaptionML=[ENU=In proces,By Task Handler;
                                                                    NLD=In proces,Door taakverwerker];
                                                   OptionString=In proces,By Task Handler }
    { 24  ;   ;E-Mail Address      ;Text80        ;CaptionML=[ENU=E-Mail Address;
                                                              NLD=E-mailadres] }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
    {    ;Apply Method                             }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE ApplyRules@1100531000();
    VAR
      TraceMgt@1100531000 : Codeunit 11148642;
    BEGIN
      TraceMgt.ApplyTaskHandlerRule(Rec);
    END;

    PROCEDURE SendEmails@1100531001();
    VAR
      TraceMgt@1100531000 : Codeunit 11148642;
    BEGIN
      TraceMgt.SendMails(Rec);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148629 IN - Trace Message
{
  OBJECT-PROPERTIES
  {
    Date=05-11-13;
    Time=13:00:00;
    Version List=IDYN-CE5.50.8;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Trace Message;
               NLD=Traceermelding];
    LookupPageID=Page11117048;
    DrillDownPageID=Page11117048;
  }
  FIELDS
  {
    { 1   ;   ;Entry No.           ;Integer       ;AutoIncrement=Yes;
                                                   CaptionML=[ENU=Entry No.;
                                                              NLD=Volgnummer] }
    { 2   ;   ;Trace Rule          ;Code20        ;TableRelation="IN - Trace Rule";
                                                   CaptionML=[ENU=Trace Rule;
                                                              NLD=Traceerregel] }
    { 3   ;   ;Date                ;Date          ;CaptionML=[ENU=Date;
                                                              NLD=Datum] }
    { 4   ;   ;Time                ;Time          ;CaptionML=[ENU=Time;
                                                              NLD=Tijd] }
    { 5   ;   ;User Id             ;Code50        ;CaptionML=[ENU=User Id;
                                                              NLD=Gebruikers Id];
                                                   Description=CI-129: was: Code[20] }
    { 6   ;   ;Trace Entry No.     ;Integer       ;TableRelation="IN - Trace Entry";
                                                   CaptionML=[ENU=Trace Entry No.;
                                                              NLD=Traceerpostvolgnr.];
                                                   BlankZero=Yes }
    { 7   ;   ;E-Mail Status       ;Option        ;CaptionML=[ENU=E-Mail Status;
                                                              NLD=E-mailstatus];
                                                   OptionCaptionML=[ENU=" ,Pending,Send";
                                                                    NLD=" ,Afwachten,Verzonden"];
                                                   OptionString=[ ,Pending,Send] }
    { 8   ;   ;DateTime            ;DateTime      ;CaptionML=[ENU=DateTime;
                                                              NLD=Datumtijd] }
    { 9   ;   ;Type                ;Option        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("IN - Trace Entry".Type WHERE (Entry No.=FIELD(Entry No.)));
                                                   CaptionML=[ENU=Type;
                                                              NLD=Soort];
                                                   OptionCaptionML=[ENU=" ,Export Definition,Import Definition,Task,Transport,Connector";
                                                                    NLD=" ,Exportdefinitie,Importdefinitie,Task,Transport,Connecter"];
                                                   OptionString=[ ,Export Definition,Import Definition,Task,Transport,Connector];
                                                   Editable=No }
    { 10  ;   ;Code                ;Code20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("IN - Trace Entry".Code WHERE (Entry No.=FIELD(Entry No.)));
                                                   TableRelation=IF (Type=CONST(Export Definition)) "IN - Export Definition"
                                                                 ELSE IF (Type=CONST(Import Definition)) "IN - Import Definition"
                                                                 ELSE IF (Type=CONST(Task)) "IN - Task"
                                                                 ELSE IF (Type=CONST(Transport)) "IN - Transport";
                                                   CaptionML=[ENU=Code;
                                                              NLD=Code];
                                                   Editable=No }
    { 11  ;   ;Error               ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("IN - Trace Entry".Error WHERE (Entry No.=FIELD(Entry No.)));
                                                   CaptionML=[ENU=Error;
                                                              NLD=Fout];
                                                   Editable=No }
    { 12  ;   ;Error Message       ;Text250       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("IN - Trace Entry"."Error Message" WHERE (Entry No.=FIELD(Entry No.)));
                                                   CaptionML=[ENU=Error Message;
                                                              NLD=Foutmelding];
                                                   Editable=No }
    { 13  ;   ;No. of Records Processed;Integer   ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("IN - Trace Entry"."No. of Records Processed" WHERE (Entry No.=FIELD(Entry No.)));
                                                   CaptionML=[ENU=No. of Records Processed;
                                                              NLD=Aantal records verwerkt];
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Entry No.                               ;Clustered=Yes }
    {    ;Trace Rule,DateTime                      }
    {    ;Trace Rule,E-Mail Status                 }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148630 IN - Trace Entry
{
  OBJECT-PROPERTIES
  {
    Date=05-11-13;
    Time=13:00:00;
    Version List=IDYN-CE5.50.8;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Trace Entry;
               NLD=Traceerpost];
    LookupPageID=Page11117020;
    DrillDownPageID=Page11117020;
  }
  FIELDS
  {
    { 1   ;   ;Entry No.           ;Integer       ;AutoIncrement=Yes;
                                                   CaptionML=[ENU=Entry No.;
                                                              NLD=Volgnummer] }
    { 2   ;   ;Date                ;Date          ;CaptionML=[ENU=Date;
                                                              NLD=Datum] }
    { 3   ;   ;Time                ;Time          ;CaptionML=[ENU=Time;
                                                              NLD=Tijd] }
    { 4   ;   ;DateTime            ;DateTime      ;CaptionML=[ENU=DateTime;
                                                              NLD=Datumtijd] }
    { 5   ;   ;User Id             ;Code50        ;CaptionML=[ENU=User Id;
                                                              NLD=Gebruikers Id];
                                                   Description=CI-129: was: Code[20] }
    { 6   ;   ;Type                ;Option        ;CaptionML=[ENU=Type;
                                                              NLD=Soort];
                                                   OptionCaptionML=[ENU=" ,Export Definition,Import Definition,Task,Transport,Connector";
                                                                    NLD=" ,Exportdefinitie,Importdefinitie,Task,Transport,Connecter"];
                                                   OptionString=[ ,Export Definition,Import Definition,Task,Transport,Connector] }
    { 7   ;   ;Code                ;Code20        ;TableRelation=IF (Type=CONST(Export Definition)) "IN - Export Definition"
                                                                 ELSE IF (Type=CONST(Import Definition)) "IN - Import Definition"
                                                                 ELSE IF (Type=CONST(Task)) "IN - Task"
                                                                 ELSE IF (Type=CONST(Transport)) "IN - Transport";
                                                   CaptionML=[ENU=Code;
                                                              NLD=Code] }
    { 8   ;   ;Error               ;Boolean       ;CaptionML=[ENU=Error;
                                                              NLD=Fout] }
    { 9   ;   ;Error Message       ;Text250       ;CaptionML=[ENU=Error Message;
                                                              NLD=Foutmelding] }
    { 10  ;   ;No. of Records Processed;Integer   ;CaptionML=[ENU=No. of Records Processed;
                                                              NLD=Aantal records verwerkt] }
    { 11  ;   ;Status              ;Option        ;CaptionML=[ENU=Status;
                                                              NLD=Status];
                                                   OptionCaptionML=[ENU=" ,Rules Applied";
                                                                    NLD=" ,Regels toegepast"];
                                                   OptionString=[ ,Rules Applied] }
    { 12  ;   ;No. of Message      ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("IN - Trace Message" WHERE (Trace Entry No.=FIELD(Entry No.)));
                                                   CaptionML=[ENU=No. of Message;
                                                              NLD=Aantal berichten];
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Entry No.                               ;Clustered=Yes }
    {    ;Status,DateTime,Type,Code                }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE ApplyRules@1100531000();
    VAR
      TraceMgt@1100531000 : Codeunit 11148642;
    BEGIN
      TraceMgt.ApplyRulesToTraceEntry(Rec);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148631 IN - Import Definition Version
{
  OBJECT-PROPERTIES
  {
    Date=05-11-13;
    Time=13:00:00;
    Version List=IDYN-CE5.50.8;
  }
  PROPERTIES
  {
    OnDelete=VAR
               ImportDefVersionLine@1100531001 : Record 11148632;
               ImportDefVersTLink@1100531000 : Record 11148633;
             BEGIN
               ImportDefVersionLine.SETRANGE("Import Definition", Code);
               ImportDefVersionLine.SETRANGE("Version No.", "Version No.");
               ImportDefVersionLine.DELETEALL;

               ImportDefVersTLink.SETRANGE("Import Definition", Code);
               ImportDefVersTLink.SETRANGE("Version No.", "Version No.");
               ImportDefVersTLink.DELETEALL;
             END;

    CaptionML=[ENU=Import Definition Version;
               NLD=Importdefinitieversie];
    LookupPageID=Page11117000;
    DrillDownPageID=Page11117000;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code20        ;CaptionML=[ENU=Code;
                                                              NLD=Code];
                                                   NotBlank=Yes }
    { 2   ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              NLD=Omschrijving] }
    { 3   ;   ;Location            ;Text250       ;CaptionML=[ENU=Location;
                                                              NLD=Locatie] }
    { 4   ;   ;Filename            ;Text30        ;CaptionML=[ENU=Filename;
                                                              NLD=Bestandsnaam] }
    { 5   ;   ;Processed Location  ;Text250       ;CaptionML=[ENU=Processed Location;
                                                              NLD=Verwerkt locatie] }
    { 6   ;   ;Log Location        ;Text250       ;CaptionML=[ENU=Log Location;
                                                              NLD=Log locatie] }
    { 8   ;   ;Run Codeunit No.    ;Integer       ;CaptionML=[ENU=Run Codeunit;
                                                              NLD=Codeunit starten];
                                                   BlankZero=Yes }
    { 9   ;   ;Status              ;Option        ;CaptionML=[ENU=Status;
                                                              NLD=Status];
                                                   OptionCaptionML=[ENU=Edit,Manual,Automated,Blocked;
                                                                    NLD=Bewerken,Handmatig,Geautomatiseerd,Geblokkeerd];
                                                   OptionString=Edit,Manual,Automated,Blocked }
    { 10  ;   ;File Format         ;Option        ;CaptionML=[ENU=File Format;
                                                              NLD=Bestandsformaat];
                                                   OptionCaptionML=[ENU=XML,CSV,Fixed Width,Excel,ADO;
                                                                    NLD=XML,CSV,Fixed Width,Excel,ADO];
                                                   OptionString=XML,CSV,Fixed Width,Excel,ADO }
    { 12  ;   ;Headers             ;Boolean       ;CaptionML=[ENU=Headers;
                                                              NLD=Koppen] }
    { 13  ;   ;Field Delimiter     ;Text1         ;InitValue=";
                                                   CaptionML=[ENU=Field Delimiter;
                                                              NLD=Tekstindicator] }
    { 14  ;   ;Field Separator     ;Text1         ;InitValue=,;
                                                   CaptionML=[ENU=Field Separator;
                                                              NLD=Scheidingsteken] }
    { 15  ;   ;Save to Messages    ;Boolean       ;InitValue=Yes;
                                                   CaptionML=[ENU=Save to Messages;
                                                              NLD=Opslaan in berichten] }
    { 16  ;   ;Main Table No.      ;Integer       ;TableRelation=Object.ID WHERE (Type=CONST(Table),
                                                                                  Company Name=CONST());
                                                   CaptionML=[ENU=Main Table;
                                                              NLD=Hoofdtabel];
                                                   BlankZero=Yes }
    { 19  ;   ;Sub Table No.       ;Integer       ;TableRelation=Object.ID WHERE (Type=CONST(Table),
                                                                                  Company Name=CONST());
                                                   CaptionML=[ENU=Sub Table;
                                                              NLD=Subtabel];
                                                   BlankZero=Yes }
    { 24  ;   ;Error Notific. E-Mail Address;Text80;
                                                   CaptionML=[ENU=Error Notification E-Mail Address;
                                                              NLD=Foutmeldingnotificatie e-mailadres] }
    { 25  ;   ;Main Table Name     ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Object.Name WHERE (Type=CONST(Table),
                                                                                         Company Name=CONST(),
                                                                                         ID=FIELD(Main Table No.)));
                                                   CaptionML=[ENU=Main Table Name;
                                                              NLD=Hoofdtabelnaam];
                                                   Editable=No }
    { 26  ;   ;Main Table No. of Fields;Integer   ;FieldClass=FlowField;
                                                   CalcFormula=Count("IN - Import Definition Line" WHERE (Import Definition=FIELD(Code),
                                                                                                          Table No.=FIELD(Main Table No.),
                                                                                                          Field No.=FILTER(<>0)));
                                                   CaptionML=[ENU=Main Table No. of Fields;
                                                              NLD=Hoofdtabel aantal velden];
                                                   Editable=No }
    { 27  ;   ;Sub Table Name      ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Object.Name WHERE (Type=CONST(Table),
                                                                                         Company Name=CONST(),
                                                                                         ID=FIELD(Sub Table No.)));
                                                   CaptionML=[ENU=Sub Table Name;
                                                              NLD=Subtabelnaam];
                                                   Editable=No }
    { 28  ;   ;Sub Table No. of Fields;Integer    ;FieldClass=FlowField;
                                                   CalcFormula=Count("IN - Import Definition Line" WHERE (Import Definition=FIELD(Code),
                                                                                                          Table No.=FIELD(Sub Table No.),
                                                                                                          Field No.=FILTER(<>0)));
                                                   CaptionML=[ENU=Sub Table No. of Fields;
                                                              NLD=Subtabel aantal velden];
                                                   Editable=No }
    { 30  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("IN - Comment Line" WHERE (Table Name=CONST(Import Definition),
                                                                                                Code=FIELD(Code)));
                                                   CaptionML=[ENU=Comment;
                                                              NLD=Opmerking];
                                                   Editable=No }
    { 31  ;   ;Company Name        ;Text30        ;TableRelation=Company;
                                                   CaptionML=[ENU=Company Name;
                                                              NLD=Bedrijfsnaam] }
    { 32  ;   ;Project Code        ;Code20        ;TableRelation="IN - Project";
                                                   CaptionML=[ENU=Project;
                                                              NLD=Project] }
    { 33  ;   ;Start at Line No.   ;Integer       ;InitValue=1;
                                                   CaptionML=[ENU=Start at Line No.;
                                                              NLD=Starten op regelnr.] }
    { 34  ;   ;Error Location      ;Text250       ;CaptionML=[ENU=Error Location;
                                                              NLD=Foutlocatie] }
    { 35  ;   ;Created On          ;DateTime      ;CaptionML=[ENU=Created On;
                                                              NLD=Gemaakt op];
                                                   Editable=No }
    { 36  ;   ;Created By          ;Code50        ;CaptionML=[ENU=Created By;
                                                              NLD=Gemaakt door];
                                                   Description=CI-129: was: Code[20];
                                                   Editable=No }
    { 37  ;   ;Modified On         ;DateTime      ;CaptionML=[ENU=Modified On;
                                                              NLD=Gewijzigd op];
                                                   Editable=No }
    { 38  ;   ;Modified By         ;Code50        ;CaptionML=[ENU=Modified By;
                                                              NLD=Gewijzigd door];
                                                   Description=CI-129: was: Code[20];
                                                   Editable=No }
    { 39  ;   ;Original Status     ;Option        ;CaptionML=[ENU=Original Status;
                                                              NLD=Originele status];
                                                   OptionCaptionML=[ENU=Edit,Manual,Automated,Blocked;
                                                                    NLD=Bewerken,Handmatig,Geautomatiseerd,Geblokkeerd];
                                                   OptionString=Edit,Manual,Automated,Blocked }
    { 40  ;   ;Archive add YYYYMMDD;Boolean       ;CaptionML=[ENU=Archive add YYYYMMDD;
                                                              NLD=YYYMMDD toevoegen bij archiveren] }
    { 41  ;   ;Connection String   ;Text250       ;CaptionML=[ENU=Connection String;
                                                              NLD=Connectiestring] }
    { 42  ;   ;SQL String          ;Text250       ;CaptionML=[ENU=SQL String;
                                                              NLD=SQL String] }
    { 43  ;   ;Error Notific. Include File;Boolean;CaptionML=[ENU=Error Notific. Include File;
                                                              NLD=Fout. notificatie bestand meesturen] }
    { 44  ;   ;Monitor Modifications;Boolean      ;InitValue=Yes;
                                                   CaptionML=[ENU=Monitor Modifications;
                                                              NLD=Wijzigingen monitoren] }
    { 45  ;   ;Run Task            ;Code20        ;TableRelation="IN - Task";
                                                   CaptionML=[ENU=Run Task;
                                                              NLD=Taak uitvoeren] }
    { 46  ;   ;Version No.         ;Integer       ;CaptionML=[ENU=Version No.;
                                                              NLD=Versienr.] }
    { 47  ;   ;Version Date        ;Date          ;CaptionML=[ENU=Version Date;
                                                              NLD=Versiedatum] }
    { 48  ;   ;Version Time        ;Time          ;CaptionML=[ENU=Version Time;
                                                              NLD=Versietijd] }
  }
  KEYS
  {
    {    ;Code,Version No.                        ;Clustered=Yes }
    {    ;Project Code                             }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148632 IN - Import Def. Version Line
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Import Definition Version Line;
               NLD=Importdefinitieversieregel];
  }
  FIELDS
  {
    { 1   ;   ;Import Definition   ;Code20        ;TableRelation="IN - Import Definition";
                                                   CaptionML=[ENU=Import Definition;
                                                              NLD=Importdefinitie] }
    { 2   ;   ;Entry No.           ;Integer       ;CaptionML=[ENU=Entry No.;
                                                              NLD=Volgnummer] }
    { 3   ;   ;Line No.            ;Integer       ;CaptionML=[ENU=Line No.;
                                                              NLD=Regelnr.] }
    { 4   ;   ;Indent              ;Integer       ;CaptionML=[ENU=Indent;
                                                              NLD=Inspringen] }
    { 5   ;   ;Tag Name            ;Text50        ;CaptionML=[ENU=Tag Name;
                                                              NLD=Tagnaam] }
    { 6   ;   ;Type                ;Option        ;CaptionML=[ENU=Type;
                                                              NLD=Soort];
                                                   OptionCaptionML=[ENU=" ,Tag,Table,Value,Const,Variable";
                                                                    NLD=" ,Tag,Tabel,Waarde,Constante,Variabele"];
                                                   OptionString=[ ,Tag,Table,Value,Const,Variable] }
    { 7   ;   ;Code                ;Text250       ;TableRelation=IF (Type=CONST(Variable)) "IN - Variable";
                                                   CaptionML=[ENU=Code;
                                                              NLD=Code] }
    { 10  ;   ;Table No.           ;Integer       ;TableRelation=Object.ID WHERE (Type=CONST(Table),
                                                                                  Company Name=CONST());
                                                   CaptionML=[ENU=Table;
                                                              NLD=Tabel];
                                                   BlankZero=Yes }
    { 11  ;   ;Field No.           ;Integer       ;TableRelation=Field.No. WHERE (TableNo=FIELD(Table No.),
                                                                                  Type=FILTER(RecordID|Text|Code|GUID|Date|Time|DateFormula|Decimal|Integer|Option|Boolean|BigInteger|Duration|DateTime),
                                                                                  Class=CONST(Normal));
                                                   CaptionML=[ENU=Field;
                                                              NLD=Veld];
                                                   BlankZero=Yes }
    { 12  ;   ;Format              ;Option        ;InitValue=XML;
                                                   CaptionML=[ENU=Format;
                                                              NLD=Formaat];
                                                   OptionCaptionML=[ENU=" ,Navision,XML,YYYYMMDD";
                                                                    NLD=" ,Navision,XML,YYYYMMDD"];
                                                   OptionString=[ ,Navision,XML,YYYYMMDD] }
    { 13  ;   ;Conversion Code     ;Code20        ;TableRelation="IN - Conversion";
                                                   CaptionML=[ENU=Conversion Code;
                                                              NLD=Conversie] }
    { 14  ;   ;Mandatory           ;Boolean       ;CaptionML=[ENU=Mandatory;
                                                              NLD=Verplicht] }
    { 15  ;   ;Error No. Field Mandatory;Integer  ;CaptionML=[ENU=Error No. Field Mandatory;
                                                              NLD=Foutnummer veld verplicht];
                                                   BlankZero=Yes }
    { 16  ;   ;Skip If Empty       ;Boolean       ;CaptionML=[ENU=Skip If Empty;
                                                              NLD=Als leeg overslaan] }
    { 17  ;   ;Validate Field      ;Boolean       ;InitValue=Yes;
                                                   CaptionML=[ENU=Validate;
                                                              NLD=Valideren] }
    { 18  ;   ;Save Record         ;Boolean       ;CaptionML=[ENU=Save Record;
                                                              NLD=Record opslaan] }
    { 19  ;   ;Existing Record     ;Option        ;CaptionML=[ENU=Existing Record;
                                                              NLD=Bestaand record];
                                                   OptionCaptionML=[ENU=Update,Create,Delete,Error;
                                                                    NLD=Wijzigen,Aanmaken,Verwijderen,Foutmelding];
                                                   OptionString=Update,Create,Delete,Error }
    { 20  ;   ;Error No. Existing Record;Integer  ;CaptionML=[ENU=Error No. Existing Record;
                                                              NLD=Foutnummer bestaand record];
                                                   BlankZero=Yes }
    { 21  ;   ;New Record          ;Option        ;CaptionML=[ENU=New Record;
                                                              NLD=Nieuw record];
                                                   OptionCaptionML=[ENU=Create,Skip,Error;
                                                                    NLD=Aanmaken,Overslaan,Foutmelding];
                                                   OptionString=Create,Skip,Error }
    { 22  ;   ;Error No. New Record;Integer       ;CaptionML=[ENU=Error No. New Record;
                                                              NLD=Foutnummer nieuw record];
                                                   BlankZero=Yes }
    { 23  ;   ;Dest. Variable      ;Code20        ;TableRelation="IN - Variable";
                                                   CaptionML=[ENU=Dest. Variable;
                                                              NLD=Doelvariabele] }
    { 24  ;   ;As Attribute        ;Boolean       ;CaptionML=[ENU=As Attribute;
                                                              NLD=Als attribuut] }
    { 25  ;   ;Width               ;Integer       ;CaptionML=[ENU=Width;
                                                              NLD=Breedte];
                                                   BlankZero=Yes }
    { 26  ;   ;Link to Table (Tag Name);Text50    ;CaptionML=[ENU=Link to Table (Tag Name);
                                                              NLD=Linken aan tabel (tagnaam)] }
    { 27  ;   ;Table Name          ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Object.Name WHERE (Type=CONST(Table),
                                                                                         Company Name=CONST(),
                                                                                         ID=FIELD(Table No.)));
                                                   CaptionML=[ENU=Table Name;
                                                              NLD=Tabelnaam];
                                                   Editable=No }
    { 28  ;   ;Field Name          ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Field.FieldName WHERE (TableNo=FIELD(Table No.),
                                                                                             No.=FIELD(Field No.)));
                                                   CaptionML=[ENU=Field Name;
                                                              NLD=Veldnaam];
                                                   Editable=No }
    { 29  ;   ;No. of Restrictions ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("IN - Import Restriction" WHERE (Import Definition=FIELD(Import Definition),
                                                                                                      Import Def. Entry No.=FIELD(Entry No.)));
                                                   CaptionML=[ENU=No. of Restrictions;
                                                              NLD=Aantal restricties];
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 30  ;   ;Increment Method    ;Option        ;CaptionML=[ENU=Increment Method;
                                                              NLD=Ophoogmethode];
                                                   OptionCaptionML=[ENU=" ,1,10000,Max. + 1,Max. + 10000";
                                                                    NLD=" ,1,10000,Max. + 1,Max. + 10000"];
                                                   OptionString=[ ,1,10000,Max. + 1,Max. + 10000] }
    { 31  ;   ;Original Value      ;Boolean       ;CaptionML=[ENU=Original Value;
                                                              NLD=Originele waarde] }
    { 32  ;   ;Clear Every Record  ;Boolean       ;InitValue=Yes;
                                                   CaptionML=[ENU=Clear Every Record;
                                                              NLD=Ieder record schonen] }
    { 33  ;   ;Option Type         ;Option        ;CaptionML=[ENU=Option Type;
                                                              NLD=Optietype];
                                                   OptionCaptionML=[ENU=Value,Name,Caption;
                                                                    NLD=Waarde,Naam,Caption];
                                                   OptionString=Value,Name,Caption }
    { 34  ;   ;Identifier          ;Boolean       ;CaptionML=[ENU=Identifier;
                                                              NLD=Identificatie] }
    { 35  ;   ;Version No.         ;Integer       ;CaptionML=[ENU=Version No.;
                                                              NLD=Versienr.] }
  }
  KEYS
  {
    {    ;Import Definition,Version No.,Entry No. ;Clustered=Yes }
    {    ;Import Definition,Line No.               }
    {    ;Import Definition,Tag Name               }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148633 IN - Import Def. Vers. T. Link
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Import Definition Version Table Link;
               NLD=Importdefinitieversie tabellink];
  }
  FIELDS
  {
    { 1   ;   ;Import Definition   ;Code20        ;TableRelation="IN - Import Definition";
                                                   CaptionML=[ENU=Import Definition;
                                                              NLD=Importdefinitie] }
    { 2   ;   ;Import Def. Entry No.;Integer      ;TableRelation="IN - Import Definition Line"."Entry No." WHERE (Import Definition=FIELD(Import Definition));
                                                   CaptionML=[ENU=Import Def. Entry No.;
                                                              NLD=Importdefinitieregelvolgnr.] }
    { 3   ;   ;Main Table No.      ;Integer       ;TableRelation=Object.ID WHERE (Type=CONST(Table),
                                                                                  Company Name=CONST());
                                                   CaptionML=[ENU=Main Table;
                                                              NLD=Hoofdtabel] }
    { 4   ;   ;Main Field No.      ;Integer       ;TableRelation=Field.No. WHERE (TableNo=FIELD(Main Table No.),
                                                                                  Type=FILTER(RecordID|Text|Code|GUID|Date|Time|DateFormula|Decimal|Integer|Option|Boolean|BigInteger|Duration|DateTime),
                                                                                  Class=CONST(Normal));
                                                   CaptionML=[ENU=Main Field;
                                                              NLD=Hoofdveld];
                                                   BlankZero=Yes }
    { 5   ;   ;Sub Table No.       ;Integer       ;TableRelation=Object.ID WHERE (Type=CONST(Table),
                                                                                  Company Name=CONST());
                                                   CaptionML=[ENU=Sub Table;
                                                              NLD=Subtabel] }
    { 6   ;   ;Sub Field No.       ;Integer       ;TableRelation=Field.No. WHERE (TableNo=FIELD(Sub Table No.),
                                                                                  Type=FILTER(RecordID|Text|Code|GUID|Date|Time|DateFormula|Decimal|Integer|Option|Boolean|BigInteger|Duration|DateTime),
                                                                                  Class=CONST(Normal));
                                                   CaptionML=[ENU=Sub Field;
                                                              NLD=Subveld];
                                                   BlankZero=Yes }
    { 7   ;   ;Main Field Name     ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Field.FieldName WHERE (TableNo=FIELD(Main Table No.),
                                                                                             No.=FIELD(Main Field No.)));
                                                   CaptionML=[ENU=Main Field Name;
                                                              NLD=Hoofdveldnaam];
                                                   Editable=No }
    { 8   ;   ;Sub Field Name      ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Field.FieldName WHERE (TableNo=FIELD(Sub Table No.),
                                                                                             No.=FIELD(Sub Field No.)));
                                                   CaptionML=[ENU=Sub Field Name;
                                                              NLD=Subveldnaam];
                                                   Editable=No }
    { 9   ;   ;Version No.         ;Integer       ;CaptionML=[ENU=Version No.;
                                                              NLD=Versienr.] }
  }
  KEYS
  {
    {    ;Import Definition,Version No.,Import Def. Entry No.,Main Field No.;
                                                   Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148634 IN - Export Definition Version
{
  OBJECT-PROPERTIES
  {
    Date=05-11-13;
    Time=13:00:00;
    Version List=IDYN-CE5.50.8;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Export Definition Version;
               NLD=Exportdefinitieversie];
    LookupPageID=Page11117013;
    DrillDownPageID=Page11117013;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code20        ;CaptionML=[ENU=Code;
                                                              NLD=Code];
                                                   NotBlank=Yes }
    { 2   ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              NLD=Omschrijving] }
    { 3   ;   ;Location            ;Text250       ;CaptionML=[ENU=Location;
                                                              NLD=Locatie] }
    { 4   ;   ;Filename            ;Text250       ;CaptionML=[ENU=Filename;
                                                              NLD=Bestandsnaam] }
    { 5   ;   ;Run Codeunit No.    ;Integer       ;CaptionML=[ENU=Run Codeunit;
                                                              NLD=Codeunit starten];
                                                   BlankZero=Yes }
    { 6   ;   ;XML Declaration     ;Text250       ;CaptionML=[ENU=XML Declaration;
                                                              NLD=XML Declaratie] }
    { 7   ;   ;Status              ;Option        ;CaptionML=[ENU=Status;
                                                              NLD=Status];
                                                   OptionCaptionML=[ENU=Edit,Manual,Automated,Blocked;
                                                                    NLD=Bewerken,Handmatig,Geautomatiseerd,Geblokkeerd];
                                                   OptionString=Edit,Manual,Automated,Blocked }
    { 8   ;   ;File Format         ;Option        ;CaptionML=[ENU=File Format;
                                                              NLD=Bestandsformaat];
                                                   OptionCaptionML=[ENU=XML,CSV,Fixed Width,Excel,ADO;
                                                                    NLD=XML,CSV,Fixed Width,Excel,ADO];
                                                   OptionString=XML,CSV,Fixed Width,Excel,ADO }
    { 10  ;   ;Headers             ;Boolean       ;CaptionML=[ENU=Headers;
                                                              NLD=Koppen] }
    { 11  ;   ;One File per Record ;Boolean       ;CaptionML=[ENU=One File per Record;
                                                              NLD=En bestand per record] }
    { 12  ;   ;Field Delimiter     ;Text1         ;InitValue=";
                                                   CaptionML=[ENU=Field Delimiter;
                                                              NLD=Tekstindicator] }
    { 13  ;   ;Field Separator     ;Text1         ;InitValue=,;
                                                   CaptionML=[ENU=Field Separator;
                                                              NLD=Scheidingsteken] }
    { 14  ;   ;Save to Messages    ;Boolean       ;InitValue=Yes;
                                                   CaptionML=[ENU=Save to Messages;
                                                              NLD=Opslaan in berichten] }
    { 15  ;   ;Main Table No.      ;Integer       ;TableRelation=Object.ID WHERE (Type=CONST(Table),
                                                                                  Company Name=CONST());
                                                   CaptionML=[ENU=Main Table;
                                                              NLD=Hoofdtabel];
                                                   BlankZero=Yes }
    { 16  ;   ;Main Table Filter   ;TableFilter   ;CaptionML=[ENU=Main Table Filter;
                                                              NLD=Hoofdtabelfilter] }
    { 19  ;   ;Sub Table No.       ;Integer       ;TableRelation=Object.ID WHERE (Type=CONST(Table),
                                                                                  Company Name=CONST());
                                                   CaptionML=[ENU=Sub Table;
                                                              NLD=Subtabel];
                                                   BlankZero=Yes }
    { 20  ;   ;Sub Table Filter    ;TableFilter   ;CaptionML=[ENU=Sub Table Filter;
                                                              NLD=Subtabelfilter] }
    { 24  ;   ;Main Table No. of Fields;Integer   ;FieldClass=FlowField;
                                                   CalcFormula=Count("IN - Export Definition Line" WHERE (Export Definition=FIELD(Code),
                                                                                                          Table No.=FIELD(Main Table No.),
                                                                                                          Field No.=FILTER(<>0)));
                                                   CaptionML=[ENU=Main Table No. of Fields;
                                                              NLD=Hoofdtabel aantal velden];
                                                   Editable=No }
    { 26  ;   ;Sub Table No. of Fields;Integer    ;FieldClass=FlowField;
                                                   CalcFormula=Count("IN - Export Definition Line" WHERE (Export Definition=FIELD(Code),
                                                                                                          Table No.=FIELD(Sub Table No.),
                                                                                                          Field No.=FILTER(<>0)));
                                                   CaptionML=[ENU=Sub Table No. of Fields;
                                                              NLD=Subtabel aantal velden];
                                                   Editable=No }
    { 27  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("IN - Comment Line" WHERE (Table Name=CONST(Export Definition),
                                                                                                Code=FIELD(Code)));
                                                   CaptionML=[ENU=Comment;
                                                              NLD=Opmerking];
                                                   Editable=No }
    { 28  ;   ;Run Task            ;Code20        ;TableRelation="IN - Task";
                                                   CaptionML=[ENU=Run Task;
                                                              NLD=Taak uitvoeren] }
    { 29  ;   ;Synchronize         ;Boolean       ;CaptionML=[ENU=Synchronize;
                                                              NLD=Synchroniseren] }
    { 30  ;   ;Destination Company ;Text30        ;TableRelation=Company;
                                                   CaptionML=[ENU=Destination Company;
                                                              NLD=Doelbedrijf] }
    { 31  ;   ;Import Code         ;Code20        ;CaptionML=[ENU=Import Code;
                                                              NLD=Importdefinitie] }
    { 32  ;   ;Use Inbox           ;Boolean       ;CaptionML=[ENU=Use Inbox;
                                                              NLD=Inbox gebruiken] }
    { 33  ;   ;Export Entry No.    ;Integer       ;CaptionML=[ENU=Export Entry No.;
                                                              NLD=Exportvolgnr.] }
    { 34  ;   ;Filename Type       ;Option        ;CaptionML=[ENU=Filename Type;
                                                              NLD=Bestandsnaammethode];
                                                   OptionCaptionML=[ENU=" ,YYYYMMDDHHMMSS,YYYYMMDD,Dest. Variable,Key,Entry No.,Project Entry No.,Trigger,Companyname,Table No.,Exp. Job Entry. No.";
                                                                    NLD=" ,YYYYMMDDHHMMSS,YYYYMMDD,Doelvariabele,Sleutel,Volgnr.,Projectvolgnr.,Trigger,Bedrijfsnaam,Tabelnr.,Exporteeropdr. volgnr."];
                                                   OptionString=[ ,YYYYMMDDHHMMSS,YYYYMMDD,Dest. Variable,Key,Entry No.,Project Entry No.,Trigger,Companyname,Table No.,Exp. Job Entry. No.] }
    { 35  ;   ;Project Code        ;Code20        ;TableRelation="IN - Project";
                                                   CaptionML=[ENU=Project;
                                                              NLD=Project] }
    { 36  ;   ;Company Name        ;Text30        ;TableRelation=Company;
                                                   CaptionML=[ENU=Company Name;
                                                              NLD=Bedrijfsnaam] }
    { 37  ;   ;No. of Monitoring Lines;Integer    ;FieldClass=FlowField;
                                                   CalcFormula=Count("IN - Monitoring Setup" WHERE (Export Definition=FIELD(Code)));
                                                   CaptionML=[ENU=No. of Monitoring Lines;
                                                              NLD=Aantal monitoringregels];
                                                   Editable=No }
    { 38  ;   ;No. of Export Jobs  ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("IN - Export Job" WHERE (Export Definition=FIELD(Code),
                                                                                              Status=FILTER(<>Exported)));
                                                   CaptionML=[ENU=No. of Export Jobs;
                                                              NLD=Aantal exporteeropdrachten];
                                                   Editable=No }
    { 39  ;   ;Created On          ;DateTime      ;CaptionML=[ENU=Created On;
                                                              NLD=Gemaakt op];
                                                   Editable=No }
    { 40  ;   ;Created By          ;Code50        ;CaptionML=[ENU=Created By;
                                                              NLD=Gemaakt door];
                                                   Description=CI-129: was: Code[20];
                                                   Editable=No }
    { 41  ;   ;Modified On         ;DateTime      ;CaptionML=[ENU=Modified On;
                                                              NLD=Gewijzigd op];
                                                   Editable=No }
    { 42  ;   ;Modified By         ;Code50        ;CaptionML=[ENU=Modified By;
                                                              NLD=Gewijzigd door];
                                                   Description=CI-129: was: Code[20];
                                                   Editable=No }
    { 43  ;   ;Original Status     ;Option        ;CaptionML=[ENU=Original Status;
                                                              NLD=Originele status];
                                                   OptionCaptionML=[ENU=Edit,Manual,Automated,Blocked;
                                                                    NLD=Bewerken,Handmatig,Geautomatiseerd,Geblokkeerd];
                                                   OptionString=Edit,Manual,Automated,Blocked }
    { 44  ;   ;Connection String   ;Text250       ;CaptionML=[ENU=Connection String;
                                                              NLD=Connectiestring] }
    { 45  ;   ;SQL String          ;Text250       ;CaptionML=[ENU=SQL String;
                                                              NLD=SQL String] }
    { 46  ;   ;Execute in ADO Database;Text30     ;CaptionML=[ENU=Execute in ADO Database;
                                                              NLD=Uitvoeren in ADO database] }
    { 47  ;   ;Version No.         ;Integer       ;CaptionML=[ENU=Version No.;
                                                              NLD=Versienr.] }
    { 48  ;   ;Version Date        ;Date          ;CaptionML=[ENU=Version Date;
                                                              NLD=Versiedatum] }
    { 49  ;   ;Version Time        ;Time          ;CaptionML=[ENU=Version Time;
                                                              NLD=Versietijd] }
  }
  KEYS
  {
    {    ;Code,Version No.                        ;Clustered=Yes }
    {    ;Project Code                             }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148635 IN - Export Def. Version Line
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Export Definition Version Line;
               NLD=Exportdefinitieversieregel];
  }
  FIELDS
  {
    { 1   ;   ;Export Definition   ;Code20        ;TableRelation="IN - Export Definition";
                                                   CaptionML=[ENU=Export Definition;
                                                              NLD=Exportdefinitie] }
    { 2   ;   ;Entry No.           ;Integer       ;CaptionML=[ENU=Entry No.;
                                                              NLD=Volgnummer] }
    { 3   ;   ;Line No.            ;Integer       ;CaptionML=[ENU=Line No.;
                                                              NLD=Regelnr.] }
    { 5   ;   ;Indent              ;Integer       ;CaptionML=[ENU=Indent;
                                                              NLD=Inspringen] }
    { 6   ;   ;Tag Name            ;Text50        ;CaptionML=[ENU=Tag Name;
                                                              NLD=Tagnaam] }
    { 7   ;   ;Type                ;Option        ;CaptionML=[ENU=Type;
                                                              NLD=Soort];
                                                   OptionCaptionML=[ENU=" ,Tag,Table,Field,Const,Variable";
                                                                    NLD=" ,Tag,Tabel,Veld,Constante,Variabele"];
                                                   OptionString=[ ,Tag,Table,Field,Const,Variable] }
    { 8   ;   ;Code                ;Text250       ;TableRelation=IF (Type=CONST(Variable)) "IN - Variable";
                                                   CaptionML=[ENU=Code;
                                                              NLD=Code] }
    { 11  ;   ;Table No.           ;Integer       ;TableRelation=Object.ID WHERE (Type=CONST(Table),
                                                                                  Company Name=CONST());
                                                   CaptionML=[ENU=Table;
                                                              NLD=Tabel];
                                                   BlankZero=Yes }
    { 12  ;   ;Field No.           ;Integer       ;TableRelation=Field.No. WHERE (TableNo=FIELD(Table No.),
                                                                                  Type=FILTER(RecordID|Text|Code|GUID|Date|Time|DateFormula|Decimal|Integer|Option|Boolean|BigInteger|Duration|DateTime),
                                                                                  Class=FILTER(Normal|FlowField));
                                                   CaptionML=[ENU=Field;
                                                              NLD=Veld];
                                                   BlankZero=Yes }
    { 13  ;   ;Format              ;Text250       ;CaptionML=[ENU=Format;
                                                              NLD=Formaat] }
    { 15  ;   ;Conversion Code     ;Code20        ;TableRelation="IN - Conversion";
                                                   CaptionML=[ENU=Conversion Code;
                                                              NLD=Conversie] }
    { 16  ;   ;As Attribute        ;Boolean       ;CaptionML=[ENU=As Attribute;
                                                              NLD=Als attribuut] }
    { 17  ;   ;Width               ;Integer       ;CaptionML=[ENU=Width;
                                                              NLD=Breedte];
                                                   BlankZero=Yes }
    { 18  ;   ;Alignment           ;Option        ;CaptionML=[ENU=Alignment;
                                                              NLD=Uitlijning];
                                                   OptionCaptionML=[ENU=Left,Right;
                                                                    NLD=Links,Rechts];
                                                   OptionString=Left,Right }
    { 19  ;   ;Table Filter        ;TableFilter   ;CaptionML=[ENU=Table Filter;
                                                              NLD=Tabelfilter] }
    { 20  ;   ;Link to Table (Tag Name);Text50    ;CaptionML=[ENU=Link to Table (Tag Name);
                                                              NLD=Linken aan tabel (tagnaam)] }
    { 21  ;   ;Table Name          ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Object.Name WHERE (Type=CONST(Table),
                                                                                         Company Name=CONST(),
                                                                                         ID=FIELD(Table No.)));
                                                   CaptionML=[ENU=Table Name;
                                                              NLD=Tabelnaam];
                                                   Editable=No }
    { 22  ;   ;Field Name          ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Field.FieldName WHERE (TableNo=FIELD(Table No.),
                                                                                             No.=FIELD(Field No.)));
                                                   CaptionML=[ENU=Field Name;
                                                              NLD=Veldnaam];
                                                   Editable=No }
    { 23  ;   ;Before Field        ;Text30        ;CaptionML=[ENU=Before Field;
                                                              NLD=Voorloop] }
    { 24  ;   ;After Field         ;Text30        ;CaptionML=[ENU=After Field;
                                                              NLD=Naloop] }
    { 25  ;   ;Dest. Variable      ;Code20        ;TableRelation="IN - Variable";
                                                   CaptionML=[ENU=Dest. Variable;
                                                              NLD=Doelvariabele] }
    { 26  ;   ;Original Value      ;Boolean       ;CaptionML=[ENU=Original Value;
                                                              NLD=Originele waarde] }
    { 27  ;   ;Option Type         ;Option        ;CaptionML=[ENU=Option Type;
                                                              NLD=Optietype];
                                                   OptionCaptionML=[ENU=Value,Name,Caption;
                                                                    NLD=Waarde,Naam,Caption];
                                                   OptionString=Value,Name,Caption }
    { 35  ;   ;Skip If Empty       ;Boolean       ;CaptionML=[ENU=Skip If Empty;
                                                              NLD=Overslaan als leeg] }
    { 36  ;   ;Version No.         ;Integer       ;CaptionML=[ENU=Version No.;
                                                              NLD=Versienr.] }
  }
  KEYS
  {
    {    ;Export Definition,Version No.,Entry No. ;Clustered=Yes }
    {    ;Export Definition,Line No.               }
    {    ;Export Definition,Link to Table (Tag Name) }
    {    ;Export Definition,Tag Name               }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148636 IN - Export Def. Vers. T. Link
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Export Definition Version Table Link;
               NLD=Exportdefinitieversie tabellink];
  }
  FIELDS
  {
    { 1   ;   ;Export Definition   ;Code20        ;TableRelation="IN - Export Definition";
                                                   CaptionML=[ENU=Export Definition;
                                                              NLD=Exportdefinitie] }
    { 2   ;   ;Export Def. Entry No.;Integer      ;TableRelation="IN - Export Definition Line"."Entry No." WHERE (Export Definition=FIELD(Export Definition));
                                                   CaptionML=[ENU=Export Def. Entry No.;
                                                              NLD=Exportdefinitieregelvolgnr.] }
    { 3   ;   ;Main Table No.      ;Integer       ;TableRelation=Object.ID WHERE (Type=CONST(Table),
                                                                                  Company Name=CONST());
                                                   CaptionML=[ENU=Main Table;
                                                              NLD=Hoofdtabel] }
    { 4   ;   ;Main Field No.      ;Integer       ;TableRelation=Field.No. WHERE (TableNo=FIELD(Main Table No.),
                                                                                  Type=FILTER(RecordID|Text|Code|GUID|Date|Time|DateFormula|Decimal|Integer|Option|Boolean|BigInteger|Duration|DateTime),
                                                                                  Class=FILTER(Normal|FlowField));
                                                   CaptionML=[ENU=Main Field;
                                                              NLD=Hoofdveld];
                                                   BlankZero=Yes }
    { 5   ;   ;Sub Table No.       ;Integer       ;TableRelation=Object.ID WHERE (Type=CONST(Table),
                                                                                  Company Name=CONST());
                                                   CaptionML=[ENU=Sub Table;
                                                              NLD=Subtabel] }
    { 6   ;   ;Sub Field No.       ;Integer       ;TableRelation=Field.No. WHERE (TableNo=FIELD(Sub Table No.),
                                                                                  Type=FILTER(RecordID|Text|Code|GUID|Date|Time|DateFormula|Decimal|Integer|Option|Boolean|BigInteger|Duration|DateTime),
                                                                                  Class=FILTER(Normal|FlowField));
                                                   CaptionML=[ENU=Sub Field;
                                                              NLD=Subveld];
                                                   BlankZero=Yes }
    { 7   ;   ;Variable            ;Code20        ;TableRelation="IN - Variable";
                                                   CaptionML=[ENU=Variable;
                                                              NLD=Variabele] }
    { 8   ;   ;Main Field Name     ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Field.FieldName WHERE (TableNo=FIELD(Main Table No.),
                                                                                             No.=FIELD(Main Field No.)));
                                                   CaptionML=[ENU=Main Field Name;
                                                              NLD=Hoofdveldnaam];
                                                   Editable=No }
    { 9   ;   ;Sub Field Name      ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Field.FieldName WHERE (TableNo=FIELD(Sub Table No.),
                                                                                             No.=FIELD(Sub Field No.)));
                                                   CaptionML=[ENU=Sub Field Name;
                                                              NLD=Subveldnaam];
                                                   Editable=No }
    { 10  ;   ;Version No.         ;Integer       ;CaptionML=[ENU=Version No.;
                                                              NLD=Versienr.] }
  }
  KEYS
  {
    {    ;Export Definition,Version No.,Export Def. Entry No.,Main Field No.;
                                                   Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148637 IN - Relation Error Message
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Relation Error Message Log;
               NLD=Relatiefoutenberichtenlogboek];
    LookupPageID=Page11117059;
    DrillDownPageID=Page11117059;
  }
  FIELDS
  {
    { 1   ;   ;Table No.           ;Integer       ;TableRelation=Object.ID WHERE (Type=CONST(Table));
                                                   CaptionML=[ENU=Table No.;
                                                              NLD=Tabelnr.] }
    { 2   ;   ;Table Name          ;Text80        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(AllObjWithCaption."Object Caption" WHERE (Object Type=CONST(Table),
                                                                                                                Object ID=FIELD(Table No.)));
                                                   CaptionML=[ENU=Table Name;
                                                              NLD=Tabelnaam];
                                                   Editable=No }
    { 3   ;   ;Error Message       ;Text250       ;CaptionML=[ENU=Error Message;
                                                              NLD=Foutmelding] }
  }
  KEYS
  {
    {    ;Table No.                               ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE LogError@1000000000(ID@1000000000 : Integer;Message@1000000001 : Text[1024]);
    BEGIN
      "Table No." := ID;
      "Error Message" := COPYSTR(Message, 1, MAXSTRLEN("Error Message"));
      INSERT;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148638 IN - Data Change Setup
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Data Change Setup;
               NLD=Wijzingingsmonitorinst.];
  }
  FIELDS
  {
    { 1   ;   ;Primary Key         ;Code10        ;CaptionML=[ENU=Primary Key;
                                                              NLD=Primaire sleutel] }
    { 2   ;   ;Data Change Activated;Boolean      ;CaptionML=[ENU=Data Change Activated;
                                                              NLD=Wijzigingmonitor geactiv.] }
  }
  KEYS
  {
    {    ;Primary Key                             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148639 IN - Data Change Setup (Table)
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Data Change Setup (Table);
               NLD=Wijz.-monitorinst. (Tabel)];
  }
  FIELDS
  {
    { 1   ;   ;Table No.           ;Integer       ;TableRelation=AllObj."Object ID" WHERE (Object Type=CONST(Table));
                                                   CaptionML=[ENU=Table No.;
                                                              NLD=Tabelnr.] }
    { 2   ;   ;Table Name          ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(AllObjWithCaption."Object Caption" WHERE (Object Type=CONST(Table),
                                                                                                                Object ID=FIELD(Table No.)));
                                                   CaptionML=[ENU=Table Name;
                                                              NLD=Tabelnaam] }
    { 3   ;   ;Log Insertion       ;Option        ;OnValidate=BEGIN
                                                                IF (xRec."Log Insertion" = xRec."Log Insertion"::"Some Fields") AND (xRec."Log Insertion" <> "Log Insertion") THEN
                                                                  IF CONFIRM(STRSUBSTNO(Text001,xRec.FIELDCAPTION("Log Insertion"),xRec."Log Insertion"),FALSE) THEN
                                                                    DelChangeLogFields(0);
                                                              END;

                                                   CaptionML=[ENU=Log Insertion;
                                                              NLD=Gereg. invoeging];
                                                   OptionCaptionML=[ENU=" ,Some Fields,All Fields";
                                                                    NLD=" ,Bepaalde velden,Alle velden"];
                                                   OptionString=[ ,Some Fields,All Fields] }
    { 4   ;   ;Log Modification    ;Option        ;OnValidate=BEGIN
                                                                IF (xRec."Log Modification" = xRec."Log Modification"::"Some Fields") AND (xRec."Log Modification" <> "Log Modification") THEN
                                                                  IF CONFIRM(STRSUBSTNO(Text001,xRec.FIELDCAPTION("Log Modification"),xRec."Log Modification"),FALSE) THEN
                                                                    DelChangeLogFields(1);
                                                              END;

                                                   CaptionML=[ENU=Log Modification;
                                                              NLD=Gereg. wijziging];
                                                   OptionCaptionML=[ENU=" ,Some Fields,All Fields";
                                                                    NLD=" ,Bepaalde velden,Alle velden"];
                                                   OptionString=[ ,Some Fields,All Fields] }
    { 5   ;   ;Log Deletion        ;Option        ;OnValidate=BEGIN
                                                                IF (xRec."Log Deletion" = xRec."Log Deletion"::"Some Fields") AND (xRec."Log Deletion" <> "Log Deletion") THEN
                                                                  IF CONFIRM(STRSUBSTNO(Text001,xRec.FIELDCAPTION("Log Deletion"),xRec."Log Deletion"),FALSE) THEN
                                                                    DelChangeLogFields(2);
                                                              END;

                                                   CaptionML=[ENU=Log Deletion;
                                                              NLD=Gereg. verwijdering];
                                                   OptionCaptionML=[ENU=" ,Some Fields,All Fields";
                                                                    NLD=" ,Bepaalde velden,Alle velden"];
                                                   OptionString=[ ,Some Fields,All Fields] }
  }
  KEYS
  {
    {    ;Table No.                               ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text001@1000 : TextConst 'ENU=You have changed the %1 field to no longer be %2. Do you want to remove the field selections?;NLD=U hebt het veld %1 gewijzigd waardoor de inhoud niet langer %2 is. Wilt u de veldselecties verwijderen?';

    PROCEDURE DelChangeLogFields@1(InsModDel@1000 : Integer);
    VAR
      ChangeLogSetupField@1001 : Record 404;
    BEGIN
      ChangeLogSetupField.SETRANGE("Table No.","Table No.");
      CASE InsModDel OF
        0: ChangeLogSetupField.SETRANGE("Log Insertion",TRUE);
        1: ChangeLogSetupField.SETRANGE("Log Modification",TRUE);
        2: ChangeLogSetupField.SETRANGE("Log Deletion",TRUE);
      END;
      IF ChangeLogSetupField.FIND('-') THEN
        REPEAT
          CASE InsModDel OF
            0: ChangeLogSetupField."Log Insertion" := FALSE;
            1: ChangeLogSetupField."Log Modification" := FALSE;
            2: ChangeLogSetupField."Log Deletion" := FALSE;
          END;
          WITH ChangeLogSetupField DO
            IF "Log Insertion" OR "Log Modification" OR "Log Deletion" THEN
              MODIFY
            ELSE
              DELETE;
        UNTIL ChangeLogSetupField.NEXT = 0;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148640 IN - Data Change Setup (Field)
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Data Change Setup (Field);
               NLD=Wijz.-monitorinst. (Veld)];
  }
  FIELDS
  {
    { 1   ;   ;Table No.           ;Integer       ;TableRelation="IN - Data Change Setup (Table)";
                                                   CaptionML=[ENU=Table No.;
                                                              NLD=Tabelnr.] }
    { 2   ;   ;Field No.           ;Integer       ;TableRelation=Field.No. WHERE (TableNo=FIELD(Table No.));
                                                   CaptionML=[ENU=Field No.;
                                                              NLD=Veldnr.] }
    { 3   ;   ;Field Caption       ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Field."Field Caption" WHERE (TableNo=FIELD(Table No.),
                                                                                                   No.=FIELD(Field No.)));
                                                   CaptionML=[ENU=Field Caption;
                                                              NLD=Veldbijschrift] }
    { 4   ;   ;Log Insertion       ;Boolean       ;CaptionML=[ENU=Log Insertion;
                                                              NLD=Gereg. invoeging] }
    { 5   ;   ;Log Modification    ;Boolean       ;CaptionML=[ENU=Log Modification;
                                                              NLD=Gereg. wijziging] }
    { 6   ;   ;Log Deletion        ;Boolean       ;CaptionML=[ENU=Log Deletion;
                                                              NLD=Gereg. verwijdering] }
  }
  KEYS
  {
    {    ;Table No.,Field No.                     ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148641 IN - RTC Table Filter
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Table Filter;
               NLD=Tabelfilter];
  }
  FIELDS
  {
    { 1   ;   ;Table No.           ;Integer       ;TableRelation=AllObj."Object ID" WHERE (Object Type=CONST(Table));
                                                   CaptionML=[ENU=Table No.;
                                                              NLD=Tabelnr.] }
    { 2   ;   ;Field Caption       ;Text250       ;OnLookup=VAR
                                                              Field@1000000001 : Record 2000000041;
                                                            BEGIN
                                                              Field.SETRANGE(TableNo,"Table No.");

                                                              IF PAGE.RUNMODAL(PAGE::"IN - Fields", Field) = ACTION::LookupOK THEN BEGIN
                                                                "Field No." := Field."No.";
                                                                // CI-122.begin
                                                                // "Field Name" := Field.FieldName;
                                                                "Field Caption" := Field."Field Caption";
                                                                // CI-122.end
                                                                "Field Type" := Field.Type;
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Field;
                                                              NLD=Veld];
                                                   Description=[CI-122: Field Name => Field Caption; Text[30]] => Text[250]]] }
    { 3   ;   ;Field Filter        ;Text250       ;OnValidate=VAR
                                                                RecRef@1000000000 : RecordRef;
                                                                FldRef@1000000001 : FieldRef;
                                                              BEGIN
                                                                RecRef.OPEN("Table No.");
                                                                FldRef := RecRef.FIELD("Field No.");
                                                                FldRef.SETFILTER("Field Filter");

                                                                "Field Filter" := FldRef.GETFILTER;
                                                              END;

                                                   CaptionML=[ENU=Filter;
                                                              NLD=Filter] }
    { 4   ;   ;Field No.           ;Integer       ;CaptionML=[ENU=Field No.;
                                                              NLD=Veldnr.] }
    { 5   ;   ;Field Type          ;Integer       ;CaptionML=[ENU=Field Type;
                                                              NLD=Veldtype] }
  }
  KEYS
  {
    {    ;Table No.,Field No.                     ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      GlobalTableNo@1000000000 : Integer;

    PROCEDURE SetTableByNo@1000000000(_TableNo@1000000000 : Integer) : Integer;
    BEGIN
      GlobalTableNo := _TableNo;
      EXIT(GlobalTableNo);
    END;

    PROCEDURE SetTableByName@1000000001(_TableName@1000000000 : Text[30]) : Integer;
    VAR
      Object@1000000001 : Record 2000000001;
    BEGIN
      Object.SETRANGE(Type,Object.Type::Table);
      Object.SETFILTER(Name, '@' + _TableName);
      IF Object.FINDFIRST THEN
        GlobalTableNo := Object.ID;
      EXIT(GlobalTableNo);
    END;

    PROCEDURE CreateTableFilter@1000000002() : Text[1024];
    VAR
      InMgt@1000000000 : Codeunit 11148589;
      TableFilterTxt@1000000001 : Text[250];
      FieldFilterTxt@1000000002 : Text[1024];
    BEGIN
      RESET;

      IF NOT FINDFIRST THEN
        EXIT
      ELSE
        TableFilterTxt := InMgt.EmptyTableFilter("Table No.") + ' ';

      FINDSET;
      REPEAT
        FieldFilterTxt := FieldFilterTxt + "Field Caption" + '=' + "Field Filter" + ',';
      UNTIL NEXT = 0;
      FieldFilterTxt := COPYSTR(FieldFilterTxt,1,STRLEN(FieldFilterTxt)-1);

      EXIT(TableFilterTxt + FieldFilterTxt);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148642 IN - Task Group
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Task Group;
               NLD=Taakgroep];
    LookupPageID=Page11148612;
    DrillDownPageID=Page11148612;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code10        ;CaptionML=[ENU=Code;
                                                              NLD=Code] }
    { 2   ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              NLD=Omschrijving] }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148643 IN - Definition Copy Rules
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Definition Copy Rules;
               NLD=Definitie kopieerregels];
    LookupPageID=Page11182710;
    DrillDownPageID=Page11182710;
  }
  FIELDS
  {
    { 1   ;   ;Definition Type     ;Option        ;CaptionML=[ENU=Definition Type;
                                                              NLD=Soort definitie];
                                                   OptionCaptionML=[ENU=Import,Export,Task,Project;
                                                                    NLD=Import,Export,Taak,Project];
                                                   OptionString=Import,Export,Task,Project }
    { 2   ;   ;Definition Code     ;Code20        ;TableRelation=IF (Definition Type=CONST(Import)) "IN - Import Definition".Code
                                                                 ELSE IF (Definition Type=CONST(Export)) "IN - Export Definition".Code
                                                                 ELSE IF (Definition Type=CONST(Task)) "IN - Task".Code
                                                                 ELSE IF (Definition Type=CONST(Project)) "IN - Project".Code;
                                                   CaptionML=[ENU=Definition Code;
                                                              NLD=Definitie code] }
    { 3   ;   ;Company Name        ;Text30        ;TableRelation=Company;
                                                   CaptionML=[ENU=Company Name;
                                                              NLD=Bedrijfsnaam] }
    { 4   ;   ;Copy Definition     ;Boolean       ;CaptionML=[ENU=Copy;
                                                              NLD=Kopieren] }
    { 5   ;   ;Overwrite Definition;Boolean       ;CaptionML=[ENU=Overwrite without warning;
                                                              NLD=Overschrijven zonder waarschuwing] }
  }
  KEYS
  {
    {    ;Definition Type,Definition Code,Company Name;
                                                   Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE SetupCopy@1000000000(DefinitionType@1000000000 : 'Import,Export,Task,Project';DefinitionCode@1000000001 : Code[20]);
    VAR
      CopyRules@1000000002 : Record 11148643;
      Company@1000000003 : Record 2000000006;
    BEGIN
      Company.SETFILTER(Name, '<>%1', COMPANYNAME);
      IF Company.FINDSET THEN
        REPEAT
          IF NOT CopyRules.GET(DefinitionType, DefinitionCode, Company.Name) THEN BEGIN
            CopyRules."Definition Type" := DefinitionType;
            CopyRules."Definition Code" := DefinitionCode;
            CopyRules."Company Name" := Company.Name;
            CopyRules."Copy Definition" := TRUE;
            CopyRules."Overwrite Definition" := FALSE;
            CopyRules.INSERT;
          END;
        UNTIL Company.NEXT = 0;
    END;

    PROCEDURE Select@1000000001(Type@1000000000 : 'All,None,Toggle');
    VAR
      CopyRules@1000000001 : Record 11148643;
    BEGIN
      CopyRules.COPY(Rec);
      CASE Type OF
        Type::All : CopyRules.MODIFYALL("Copy Definition", TRUE);
        Type::None : CopyRules.MODIFYALL("Copy Definition", FALSE);
        Type::Toggle :
            BEGIN
              IF CopyRules.FINDSET THEN
                REPEAT
                  CopyRules."Copy Definition" := NOT CopyRules."Copy Definition";
                  CopyRules.MODIFY;
                UNTIL CopyRules.NEXT = 0;
            END;
      END;
    END;

    PROCEDURE Overwrite@1000000002(Type@1000000000 : 'All,None,Toggle');
    VAR
      CopyRules@1000000001 : Record 11148643;
    BEGIN
      CopyRules.COPY(Rec);
      CASE Type OF
        Type::All : CopyRules.MODIFYALL("Overwrite Definition", TRUE);
        Type::None : CopyRules.MODIFYALL("Overwrite Definition", FALSE);
        Type::Toggle :
            BEGIN
              IF CopyRules.FINDSET THEN
                REPEAT
                  CopyRules."Overwrite Definition" := NOT CopyRules."Overwrite Definition";
                  CopyRules.MODIFY;
                UNTIL CopyRules.NEXT = 0;
            END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148644 IN - Data Change Temp
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Data Change Temp;
               NLD=Wijzigingsmonitorbuffer];
  }
  FIELDS
  {
    { 1   ;   ;RecId               ;RecordID      ;CaptionML=[ENU=Record ID;
                                                              NLD=Record-ID] }
  }
  KEYS
  {
    {    ;RecId                                   ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148645 IN - No. Series Store
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=No. Series Store;
               NLD=Nummerreeksbuffer];
  }
  FIELDS
  {
    { 1   ;   ;Key                 ;Text250       ;CaptionML=[ENU=Key;
                                                              NLD=Sleutel] }
    { 2   ;   ;Value               ;Text250       ;CaptionML=[ENU=Value;
                                                              NLD=Waarde] }
  }
  KEYS
  {
    {    ;Key                                     ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Table 11148646 IN - Timer Parameter
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Timer Parameter;
               NLD=Timer-parameter];
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code20        ;CaptionML=[ENU=Code;
                                                              NLD=Code] }
    { 10  ;   ;Type                ;Option        ;CaptionML=[ENU=Type;
                                                              NLD=Soort];
                                                   OptionCaptionML=[ENU=Text,,,,,Integer,,,,,Date;
                                                                    NLD=Tekst,,,,,Getal,,,,,Datum];
                                                   OptionString=Text,,,,,Integer,,,,,Date }
    { 20  ;   ;Text Value          ;Text250       ;CaptionML=[ENU=Text Value;
                                                              NLD=Tekstwaarde] }
    { 30  ;   ;Integer Value       ;Integer       ;CaptionML=[ENU=Integer Value;
                                                              NLD=Getalwaarde] }
    { 40  ;   ;Date Value          ;Date          ;CaptionML=[ENU=Date Value;
                                                              NLD=Datumwaarde] }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE InsertTextParameter@1000000000(Code@1000000000 : Code[10];Value@1000000001 : Text[250]);
    BEGIN
      Rec.Code := Code;
      Rec.Type := Rec.Type::Text;
      Rec."Text Value" := Value;
      Rec.INSERT;
    END;

    PROCEDURE InsertIntegerParameter@1000000002(Code@1000000000 : Code[10];Value@1000000001 : Integer);
    BEGIN
      Rec.Code := Code;
      Rec.Type := Rec.Type::Integer;
      Rec."Integer Value" := Value;
      Rec.INSERT;
    END;

    PROCEDURE InsertDateParameter@1000000003(Code@1000000000 : Code[10];Value@1000000001 : Date);
    BEGIN
      Rec.Code := Code;
      Rec.Type := Rec.Type::Date;
      Rec."Date Value" := Value;
      Rec.INSERT;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Report 11116997 CI - Process Transports
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    CaptionML=ENU=Process Transports;
    ProcessingOnly=Yes;
    OnPostReport=VAR
                   ctNoOfRecordsProcessed@1000000 : TextConst 'ENU=%1 transports processed.';
                 BEGIN
                   IF GUIALLOWED THEN
                     MESSAGE(ctNoOfRecordsProcessed, NoOfRecordsProcessed);
                 END;

  }
  DATASET
  {
    { 2537;    ;DataItem;                    ;
               DataItemTable=Table11148590;
               DataItemTableView=SORTING(Code)
                                 WHERE(Status=CONST(Automated));
               OnAfterGetRecord=BEGIN
                                  Process(FALSE);

                                  NoOfRecordsProcessed += 1;
                                END;

               OnPostDataItem=BEGIN
                                IF NoOfRecordsProcessed = 0 THEN BEGIN
                                  SETRANGE(Status, Status::Automated);
                                  FINDFIRST;
                                END;
                              END;

               ReqFilterFields=Code }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      NoOfRecordsProcessed@1000000 : Integer;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 11116998 CI - Process Import Definition
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    CaptionML=ENU=Process Import Definitions;
    ProcessingOnly=Yes;
    OnPreReport=BEGIN
                  Progressbar.Open(3);
                END;

    OnPostReport=VAR
                   ctNoOfRecordsProcessed@1000001 : TextConst 'ENU=%1 import definitions processed.';
                   ctOutOfProcessed@1000000 : TextConst 'ENU=%1 of %2 import definitions processed.';
                 BEGIN
                   Progressbar.Close;

                   IF GUIALLOWED THEN
                     IF NoOfRecordsFailed = 0 THEN
                       MESSAGE(ctNoOfRecordsProcessed, NoOfRecordsProcessed)
                     ELSE
                       MESSAGE(ctOutOfProcessed, NoOfRecordsProcessed, NoOfRecordsProcessed + NoOfRecordsFailed);
                 END;

  }
  DATASET
  {
    { 8962;    ;DataItem;                    ;
               DataItemTable=Table11148591;
               DataItemTableView=SORTING(Code)
                                 WHERE(Status=CONST(Automated));
               OnPreDataItem=BEGIN
                               NoOfRecords := COUNT;

                               Progressbar.InitializeBar(3, NoOfRecords);
                             END;

               OnAfterGetRecord=VAR
                                  ProcessImportDef@1000000 : Codeunit 11148592;
                                  ErrorMgt@1000003 : Codeunit 11148630;
                                  FileProcessed@1000002 : Boolean;
                                  ctImporting@1000001 : TextConst 'ENU=Importing %1...;NLD=Importeren %1...';
                                BEGIN
                                  ErrorMgt.ClearError;

                                  Progressbar.SetText(3, STRSUBSTNO(ctImporting, Code));
                                  Progressbar.AddRecordCounter(3, 1, '');

                                  ProcessImportDef.SetHideMessage(TRUE);
                                  FileProcessed := ProcessImportDef.RUN("IN - Import Definition");

                                  IF FileProcessed THEN
                                    NoOfRecordsProcessed += 1
                                  ELSE
                                    NoOfRecordsFailed += 1;

                                  IF ErrorMgt.GetError <> '' THEN BEGIN
                                    MESSAGE(ErrorMgt.GetError);
                                    ErrorMgt.ClearError;
                                    CurrReport.BREAK;
                                  END;

                                  IF NOT FileProcessed THEN
                                    CurrReport.BREAK;
                                END;

               OnPostDataItem=BEGIN
                                IF NoOfRecordsProcessed + NoOfRecordsFailed = 0 THEN BEGIN
                                  Progressbar.Close;
                                  SETRANGE(Status, Status::Automated);
                                  FINDFIRST;
                                END;
                              END;

               ReqFilterFields=Code }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      Progressbar@1000000 : Codeunit 11148624;
      NoOfRecords@1000001 : Integer;
      NoOfRecordsFailed@1000003 : Integer;
      NoOfRecordsProcessed@1000002 : Integer;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 11116999 CI - Process Export Definition
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    CaptionML=ENU=Process Export Definition;
    ProcessingOnly=Yes;
    OnPreReport=BEGIN
                  Progressbar.Open(2);
                END;

    OnPostReport=VAR
                   ctNoOfRecordsProcessed@1000001 : TextConst 'ENU=%1 export definitions processed.';
                   ctOutOfProcessed@1000000 : TextConst 'ENU=%1 of %2 export definitions processed.';
                 BEGIN
                   Progressbar.Close;

                   IF GUIALLOWED THEN
                     IF NoOfRecordsFailed = 0 THEN
                       MESSAGE(ctNoOfRecordsProcessed, NoOfRecordsProcessed)
                     ELSE
                       MESSAGE(ctOutOfProcessed, NoOfRecordsProcessed, NoOfRecordsProcessed + NoOfRecordsFailed);
                 END;

  }
  DATASET
  {
    { 5283;    ;DataItem;                    ;
               DataItemTable=Table11148599;
               DataItemTableView=SORTING(Code)
                                 WHERE(Status=CONST(Automated));
               OnPreDataItem=BEGIN
                               Progressbar.InitializeBar(2, COUNT);
                             END;

               OnAfterGetRecord=VAR
                                  ProcessExportDef@1000000 : Codeunit 11148606;
                                  ErrorMgt@1000003 : Codeunit 11148630;
                                  FileProcessed@1000002 : Boolean;
                                  ctExporting@1000001 : TextConst 'ENU=Exporting %1...;NLD=Exporteren %1...';
                                BEGIN
                                  Progressbar.SetText(2, STRSUBSTNO(ctExporting, Code));
                                  Progressbar.AddRecordCounter(2, 1, '');

                                  ErrorMgt.ClearError;

                                  FileProcessed := ProcessExportDef.RUN("IN - Export Definition");
                                  IF FileProcessed THEN
                                    NoOfRecordsProcessed += 1
                                  ELSE
                                    NoOfRecordsFailed += 1;

                                  IF ErrorMgt.GetError <> '' THEN BEGIN
                                    MESSAGE(ErrorMgt.GetError);
                                    ErrorMgt.ClearError;
                                  END;

                                  IF NOT FileProcessed THEN
                                    CurrReport.BREAK;
                                END;

               OnPostDataItem=BEGIN
                                IF NoOfRecordsProcessed + NoOfRecordsFailed = 0 THEN BEGIN
                                  Progressbar.Close;
                                  SETRANGE(Status, Status::Automated);
                                  FINDFIRST;
                                END;
                              END;

               ReqFilterFields=Code }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      Progressbar@1000000 : Codeunit 11148624;
      NoOfRecordsFailed@1000002 : Integer;
      NoOfRecordsProcessed@1000001 : Integer;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 11117000 CI - Process Export Jobs
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    CaptionML=ENU=Process Export Jobs;
    ProcessingOnly=Yes;
    OnPreReport=BEGIN
                  IF CurrReport.USEREQUESTPAGE THEN
                    Window.OPEN('#1##############');
                END;

    OnPostReport=VAR
                   ctNoOfRecordsProcessed@1000001 : TextConst 'ENU=%1 export jobs processed.';
                   ctOutOfProcessed@1000000 : TextConst 'ENU=%1 of %2 export jobs processed.';
                 BEGIN
                   IF GUIALLOWED THEN
                     IF NoOfRecordsFailed = 0 THEN
                       MESSAGE(ctNoOfRecordsProcessed, NoOfRecords)
                     ELSE
                       MESSAGE(ctOutOfProcessed, NoOfRecordsProcessed, NoOfRecords);
                 END;

  }
  DATASET
  {
    { 3997;    ;DataItem;                    ;
               DataItemTable=Table11148608;
               DataItemTableView=SORTING(Status,Export Definition)
                                 WHERE(Status=CONST(New));
               OnPreDataItem=BEGIN
                               NoOfRecords := COUNT;
                             END;

               OnAfterGetRecord=VAR
                                  ExportDefinition@1000004 : Record 11148599;
                                  ExportJob@1000001 : Record 11148608;
                                  ProcessExportJob@1000000 : Codeunit 11148621;
                                  RecordProcessed@1000002 : Boolean;
                                BEGIN
                                  RecordCounter += 1;

                                  IF CurrReport.USEREQUESTPAGE THEN
                                    Window.UPDATE(1, ROUND(RecordCounter / NoOfRecords * 10000, 1));

                                  ExportJob := "IN - Export Job";

                                  ExportJob.FIND('=');
                                  IF ExportJob.Status = ExportJob.Status::New THEN BEGIN
                                    IF ExportDefinition.GET(ExportJob."Export Definition") THEN
                                      IF ExportDefinition.Status = ExportDefinition.Status::Automated THEN
                                        RecordProcessed := ProcessExportJob.RUN(ExportJob);
                                  END ELSE
                                    RecordProcessed := TRUE;

                                  IF RecordProcessed THEN
                                    NoOfRecordsProcessed += 1
                                  ELSE
                                    NoOfRecordsFailed += 1;

                                  IF NOT RecordProcessed THEN
                                    CurrReport.BREAK;
                                END;

               ReqFilterFields=Entry No. }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      Window@1000000 : Dialog;
      NoOfRecords@1000003 : Integer;
      NoOfRecordsFailed@1000001 : Integer;
      NoOfRecordsProcessed@1000002 : Integer;
      RecordCounter@1000004 : Integer;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 11117001 CI - Copy Import Definition
{
  OBJECT-PROPERTIES
  {
    Date=24-05-13;
    Time=13:00:00;
    Version List=IDYN-CI5.50.0;
  }
  PROPERTIES
  {
    CaptionML=ENU=Copy Import Definition;
    ProcessingOnly=Yes;
    OnPreReport=BEGIN
                  CASE FileType OF
                    FileType::"Import Definition" :
                      CopyFromImportDef;

                    FileType::"Export Definition" :
                      CopyFromExportDef;

                  END;
                END;

  }
  DATASET
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      OnOpenPage=BEGIN
                   FromCompanyName := COMPANYNAME;
                 END;

    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=ENU=Options }

      { 1000002;2;Field     ;
                  CaptionML=ENU=File Type;
                  OptionCaptionML=ENU=Import Definition,Export Definition;
                  SourceExpr=FileType;
                  OnValidate=BEGIN
                               FromFileCode := '';
                               ValidateFromFile;
                             END;
                              }

      { 1000000;2;Field     ;
                  CaptionML=ENU=Source Company;
                  SourceExpr=FromCompanyName;
                  TableRelation=Company }

      { 1000000002;2;Field  ;
                  CaptionML=ENU=Source File;
                  SourceExpr=FromFileCode;
                  OnValidate=BEGIN
                               ValidateFromFile;
                             END;

                  OnLookup=VAR
                             ImportDefinition@1000002 : Record 11148591;
                             ExportDefinition@1000003 : Record 11148599;
                           BEGIN
                             CASE FileType OF
                               FileType::"Import Definition" :
                                 BEGIN
                                   IF FromCompanyName <> '' THEN
                                     ImportDefinition.CHANGECOMPANY(FromCompanyName);

                                   IF ImportDefinition.GET(Text) THEN
                                     ;

                                   IF PAGE.RUNMODAL(0, ImportDefinition) = ACTION::LookupOK THEN BEGIN
                                     Text := ImportDefinition.Code;
                                     EXIT(TRUE);
                                   END;
                                 END;

                               FileType::"Export Definition" :
                                 BEGIN
                                   IF FromCompanyName <> '' THEN
                                     ExportDefinition.CHANGECOMPANY(FromCompanyName);

                                   IF ExportDefinition.GET(Text) THEN
                                     ;

                                   IF PAGE.RUNMODAL(0, ExportDefinition) = ACTION::LookupOK THEN BEGIN
                                     Text := ExportDefinition.Code;
                                     EXIT(TRUE);
                                   END;
                                 END;

                             END;
                           END;
                            }

      { 1000000000;2;Field  ;
                  CaptionML=ENU=Description;
                  SourceExpr=CopyFormDescription;
                  Editable=FALSE }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      FromImportDef@1000000002 : Record 11148591;
      ToImportDef@1000000000 : Record 11148591;
      FromExportDef@1000002 : Record 11148599;
      CopyFormDescription@1000003 : Text[1024];
      FromCompanyName@1000001 : Text[30];
      FromFileCode@1000000001 : Code[20];
      FileType@1000000 : 'Import Definition,Export Definition';

    PROCEDURE SetImportDef@1000000000(NewImportDef@1000000000 : Record 11148591);
    VAR
      ImportDefinitionLine@1000000001 : Record 11148592;
      tLinesPresent@1000000002 : TextConst 'ENU="There are already lines present in %1 %2=''%3''."';
    BEGIN
      ToImportDef := NewImportDef;

      ImportDefinitionLine.SETRANGE("Import Definition", NewImportDef.Code);
      IF NOT ImportDefinitionLine.ISEMPTY THEN
        ERROR(tLinesPresent, NewImportDef.TABLECAPTION, NewImportDef.FIELDCAPTION(Code), NewImportDef.Code);
    END;

    LOCAL PROCEDURE ValidateFromFile@1000000001();
    BEGIN
      IF FromFileCode = '' THEN BEGIN
        CLEAR(FromImportDef);
        CLEAR(FromExportDef);
        CopyFormDescription := '';
      END ELSE
        CASE FileType OF
          FileType::"Import Definition" :
            BEGIN
              IF FromCompanyName <> '' THEN
                FromImportDef.CHANGECOMPANY(FromCompanyName);
              FromImportDef.GET(FromFileCode);
              CopyFormDescription := FromImportDef.Description;
            END;

          FileType::"Export Definition" :
            BEGIN
              IF FromCompanyName <> '' THEN
                FromExportDef.CHANGECOMPANY(FromCompanyName);
              FromExportDef.GET(FromFileCode);
              CopyFormDescription := FromExportDef.Description;
            END;

        END;
    END;

    LOCAL PROCEDURE CopyFromImportDef@1000000();
    VAR
      FromImportDefinitionLine@1000005 : Record 11148592;
      ToImportDefinitionLine@1000004 : Record 11148592;
      FromImportDefTableLink@1000003 : Record 11148593;
      ToImportDefTableLink@1000002 : Record 11148593;
      FromImportDefFunction@1100531001 : Record 11148594;
      ToImportDefFunction@1100531000 : Record 11148594;
      CurrentType@1000000000 : Integer;
    BEGIN
      ToImportDefinitionLine.SETRANGE("Import Definition", ToImportDef.Code);
      ToImportDefinitionLine.DELETEALL(TRUE);

      IF FromCompanyName <> '' THEN
        FromImportDefinitionLine.CHANGECOMPANY(FromCompanyName);
      FromImportDefinitionLine.SETRANGE("Import Definition", FromFileCode);
      IF FromImportDefinitionLine.FINDSET THEN
        REPEAT
          ToImportDefinitionLine := FromImportDefinitionLine;
          ToImportDefinitionLine."Import Definition" := ToImportDef.Code;
          ToImportDefinitionLine.INSERT(TRUE);
        UNTIL FromImportDefinitionLine.NEXT = 0;

      ToImportDefTableLink.SETRANGE("Import Definition", ToImportDef.Code);
      ToImportDefTableLink.DELETEALL(TRUE);

      IF FromCompanyName <> '' THEN
        FromImportDefTableLink.CHANGECOMPANY(FromCompanyName);
      FromImportDefTableLink.SETRANGE("Import Definition", FromFileCode);
      IF FromImportDefTableLink.FINDSET THEN
        REPEAT
          ToImportDefTableLink := FromImportDefTableLink;
          ToImportDefTableLink."Import Definition" := ToImportDef.Code;
          ToImportDefTableLink.INSERT(TRUE);
        UNTIL FromImportDefTableLink.NEXT = 0;

      ToImportDefFunction.SETRANGE("Import Definition", ToImportDef.Code);
      ToImportDefFunction.DELETEALL(TRUE);

      IF FromCompanyName <> '' THEN
        FromImportDefFunction.CHANGECOMPANY(FromCompanyName);
      FromImportDefFunction.SETRANGE("Import Definition", FromFileCode);
      IF FromImportDefFunction.FINDSET THEN
        REPEAT
          ToImportDefFunction := FromImportDefFunction;
          ToImportDefFunction."Import Definition" := ToImportDef.Code;
          ToImportDefFunction.INSERT(TRUE);
        UNTIL FromImportDefFunction.NEXT = 0;

      ToImportDef.FIND('=');
      CurrentType := ToImportDef."File Format";
      ToImportDef.TRANSFERFIELDS(FromImportDef, FALSE);
      ToImportDef."File Format" := CurrentType;
      ToImportDef.MODIFY;
    END;

    LOCAL PROCEDURE CopyFromExportDef@1000003();
    VAR
      FromExportDefLine@1000005 : Record 11148600;
      ToImportDefinitionLine@1000004 : Record 11148592;
      FromExportDefTableLink@1000003 : Record 11148601;
      ToImportDefTableLink@1000002 : Record 11148593;
    BEGIN
      ToImportDefinitionLine.SETRANGE("Import Definition", ToImportDef.Code);
      ToImportDefinitionLine.DELETEALL(TRUE);

      IF FromCompanyName <> '' THEN
        FromExportDefLine.CHANGECOMPANY(FromCompanyName);
      FromExportDefLine.SETRANGE("Export Definition", FromFileCode);
      IF FromExportDefLine.FINDSET THEN
        REPEAT

          ToImportDefinitionLine."Import Definition" := ToImportDef.Code;
          ToImportDefinitionLine."Line No." := FromExportDefLine."Line No.";
          ToImportDefinitionLine."Entry No." := FromExportDefLine."Entry No.";
          ToImportDefinitionLine.Indent := FromExportDefLine.Indent;
          ToImportDefinitionLine."Tag Name" := FromExportDefLine."Tag Name";
          CASE FromExportDefLine.Type OF
            FromExportDefLine.Type::" " :
              ToImportDefinitionLine.Type := ToImportDefinitionLine.Type::" ";
            FromExportDefLine.Type::Tag :
              ToImportDefinitionLine.Type := ToImportDefinitionLine.Type::Tag;
            FromExportDefLine.Type::Table :
              ToImportDefinitionLine.Type := ToImportDefinitionLine.Type::Table;
            FromExportDefLine.Type::Field :
              ToImportDefinitionLine.Type := ToImportDefinitionLine.Type::Value;
            FromExportDefLine.Type::Const :
              ToImportDefinitionLine.Type := ToImportDefinitionLine.Type::Const;
            FromExportDefLine.Type::Variable :
              ToImportDefinitionLine.Type := ToImportDefinitionLine.Type::Variable;
          END;

          ToImportDefinitionLine.Code := FromExportDefLine.Code;
          ToImportDefinitionLine."Table No." := FromExportDefLine."Table No.";
          ToImportDefinitionLine."Field No." := FromExportDefLine."Field No.";
          ToImportDefinitionLine."As Attribute" := FromExportDefLine."As Attribute";
          ToImportDefinitionLine.Width := FromExportDefLine.Width;
          ToImportDefinitionLine."Link to Table (Tag Name)" := FromExportDefLine."Link to Table (Tag Name)";
          ToImportDefinitionLine."Option Type" := FromExportDefLine."Option Type";
          ToImportDefinitionLine.INSERT(TRUE);
        UNTIL FromExportDefLine.NEXT = 0;

      ToImportDefTableLink.SETRANGE("Import Definition", ToImportDef.Code);
      ToImportDefTableLink.DELETEALL(TRUE);

      IF FromCompanyName <> '' THEN
        FromExportDefTableLink.CHANGECOMPANY(FromCompanyName);
      FromExportDefTableLink.SETRANGE("Export Definition", FromFileCode);
      IF FromExportDefTableLink.FINDSET THEN
        REPEAT
          ToImportDefTableLink."Import Definition" := ToImportDef.Code;
          ToImportDefTableLink."Import Def. Entry No." := FromExportDefTableLink."Export Def. Entry No.";
          ToImportDefTableLink."Main Field No." := FromExportDefTableLink."Main Field No.";
          ToImportDefTableLink."Main Table No." := FromExportDefTableLink."Main Table No.";
          ToImportDefTableLink."Sub Table No." := FromExportDefTableLink."Sub Table No.";
          ToImportDefTableLink."Sub Field No." := FromExportDefTableLink."Sub Field No.";
          ToImportDefTableLink.INSERT(TRUE);
        UNTIL FromExportDefTableLink.NEXT = 0;

      ToImportDef.Description := FromExportDef.Description;
      ToImportDef.Location := FromExportDef.Location;
      ToImportDef.Filename := FromExportDef.Filename;
      ToImportDef.Status := FromExportDef.Status;
      ToImportDef."File Format" := FromExportDef."File Format";
      ToImportDef.Headers := FromExportDef.Headers;
      ToImportDef."Field Delimiter" := FromExportDef."Field Delimiter";
      ToImportDef."Field Separator" := FromExportDef."Field Separator";
      ToImportDef."Save to Messages" := FromExportDef."Save to Messages";
      ToImportDef."Main Table No." := FromExportDef."Main Table No.";
      ToImportDef."Sub Table No." := FromExportDef."Sub Table No.";
      ToImportDef."Connection String" := FromExportDef."Connection String";
      ToImportDef."SQL String" := FromExportDef."SQL String";
      ToImportDef.MODIFY;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 11117002 CI - Copy Export Definition
{
  OBJECT-PROPERTIES
  {
    Date=24-05-13;
    Time=13:00:00;
    Version List=IDYN-CI5.50.0;
  }
  PROPERTIES
  {
    CaptionML=ENU=Copy Export Definition;
    ProcessingOnly=Yes;
    OnPreReport=BEGIN
                  CASE FileType OF
                    FileType::"Export Definition" :
                      CopyFromExportDef;

                    FileType::"Import Definition" :
                      CopyFromImportDef;

                  END;
                END;

  }
  DATASET
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      OnOpenPage=BEGIN
                   FromCompanyName := COMPANYNAME;
                 END;

    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=ENU=Options }

      { 1000002;2;Field     ;
                  CaptionML=ENU=File Type;
                  OptionCaptionML=ENU=Export Definition,Import Definition;
                  SourceExpr=FileType;
                  OnValidate=BEGIN
                               FromFileCode := '';
                               ValidateFromFile;
                             END;
                              }

      { 1000000;2;Field     ;
                  CaptionML=ENU=Source Company;
                  SourceExpr=FromCompanyName;
                  TableRelation=Company }

      { 1000000002;2;Field  ;
                  CaptionML=ENU=Source File;
                  SourceExpr=FromFileCode;
                  OnValidate=BEGIN
                               ValidateFromFile;
                             END;

                  OnLookup=VAR
                             ImportDefinition@1000003 : Record 11148591;
                             ExportDefinition@1000002 : Record 11148599;
                           BEGIN
                             CASE FileType OF
                               FileType::"Export Definition" :
                                 BEGIN
                                   IF FromCompanyName <> '' THEN
                                     ExportDefinition.CHANGECOMPANY(FromCompanyName);

                                   IF ExportDefinition.GET(Text) THEN
                                     ;

                                   IF PAGE.RUNMODAL(0, ExportDefinition) = ACTION::LookupOK THEN BEGIN
                                     Text := ExportDefinition.Code;
                                     EXIT(TRUE);
                                   END;
                                 END;

                               FileType::"Import Definition" :
                                 BEGIN
                                   IF FromCompanyName <> '' THEN
                                     ImportDefinition.CHANGECOMPANY(FromCompanyName);

                                   IF ImportDefinition.GET(Text) THEN
                                     ;

                                   IF PAGE.RUNMODAL(0, ImportDefinition) = ACTION::LookupOK THEN BEGIN
                                     Text := ImportDefinition.Code;
                                     EXIT(TRUE);
                                   END;
                                 END;

                             END;
                           END;
                            }

      { 1000000000;2;Field  ;
                  CaptionML=ENU=Description;
                  SourceExpr=CopyFormDescription;
                  Editable=FALSE }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      FromImportDef@1000002 : Record 11148591;
      FromExportDef@1000000002 : Record 11148599;
      ToExportDef@1000000000 : Record 11148599;
      CopyFormDescription@1000003 : Text[1024];
      FromCompanyName@1000001 : Text[30];
      FromFileCode@1000000001 : Code[20];
      FileType@1000000 : 'Export Definition,Import Definition';

    PROCEDURE SetExportDef@1000000000(NewExportDef@1000000000 : Record 11148599);
    VAR
      ExportDefLine@1000000001 : Record 11148600;
      tLinesPresent@1000000002 : TextConst 'ENU="There are already lines present in %1 %2=''%3''."';
    BEGIN
      ToExportDef := NewExportDef;

      ExportDefLine.SETRANGE("Export Definition", NewExportDef.Code);
      IF NOT ExportDefLine.ISEMPTY THEN
        ERROR(tLinesPresent, NewExportDef.TABLECAPTION, NewExportDef.FIELDCAPTION(Code), NewExportDef.Code);
    END;

    LOCAL PROCEDURE ValidateFromFile@1000000001();
    BEGIN
      IF FromFileCode = '' THEN BEGIN
        CLEAR(FromExportDef);
        CLEAR(FromImportDef);
        CopyFormDescription := '';
      END ELSE
        CASE FileType OF
          FileType::"Export Definition" :
            BEGIN
              IF FromCompanyName <> '' THEN
                FromExportDef.CHANGECOMPANY(FromCompanyName);
              FromExportDef.GET(FromFileCode);
              CopyFormDescription := FromExportDef.Description;
            END;

          FileType::"Import Definition" :
            BEGIN
              IF FromCompanyName <> '' THEN
                FromImportDef.CHANGECOMPANY(FromCompanyName);
              FromImportDef.GET(FromFileCode);
              CopyFormDescription := FromImportDef.Description;
            END;

        END;
    END;

    LOCAL PROCEDURE CopyFromExportDef@1000000();
    VAR
      FromExportDefLine@1000005 : Record 11148600;
      ToExportDefLine@1000004 : Record 11148600;
      FromExportDefTableLink@1000003 : Record 11148601;
      ToExportDefTableLink@1000002 : Record 11148601;
      FromExportDefFunction@1100531001 : Record 11148602;
      ToExportDefFunction@1100531000 : Record 11148602;
      CurrentType@1000000000 : Integer;
    BEGIN
      ToExportDefLine.SETRANGE("Export Definition", ToExportDef.Code);
      ToExportDefLine.DELETEALL(TRUE);

      IF FromCompanyName <> '' THEN
        FromExportDefLine.CHANGECOMPANY(FromCompanyName);
      FromExportDefLine.SETRANGE("Export Definition", FromFileCode);
      IF FromExportDefLine.FINDSET THEN
        REPEAT
          ToExportDefLine := FromExportDefLine;
          ToExportDefLine."Export Definition" := ToExportDef.Code;
          ToExportDefLine.INSERT(TRUE);
        UNTIL FromExportDefLine.NEXT = 0;

      ToExportDefTableLink.SETRANGE("Export Definition", ToExportDef.Code);
      ToExportDefTableLink.DELETEALL(TRUE);

      IF FromCompanyName <> '' THEN
        FromExportDefTableLink.CHANGECOMPANY(FromCompanyName);
      FromExportDefTableLink.SETRANGE("Export Definition", FromFileCode);
      IF FromExportDefTableLink.FINDSET THEN
        REPEAT
          ToExportDefTableLink := FromExportDefTableLink;
          ToExportDefTableLink."Export Definition" := ToExportDef.Code;
          ToExportDefTableLink.INSERT(TRUE);
        UNTIL FromExportDefTableLink.NEXT = 0;

      ToExportDefFunction.SETRANGE("Export Definition", ToExportDef.Code);
      ToExportDefFunction.DELETEALL(TRUE);

      IF FromCompanyName <> '' THEN
        FromExportDefFunction.CHANGECOMPANY(FromCompanyName);
      FromExportDefFunction.SETRANGE("Export Definition", FromFileCode);
      IF FromExportDefFunction.FINDSET THEN
        REPEAT
          ToExportDefFunction := FromExportDefFunction;
          ToExportDefFunction."Export Definition" := ToExportDef.Code;
          ToExportDefFunction.INSERT(TRUE);
        UNTIL FromExportDefFunction.NEXT = 0;

      ToExportDef.FIND('=');
      CurrentType := ToExportDef."File Format";
      ToExportDef.TRANSFERFIELDS(FromExportDef, FALSE);
      ToExportDef."File Format" := CurrentType;
      ToExportDef.MODIFY;
    END;

    LOCAL PROCEDURE CopyFromImportDef@1000003();
    VAR
      FromImportDefinitionLine@1000005 : Record 11148592;
      ToExportDefLine@1000004 : Record 11148600;
      FromImportDefTableLink@1000003 : Record 11148593;
      ToExportDefTableLink@1000002 : Record 11148601;
    BEGIN
      ToExportDefLine.SETRANGE("Export Definition", ToExportDef.Code);
      ToExportDefLine.DELETEALL(TRUE);

      IF FromCompanyName <> '' THEN
        FromImportDefinitionLine.CHANGECOMPANY(FromCompanyName);
      FromImportDefinitionLine.SETRANGE("Import Definition", FromFileCode);
      IF FromImportDefinitionLine.FINDSET THEN
        REPEAT

          ToExportDefLine."Export Definition" := ToExportDef.Code;
          ToExportDefLine."Line No." := FromImportDefinitionLine."Line No.";
          ToExportDefLine."Entry No." := FromImportDefinitionLine."Entry No.";
          ToExportDefLine.Indent := FromImportDefinitionLine.Indent;
          ToExportDefLine."Tag Name" := FromImportDefinitionLine."Tag Name";

          CASE FromImportDefinitionLine.Type OF
            FromImportDefinitionLine.Type::" " :
              ToExportDefLine.Type := ToExportDefLine.Type::" ";
            FromImportDefinitionLine.Type::Tag :
              ToExportDefLine.Type := ToExportDefLine.Type::Tag;
            FromImportDefinitionLine.Type::Table :
              ToExportDefLine.Type := ToExportDefLine.Type::Table;
            FromImportDefinitionLine.Type::Value :
              ToExportDefLine.Type := ToExportDefLine.Type::Field;
            FromImportDefinitionLine.Type::Const :
              ToExportDefLine.Type := ToExportDefLine.Type::Const;
            FromImportDefinitionLine.Type::Variable :
              ToExportDefLine.Type := ToExportDefLine.Type::Variable;
          END;

          ToExportDefLine.Code := FromImportDefinitionLine.Code;
          ToExportDefLine."Table No." := FromImportDefinitionLine."Table No.";
          ToExportDefLine."Field No." := FromImportDefinitionLine."Field No.";
          ToExportDefLine."As Attribute" := FromImportDefinitionLine."As Attribute";
          ToExportDefLine.Width := FromImportDefinitionLine.Width;
          ToExportDefLine."Link to Table (Tag Name)" := FromImportDefinitionLine."Link to Table (Tag Name)";
          ToExportDefLine."Conversion Code" := FromImportDefinitionLine."Conversion Code";
          ToExportDefLine."Option Type" := FromImportDefinitionLine."Option Type";
          ToExportDefLine.INSERT(TRUE);
        UNTIL FromImportDefinitionLine.NEXT = 0;

      ToExportDefTableLink.SETRANGE("Export Definition", ToExportDef.Code);
      ToExportDefTableLink.DELETEALL(TRUE);

      IF FromCompanyName <> '' THEN
        FromImportDefTableLink.CHANGECOMPANY(FromCompanyName);
      FromImportDefTableLink.SETRANGE("Import Definition", FromFileCode);
      IF FromImportDefTableLink.FINDSET THEN
        REPEAT
          ToExportDefTableLink."Export Definition" := ToExportDef.Code;
          ToExportDefTableLink."Export Def. Entry No." := FromImportDefTableLink."Import Def. Entry No.";
          ToExportDefTableLink."Main Field No." := FromImportDefTableLink."Main Field No.";
          ToExportDefTableLink."Main Table No." := FromImportDefTableLink."Main Table No.";
          ToExportDefTableLink."Sub Table No." := FromImportDefTableLink."Sub Table No.";
          ToExportDefTableLink."Sub Field No." := FromImportDefTableLink."Sub Field No.";
          ToExportDefTableLink.INSERT(TRUE);
        UNTIL FromImportDefTableLink.NEXT = 0;

      ToExportDef.Description := FromImportDef.Description;
      ToExportDef.Location := FromImportDef.Location;
      ToExportDef.Filename := FromImportDef.Filename;
      ToExportDef.Status := FromImportDef.Status;
      ToExportDef."File Format" := FromImportDef."File Format";
      ToExportDef.Headers := FromImportDef.Headers;
      ToExportDef."Field Delimiter" := FromImportDef."Field Delimiter";
      ToExportDef."Field Separator" := FromImportDef."Field Separator";
      ToExportDef."Save to Messages" := FromImportDef."Save to Messages";
      ToExportDef."Main Table No." := FromImportDef."Main Table No.";
      ToExportDef."Sub Table No." := FromImportDef."Sub Table No.";
      ToExportDef."Connection String" := FromImportDef."Connection String";
      ToExportDef."SQL String" := FromImportDef."SQL String";
      ToExportDef.MODIFY;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 11117003 CI - Import Definitions
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    CaptionML=ENU=Import Definitions;
  }
  DATASET
  {
    { 8962;    ;DataItem;                    ;
               DataItemTable=Table11148591;
               DataItemTableView=SORTING(Code);
               ReqFilterFields=Code }

    { 1000000000;1;Column;USERID             ;
               SourceExpr=USERID }

    { 1000000002;1;Column;CurrReport_PAGENO  ;
               SourceExpr=CurrReport.PAGENO }

    { 1000000003;1;Column;FORMAT_TODAY_0_4_  ;
               SourceExpr=FORMAT(TODAY,0,4) }

    { 1000000005;1;Column;COMPANYNAME        ;
               SourceExpr=COMPANYNAME }

    { 1000000036;1;Column;IN___Import_Definition__Run_Codeunit_No__;
               SourceExpr="Run Codeunit No." }

    { 1000000028;1;Column;IN___Import_Definition__Save_to_Messages_;
               SourceExpr="Save to Messages" }

    { 1000000014;1;Column;IN___Import_Definition__Log_Location_;
               SourceExpr="Log Location" }

    { 1000000012;1;Column;IN___Import_Definition__Processed_Location_;
               SourceExpr="Processed Location" }

    { 1000000016;1;Column;IN___Import_Definition_Filename;
               SourceExpr=Filename }

    { 1000000010;1;Column;IN___Import_Definition_Location;
               SourceExpr=Location }

    { 1000000026;1;Column;IN___Import_Definition_Headers;
               SourceExpr=Headers }

    { 1000000008;1;Column;IN___Import_Definition_Description;
               SourceExpr=Description }

    { 1000000024;1;Column;IN___Import_Definition__File_Format_;
               SourceExpr="File Format" }

    { 1000000006;1;Column;IN___Import_Definition_Code;
               SourceExpr=Code }

    { 1000000020;1;Column;IN___Import_Definition_Status;
               SourceExpr=Status }

    { 1000003;1;Column  ;IN___Import_Definition__Error_Notific__E_Mail_Address_;
               SourceExpr="Error Notific. E-Mail Address" }

    { 1000004;1;Column  ;IN___Import_Definition__Field_Separator_;
               SourceExpr="Field Separator" }

    { 1000007;1;Column  ;IN___Import_Definition__Field_Delimiter_;
               SourceExpr="Field Delimiter" }

    { 1000000001;1;Column;CurrReport_PAGENOCaption;
               SourceExpr=CurrReport_PAGENOCaptionLbl }

    { 1000000004;1;Column;ConnectIT_Import_DefinitionsCaption;
               SourceExpr=ConnectIT_Import_DefinitionsCaptionLbl }

    { 1000000037;1;Column;IN___Import_Definition__Run_Codeunit_No__Caption;
               SourceExpr=FIELDCAPTION("Run Codeunit No.") }

    { 1000000029;1;Column;IN___Import_Definition__Save_to_Messages_Caption;
               SourceExpr=FIELDCAPTION("Save to Messages") }

    { 1000000015;1;Column;IN___Import_Definition__Log_Location_Caption;
               SourceExpr=FIELDCAPTION("Log Location") }

    { 1000000013;1;Column;IN___Import_Definition__Processed_Location_Caption;
               SourceExpr=FIELDCAPTION("Processed Location") }

    { 1000000017;1;Column;IN___Import_Definition_FilenameCaption;
               SourceExpr=FIELDCAPTION(Filename) }

    { 1000000011;1;Column;IN___Import_Definition_LocationCaption;
               SourceExpr=FIELDCAPTION(Location) }

    { 1000000027;1;Column;IN___Import_Definition_HeadersCaption;
               SourceExpr=FIELDCAPTION(Headers) }

    { 1000000009;1;Column;IN___Import_Definition_DescriptionCaption;
               SourceExpr=FIELDCAPTION(Description) }

    { 1000000025;1;Column;IN___Import_Definition__File_Format_Caption;
               SourceExpr=FIELDCAPTION("File Format") }

    { 1000000007;1;Column;IN___Import_Definition_CodeCaption;
               SourceExpr=FIELDCAPTION(Code) }

    { 1000000021;1;Column;IN___Import_Definition_StatusCaption;
               SourceExpr=FIELDCAPTION(Status) }

    { 1000002;1;Column  ;IN___Import_Definition__Error_Notific__E_Mail_Address_Caption;
               SourceExpr=FIELDCAPTION("Error Notific. E-Mail Address") }

    { 1000005;1;Column  ;IN___Import_Definition__Field_Separator_Caption;
               SourceExpr=FIELDCAPTION("Field Separator") }

    { 1000006;1;Column  ;IN___Import_Definition__Field_Delimiter_Caption;
               SourceExpr=FIELDCAPTION("Field Delimiter") }

    { 1636;1   ;DataItem;                    ;
               DataItemTable=Table11148592;
               DataItemTableView=SORTING(Import Definition,Line No.);
               CalcFields=Table Name,Field Name;
               DataItemLink=Import Definition=FIELD(Code) }

    { 1000000018;2;Column;IndentText__Tag_Name___Indent_;
               SourceExpr=IndentText("Tag Name", Indent) }

    { 1000000022;2;Column;IN___Import_Definition_Line_Type;
               OptionCaptionML=ENU=" ,Tag,Table,Value,Const,Variable";
               OptionString=[ ,Tag,Table,Value,Const,Variable];
               SourceExpr=Type }

    { 1000000040;2;Column;PrintTable__Table_No_____Table_Name__;
               SourceExpr=PrintTable("Table No.", "Table Name") }

    { 1000000044;2;Column;PrintTable__Field_No_____Field_Name__;
               SourceExpr=PrintTable("Field No.", "Field Name") }

    { 1000000074;2;Column;IN___Import_Definition_Line__Conversion_Code_;
               SourceExpr="Conversion Code" }

    { 1000000098;2;Column;IN___Import_Definition_Line__Dest__Variable_;
               SourceExpr="Dest. Variable" }

    { 1000000080;2;Column;IN___Import_Definition_Line_Code;
               SourceExpr=Code }

    { 1000000090;2;Column;IN___Import_Definition_Line__Skip_If_Empty_;
               SourceExpr="Skip If Empty" }

    { 1000000092;2;Column;IN___Import_Definition_Line__Existing_Record_;
               OptionCaptionML=ENU=Update,Create Record,Error;
               SourceExpr="Existing Record" }

    { 1000000082;2;Column;IN___Import_Definition_Line__Validate_Field_;
               SourceExpr="Validate Field" }

    { 1000000094;2;Column;IN___Import_Definition_Line__New_Record_;
               OptionCaptionML=ENU=Create Record,Error;
               SourceExpr="New Record" }

    { 1000000084;2;Column;IN___Import_Definition_Line_Mandatory;
               SourceExpr=Mandatory }

    { 1000000096;2;Column;IN___Import_Definition_Line__Save_Record_;
               SourceExpr="Save Record" }

    { 1000000072;2;Column;IN___Import_Definition_Line__Data_Format_;
               OptionCaptionML=ENU=" ,Navision,XML";
               SourceExpr="Data Format" }

    { 1000000038;2;Column;IN___Import_Definition_Line__As_Attribute_;
               SourceExpr="As Attribute" }

    { 1000034;2;Column  ;IN___Import_Definition_Line__Error_No__Field_Mandatory_;
               SourceExpr="Error No. Field Mandatory" }

    { 1000038;2;Column  ;IN___Import_Definition_Line__Error_No__Existing_Record_;
               SourceExpr="Error No. Existing Record" }

    { 1000046;2;Column  ;IN___Import_Definition_Line__Error_No__New_Record_;
               SourceExpr="Error No. New Record" }

    { 1000000121;2;Column;IndentText__Tag_Name___Indent__Control1000000121;
               SourceExpr=IndentText("Tag Name", Indent) }

    { 1000000122;2;Column;IN___Import_Definition_Line_Type_Control1000000122;
               OptionCaptionML=ENU=" ,Tag,Table,Value,Const,Variable";
               OptionString=[ ,Tag,Table,Value,Const,Variable];
               SourceExpr=Type }

    { 1000000123;2;Column;PrintTable__Table_No_____Table_Name___Control1000000123;
               SourceExpr=PrintTable("Table No.", "Table Name") }

    { 1000000124;2;Column;PrintTable__Field_No_____Field_Name___Control1000000124;
               SourceExpr=PrintTable("Field No.", "Field Name") }

    { 1000000125;2;Column;IN___Import_Definition_Line__Conversion_Code__Control1000000125;
               SourceExpr="Conversion Code" }

    { 1000000127;2;Column;IN___Import_Definition_Line__Dest__Variable__Control1000000127;
               SourceExpr="Dest. Variable" }

    { 1000000128;2;Column;IN___Import_Definition_Line_Code_Control1000000128;
               SourceExpr=Code }

    { 1000000129;2;Column;IN___Import_Definition_Line__Skip_If_Empty__Control1000000129;
               SourceExpr="Skip If Empty" }

    { 1000000130;2;Column;IN___Import_Definition_Line__Existing_Record__Control1000000130;
               OptionCaptionML=ENU=Update,Create Record,Error;
               SourceExpr="Existing Record" }

    { 1000000131;2;Column;IN___Import_Definition_Line__Validate_Field__Control1000000131;
               SourceExpr="Validate Field" }

    { 1000000132;2;Column;IN___Import_Definition_Line__New_Record__Control1000000132;
               OptionCaptionML=ENU=Create Record,Error;
               SourceExpr="New Record" }

    { 1000000133;2;Column;IN___Import_Definition_Line_Mandatory_Control1000000133;
               SourceExpr=Mandatory }

    { 1000000134;2;Column;IN___Import_Definition_Line__Save_Record__Control1000000134;
               SourceExpr="Save Record" }

    { 1000000135;2;Column;IN___Import_Definition_Line__Data_Format__Control1000000135;
               OptionCaptionML=ENU=" ,Navision,XML";
               SourceExpr="Data Format" }

    { 1000048;2;Column  ;IN___Import_Definition_Line__Error_No__Field_Mandatory__Control1000048;
               SourceExpr="Error No. Field Mandatory" }

    { 1000054;2;Column  ;IN___Import_Definition_Line__Error_No__Existing_Record__Control1000054;
               SourceExpr="Error No. Existing Record" }

    { 1000058;2;Column  ;IN___Import_Definition_Line__Error_No__New_Record__Control1000058;
               SourceExpr="Error No. New Record" }

    { 1000000138;2;Column;IN___Import_Definition_Line_Width;
               SourceExpr=Width }

    { 1000000143;2;Column;IN___Import_Definition_Line__Dest__Variable__Control1000000143;
               SourceExpr="Dest. Variable" }

    { 1000000145;2;Column;IN___Import_Definition_Line__New_Record__Control1000000145;
               OptionCaptionML=ENU=Create Record,Error;
               SourceExpr="New Record" }

    { 1000000147;2;Column;IN___Import_Definition_Line__Existing_Record__Control1000000147;
               OptionCaptionML=ENU=Update,Create Record,Error;
               SourceExpr="Existing Record" }

    { 1000000149;2;Column;IN___Import_Definition_Line__Save_Record__Control1000000149;
               SourceExpr="Save Record" }

    { 1000000151;2;Column;IN___Import_Definition_Line__Validate_Field__Control1000000151;
               SourceExpr="Validate Field" }

    { 1000000153;2;Column;IN___Import_Definition_Line__Skip_If_Empty__Control1000000153;
               SourceExpr="Skip If Empty" }

    { 1000000155;2;Column;IN___Import_Definition_Line_Mandatory_Control1000000155;
               SourceExpr=Mandatory }

    { 1000000157;2;Column;IN___Import_Definition_Line__Conversion_Code__Control1000000157;
               SourceExpr="Conversion Code" }

    { 1000000159;2;Column;IN___Import_Definition_Line_Code_Control1000000159;
               SourceExpr=Code }

    { 1000000163;2;Column;IN___Import_Definition_Line__Data_Format__Control1000000163;
               OptionCaptionML=ENU=" ,Navision,XML";
               SourceExpr="Data Format" }

    { 1000000165;2;Column;PrintTable__Field_No_____Field_Name___Control1000000165;
               SourceExpr=PrintTable("Field No.", "Field Name") }

    { 1000000167;2;Column;PrintTable__Table_No_____Table_Name___Control1000000167;
               SourceExpr=PrintTable("Table No.", "Table Name") }

    { 1000000169;2;Column;IN___Import_Definition_Line_Type_Control1000000169;
               OptionCaptionML=ENU=" ,Tag,Table,Value,Const,Variable";
               OptionString=[ ,Tag,Table,Value,Const,Variable];
               SourceExpr=Type }

    { 1000000171;2;Column;IndentText__Tag_Name___Indent__Control1000000171;
               SourceExpr=IndentText("Tag Name", Indent) }

    { 1000049;2;Column  ;IN___Import_Definition_Line__Error_No__Field_Mandatory__Control1000049;
               SourceExpr="Error No. Field Mandatory" }

    { 1000055;2;Column  ;IN___Import_Definition_Line__Error_No__Existing_Record__Control1000055;
               SourceExpr="Error No. Existing Record" }

    { 1000059;2;Column  ;IN___Import_Definition_Line__Error_No__New_Record__Control1000059;
               SourceExpr="Error No. New Record" }

    { 1000000039;2;Column;IN___Import_Definition_Line__As_Attribute_Caption;
               SourceExpr=IN___Import_Definition_Line__As_Attribute_CaptionLbl }

    { 1000000099;2;Column;IN___Import_Definition_Line__Dest__Variable_Caption;
               SourceExpr=IN___Import_Definition_Line__Dest__Variable_CaptionLbl }

    { 1000000095;2;Column;IN___Import_Definition_Line__New_Record_Caption;
               SourceExpr=IN___Import_Definition_Line__New_Record_CaptionLbl }

    { 1000000093;2;Column;IN___Import_Definition_Line__Existing_Record_Caption;
               SourceExpr=IN___Import_Definition_Line__Existing_Record_CaptionLbl }

    { 1000000097;2;Column;IN___Import_Definition_Line__Save_Record_Caption;
               SourceExpr=IN___Import_Definition_Line__Save_Record_CaptionLbl }

    { 1000000083;2;Column;IN___Import_Definition_Line__Validate_Field_Caption;
               SourceExpr=IN___Import_Definition_Line__Validate_Field_CaptionLbl }

    { 1000000091;2;Column;IN___Import_Definition_Line__Skip_If_Empty_Caption;
               SourceExpr=IN___Import_Definition_Line__Skip_If_Empty_CaptionLbl }

    { 1000000085;2;Column;IN___Import_Definition_Line_MandatoryCaption;
               SourceExpr=IN___Import_Definition_Line_MandatoryCaptionLbl }

    { 1000000075;2;Column;IN___Import_Definition_Line__Conversion_Code_Caption;
               SourceExpr=IN___Import_Definition_Line__Conversion_Code_CaptionLbl }

    { 1000000081;2;Column;IN___Import_Definition_Line_CodeCaption;
               SourceExpr=IN___Import_Definition_Line_CodeCaptionLbl }

    { 1000000073;2;Column;IN___Import_Definition_Line__Data_Format_Caption;
               SourceExpr=IN___Import_Definition_Line__Data_Format_CaptionLbl }

    { 1000000045;2;Column;PrintTable__Field_No_____Field_Name__Caption;
               SourceExpr=PrintTable__Field_No_____Field_Name__CaptionLbl }

    { 1000000041;2;Column;PrintTable__Table_No_____Table_Name__Caption;
               SourceExpr=PrintTable__Table_No_____Table_Name__CaptionLbl }

    { 1000000023;2;Column;IN___Import_Definition_Line_TypeCaption;
               SourceExpr=IN___Import_Definition_Line_TypeCaptionLbl }

    { 1000000019;2;Column;IndentText__Tag_Name___Indent_Caption;
               SourceExpr=IndentText__Tag_Name___Indent_CaptionLbl }

    { 1000000;2;Column  ;IN___Import_Definition_Line__Error_No__Field_Mandatory_Caption;
               SourceExpr=IN___Import_Definition_Line__Error_No__Field_Mandatory_CaptionLbl }

    { 1000001;2;Column  ;IN___Import_Definition_Line__Error_No__New_Record_Caption;
               SourceExpr=IN___Import_Definition_Line__Error_No__New_Record_CaptionLbl }

    { 1000008;2;Column  ;IN___Import_Definition_Line__Error_No__Existing_Record_Caption;
               SourceExpr=IN___Import_Definition_Line__Error_No__Existing_Record_CaptionLbl }

    { 1000000106;2;Column;IN___Import_Definition_Line__Dest__Variable__Control1000000127Caption;
               SourceExpr=IN___Import_Definition_Line__Dest__Variable__Control1000000127CaptionLbl }

    { 1000000107;2;Column;IN___Import_Definition_Line__New_Record__Control1000000132Caption;
               SourceExpr=IN___Import_Definition_Line__New_Record__Control1000000132CaptionLbl }

    { 1000000108;2;Column;IN___Import_Definition_Line__Existing_Record__Control1000000130Caption;
               SourceExpr=IN___Import_Definition_Line__Existing_Record__Control1000000130CaptionLbl }

    { 1000000109;2;Column;IN___Import_Definition_Line__Save_Record__Control1000000134Caption;
               SourceExpr=IN___Import_Definition_Line__Save_Record__Control1000000134CaptionLbl }

    { 1000000110;2;Column;IN___Import_Definition_Line__Validate_Field__Control1000000131Caption;
               SourceExpr=IN___Import_Definition_Line__Validate_Field__Control1000000131CaptionLbl }

    { 1000000111;2;Column;IN___Import_Definition_Line__Skip_If_Empty__Control1000000129Caption;
               SourceExpr=IN___Import_Definition_Line__Skip_If_Empty__Control1000000129CaptionLbl }

    { 1000000112;2;Column;IN___Import_Definition_Line_Mandatory_Control1000000133Caption;
               SourceExpr=IN___Import_Definition_Line_Mandatory_Control1000000133CaptionLbl }

    { 1000000113;2;Column;IN___Import_Definition_Line__Conversion_Code__Control1000000125Caption;
               SourceExpr=IN___Import_Definition_Line__Conversion_Code__Control1000000125CaptionLbl }

    { 1000000114;2;Column;IN___Import_Definition_Line_Code_Control1000000128Caption;
               SourceExpr=IN___Import_Definition_Line_Code_Control1000000128CaptionLbl }

    { 1000000116;2;Column;IN___Import_Definition_Line__Data_Format__Control1000000135Caption;
               SourceExpr=IN___Import_Definition_Line__Data_Format__Control1000000135CaptionLbl }

    { 1000000117;2;Column;PrintTable__Field_No_____Field_Name___Control1000000124Caption;
               SourceExpr=PrintTable__Field_No_____Field_Name___Control1000000124CaptionLbl }

    { 1000000118;2;Column;PrintTable__Table_No_____Table_Name___Control1000000123Caption;
               SourceExpr=PrintTable__Table_No_____Table_Name___Control1000000123CaptionLbl }

    { 1000000119;2;Column;IN___Import_Definition_Line_Type_Control1000000122Caption;
               SourceExpr=IN___Import_Definition_Line_Type_Control1000000122CaptionLbl }

    { 1000000120;2;Column;IndentText__Tag_Name___Indent__Control1000000121Caption;
               SourceExpr=IndentText__Tag_Name___Indent__Control1000000121CaptionLbl }

    { 1000050;2;Column  ;IN___Import_Definition_Line__Error_No__Field_Mandatory__Control1000048Caption;
               SourceExpr=IN___Import_Definition_Line__Error_No__Field_Mandatory__Control1000048CaptionLbl }

    { 1000056;2;Column  ;IN___Import_Definition_Line__Error_No__Existing_Record__Control1000054Caption;
               SourceExpr=IN___Import_Definition_Line__Error_No__Existing_Record__Control1000054CaptionLbl }

    { 1000060;2;Column  ;IN___Import_Definition_Line__Error_No__New_Record__Control1000058Caption;
               SourceExpr=IN___Import_Definition_Line__Error_No__New_Record__Control1000058CaptionLbl }

    { 1000000139;2;Column;IN___Import_Definition_Line_WidthCaption;
               SourceExpr=IN___Import_Definition_Line_WidthCaptionLbl }

    { 1000000142;2;Column;IN___Import_Definition_Line__Dest__Variable__Control1000000143Caption;
               SourceExpr=IN___Import_Definition_Line__Dest__Variable__Control1000000143CaptionLbl }

    { 1000000144;2;Column;IN___Import_Definition_Line__New_Record__Control1000000145Caption;
               SourceExpr=IN___Import_Definition_Line__New_Record__Control1000000145CaptionLbl }

    { 1000000146;2;Column;IN___Import_Definition_Line__Existing_Record__Control1000000147Caption;
               SourceExpr=IN___Import_Definition_Line__Existing_Record__Control1000000147CaptionLbl }

    { 1000000148;2;Column;IN___Import_Definition_Line__Save_Record__Control1000000149Caption;
               SourceExpr=IN___Import_Definition_Line__Save_Record__Control1000000149CaptionLbl }

    { 1000000150;2;Column;IN___Import_Definition_Line__Validate_Field__Control1000000151Caption;
               SourceExpr=IN___Import_Definition_Line__Validate_Field__Control1000000151CaptionLbl }

    { 1000000152;2;Column;IN___Import_Definition_Line__Skip_If_Empty__Control1000000153Caption;
               SourceExpr=IN___Import_Definition_Line__Skip_If_Empty__Control1000000153CaptionLbl }

    { 1000000154;2;Column;IN___Import_Definition_Line_Mandatory_Control1000000155Caption;
               SourceExpr=IN___Import_Definition_Line_Mandatory_Control1000000155CaptionLbl }

    { 1000000156;2;Column;IN___Import_Definition_Line__Conversion_Code__Control1000000157Caption;
               SourceExpr=IN___Import_Definition_Line__Conversion_Code__Control1000000157CaptionLbl }

    { 1000000158;2;Column;IN___Import_Definition_Line_Code_Control1000000159Caption;
               SourceExpr=IN___Import_Definition_Line_Code_Control1000000159CaptionLbl }

    { 1000000162;2;Column;IN___Import_Definition_Line__Data_Format__Control1000000163Caption;
               SourceExpr=IN___Import_Definition_Line__Data_Format__Control1000000163CaptionLbl }

    { 1000000164;2;Column;PrintTable__Field_No_____Field_Name___Control1000000165Caption;
               SourceExpr=PrintTable__Field_No_____Field_Name___Control1000000165CaptionLbl }

    { 1000000166;2;Column;PrintTable__Table_No_____Table_Name___Control1000000167Caption;
               SourceExpr=PrintTable__Table_No_____Table_Name___Control1000000167CaptionLbl }

    { 1000000168;2;Column;IN___Import_Definition_Line_Type_Control1000000169Caption;
               SourceExpr=IN___Import_Definition_Line_Type_Control1000000169CaptionLbl }

    { 1000000170;2;Column;IndentText__Tag_Name___Indent__Control1000000171Caption;
               SourceExpr=IndentText__Tag_Name___Indent__Control1000000171CaptionLbl }

    { 1000051;2;Column  ;IN___Import_Definition_Line__Error_No__Field_Mandatory__Control1000049Caption;
               SourceExpr=IN___Import_Definition_Line__Error_No__Field_Mandatory__Control1000049CaptionLbl }

    { 1000057;2;Column  ;IN___Import_Definition_Line__Error_No__Existing_Record__Control1000055Caption;
               SourceExpr=IN___Import_Definition_Line__Error_No__Existing_Record__Control1000055CaptionLbl }

    { 1000061;2;Column  ;IN___Import_Definition_Line__Error_No__New_Record__Control1000059Caption;
               SourceExpr=IN___Import_Definition_Line__Error_No__New_Record__Control1000059CaptionLbl }

    { 9308;2   ;Column  ;IN___Import_Definition_Line_Import_Definition;
               SourceExpr="Import Definition" }

    { 2015;2   ;Column  ;IN___Import_Definition_Line_Entry_No_;
               SourceExpr="Entry No." }

    { 7651;1   ;DataItem;ImportDefinitionLineTableLink;
               DataItemTable=Table11148592;
               DataItemTableView=SORTING(Import Definition,Line No.);
               PrintOnlyIfDetail=Yes;
               OnAfterGetRecord=BEGIN
                                  LinkCounter := 0;
                                END;

               DataItemLink=Import Definition=FIELD(Code) }

    { 1000016;2;Column  ;Table_LinkCaption   ;
               SourceExpr=Table_LinkCaptionLbl }

    { 1000017;2;Column  ;ImportDefinitionLineTableLink__Link_to_Table__Tag_Name__Caption;
               SourceExpr=ImportDefinitionLineTableLink__Link_to_Table__Tag_Name__CaptionLbl }

    { 1000019;2;Column  ;ImportDefinitionLineTableLink__Tag_Name_Caption;
               SourceExpr=ImportDefinitionLineTableLink__Tag_Name_CaptionLbl }

    { 1000020;2;Column  ;PrintTable__Main_Field_No_____Main_Field_Name__Caption;
               SourceExpr=PrintTable__Main_Field_No_____Main_Field_Name__CaptionLbl }

    { 1000021;2;Column  ;PrintTable__Sub_Field_No_____Sub_Field_Name__Caption;
               SourceExpr=PrintTable__Sub_Field_No_____Sub_Field_Name__CaptionLbl }

    { 9908;2   ;Column  ;ImportDefinitionLineTableLink_Import_Definition;
               SourceExpr="Import Definition" }

    { 4006;2   ;Column  ;ImportDefinitionLineTableLink_Entry_No_;
               SourceExpr="Entry No." }

    { 6174;2   ;DataItem;                    ;
               DataItemTable=Table11148593;
               DataItemTableView=SORTING(Import Definition,Import Def. Entry No.,Main Field No.);
               OnAfterGetRecord=BEGIN
                                  LinkCounter += 1;
                                END;

               CalcFields=Main Field Name,Sub Field Name;
               DataItemLink=Import Definition=FIELD(Import Definition),
                            Import Def. Entry No.=FIELD(Entry No.) }

    { 1000009;3;Column  ;PrintTable__Main_Field_No_____Main_Field_Name__;
               SourceExpr=PrintTable("Main Field No.", "Main Field Name") }

    { 1000015;3;Column  ;PrintTable__Sub_Field_No_____Sub_Field_Name__;
               SourceExpr=PrintTable("Sub Field No.", "Sub Field Name") }

    { 1000014;3;Column  ;ImportDefinitionLineTableLink__Tag_Name_;
               SourceExpr=ImportDefinitionLineTableLink."Tag Name" }

    { 1000010;3;Column  ;ImportDefinitionLineTableLink__Link_to_Table__Tag_Name__;
               SourceExpr=ImportDefinitionLineTableLink."Link to Table (Tag Name)" }

    { 1000012;3;Column  ;PrintTable__Main_Field_No_____Main_Field_Name___Control1000012;
               SourceExpr=PrintTable("Main Field No.", "Main Field Name") }

    { 1000013;3;Column  ;PrintTable__Sub_Field_No_____Sub_Field_Name___Control1000013;
               SourceExpr=PrintTable("Sub Field No.", "Sub Field Name") }

    { 1605;3   ;Column  ;IN___Import_Def__Table_Link_Import_Definition;
               SourceExpr="Import Definition" }

    { 3643;3   ;Column  ;IN___Import_Def__Table_Link_Import_Def__Entry_No_;
               SourceExpr="Import Def. Entry No." }

    { 1760;3   ;Column  ;IN___Import_Def__Table_Link_Main_Field_No_;
               SourceExpr="Main Field No." }

    { 1877;1   ;DataItem;ImportDefLineRestrictions;
               DataItemTable=Table11148592;
               DataItemTableView=SORTING(Import Definition,Line No.);
               PrintOnlyIfDetail=Yes;
               CalcFields=Table Name,Field Name;
               DataItemLink=Import Definition=FIELD(Code) }

    { 1000018;2;Column  ;IN___Import_Restriction_TypeCaption;
               SourceExpr="IN - Import Restriction".FIELDCAPTION(Type) }

    { 1000023;2;Column  ;PrintTable__Table_No_____Table_Name___Control1000022Caption;
               SourceExpr=PrintTable__Table_No_____Table_Name___Control1000022CaptionLbl }

    { 1000025;2;Column  ;PrintTable__Field_No_____Field_Name___Control1000024Caption;
               SourceExpr=PrintTable__Field_No_____Field_Name___Control1000024CaptionLbl }

    { 1000027;2;Column  ;TableFilterCaption  ;
               SourceExpr=TableFilterCaptionLbl }

    { 1000029;2;Column  ;IN___Import_Restriction__Alternative_Value_Caption;
               SourceExpr="IN - Import Restriction".FIELDCAPTION("Alternative Value") }

    { 1000031;2;Column  ;IN___Import_Restriction__Error_No__Caption;
               SourceExpr="IN - Import Restriction".FIELDCAPTION("Error No.") }

    { 1000037;2;Column  ;IN___Import_Restriction__No__of_Values_Caption;
               SourceExpr="IN - Import Restriction".FIELDCAPTION("No. of Values") }

    { 1000041;2;Column  ;IN___Import_Restriction__Max__Length_Caption;
               SourceExpr="IN - Import Restriction".FIELDCAPTION("Max. Length") }

    { 1000043;2;Column  ;IN___Import_Restriction__Min__Value_Caption;
               SourceExpr="IN - Import Restriction".FIELDCAPTION("Min. Value") }

    { 1000045;2;Column  ;IN___Import_Restriction__Max__Value_Caption;
               SourceExpr="IN - Import Restriction".FIELDCAPTION("Max. Value") }

    { 1000032;2;Column  ;ImportDefLineRestrictions__Tag_Name_Caption;
               SourceExpr=ImportDefLineRestrictions__Tag_Name_CaptionLbl }

    { 4532;2   ;Column  ;ImportDefLineRestrictions_Import_Definition;
               SourceExpr="Import Definition" }

    { 9840;2   ;Column  ;ImportDefLineRestrictions_Entry_No_;
               SourceExpr="Entry No." }

    { 3938;2   ;DataItem;                    ;
               DataItemTable=Table11148596;
               DataItemTableView=SORTING(Import Definition,Import Def. Entry No.,Entry No.);
               OnPreDataItem=BEGIN
                               SETRANGE("Import Definition", "Import Definition");
                               SETRANGE("Import Def. Entry No.", "Entry No.");
                             END;

               OnAfterGetRecord=VAR
                                  Mgt@1000000 : Codeunit 11148589;
                                BEGIN
                                  TableFilter := FORMAT("Table Filter");
                                  Mgt.FormatTableFilter(TableFilter, "Table No.");
                                END;

               CalcFields=Table Name,Field Name;
               DataItemLink=Import Definition=FIELD(Import Definition),
                            Import Def. Entry No.=FIELD(Entry No.) }

    { 1000011;3;Column  ;IN___Import_Restriction_Type;
               SourceExpr=Type }

    { 1000022;3;Column  ;PrintTable__Table_No_____Table_Name___Control1000022;
               SourceExpr=PrintTable("Table No.", "Table Name") }

    { 1000024;3;Column  ;PrintTable__Field_No_____Field_Name___Control1000024;
               SourceExpr=PrintTable("Field No.", "Field Name") }

    { 1000026;3;Column  ;TableFilter         ;
               SourceExpr=TableFilter }

    { 1000028;3;Column  ;IN___Import_Restriction__Alternative_Value_;
               SourceExpr="Alternative Value" }

    { 1000030;3;Column  ;IN___Import_Restriction__Error_No__;
               SourceExpr="Error No." }

    { 1000036;3;Column  ;IN___Import_Restriction__No__of_Values_;
               SourceExpr="No. of Values" }

    { 1000040;3;Column  ;IN___Import_Restriction__Max__Length_;
               SourceExpr="Max. Length" }

    { 1000042;3;Column  ;IN___Import_Restriction__Min__Value_;
               SourceExpr="Min. Value" }

    { 1000044;3;Column  ;IN___Import_Restriction__Max__Value_;
               SourceExpr="Max. Value" }

    { 1000033;3;Column  ;ImportDefLineRestrictions__Tag_Name_;
               SourceExpr=ImportDefLineRestrictions."Tag Name" }

    { 8254;3   ;Column  ;IN___Import_Restriction_Import_Definition;
               SourceExpr="Import Definition" }

    { 9972;3   ;Column  ;IN___Import_Restriction_Import_Def__Entry_No_;
               SourceExpr="Import Def. Entry No." }

    { 9812;3   ;Column  ;IN___Import_Restriction_Entry_No_;
               SourceExpr="Entry No." }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      TableFilter@1000000 : Text[1024];
      LinkCounter@1000001 : Integer;
      CurrReport_PAGENOCaptionLbl@1000897509 : TextConst 'ENU=Page';
      ConnectIT_Import_DefinitionsCaptionLbl@1000784203 : TextConst 'ENU=ConnectIT Import Definitions';
      IN___Import_Definition_Line__As_Attribute_CaptionLbl@1000426463 : TextConst 'ENU=As Attribute';
      IN___Import_Definition_Line__Dest__Variable_CaptionLbl@1000007505 : TextConst 'ENU=Dest. Variable';
      IN___Import_Definition_Line__New_Record_CaptionLbl@1000544207 : TextConst 'ENU=New Record';
      IN___Import_Definition_Line__Existing_Record_CaptionLbl@1000559200 : TextConst 'ENU=Existing Record';
      IN___Import_Definition_Line__Save_Record_CaptionLbl@1000637950 : TextConst 'ENU=Save Record';
      IN___Import_Definition_Line__Validate_Field_CaptionLbl@1000951908 : TextConst 'ENU=Validate';
      IN___Import_Definition_Line__Skip_If_Empty_CaptionLbl@1000043492 : TextConst 'ENU=Skip If Empty';
      IN___Import_Definition_Line_MandatoryCaptionLbl@1000508175 : TextConst 'ENU=Mandatory';
      IN___Import_Definition_Line__Conversion_Code_CaptionLbl@1000298674 : TextConst 'ENU=Conversion Code';
      IN___Import_Definition_Line_CodeCaptionLbl@1000677076 : TextConst 'ENU=Code';
      IN___Import_Definition_Line__Data_Format_CaptionLbl@1000936641 : TextConst 'ENU=Format';
      PrintTable__Field_No_____Field_Name__CaptionLbl@1000820882 : TextConst 'ENU=Field';
      PrintTable__Table_No_____Table_Name__CaptionLbl@1000582887 : TextConst 'ENU=Table';
      IN___Import_Definition_Line_TypeCaptionLbl@1000276137 : TextConst 'ENU=Type';
      IndentText__Tag_Name___Indent_CaptionLbl@1000465896 : TextConst 'ENU=Tag Name';
      IN___Import_Definition_Line__Error_No__Field_Mandatory_CaptionLbl@1003383 : TextConst 'ENU=Err.';
      IN___Import_Definition_Line__Error_No__New_Record_CaptionLbl@1001697 : TextConst 'ENU=Err.';
      IN___Import_Definition_Line__Error_No__Existing_Record_CaptionLbl@1003153 : TextConst 'ENU=Err.';
      IN___Import_Definition_Line__Dest__Variable__Control1000000127CaptionLbl@1000890882 : TextConst 'ENU=Dest. Variable';
      IN___Import_Definition_Line__New_Record__Control1000000132CaptionLbl@1000005155 : TextConst 'ENU=New Record';
      IN___Import_Definition_Line__Existing_Record__Control1000000130CaptionLbl@1000262314 : TextConst 'ENU=Existing Record';
      IN___Import_Definition_Line__Save_Record__Control1000000134CaptionLbl@1000259535 : TextConst 'ENU=Save Record';
      IN___Import_Definition_Line__Validate_Field__Control1000000131CaptionLbl@1000202260 : TextConst 'ENU=Validate';
      IN___Import_Definition_Line__Skip_If_Empty__Control1000000129CaptionLbl@1000521240 : TextConst 'ENU=Skip If Empty';
      IN___Import_Definition_Line_Mandatory_Control1000000133CaptionLbl@1000176750 : TextConst 'ENU=Mandatory';
      IN___Import_Definition_Line__Conversion_Code__Control1000000125CaptionLbl@1000510273 : TextConst 'ENU=Conversion Code';
      IN___Import_Definition_Line_Code_Control1000000128CaptionLbl@1000079781 : TextConst 'ENU=Code';
      IN___Import_Definition_Line__Data_Format__Control1000000135CaptionLbl@1000795620 : TextConst 'ENU=Format';
      PrintTable__Field_No_____Field_Name___Control1000000124CaptionLbl@1000462612 : TextConst 'ENU=Field';
      PrintTable__Table_No_____Table_Name___Control1000000123CaptionLbl@1000774950 : TextConst 'ENU=Table';
      IN___Import_Definition_Line_Type_Control1000000122CaptionLbl@1000747733 : TextConst 'ENU=Type';
      IndentText__Tag_Name___Indent__Control1000000121CaptionLbl@1000665388 : TextConst 'ENU=Tag Name';
      IN___Import_Definition_Line__Error_No__Field_Mandatory__Control1000048CaptionLbl@1005540 : TextConst 'ENU=Err.';
      IN___Import_Definition_Line__Error_No__Existing_Record__Control1000054CaptionLbl@1006732 : TextConst 'ENU=Err.';
      IN___Import_Definition_Line__Error_No__New_Record__Control1000058CaptionLbl@1003079 : TextConst 'ENU=Err.';
      IN___Import_Definition_Line_WidthCaptionLbl@1000496939 : TextConst 'ENU=Width';
      IN___Import_Definition_Line__Dest__Variable__Control1000000143CaptionLbl@1000465639 : TextConst 'ENU=Dest. Variable';
      IN___Import_Definition_Line__New_Record__Control1000000145CaptionLbl@1000558119 : TextConst 'ENU=New Record';
      IN___Import_Definition_Line__Existing_Record__Control1000000147CaptionLbl@1000626892 : TextConst 'ENU=Existing Record';
      IN___Import_Definition_Line__Save_Record__Control1000000149CaptionLbl@1000717522 : TextConst 'ENU=Save Record';
      IN___Import_Definition_Line__Validate_Field__Control1000000151CaptionLbl@1000698272 : TextConst 'ENU=Validate';
      IN___Import_Definition_Line__Skip_If_Empty__Control1000000153CaptionLbl@1000329231 : TextConst 'ENU=Skip If Empty';
      IN___Import_Definition_Line_Mandatory_Control1000000155CaptionLbl@1000579353 : TextConst 'ENU=Mandatory';
      IN___Import_Definition_Line__Conversion_Code__Control1000000157CaptionLbl@1000051241 : TextConst 'ENU=Conversion Code';
      IN___Import_Definition_Line_Code_Control1000000159CaptionLbl@1000114093 : TextConst 'ENU=Code';
      IN___Import_Definition_Line__Data_Format__Control1000000163CaptionLbl@1000524974 : TextConst 'ENU=Format';
      PrintTable__Field_No_____Field_Name___Control1000000165CaptionLbl@1000744930 : TextConst 'ENU=Field';
      PrintTable__Table_No_____Table_Name___Control1000000167CaptionLbl@1000470515 : TextConst 'ENU=Table';
      IN___Import_Definition_Line_Type_Control1000000169CaptionLbl@1000856437 : TextConst 'ENU=Type';
      IndentText__Tag_Name___Indent__Control1000000171CaptionLbl@1000687596 : TextConst 'ENU=Tag Name';
      IN___Import_Definition_Line__Error_No__Field_Mandatory__Control1000049CaptionLbl@1007247 : TextConst 'ENU=Err.';
      IN___Import_Definition_Line__Error_No__Existing_Record__Control1000055CaptionLbl@1008439 : TextConst 'ENU=Err.';
      IN___Import_Definition_Line__Error_No__New_Record__Control1000059CaptionLbl@1004786 : TextConst 'ENU=Err.';
      Table_LinkCaptionLbl@1004585 : TextConst 'ENU=Table Link';
      ImportDefinitionLineTableLink__Link_to_Table__Tag_Name__CaptionLbl@1000499 : TextConst 'ENU=Main Table Tag';
      ImportDefinitionLineTableLink__Tag_Name_CaptionLbl@1003150 : TextConst 'ENU=Sub Table Tag';
      PrintTable__Main_Field_No_____Main_Field_Name__CaptionLbl@1007817 : TextConst 'ENU=Main Field';
      PrintTable__Sub_Field_No_____Sub_Field_Name__CaptionLbl@1003298 : TextConst 'ENU=Sub Field';
      PrintTable__Table_No_____Table_Name___Control1000022CaptionLbl@1008666 : TextConst 'ENU=Table';
      PrintTable__Field_No_____Field_Name___Control1000024CaptionLbl@1004086 : TextConst 'ENU=Field';
      TableFilterCaptionLbl@1003610 : TextConst 'ENU=Table Filter';
      ImportDefLineRestrictions__Tag_Name_CaptionLbl@1007774 : TextConst 'ENU=Tag Name';

    LOCAL PROCEDURE PrintTable@1000000000(TableNo@1000000000 : Integer;TableName@1000000001 : Text[30]) : Text[50];
    BEGIN
      IF TableNo <> 0 THEN
        EXIT(FORMAT(TableNo) + ' - ' + TableName);
    END;

    LOCAL PROCEDURE IndentText@1000000001(Text@1000000000 : Text[1024];Indent@1000000001 : Integer) ExitValue : Text[1024];
    VAR
      i@1000000002 : Integer;
    BEGIN
      FOR i := 1 TO Indent DO
        ExitValue += '  ';

      ExitValue += Text;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2008/01/reportdefinition">
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>fae0f653-7e32-4b05-9f98-1128e96ecbd7</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="DataSet_Result">
      <Query>
        <DataSourceName>DataSource</DataSourceName>
        <CommandText />
      </Query>
      <Fields>
        <Field Name="USERID">
          <DataField>USERID</DataField>
        </Field>
        <Field Name="CurrReport_PAGENO">
          <DataField>CurrReport_PAGENO</DataField>
        </Field>
        <Field Name="FORMAT_TODAY_0_4_">
          <DataField>FORMAT_TODAY_0_4_</DataField>
        </Field>
        <Field Name="COMPANYNAME">
          <DataField>COMPANYNAME</DataField>
        </Field>
        <Field Name="IN___Import_Definition__Run_Codeunit_No__">
          <DataField>IN___Import_Definition__Run_Codeunit_No__</DataField>
        </Field>
        <Field Name="IN___Import_Definition__Save_to_Messages_">
          <DataField>IN___Import_Definition__Save_to_Messages_</DataField>
        </Field>
        <Field Name="IN___Import_Definition__Log_Location_">
          <DataField>IN___Import_Definition__Log_Location_</DataField>
        </Field>
        <Field Name="IN___Import_Definition__Processed_Location_">
          <DataField>IN___Import_Definition__Processed_Location_</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Filename">
          <DataField>IN___Import_Definition_Filename</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Location">
          <DataField>IN___Import_Definition_Location</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Headers">
          <DataField>IN___Import_Definition_Headers</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Description">
          <DataField>IN___Import_Definition_Description</DataField>
        </Field>
        <Field Name="IN___Import_Definition__File_Format_">
          <DataField>IN___Import_Definition__File_Format_</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Code">
          <DataField>IN___Import_Definition_Code</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Status">
          <DataField>IN___Import_Definition_Status</DataField>
        </Field>
        <Field Name="IN___Import_Definition__Error_Notific__E_Mail_Address_">
          <DataField>IN___Import_Definition__Error_Notific__E_Mail_Address_</DataField>
        </Field>
        <Field Name="IN___Import_Definition__Field_Separator_">
          <DataField>IN___Import_Definition__Field_Separator_</DataField>
        </Field>
        <Field Name="IN___Import_Definition__Field_Delimiter_">
          <DataField>IN___Import_Definition__Field_Delimiter_</DataField>
        </Field>
        <Field Name="CurrReport_PAGENOCaption">
          <DataField>CurrReport_PAGENOCaption</DataField>
        </Field>
        <Field Name="ConnectIT_Import_DefinitionsCaption">
          <DataField>ConnectIT_Import_DefinitionsCaption</DataField>
        </Field>
        <Field Name="IN___Import_Definition__Run_Codeunit_No__Caption">
          <DataField>IN___Import_Definition__Run_Codeunit_No__Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition__Save_to_Messages_Caption">
          <DataField>IN___Import_Definition__Save_to_Messages_Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition__Log_Location_Caption">
          <DataField>IN___Import_Definition__Log_Location_Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition__Processed_Location_Caption">
          <DataField>IN___Import_Definition__Processed_Location_Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_FilenameCaption">
          <DataField>IN___Import_Definition_FilenameCaption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_LocationCaption">
          <DataField>IN___Import_Definition_LocationCaption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_HeadersCaption">
          <DataField>IN___Import_Definition_HeadersCaption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_DescriptionCaption">
          <DataField>IN___Import_Definition_DescriptionCaption</DataField>
        </Field>
        <Field Name="IN___Import_Definition__File_Format_Caption">
          <DataField>IN___Import_Definition__File_Format_Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_CodeCaption">
          <DataField>IN___Import_Definition_CodeCaption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_StatusCaption">
          <DataField>IN___Import_Definition_StatusCaption</DataField>
        </Field>
        <Field Name="IN___Import_Definition__Error_Notific__E_Mail_Address_Caption">
          <DataField>IN___Import_Definition__Error_Notific__E_Mail_Address_Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition__Field_Separator_Caption">
          <DataField>IN___Import_Definition__Field_Separator_Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition__Field_Delimiter_Caption">
          <DataField>IN___Import_Definition__Field_Delimiter_Caption</DataField>
        </Field>
        <Field Name="IndentText__Tag_Name___Indent_">
          <DataField>IndentText__Tag_Name___Indent_</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line_Type">
          <DataField>IN___Import_Definition_Line_Type</DataField>
        </Field>
        <Field Name="PrintTable__Table_No_____Table_Name__">
          <DataField>PrintTable__Table_No_____Table_Name__</DataField>
        </Field>
        <Field Name="PrintTable__Field_No_____Field_Name__">
          <DataField>PrintTable__Field_No_____Field_Name__</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Conversion_Code_">
          <DataField>IN___Import_Definition_Line__Conversion_Code_</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Dest__Variable_">
          <DataField>IN___Import_Definition_Line__Dest__Variable_</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line_Code">
          <DataField>IN___Import_Definition_Line_Code</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Skip_If_Empty_">
          <DataField>IN___Import_Definition_Line__Skip_If_Empty_</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Existing_Record_">
          <DataField>IN___Import_Definition_Line__Existing_Record_</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Validate_Field_">
          <DataField>IN___Import_Definition_Line__Validate_Field_</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__New_Record_">
          <DataField>IN___Import_Definition_Line__New_Record_</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line_Mandatory">
          <DataField>IN___Import_Definition_Line_Mandatory</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Save_Record_">
          <DataField>IN___Import_Definition_Line__Save_Record_</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Data_Format_">
          <DataField>IN___Import_Definition_Line__Data_Format_</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__As_Attribute_">
          <DataField>IN___Import_Definition_Line__As_Attribute_</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Error_No__Field_Mandatory_">
          <DataField>IN___Import_Definition_Line__Error_No__Field_Mandatory_</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Error_No__Existing_Record_">
          <DataField>IN___Import_Definition_Line__Error_No__Existing_Record_</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Error_No__New_Record_">
          <DataField>IN___Import_Definition_Line__Error_No__New_Record_</DataField>
        </Field>
        <Field Name="IndentText__Tag_Name___Indent__Control1000000121">
          <DataField>IndentText__Tag_Name___Indent__Control1000000121</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line_Type_Control1000000122">
          <DataField>IN___Import_Definition_Line_Type_Control1000000122</DataField>
        </Field>
        <Field Name="PrintTable__Table_No_____Table_Name___Control1000000123">
          <DataField>PrintTable__Table_No_____Table_Name___Control1000000123</DataField>
        </Field>
        <Field Name="PrintTable__Field_No_____Field_Name___Control1000000124">
          <DataField>PrintTable__Field_No_____Field_Name___Control1000000124</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Conversion_Code__Control1000000125">
          <DataField>IN___Import_Definition_Line__Conversion_Code__Control1000000125</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Dest__Variable__Control1000000127">
          <DataField>IN___Import_Definition_Line__Dest__Variable__Control1000000127</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line_Code_Control1000000128">
          <DataField>IN___Import_Definition_Line_Code_Control1000000128</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Skip_If_Empty__Control1000000129">
          <DataField>IN___Import_Definition_Line__Skip_If_Empty__Control1000000129</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Existing_Record__Control1000000130">
          <DataField>IN___Import_Definition_Line__Existing_Record__Control1000000130</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Validate_Field__Control1000000131">
          <DataField>IN___Import_Definition_Line__Validate_Field__Control1000000131</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__New_Record__Control1000000132">
          <DataField>IN___Import_Definition_Line__New_Record__Control1000000132</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line_Mandatory_Control1000000133">
          <DataField>IN___Import_Definition_Line_Mandatory_Control1000000133</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Save_Record__Control1000000134">
          <DataField>IN___Import_Definition_Line__Save_Record__Control1000000134</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Data_Format__Control1000000135">
          <DataField>IN___Import_Definition_Line__Data_Format__Control1000000135</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Error_No__Field_Mandatory__Control1000048">
          <DataField>IN___Import_Definition_Line__Error_No__Field_Mandatory__Control1000048</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Error_No__Existing_Record__Control1000054">
          <DataField>IN___Import_Definition_Line__Error_No__Existing_Record__Control1000054</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Error_No__New_Record__Control1000058">
          <DataField>IN___Import_Definition_Line__Error_No__New_Record__Control1000058</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line_Width">
          <DataField>IN___Import_Definition_Line_Width</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Dest__Variable__Control1000000143">
          <DataField>IN___Import_Definition_Line__Dest__Variable__Control1000000143</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__New_Record__Control1000000145">
          <DataField>IN___Import_Definition_Line__New_Record__Control1000000145</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Existing_Record__Control1000000147">
          <DataField>IN___Import_Definition_Line__Existing_Record__Control1000000147</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Save_Record__Control1000000149">
          <DataField>IN___Import_Definition_Line__Save_Record__Control1000000149</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Validate_Field__Control1000000151">
          <DataField>IN___Import_Definition_Line__Validate_Field__Control1000000151</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Skip_If_Empty__Control1000000153">
          <DataField>IN___Import_Definition_Line__Skip_If_Empty__Control1000000153</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line_Mandatory_Control1000000155">
          <DataField>IN___Import_Definition_Line_Mandatory_Control1000000155</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Conversion_Code__Control1000000157">
          <DataField>IN___Import_Definition_Line__Conversion_Code__Control1000000157</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line_Code_Control1000000159">
          <DataField>IN___Import_Definition_Line_Code_Control1000000159</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Data_Format__Control1000000163">
          <DataField>IN___Import_Definition_Line__Data_Format__Control1000000163</DataField>
        </Field>
        <Field Name="PrintTable__Field_No_____Field_Name___Control1000000165">
          <DataField>PrintTable__Field_No_____Field_Name___Control1000000165</DataField>
        </Field>
        <Field Name="PrintTable__Table_No_____Table_Name___Control1000000167">
          <DataField>PrintTable__Table_No_____Table_Name___Control1000000167</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line_Type_Control1000000169">
          <DataField>IN___Import_Definition_Line_Type_Control1000000169</DataField>
        </Field>
        <Field Name="IndentText__Tag_Name___Indent__Control1000000171">
          <DataField>IndentText__Tag_Name___Indent__Control1000000171</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Error_No__Field_Mandatory__Control1000049">
          <DataField>IN___Import_Definition_Line__Error_No__Field_Mandatory__Control1000049</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Error_No__Existing_Record__Control1000055">
          <DataField>IN___Import_Definition_Line__Error_No__Existing_Record__Control1000055</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Error_No__New_Record__Control1000059">
          <DataField>IN___Import_Definition_Line__Error_No__New_Record__Control1000059</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__As_Attribute_Caption">
          <DataField>IN___Import_Definition_Line__As_Attribute_Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Dest__Variable_Caption">
          <DataField>IN___Import_Definition_Line__Dest__Variable_Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__New_Record_Caption">
          <DataField>IN___Import_Definition_Line__New_Record_Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Existing_Record_Caption">
          <DataField>IN___Import_Definition_Line__Existing_Record_Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Save_Record_Caption">
          <DataField>IN___Import_Definition_Line__Save_Record_Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Validate_Field_Caption">
          <DataField>IN___Import_Definition_Line__Validate_Field_Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Skip_If_Empty_Caption">
          <DataField>IN___Import_Definition_Line__Skip_If_Empty_Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line_MandatoryCaption">
          <DataField>IN___Import_Definition_Line_MandatoryCaption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Conversion_Code_Caption">
          <DataField>IN___Import_Definition_Line__Conversion_Code_Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line_CodeCaption">
          <DataField>IN___Import_Definition_Line_CodeCaption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Data_Format_Caption">
          <DataField>IN___Import_Definition_Line__Data_Format_Caption</DataField>
        </Field>
        <Field Name="PrintTable__Field_No_____Field_Name__Caption">
          <DataField>PrintTable__Field_No_____Field_Name__Caption</DataField>
        </Field>
        <Field Name="PrintTable__Table_No_____Table_Name__Caption">
          <DataField>PrintTable__Table_No_____Table_Name__Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line_TypeCaption">
          <DataField>IN___Import_Definition_Line_TypeCaption</DataField>
        </Field>
        <Field Name="IndentText__Tag_Name___Indent_Caption">
          <DataField>IndentText__Tag_Name___Indent_Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Error_No__Field_Mandatory_Caption">
          <DataField>IN___Import_Definition_Line__Error_No__Field_Mandatory_Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Error_No__New_Record_Caption">
          <DataField>IN___Import_Definition_Line__Error_No__New_Record_Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Error_No__Existing_Record_Caption">
          <DataField>IN___Import_Definition_Line__Error_No__Existing_Record_Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Dest__Variable__Control1000000127Caption">
          <DataField>IN___Import_Definition_Line__Dest__Variable__Control1000000127Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__New_Record__Control1000000132Caption">
          <DataField>IN___Import_Definition_Line__New_Record__Control1000000132Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Existing_Record__Control1000000130Caption">
          <DataField>IN___Import_Definition_Line__Existing_Record__Control1000000130Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Save_Record__Control1000000134Caption">
          <DataField>IN___Import_Definition_Line__Save_Record__Control1000000134Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Validate_Field__Control1000000131Caption">
          <DataField>IN___Import_Definition_Line__Validate_Field__Control1000000131Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Skip_If_Empty__Control1000000129Caption">
          <DataField>IN___Import_Definition_Line__Skip_If_Empty__Control1000000129Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line_Mandatory_Control1000000133Caption">
          <DataField>IN___Import_Definition_Line_Mandatory_Control1000000133Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Conversion_Code__Control1000000125Caption">
          <DataField>IN___Import_Definition_Line__Conversion_Code__Control1000000125Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line_Code_Control1000000128Caption">
          <DataField>IN___Import_Definition_Line_Code_Control1000000128Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Data_Format__Control1000000135Caption">
          <DataField>IN___Import_Definition_Line__Data_Format__Control1000000135Caption</DataField>
        </Field>
        <Field Name="PrintTable__Field_No_____Field_Name___Control1000000124Caption">
          <DataField>PrintTable__Field_No_____Field_Name___Control1000000124Caption</DataField>
        </Field>
        <Field Name="PrintTable__Table_No_____Table_Name___Control1000000123Caption">
          <DataField>PrintTable__Table_No_____Table_Name___Control1000000123Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line_Type_Control1000000122Caption">
          <DataField>IN___Import_Definition_Line_Type_Control1000000122Caption</DataField>
        </Field>
        <Field Name="IndentText__Tag_Name___Indent__Control1000000121Caption">
          <DataField>IndentText__Tag_Name___Indent__Control1000000121Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Error_No__Field_Mandatory__Control1000048Caption">
          <DataField>IN___Import_Definition_Line__Error_No__Field_Mandatory__Control1000048Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Error_No__Existing_Record__Control1000054Caption">
          <DataField>IN___Import_Definition_Line__Error_No__Existing_Record__Control1000054Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Error_No__New_Record__Control1000058Caption">
          <DataField>IN___Import_Definition_Line__Error_No__New_Record__Control1000058Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line_WidthCaption">
          <DataField>IN___Import_Definition_Line_WidthCaption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Dest__Variable__Control1000000143Caption">
          <DataField>IN___Import_Definition_Line__Dest__Variable__Control1000000143Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__New_Record__Control1000000145Caption">
          <DataField>IN___Import_Definition_Line__New_Record__Control1000000145Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Existing_Record__Control1000000147Caption">
          <DataField>IN___Import_Definition_Line__Existing_Record__Control1000000147Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Save_Record__Control1000000149Caption">
          <DataField>IN___Import_Definition_Line__Save_Record__Control1000000149Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Validate_Field__Control1000000151Caption">
          <DataField>IN___Import_Definition_Line__Validate_Field__Control1000000151Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Skip_If_Empty__Control1000000153Caption">
          <DataField>IN___Import_Definition_Line__Skip_If_Empty__Control1000000153Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line_Mandatory_Control1000000155Caption">
          <DataField>IN___Import_Definition_Line_Mandatory_Control1000000155Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Conversion_Code__Control1000000157Caption">
          <DataField>IN___Import_Definition_Line__Conversion_Code__Control1000000157Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line_Code_Control1000000159Caption">
          <DataField>IN___Import_Definition_Line_Code_Control1000000159Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Data_Format__Control1000000163Caption">
          <DataField>IN___Import_Definition_Line__Data_Format__Control1000000163Caption</DataField>
        </Field>
        <Field Name="PrintTable__Field_No_____Field_Name___Control1000000165Caption">
          <DataField>PrintTable__Field_No_____Field_Name___Control1000000165Caption</DataField>
        </Field>
        <Field Name="PrintTable__Table_No_____Table_Name___Control1000000167Caption">
          <DataField>PrintTable__Table_No_____Table_Name___Control1000000167Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line_Type_Control1000000169Caption">
          <DataField>IN___Import_Definition_Line_Type_Control1000000169Caption</DataField>
        </Field>
        <Field Name="IndentText__Tag_Name___Indent__Control1000000171Caption">
          <DataField>IndentText__Tag_Name___Indent__Control1000000171Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Error_No__Field_Mandatory__Control1000049Caption">
          <DataField>IN___Import_Definition_Line__Error_No__Field_Mandatory__Control1000049Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Error_No__Existing_Record__Control1000055Caption">
          <DataField>IN___Import_Definition_Line__Error_No__Existing_Record__Control1000055Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line__Error_No__New_Record__Control1000059Caption">
          <DataField>IN___Import_Definition_Line__Error_No__New_Record__Control1000059Caption</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line_Import_Definition">
          <DataField>IN___Import_Definition_Line_Import_Definition</DataField>
        </Field>
        <Field Name="IN___Import_Definition_Line_Entry_No_">
          <DataField>IN___Import_Definition_Line_Entry_No_</DataField>
        </Field>
        <Field Name="Table_LinkCaption">
          <DataField>Table_LinkCaption</DataField>
        </Field>
        <Field Name="ImportDefinitionLineTableLink__Link_to_Table__Tag_Name__Caption">
          <DataField>ImportDefinitionLineTableLink__Link_to_Table__Tag_Name__Caption</DataField>
        </Field>
        <Field Name="ImportDefinitionLineTableLink__Tag_Name_Caption">
          <DataField>ImportDefinitionLineTableLink__Tag_Name_Caption</DataField>
        </Field>
        <Field Name="PrintTable__Main_Field_No_____Main_Field_Name__Caption">
          <DataField>PrintTable__Main_Field_No_____Main_Field_Name__Caption</DataField>
        </Field>
        <Field Name="PrintTable__Sub_Field_No_____Sub_Field_Name__Caption">
          <DataField>PrintTable__Sub_Field_No_____Sub_Field_Name__Caption</DataField>
        </Field>
        <Field Name="ImportDefinitionLineTableLink_Import_Definition">
          <DataField>ImportDefinitionLineTableLink_Import_Definition</DataField>
        </Field>
        <Field Name="ImportDefinitionLineTableLink_Entry_No_">
          <DataField>ImportDefinitionLineTableLink_Entry_No_</DataField>
        </Field>
        <Field Name="PrintTable__Main_Field_No_____Main_Field_Name__">
          <DataField>PrintTable__Main_Field_No_____Main_Field_Name__</DataField>
        </Field>
        <Field Name="PrintTable__Sub_Field_No_____Sub_Field_Name__">
          <DataField>PrintTable__Sub_Field_No_____Sub_Field_Name__</DataField>
        </Field>
        <Field Name="ImportDefinitionLineTableLink__Tag_Name_">
          <DataField>ImportDefinitionLineTableLink__Tag_Name_</DataField>
        </Field>
        <Field Name="ImportDefinitionLineTableLink__Link_to_Table__Tag_Name__">
          <DataField>ImportDefinitionLineTableLink__Link_to_Table__Tag_Name__</DataField>
        </Field>
        <Field Name="PrintTable__Main_Field_No_____Main_Field_Name___Control1000012">
          <DataField>PrintTable__Main_Field_No_____Main_Field_Name___Control1000012</DataField>
        </Field>
        <Field Name="PrintTable__Sub_Field_No_____Sub_Field_Name___Control1000013">
          <DataField>PrintTable__Sub_Field_No_____Sub_Field_Name___Control1000013</DataField>
        </Field>
        <Field Name="IN___Import_Def__Table_Link_Import_Definition">
          <DataField>IN___Import_Def__Table_Link_Import_Definition</DataField>
        </Field>
        <Field Name="IN___Import_Def__Table_Link_Import_Def__Entry_No_">
          <DataField>IN___Import_Def__Table_Link_Import_Def__Entry_No_</DataField>
        </Field>
        <Field Name="IN___Import_Def__Table_Link_Main_Field_No_">
          <DataField>IN___Import_Def__Table_Link_Main_Field_No_</DataField>
        </Field>
        <Field Name="IN___Import_Restriction_TypeCaption">
          <DataField>IN___Import_Restriction_TypeCaption</DataField>
        </Field>
        <Field Name="PrintTable__Table_No_____Table_Name___Control1000022Caption">
          <DataField>PrintTable__Table_No_____Table_Name___Control1000022Caption</DataField>
        </Field>
        <Field Name="PrintTable__Field_No_____Field_Name___Control1000024Caption">
          <DataField>PrintTable__Field_No_____Field_Name___Control1000024Caption</DataField>
        </Field>
        <Field Name="TableFilterCaption">
          <DataField>TableFilterCaption</DataField>
        </Field>
        <Field Name="IN___Import_Restriction__Alternative_Value_Caption">
          <DataField>IN___Import_Restriction__Alternative_Value_Caption</DataField>
        </Field>
        <Field Name="IN___Import_Restriction__Error_No__Caption">
          <DataField>IN___Import_Restriction__Error_No__Caption</DataField>
        </Field>
        <Field Name="IN___Import_Restriction__No__of_Values_Caption">
          <DataField>IN___Import_Restriction__No__of_Values_Caption</DataField>
        </Field>
        <Field Name="IN___Import_Restriction__Max__Length_Caption">
          <DataField>IN___Import_Restriction__Max__Length_Caption</DataField>
        </Field>
        <Field Name="IN___Import_Restriction__Min__Value_Caption">
          <DataField>IN___Import_Restriction__Min__Value_Caption</DataField>
        </Field>
        <Field Name="IN___Import_Restriction__Max__Value_Caption">
          <DataField>IN___Import_Restriction__Max__Value_Caption</DataField>
        </Field>
        <Field Name="ImportDefLineRestrictions__Tag_Name_Caption">
          <DataField>ImportDefLineRestrictions__Tag_Name_Caption</DataField>
        </Field>
        <Field Name="ImportDefLineRestrictions_Import_Definition">
          <DataField>ImportDefLineRestrictions_Import_Definition</DataField>
        </Field>
        <Field Name="ImportDefLineRestrictions_Entry_No_">
          <DataField>ImportDefLineRestrictions_Entry_No_</DataField>
        </Field>
        <Field Name="IN___Import_Restriction_Type">
          <DataField>IN___Import_Restriction_Type</DataField>
        </Field>
        <Field Name="PrintTable__Table_No_____Table_Name___Control1000022">
          <DataField>PrintTable__Table_No_____Table_Name___Control1000022</DataField>
        </Field>
        <Field Name="PrintTable__Field_No_____Field_Name___Control1000024">
          <DataField>PrintTable__Field_No_____Field_Name___Control1000024</DataField>
        </Field>
        <Field Name="TableFilter">
          <DataField>TableFilter</DataField>
        </Field>
        <Field Name="IN___Import_Restriction__Alternative_Value_">
          <DataField>IN___Import_Restriction__Alternative_Value_</DataField>
        </Field>
        <Field Name="IN___Import_Restriction__Error_No__">
          <DataField>IN___Import_Restriction__Error_No__</DataField>
        </Field>
        <Field Name="IN___Import_Restriction__No__of_Values_">
          <DataField>IN___Import_Restriction__No__of_Values_</DataField>
        </Field>
        <Field Name="IN___Import_Restriction__Max__Length_">
          <DataField>IN___Import_Restriction__Max__Length_</DataField>
        </Field>
        <Field Name="IN___Import_Restriction__Min__Value_">
          <DataField>IN___Import_Restriction__Min__Value_</DataField>
        </Field>
        <Field Name="IN___Import_Restriction__Min__Value_Format">
          <DataField>IN___Import_Restriction__Min__Value_Format</DataField>
        </Field>
        <Field Name="IN___Import_Restriction__Max__Value_">
          <DataField>IN___Import_Restriction__Max__Value_</DataField>
        </Field>
        <Field Name="IN___Import_Restriction__Max__Value_Format">
          <DataField>IN___Import_Restriction__Max__Value_Format</DataField>
        </Field>
        <Field Name="ImportDefLineRestrictions__Tag_Name_">
          <DataField>ImportDefLineRestrictions__Tag_Name_</DataField>
        </Field>
        <Field Name="IN___Import_Restriction_Import_Definition">
          <DataField>IN___Import_Restriction_Import_Definition</DataField>
        </Field>
        <Field Name="IN___Import_Restriction_Import_Def__Entry_No_">
          <DataField>IN___Import_Restriction_Import_Def__Entry_No_</DataField>
        </Field>
        <Field Name="IN___Import_Restriction_Entry_No_">
          <DataField>IN___Import_Restriction_Entry_No_</DataField>
        </Field>
      </Fields>
      <rd:DataSetInfo>
        <rd:DataSetName>DataSet</rd:DataSetName>
        <rd:SchemaPath>Report.xsd</rd:SchemaPath>
        <rd:TableName>Result</rd:TableName>
      </rd:DataSetInfo>
    </DataSet>
  </DataSets>
  <Code>Public Function BlankZero(ByVal Value As Decimal)
    if Value = 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankPos(ByVal Value As Decimal)
    if Value &gt; 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankZeroAndPos(ByVal Value As Decimal)
    if Value &gt;= 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankNeg(ByVal Value As Decimal)
    if Value &lt; 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankNegAndZero(ByVal Value As Decimal)
    if Value &lt;= 0 then
        Return ""
    end if
    Return Value
End Function
</Code>
  <Language>=User!Language</Language>
  <ConsumeContainerWhitespace>true</ConsumeContainerWhitespace>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
  <rd:ReportID>98fccd2c-b130-40b6-a1a7-ca386775b7e3</rd:ReportID>
  <Body>
    <ReportItems>
      <Tablix Name="Table1">
        <TablixBody>
          <TablixColumns>
            <TablixColumn>
              <Width>2.025cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1.2cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1.65cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>2.85cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>2.85cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1.35cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1.65cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1.05cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>0.75cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1.2cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1.2cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1.2cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1.35cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>0.75cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1.35cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>0.75cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1.65cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1.125cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>0.2cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>0.2cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>0.2cm</Width>
            </TablixColumn>
          </TablixColumns>
          <TablixRows>
            <TablixRow>
              <Height>0.846cm</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IndentText__Tag_Name___Indent_Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IndentText__Tag_Name___Indent_Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>0cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.95cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line_TypeCaption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Import_Definition_Line_TypeCaption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>2.1cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.05cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line_CodeCaption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Import_Definition_Line_CodeCaption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>3.3cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.5cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="PrintTable__Table_No_____Table_Name__Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!PrintTable__Table_No_____Table_Name__Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>4.95cm</Left>
                      <Height>0.846cm</Height>
                      <Width>2.7cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="PrintTable__Field_No_____Field_Name__Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!PrintTable__Field_No_____Field_Name__Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>7.8cm</Left>
                      <Height>0.846cm</Height>
                      <Width>2.7cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Data_Format_Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Import_Definition_Line__Data_Format_Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>10.65cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.2cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Conversion_Code_Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Import_Definition_Line__Conversion_Code_Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>12cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.5cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line_MandatoryCaption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Import_Definition_Line_MandatoryCaption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>13.65cm</Left>
                      <Height>0.846cm</Height>
                      <Width>0.9cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Error_No__Field_Mandatory_Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Import_Definition_Line__Error_No__Field_Mandatory_Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>14.7cm</Left>
                      <Height>0.846cm</Height>
                      <Width>0.6cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Skip_If_Empty_Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Import_Definition_Line__Skip_If_Empty_Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>15.45cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.05cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Validate_Field_Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Import_Definition_Line__Validate_Field_Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>16.65cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.05cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Save_Record_Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Import_Definition_Line__Save_Record_Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>17.85cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.05cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Existing_Record_Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Import_Definition_Line__Existing_Record_Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>19.05cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.2cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Error_No__Existing_Record_Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Import_Definition_Line__Error_No__Existing_Record_Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>20.4cm</Left>
                      <Height>0.846cm</Height>
                      <Width>0.6cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__New_Record_Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Import_Definition_Line__New_Record_Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>21.15cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.2cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Error_No__New_Record_Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Import_Definition_Line__Error_No__New_Record_Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>22.5cm</Left>
                      <Height>0.846cm</Height>
                      <Width>0.6cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Dest__Variable_Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Import_Definition_Line__Dest__Variable_Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>23.25cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.5cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__As_Attribute_Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Import_Definition_Line__As_Attribute_Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>24.9cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.05cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox181">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                    <ColSpan>3</ColSpan>
                  </CellContents>
                </TablixCell>
                <TablixCell />
                <TablixCell />
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>0.423cm</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_CodeCaption">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition_CodeCaption.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>0cm</Left>
                      <Height>0.423cm</Height>
                      <Width>2.85cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Code">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition_Code.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>3cm</Left>
                      <Height>0.423cm</Height>
                      <Width>4.5cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_StatusCaption">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition_StatusCaption.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>9.15cm</Left>
                      <Height>0.423cm</Height>
                      <Width>2.85cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Status">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition_Status.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>12.15cm</Left>
                      <Height>0.423cm</Height>
                      <Width>4.5cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition__Run_Codeunit_No__Caption">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition__Run_Codeunit_No__Caption.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>18.45cm</Left>
                      <Height>0.423cm</Height>
                      <Width>2.85cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition__Run_Codeunit_No__">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition__Run_Codeunit_No__.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>21.45cm</Left>
                      <Height>0.423cm</Height>
                      <Width>4.5cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox1">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox11">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox12">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox13">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox14">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox15">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox16">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox17">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox18">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox19">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox110">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox111">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox182">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                    <ColSpan>3</ColSpan>
                  </CellContents>
                </TablixCell>
                <TablixCell />
                <TablixCell />
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>0.423cm</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_DescriptionCaption">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition_DescriptionCaption.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>0cm</Left>
                      <Height>0.423cm</Height>
                      <Width>2.85cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Description">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition_Description.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>3cm</Left>
                      <Height>0.423cm</Height>
                      <Width>4.5cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition__File_Format_Caption">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition__File_Format_Caption.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>9.15cm</Left>
                      <Height>0.423cm</Height>
                      <Width>2.85cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition__File_Format_">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition__File_Format_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>12.15cm</Left>
                      <Height>0.423cm</Height>
                      <Width>4.5cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition__Error_Notific__E_Mail_Address_Caption">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition__Error_Notific__E_Mail_Address_Caption.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>18.45cm</Left>
                      <Height>0.423cm</Height>
                      <Width>2.85cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition__Error_Notific__E_Mail_Address_">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition__Error_Notific__E_Mail_Address_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>21.45cm</Left>
                      <Height>0.423cm</Height>
                      <Width>4.5cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox112">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox113">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox114">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox115">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox116">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox117">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox118">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox119">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox120">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox121">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox122">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox123">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox183">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                    <ColSpan>3</ColSpan>
                  </CellContents>
                </TablixCell>
                <TablixCell />
                <TablixCell />
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>0.423cm</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_LocationCaption">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition_LocationCaption.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.846cm</Top>
                      <Left>0cm</Left>
                      <Height>0.423cm</Height>
                      <Width>2.85cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Location">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition_Location.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.846cm</Top>
                      <Left>3cm</Left>
                      <Height>0.423cm</Height>
                      <Width>4.5cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_HeadersCaption">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition_HeadersCaption.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.846cm</Top>
                      <Left>9.15cm</Left>
                      <Height>0.423cm</Height>
                      <Width>2.85cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Headers">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition_Headers.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.846cm</Top>
                      <Left>12.15cm</Left>
                      <Height>0.423cm</Height>
                      <Width>4.5cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox124">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox125">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox126">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox127">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox128">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox129">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox130">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox131">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox132">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox133">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox134">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox135">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox136">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox137">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox184">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                    <ColSpan>3</ColSpan>
                  </CellContents>
                </TablixCell>
                <TablixCell />
                <TablixCell />
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>0.423cm</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_FilenameCaption">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition_FilenameCaption.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>1.269cm</Top>
                      <Left>0cm</Left>
                      <Height>0.423cm</Height>
                      <Width>2.85cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Filename">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition_Filename.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>1.269cm</Top>
                      <Left>3cm</Left>
                      <Height>0.423cm</Height>
                      <Width>4.5cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition__Save_to_Messages_Caption">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition__Save_to_Messages_Caption.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>1.269cm</Top>
                      <Left>9.15cm</Left>
                      <Height>0.423cm</Height>
                      <Width>2.85cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition__Save_to_Messages_">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition__Save_to_Messages_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <Top>1.269cm</Top>
                      <Left>12.15cm</Left>
                      <Height>0.423cm</Height>
                      <Width>4.5cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox138">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox139">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox140">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox141">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox142">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox143">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox144">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox145">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox146">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox147">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox148">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox149">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox150">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox151">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox185">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                    <ColSpan>3</ColSpan>
                  </CellContents>
                </TablixCell>
                <TablixCell />
                <TablixCell />
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>0.423cm</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition__Processed_Location_Caption">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition__Processed_Location_Caption.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>1.692cm</Top>
                      <Left>0cm</Left>
                      <Height>0.423cm</Height>
                      <Width>2.85cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition__Processed_Location_">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition__Processed_Location_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>1.692cm</Top>
                      <Left>3cm</Left>
                      <Height>0.423cm</Height>
                      <Width>4.5cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition__Field_Delimiter_Caption">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition__Field_Delimiter_Caption.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>1.692cm</Top>
                      <Left>9.15cm</Left>
                      <Height>0.423cm</Height>
                      <Width>2.85cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition__Field_Delimiter_">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition__Field_Delimiter_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <Top>1.692cm</Top>
                      <Left>12.15cm</Left>
                      <Height>0.423cm</Height>
                      <Width>4.5cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox152">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox153">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox154">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox155">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox156">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox157">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox158">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox159">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox160">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox161">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox162">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox163">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox164">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox165">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox186">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                    <ColSpan>3</ColSpan>
                  </CellContents>
                </TablixCell>
                <TablixCell />
                <TablixCell />
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>0.423cm</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition__Log_Location_Caption">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition__Log_Location_Caption.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>2.115cm</Top>
                      <Left>0cm</Left>
                      <Height>0.423cm</Height>
                      <Width>2.85cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition__Log_Location_">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition__Log_Location_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>2.115cm</Top>
                      <Left>3cm</Left>
                      <Height>0.423cm</Height>
                      <Width>4.5cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition__Field_Separator_Caption">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition__Field_Separator_Caption.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>2.115cm</Top>
                      <Left>9.15cm</Left>
                      <Height>0.423cm</Height>
                      <Width>2.85cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition__Field_Separator_">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition__Field_Separator_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <Top>2.115cm</Top>
                      <Left>12.15cm</Left>
                      <Height>0.423cm</Height>
                      <Width>4.5cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox166">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox167">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox168">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox169">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox170">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox171">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox172">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox173">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox174">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox175">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox176">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox177">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox178">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox179">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox187">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                    <ColSpan>3</ColSpan>
                  </CellContents>
                </TablixCell>
                <TablixCell />
                <TablixCell />
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>0.846cm</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IndentText__Tag_Name___Indent__Control1000000171Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IndentText__Tag_Name___Indent__Control1000000171Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>0cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.95cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line_Type_Control1000000169Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Import_Definition_Line_Type_Control1000000169Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>2.1cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.05cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line_Code_Control1000000159Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Import_Definition_Line_Code_Control1000000159Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>3.3cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.5cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="PrintTable__Table_No_____Table_Name___Control1000000167Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!PrintTable__Table_No_____Table_Name___Control1000000167Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>4.95cm</Left>
                      <Height>0.846cm</Height>
                      <Width>2.7cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="PrintTable__Field_No_____Field_Name___Control1000000165Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!PrintTable__Field_No_____Field_Name___Control1000000165Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>7.8cm</Left>
                      <Height>0.846cm</Height>
                      <Width>2.7cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Data_Format__Control1000000163Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Import_Definition_Line__Data_Format__Control1000000163Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>10.65cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.2cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Conversion_Code__Control1000000157Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Import_Definition_Line__Conversion_Code__Control1000000157Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>12cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.5cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line_Mandatory_Control1000000155Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Import_Definition_Line_Mandatory_Control1000000155Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>13.65cm</Left>
                      <Height>0.846cm</Height>
                      <Width>0.9cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Error_No__Field_Mandatory__Control1000049Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Import_Definition_Line__Error_No__Field_Mandatory__Control1000049Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>14.7cm</Left>
                      <Height>0.846cm</Height>
                      <Width>0.6cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Skip_If_Empty__Control1000000153Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Import_Definition_Line__Skip_If_Empty__Control1000000153Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>15.45cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.05cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Validate_Field__Control1000000151Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Import_Definition_Line__Validate_Field__Control1000000151Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>16.65cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.05cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Save_Record__Control1000000149Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Import_Definition_Line__Save_Record__Control1000000149Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>17.85cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.05cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Existing_Record__Control1000000147Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Import_Definition_Line__Existing_Record__Control1000000147Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>19.05cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.2cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Error_No__Existing_Record__Control1000055Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Import_Definition_Line__Error_No__Existing_Record__Control1000055Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>20.4cm</Left>
                      <Height>0.846cm</Height>
                      <Width>0.6cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__New_Record__Control1000000145Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Import_Definition_Line__New_Record__Control1000000145Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>21.15cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.2cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Error_No__New_Record__Control1000059Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Import_Definition_Line__Error_No__New_Record__Control1000059Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>22.5cm</Left>
                      <Height>0.846cm</Height>
                      <Width>0.6cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Dest__Variable__Control1000000143Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Import_Definition_Line__Dest__Variable__Control1000000143Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>23.25cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.5cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line_WidthCaption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Import_Definition_Line_WidthCaption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Right</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>24.9cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.05cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox188">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                    <ColSpan>3</ColSpan>
                  </CellContents>
                </TablixCell>
                <TablixCell />
                <TablixCell />
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>0.423cm</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IndentText__Tag_Name___Indent_">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IndentText__Tag_Name___Indent_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>0cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.95cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line_Type">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition_Line_Type.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>2.1cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.05cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line_Code">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition_Line_Code.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>3.3cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.5cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="PrintTable__Table_No_____Table_Name__">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!PrintTable__Table_No_____Table_Name__.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>4.95cm</Left>
                      <Height>0.423cm</Height>
                      <Width>2.7cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="PrintTable__Field_No_____Field_Name__">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!PrintTable__Field_No_____Field_Name__.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>7.8cm</Left>
                      <Height>0.423cm</Height>
                      <Width>2.7cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Data_Format_">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition_Line__Data_Format_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>10.65cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.2cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Conversion_Code_">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition_Line__Conversion_Code_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>12cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.5cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line_Mandatory">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition_Line_Mandatory.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>13.65cm</Left>
                      <Height>0.423cm</Height>
                      <Width>0.9cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Error_No__Field_Mandatory_">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Code.BlankZero(Fields!IN___Import_Definition_Line__Error_No__Field_Mandatory_.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>14.7cm</Left>
                      <Height>0.423cm</Height>
                      <Width>0.6cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Skip_If_Empty_">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition_Line__Skip_If_Empty_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>15.45cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.05cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Validate_Field_">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition_Line__Validate_Field_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>16.65cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.05cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Save_Record_">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition_Line__Save_Record_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>17.85cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.05cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Existing_Record_">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition_Line__Existing_Record_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>19.05cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.2cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Error_No__Existing_Record_">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Code.BlankZero(Fields!IN___Import_Definition_Line__Error_No__Existing_Record_.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>20.4cm</Left>
                      <Height>0.423cm</Height>
                      <Width>0.6cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__New_Record_">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition_Line__New_Record_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>21.15cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.2cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Error_No__New_Record_">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Code.BlankZero(Fields!IN___Import_Definition_Line__Error_No__New_Record_.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>22.5cm</Left>
                      <Height>0.423cm</Height>
                      <Width>0.6cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Dest__Variable_">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition_Line__Dest__Variable_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>23.25cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.5cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__As_Attribute_">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition_Line__As_Attribute_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>24.9cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.05cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="COMPANYNAME">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!COMPANYNAME.Value</Value>
                              <Style>
                                <Color>#ff0000</Color>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Visibility>
                        <Hidden>true</Hidden>
                      </Visibility>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="CurrReport_PAGENOCaption">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!CurrReport_PAGENOCaption.Value</Value>
                              <Style>
                                <Color>#ff0000</Color>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Visibility>
                        <Hidden>true</Hidden>
                      </Visibility>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="ConnectIT_Import_DefinitionsCaption">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!ConnectIT_Import_DefinitionsCaption.Value</Value>
                              <Style>
                                <Color>#ff0000</Color>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Visibility>
                        <Hidden>true</Hidden>
                      </Visibility>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>0.423cm</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IndentText__Tag_Name___Indent__Control1000000171">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IndentText__Tag_Name___Indent_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>0cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.95cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line_Type_Control1000000169">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition_Line_Type.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>2.1cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.05cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line_Code_Control1000000159">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition_Line_Code.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>3.3cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.5cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="PrintTable__Table_No_____Table_Name___Control1000000167">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!PrintTable__Table_No_____Table_Name__.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>4.95cm</Left>
                      <Height>0.423cm</Height>
                      <Width>2.7cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="PrintTable__Field_No_____Field_Name___Control1000000165">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!PrintTable__Field_No_____Field_Name__.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>7.8cm</Left>
                      <Height>0.423cm</Height>
                      <Width>2.7cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Data_Format__Control1000000163">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition_Line__Data_Format_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>10.65cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.2cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Conversion_Code__Control1000000157">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition_Line__Conversion_Code_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>12cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.5cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line_Mandatory_Control1000000155">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition_Line_Mandatory.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>13.65cm</Left>
                      <Height>0.423cm</Height>
                      <Width>0.9cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Error_No__Field_Mandatory__Control1000049">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Code.BlankZero(Fields!IN___Import_Definition_Line__Error_No__Field_Mandatory_.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>14.7cm</Left>
                      <Height>0.423cm</Height>
                      <Width>0.6cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Skip_If_Empty__Control1000000153">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition_Line__Skip_If_Empty_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>15.45cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.05cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Validate_Field__Control1000000151">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition_Line__Validate_Field_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>16.65cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.05cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Save_Record__Control1000000149">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition_Line__Save_Record_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>17.85cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.05cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Existing_Record__Control1000000147">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition_Line__Existing_Record_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>19.05cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.2cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Error_No__Existing_Record__Control1000055">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Code.BlankZero(Fields!IN___Import_Definition_Line__Error_No__Existing_Record_.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>20.4cm</Left>
                      <Height>0.423cm</Height>
                      <Width>0.6cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__New_Record__Control1000000145">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition_Line__New_Record_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>21.15cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.2cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Error_No__New_Record__Control1000059">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Code.BlankZero(Fields!IN___Import_Definition_Line__Error_No__New_Record_.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>22.5cm</Left>
                      <Height>0.423cm</Height>
                      <Width>0.6cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line__Dest__Variable__Control1000000143">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition_Line__Dest__Variable_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>23.25cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.5cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Import_Definition_Line_Width">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Import_Definition_Line_Width.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>24.9cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.05cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox180">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                    <ColSpan>3</ColSpan>
                  </CellContents>
                </TablixCell>
                <TablixCell />
                <TablixCell />
              </TablixCells>
            </TablixRow>
          </TablixRows>
        </TablixBody>
        <TablixColumnHierarchy>
          <TablixMembers>
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
          </TablixMembers>
        </TablixColumnHierarchy>
        <TablixRowHierarchy>
          <TablixMembers>
            <TablixMember>
              <KeepWithGroup>After</KeepWithGroup>
              <RepeatOnNewPage>true</RepeatOnNewPage>
              <KeepTogether>true</KeepTogether>
            </TablixMember>
            <TablixMember>
              <Group Name="Table1_Group">
                <GroupExpressions>
                  <GroupExpression>=Fields!IN___Import_Definition_Code.Value</GroupExpression>
                </GroupExpressions>
              </Group>
              <TablixMembers>
                <TablixMember>
                  <KeepWithGroup>After</KeepWithGroup>
                  <KeepTogether>true</KeepTogether>
                </TablixMember>
                <TablixMember>
                  <KeepWithGroup>After</KeepWithGroup>
                  <KeepTogether>true</KeepTogether>
                </TablixMember>
                <TablixMember>
                  <KeepWithGroup>After</KeepWithGroup>
                  <KeepTogether>true</KeepTogether>
                </TablixMember>
                <TablixMember>
                  <KeepWithGroup>After</KeepWithGroup>
                  <KeepTogether>true</KeepTogether>
                </TablixMember>
                <TablixMember>
                  <KeepWithGroup>After</KeepWithGroup>
                  <KeepTogether>true</KeepTogether>
                </TablixMember>
                <TablixMember>
                  <KeepWithGroup>After</KeepWithGroup>
                  <KeepTogether>true</KeepTogether>
                </TablixMember>
                <TablixMember>
                  <KeepWithGroup>After</KeepWithGroup>
                  <KeepTogether>true</KeepTogether>
                </TablixMember>
                <TablixMember>
                  <Group Name="Table1_Details_Group">
                    <DataElementName>Detail</DataElementName>
                  </Group>
                  <TablixMembers>
                    <TablixMember />
                    <TablixMember />
                  </TablixMembers>
                  <DataElementName>Detail_Collection</DataElementName>
                  <DataElementOutput>Output</DataElementOutput>
                  <KeepTogether>true</KeepTogether>
                </TablixMember>
              </TablixMembers>
            </TablixMember>
          </TablixMembers>
        </TablixRowHierarchy>
        <DataSetName>DataSet_Result</DataSetName>
        <Top>0cm</Top>
        <Height>5.076cm</Height>
      </Tablix>
    </ReportItems>
    <Height>5cm</Height>
  </Body>
  <Width>26.55cm</Width>
  <Page>
    <PageHeader>
      <Height>1.269cm</Height>
      <PrintOnFirstPage>true</PrintOnFirstPage>
      <PrintOnLastPage>true</PrintOnLastPage>
      <ReportItems>
        <Textbox Name="PageNumberTextBox">
          <KeepTogether>true</KeepTogether>
          <Paragraphs>
            <Paragraph>
              <TextRuns>
                <TextRun>
                  <Value>=Globals!PageNumber</Value>
                  <Style>
                    <FontSize>7pt</FontSize>
                  </Style>
                </TextRun>
              </TextRuns>
              <Style>
                <TextAlign>Right</TextAlign>
              </Style>
            </Paragraph>
          </Paragraphs>
          <Top>0.423cm</Top>
          <Left>25.5cm</Left>
          <Height>0.423cm</Height>
          <Width>0.45cm</Width>
          <Style>
            <VerticalAlign>Middle</VerticalAlign>
          </Style>
        </Textbox>
        <Textbox Name="UserIdTextBox">
          <KeepTogether>true</KeepTogether>
          <Paragraphs>
            <Paragraph>
              <TextRuns>
                <TextRun>
                  <Value>=User!UserID</Value>
                  <Style>
                    <FontSize>7pt</FontSize>
                  </Style>
                </TextRun>
              </TextRuns>
              <Style>
                <TextAlign>Right</TextAlign>
              </Style>
            </Paragraph>
          </Paragraphs>
          <Top>0.846cm</Top>
          <Left>22.7cm</Left>
          <Height>0.423cm</Height>
          <Width>3.25cm</Width>
          <Style>
            <VerticalAlign>Middle</VerticalAlign>
          </Style>
        </Textbox>
        <Textbox Name="ExecutionTimeTextBox">
          <KeepTogether>true</KeepTogether>
          <Paragraphs>
            <Paragraph>
              <TextRuns>
                <TextRun>
                  <Value>=Globals!ExecutionTime</Value>
                  <Style>
                    <FontSize>7pt</FontSize>
                    <Format>g</Format>
                  </Style>
                </TextRun>
              </TextRuns>
              <Style>
                <TextAlign>Right</TextAlign>
              </Style>
            </Paragraph>
          </Paragraphs>
          <Top>0cm</Top>
          <Left>22.8cm</Left>
          <Height>0.423cm</Height>
          <Width>3.15cm</Width>
          <Style>
            <VerticalAlign>Middle</VerticalAlign>
          </Style>
        </Textbox>
        <Textbox Name="COMPANYNAME1">
          <KeepTogether>true</KeepTogether>
          <Paragraphs>
            <Paragraph>
              <TextRuns>
                <TextRun>
                  <Value>=ReportItems!COMPANYNAME.Value</Value>
                  <Style>
                    <FontSize>7pt</FontSize>
                  </Style>
                </TextRun>
              </TextRuns>
            </Paragraph>
          </Paragraphs>
          <Top>0.423cm</Top>
          <Left>0cm</Left>
          <Height>0.423cm</Height>
          <Width>7.5cm</Width>
          <Style>
            <VerticalAlign>Middle</VerticalAlign>
          </Style>
        </Textbox>
        <Textbox Name="CurrReport_PAGENOCaption1">
          <KeepTogether>true</KeepTogether>
          <Paragraphs>
            <Paragraph>
              <TextRuns>
                <TextRun>
                  <Value>=ReportItems!CurrReport_PAGENOCaption.Value</Value>
                  <Style>
                    <FontSize>7pt</FontSize>
                  </Style>
                </TextRun>
              </TextRuns>
            </Paragraph>
          </Paragraphs>
          <Top>0.423cm</Top>
          <Left>24.75cm</Left>
          <Height>0.423cm</Height>
          <Width>0.75cm</Width>
          <Style>
            <VerticalAlign>Middle</VerticalAlign>
          </Style>
        </Textbox>
        <Textbox Name="ConnectIT_Import_DefinitionsCaption1">
          <KeepTogether>true</KeepTogether>
          <Paragraphs>
            <Paragraph>
              <TextRuns>
                <TextRun>
                  <Value>=ReportItems!ConnectIT_Import_DefinitionsCaption.Value</Value>
                  <Style>
                    <FontSize>8pt</FontSize>
                    <FontWeight>Bold</FontWeight>
                  </Style>
                </TextRun>
              </TextRuns>
            </Paragraph>
          </Paragraphs>
          <Top>0cm</Top>
          <Left>0cm</Left>
          <Height>0.423cm</Height>
          <Width>7.5cm</Width>
          <Style>
            <VerticalAlign>Middle</VerticalAlign>
          </Style>
        </Textbox>
      </ReportItems>
    </PageHeader>
    <PageHeight>29.7cm</PageHeight>
    <PageWidth>29.35cm</PageWidth>
    <LeftMargin>2.1cm</LeftMargin>
    <RightMargin>0cm</RightMargin>
    <TopMargin>2cm</TopMargin>
    <BottomMargin>2cm</BottomMargin>
  </Page>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 11117004 CI - Export Definitions
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    CaptionML=ENU=Export Definitions;
  }
  DATASET
  {
    { 5283;    ;DataItem;                    ;
               DataItemTable=Table11148599;
               DataItemTableView=SORTING(Code);
               ReqFilterFields=Code }

    { 1000000000;1;Column;USERID             ;
               SourceExpr=USERID }

    { 1000000002;1;Column;CurrReport_PAGENO  ;
               SourceExpr=CurrReport.PAGENO }

    { 1000000003;1;Column;FORMAT_TODAY_0_4_  ;
               SourceExpr=FORMAT(TODAY,0,4) }

    { 1000000005;1;Column;COMPANYNAME        ;
               SourceExpr=COMPANYNAME }

    { 1000000036;1;Column;IN___Export_Definition__Run_Codeunit_No__;
               SourceExpr="Run Codeunit No." }

    { 1000000028;1;Column;IN___Export_Definition__Save_to_Messages_;
               SourceExpr="Save to Messages" }

    { 1000000016;1;Column;IN___Export_Definition_Filename;
               SourceExpr=Filename }

    { 1000000010;1;Column;IN___Export_Definition_Location;
               SourceExpr=Location }

    { 1000000026;1;Column;IN___Export_Definition_Headers;
               SourceExpr=Headers }

    { 1000000008;1;Column;IN___Export_Definition_Description;
               SourceExpr=Description }

    { 1000000024;1;Column;IN___Export_Definition__File_Format_;
               SourceExpr="File Format" }

    { 1000000006;1;Column;IN___Export_Definition_Code;
               SourceExpr=Code }

    { 1000000020;1;Column;IN___Export_Definition_Status;
               SourceExpr=Status }

    { 1000004;1;Column  ;IN___Export_Definition__Field_Separator_;
               SourceExpr="Field Separator" }

    { 1000007;1;Column  ;IN___Export_Definition__Field_Delimiter_;
               SourceExpr="Field Delimiter" }

    { 1000002;1;Column  ;IN___Export_Definition__XML_Declaration_;
               SourceExpr="XML Declaration" }

    { 1000008;1;Column  ;IN___Export_Definition__One_File_per_Record_;
               SourceExpr="One File per Record" }

    { 1000000001;1;Column;CurrReport_PAGENOCaption;
               SourceExpr=CurrReport_PAGENOCaptionLbl }

    { 1000000004;1;Column;ConnectIT_Export_DefinitionsCaption;
               SourceExpr=ConnectIT_Export_DefinitionsCaptionLbl }

    { 1000000037;1;Column;IN___Export_Definition__Run_Codeunit_No__Caption;
               SourceExpr=FIELDCAPTION("Run Codeunit No.") }

    { 1000000029;1;Column;IN___Export_Definition__Save_to_Messages_Caption;
               SourceExpr=FIELDCAPTION("Save to Messages") }

    { 1000000017;1;Column;IN___Export_Definition_FilenameCaption;
               SourceExpr=FIELDCAPTION(Filename) }

    { 1000000011;1;Column;IN___Export_Definition_LocationCaption;
               SourceExpr=FIELDCAPTION(Location) }

    { 1000000027;1;Column;IN___Export_Definition_HeadersCaption;
               SourceExpr=FIELDCAPTION(Headers) }

    { 1000000009;1;Column;IN___Export_Definition_DescriptionCaption;
               SourceExpr=FIELDCAPTION(Description) }

    { 1000000025;1;Column;IN___Export_Definition__File_Format_Caption;
               SourceExpr=FIELDCAPTION("File Format") }

    { 1000000007;1;Column;IN___Export_Definition_CodeCaption;
               SourceExpr=FIELDCAPTION(Code) }

    { 1000000021;1;Column;IN___Export_Definition_StatusCaption;
               SourceExpr=FIELDCAPTION(Status) }

    { 1000005;1;Column  ;IN___Export_Definition__Field_Separator_Caption;
               SourceExpr=FIELDCAPTION("Field Separator") }

    { 1000006;1;Column  ;IN___Export_Definition__Field_Delimiter_Caption;
               SourceExpr=FIELDCAPTION("Field Delimiter") }

    { 1000003;1;Column  ;IN___Export_Definition__XML_Declaration_Caption;
               SourceExpr=FIELDCAPTION("XML Declaration") }

    { 1000011;1;Column  ;IN___Export_Definition__One_File_per_Record_Caption;
               SourceExpr=FIELDCAPTION("One File per Record") }

    { 6863;1   ;DataItem;                    ;
               DataItemTable=Table11148600;
               DataItemTableView=SORTING(Export Definition,Line No.);
               OnAfterGetRecord=VAR
                                  Mgt@1000000 : Codeunit 11148589;
                                BEGIN
                                  TableFilter := SYSTEM.FORMAT("Table Filter");
                                  Mgt.FormatTableFilter(TableFilter, "Table No.");
                                END;

               CalcFields=Table Name,Field Name;
               DataItemLink=Export Definition=FIELD(Code) }

    { 1000000018;2;Column;IndentText__Tag_Name___Indent_;
               SourceExpr=IndentText("Tag Name", Indent) }

    { 1000000022;2;Column;IN___Export_Definition_Line_Type;
               OptionCaptionML=ENU=" ,Tag,Table,Value,Const,Variable";
               OptionString=[ ,Tag,Table,Value,Const,Variable];
               SourceExpr=Type }

    { 1000000040;2;Column;PrintTable__Table_No_____Table_Name__;
               SourceExpr=PrintTable("Table No.", "Table Name") }

    { 1000000044;2;Column;PrintTable__Field_No_____Field_Name__;
               SourceExpr=PrintTable("Field No.", "Field Name") }

    { 1000000074;2;Column;IN___Export_Definition_Line__Conversion_Code_;
               SourceExpr="Conversion Code" }

    { 1000000080;2;Column;IN___Export_Definition_Line_Code;
               SourceExpr=Code }

    { 1000000072;2;Column;IN___Export_Definition_Line__Data_Format_;
               OptionCaptionML=ENU=" ,Navision,XML";
               SourceExpr="Data Format" }

    { 1000000038;2;Column;IN___Export_Definition_Line__As_Attribute_;
               SourceExpr="As Attribute" }

    { 1000023;2;Column  ;TableFilter         ;
               SourceExpr=TableFilter }

    { 1000025;2;Column  ;IN___Export_Definition_Line__Before_Field_;
               SourceExpr="Before Field" }

    { 1000027;2;Column  ;IN___Export_Definition_Line__After_Field_;
               SourceExpr="After Field" }

    { 1000000121;2;Column;IndentText__Tag_Name___Indent__Control1000000121;
               SourceExpr=IndentText("Tag Name", Indent) }

    { 1000000122;2;Column;IN___Export_Definition_Line_Type_Control1000000122;
               OptionCaptionML=ENU=" ,Tag,Table,Value,Const,Variable";
               OptionString=[ ,Tag,Table,Value,Const,Variable];
               SourceExpr=Type }

    { 1000000123;2;Column;PrintTable__Table_No_____Table_Name___Control1000000123;
               SourceExpr=PrintTable("Table No.", "Table Name") }

    { 1000000124;2;Column;PrintTable__Field_No_____Field_Name___Control1000000124;
               SourceExpr=PrintTable("Field No.", "Field Name") }

    { 1000000125;2;Column;IN___Export_Definition_Line__Conversion_Code__Control1000000125;
               SourceExpr="Conversion Code" }

    { 1000000128;2;Column;IN___Export_Definition_Line_Code_Control1000000128;
               SourceExpr=Code }

    { 1000000135;2;Column;IN___Export_Definition_Line__Data_Format__Control1000000135;
               OptionCaptionML=ENU=" ,Navision,XML";
               SourceExpr="Data Format" }

    { 1000000;2;Column  ;TableFilter_Control1000000;
               SourceExpr=TableFilter }

    { 1000029;2;Column  ;IN___Export_Definition_Line__After_Field__Control1000029;
               SourceExpr="After Field" }

    { 1000030;2;Column  ;IN___Export_Definition_Line__Before_Field__Control1000030;
               SourceExpr="Before Field" }

    { 1000000138;2;Column;IN___Export_Definition_Line_Width;
               SourceExpr=Width }

    { 1000000157;2;Column;IN___Export_Definition_Line__Conversion_Code__Control1000000157;
               SourceExpr="Conversion Code" }

    { 1000000159;2;Column;IN___Export_Definition_Line_Code_Control1000000159;
               SourceExpr=Code }

    { 1000000163;2;Column;IN___Export_Definition_Line__Data_Format__Control1000000163;
               OptionCaptionML=ENU=" ,Navision,XML";
               SourceExpr="Data Format" }

    { 1000000165;2;Column;PrintTable__Field_No_____Field_Name___Control1000000165;
               SourceExpr=PrintTable("Field No.", "Field Name") }

    { 1000000167;2;Column;PrintTable__Table_No_____Table_Name___Control1000000167;
               SourceExpr=PrintTable("Table No.", "Table Name") }

    { 1000000169;2;Column;IN___Export_Definition_Line_Type_Control1000000169;
               OptionCaptionML=ENU=" ,Tag,Table,Value,Const,Variable";
               OptionString=[ ,Tag,Table,Value,Const,Variable];
               SourceExpr=Type }

    { 1000000171;2;Column;IndentText__Tag_Name___Indent__Control1000000171;
               SourceExpr=IndentText("Tag Name", Indent) }

    { 1000001;2;Column  ;TableFilter_Control1000001;
               SourceExpr=TableFilter }

    { 1000031;2;Column  ;IN___Export_Definition_Line__After_Field__Control1000031;
               SourceExpr="After Field" }

    { 1000032;2;Column  ;IN___Export_Definition_Line__Before_Field__Control1000032;
               SourceExpr="Before Field" }

    { 1000018;2;Column  ;IN___Export_Definition_Line_Alignment;
               OptionCaptionML=ENU=Left,Right;
               OptionString=Left,Right;
               SourceExpr=Alignment }

    { 1000000039;2;Column;IN___Export_Definition_Line__As_Attribute_Caption;
               SourceExpr=FIELDCAPTION("As Attribute") }

    { 1000000075;2;Column;IN___Export_Definition_Line__Conversion_Code_Caption;
               SourceExpr=FIELDCAPTION("Conversion Code") }

    { 1000000081;2;Column;IN___Export_Definition_Line_CodeCaption;
               SourceExpr=FIELDCAPTION(Code) }

    { 1000000073;2;Column;IN___Export_Definition_Line__Data_Format_Caption;
               SourceExpr=FIELDCAPTION("Data Format") }

    { 1000000045;2;Column;PrintTable__Field_No_____Field_Name__Caption;
               SourceExpr=PrintTable__Field_No_____Field_Name__CaptionLbl }

    { 1000000041;2;Column;PrintTable__Table_No_____Table_Name__Caption;
               SourceExpr=PrintTable__Table_No_____Table_Name__CaptionLbl }

    { 1000000023;2;Column;IN___Export_Definition_Line_TypeCaption;
               SourceExpr=FIELDCAPTION(Type) }

    { 1000000019;2;Column;IndentText__Tag_Name___Indent_Caption;
               SourceExpr=IndentText__Tag_Name___Indent_CaptionLbl }

    { 1000024;2;Column  ;TableFilterCaption  ;
               SourceExpr=TableFilterCaptionLbl }

    { 1000026;2;Column  ;IN___Export_Definition_Line__Before_Field_Caption;
               SourceExpr=FIELDCAPTION("Before Field") }

    { 1000028;2;Column  ;IN___Export_Definition_Line__After_Field_Caption;
               SourceExpr=FIELDCAPTION("After Field") }

    { 1000000113;2;Column;IN___Export_Definition_Line__Conversion_Code__Control1000000125Caption;
               SourceExpr=FIELDCAPTION("Conversion Code") }

    { 1000000114;2;Column;IN___Export_Definition_Line_Code_Control1000000128Caption;
               SourceExpr=FIELDCAPTION(Code) }

    { 1000000116;2;Column;IN___Export_Definition_Line__Data_Format__Control1000000135Caption;
               SourceExpr=FIELDCAPTION("Data Format") }

    { 1000000117;2;Column;PrintTable__Field_No_____Field_Name___Control1000000124Caption;
               SourceExpr=PrintTable__Field_No_____Field_Name___Control1000000124CaptionLbl }

    { 1000000118;2;Column;PrintTable__Table_No_____Table_Name___Control1000000123Caption;
               SourceExpr=PrintTable__Table_No_____Table_Name___Control1000000123CaptionLbl }

    { 1000000119;2;Column;IN___Export_Definition_Line_Type_Control1000000122Caption;
               SourceExpr=FIELDCAPTION(Type) }

    { 1000000120;2;Column;IndentText__Tag_Name___Indent__Control1000000121Caption;
               SourceExpr=IndentText__Tag_Name___Indent__Control1000000121CaptionLbl }

    { 1000033;2;Column  ;IN___Export_Definition_Line__Before_Field__Control1000030Caption;
               SourceExpr=FIELDCAPTION("Before Field") }

    { 1000034;2;Column  ;IN___Export_Definition_Line__After_Field__Control1000029Caption;
               SourceExpr=FIELDCAPTION("After Field") }

    { 1000037;2;Column  ;TableFilter_Control1000000Caption;
               SourceExpr=TableFilter_Control1000000CaptionLbl }

    { 1000000139;2;Column;IN___Export_Definition_Line_WidthCaption;
               SourceExpr=FIELDCAPTION(Width) }

    { 1000000156;2;Column;IN___Export_Definition_Line__Conversion_Code__Control1000000157Caption;
               SourceExpr=FIELDCAPTION("Conversion Code") }

    { 1000000158;2;Column;IN___Export_Definition_Line_Code_Control1000000159Caption;
               SourceExpr=FIELDCAPTION(Code) }

    { 1000000162;2;Column;IN___Export_Definition_Line__Data_Format__Control1000000163Caption;
               SourceExpr=FIELDCAPTION("Data Format") }

    { 1000000164;2;Column;PrintTable__Field_No_____Field_Name___Control1000000165Caption;
               SourceExpr=PrintTable__Field_No_____Field_Name___Control1000000165CaptionLbl }

    { 1000000166;2;Column;PrintTable__Table_No_____Table_Name___Control1000000167Caption;
               SourceExpr=PrintTable__Table_No_____Table_Name___Control1000000167CaptionLbl }

    { 1000000168;2;Column;IN___Export_Definition_Line_Type_Control1000000169Caption;
               SourceExpr=FIELDCAPTION(Type) }

    { 1000000170;2;Column;IndentText__Tag_Name___Indent__Control1000000171Caption;
               SourceExpr=IndentText__Tag_Name___Indent__Control1000000171CaptionLbl }

    { 1000022;2;Column  ;IN___Export_Definition_Line_AlignmentCaption;
               SourceExpr=FIELDCAPTION(Alignment) }

    { 1000035;2;Column  ;IN___Export_Definition_Line__Before_Field__Control1000032Caption;
               SourceExpr=FIELDCAPTION("Before Field") }

    { 1000036;2;Column  ;IN___Export_Definition_Line__After_Field__Control1000031Caption;
               SourceExpr=FIELDCAPTION("After Field") }

    { 1000038;2;Column  ;TableFilter_Control1000001Caption;
               SourceExpr=TableFilter_Control1000001CaptionLbl }

    { 5873;2   ;Column  ;IN___Export_Definition_Line_Export_Definition;
               SourceExpr="Export Definition" }

    { 3911;2   ;Column  ;IN___Export_Definition_Line_Entry_No_;
               SourceExpr="Entry No." }

    { 8948;1   ;DataItem;ExportDefinitionLineLinks;
               DataItemTable=Table11148600;
               DataItemTableView=SORTING(Export Definition,Line No.);
               OnAfterGetRecord=BEGIN
                                  LinkCounter := 0;
                                END;

               CalcFields=Table Name,Field Name;
               DataItemLink=Export Definition=FIELD(Code) }

    { 1000016;2;Column  ;Table_LinkCaption   ;
               SourceExpr=Table_LinkCaptionLbl }

    { 1000017;2;Column  ;ExportDefinitionLineLinks__Link_to_Table__Tag_Name__Caption;
               SourceExpr=ExportDefinitionLineLinks__Link_to_Table__Tag_Name__CaptionLbl }

    { 1000019;2;Column  ;ExportDefinitionLineLinks__Tag_Name_Caption;
               SourceExpr=ExportDefinitionLineLinks__Tag_Name_CaptionLbl }

    { 1000020;2;Column  ;PrintTable__Main_Field_No_____Main_Field_Name__Caption;
               SourceExpr=PrintTable__Main_Field_No_____Main_Field_Name__CaptionLbl }

    { 1000021;2;Column  ;PrintTable__Sub_Field_No_____Sub_Field_Name__Caption;
               SourceExpr=PrintTable__Sub_Field_No_____Sub_Field_Name__CaptionLbl }

    { 2938;2   ;Column  ;ExportDefinitionLineLinks_Export_Definition;
               SourceExpr="Export Definition" }

    { 5893;2   ;Column  ;ExportDefinitionLineLinks_Entry_No_;
               SourceExpr="Entry No." }

    { 2509;2   ;DataItem;                    ;
               DataItemTable=Table11148601;
               DataItemTableView=SORTING(Export Definition,Export Def. Entry No.,Main Field No.);
               OnAfterGetRecord=BEGIN
                                  LinkCounter += 1;
                                END;

               CalcFields=Main Field Name,Sub Field Name;
               DataItemLink=Export Definition=FIELD(Export Definition),
                            Export Def. Entry No.=FIELD(Entry No.) }

    { 1000009;3;Column  ;PrintTable__Main_Field_No_____Main_Field_Name__;
               SourceExpr=PrintTable("Main Field No.", "Main Field Name") }

    { 1000015;3;Column  ;PrintTable__Sub_Field_No_____Sub_Field_Name__;
               SourceExpr=PrintTable("Sub Field No.", "Sub Field Name") }

    { 1000014;3;Column  ;ExportDefinitionLineLinks__Tag_Name_;
               SourceExpr=ExportDefinitionLineLinks."Tag Name" }

    { 1000010;3;Column  ;ExportDefinitionLineLinks__Link_to_Table__Tag_Name__;
               SourceExpr=ExportDefinitionLineLinks."Link to Table (Tag Name)" }

    { 1000012;3;Column  ;PrintTable__Main_Field_No_____Main_Field_Name___Control1000012;
               SourceExpr=PrintTable("Main Field No.", "Main Field Name") }

    { 1000013;3;Column  ;PrintTable__Sub_Field_No_____Sub_Field_Name___Control1000013;
               SourceExpr=PrintTable("Sub Field No.", "Sub Field Name") }

    { 1201;3   ;Column  ;IN___Export_Def__Table_Link_Export_Definition;
               SourceExpr="Export Definition" }

    { 3531;3   ;Column  ;IN___Export_Def__Table_Link_Export_Def__Entry_No_;
               SourceExpr="Export Def. Entry No." }

    { 3397;3   ;Column  ;IN___Export_Def__Table_Link_Main_Field_No_;
               SourceExpr="Main Field No." }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      TableFilter@1000000 : Text[1024];
      LinkCounter@1000001 : Integer;
      CurrReport_PAGENOCaptionLbl@1000897509 : TextConst 'ENU=Page';
      ConnectIT_Export_DefinitionsCaptionLbl@1000504755 : TextConst 'ENU=ConnectIT Export Definitions';
      PrintTable__Field_No_____Field_Name__CaptionLbl@1000820882 : TextConst 'ENU=Field';
      PrintTable__Table_No_____Table_Name__CaptionLbl@1000582887 : TextConst 'ENU=Table';
      IndentText__Tag_Name___Indent_CaptionLbl@1000465896 : TextConst 'ENU=Tag Name';
      TableFilterCaptionLbl@1003610 : TextConst 'ENU=Table Filter';
      PrintTable__Field_No_____Field_Name___Control1000000124CaptionLbl@1000462612 : TextConst 'ENU=Field';
      PrintTable__Table_No_____Table_Name___Control1000000123CaptionLbl@1000774950 : TextConst 'ENU=Table';
      IndentText__Tag_Name___Indent__Control1000000121CaptionLbl@1000665388 : TextConst 'ENU=Tag Name';
      TableFilter_Control1000000CaptionLbl@1007735 : TextConst 'ENU=Table Filter';
      PrintTable__Field_No_____Field_Name___Control1000000165CaptionLbl@1000744930 : TextConst 'ENU=Field';
      PrintTable__Table_No_____Table_Name___Control1000000167CaptionLbl@1000470515 : TextConst 'ENU=Table';
      IndentText__Tag_Name___Indent__Control1000000171CaptionLbl@1000687596 : TextConst 'ENU=Tag Name';
      TableFilter_Control1000001CaptionLbl@1007559 : TextConst 'ENU=Table Filter';
      Table_LinkCaptionLbl@1004585 : TextConst 'ENU=Table Link';
      ExportDefinitionLineLinks__Link_to_Table__Tag_Name__CaptionLbl@1007855 : TextConst 'ENU=Main Table Tag';
      ExportDefinitionLineLinks__Tag_Name_CaptionLbl@1005979 : TextConst 'ENU=Sub Table Tag';
      PrintTable__Main_Field_No_____Main_Field_Name__CaptionLbl@1007817 : TextConst 'ENU=Main Field';
      PrintTable__Sub_Field_No_____Sub_Field_Name__CaptionLbl@1003298 : TextConst 'ENU=Sub Field';

    LOCAL PROCEDURE PrintTable@1000000000(TableNo@1000000000 : Integer;TableName@1000000001 : Text[30]) : Text[50];
    BEGIN
      IF TableNo <> 0 THEN
        EXIT(FORMAT(TableNo) + ' - ' + TableName);
    END;

    LOCAL PROCEDURE IndentText@1000000001(Text@1000000000 : Text[1024];Indent@1000000001 : Integer) ExitValue : Text[1024];
    VAR
      i@1000000002 : Integer;
    BEGIN
      FOR i := 1 TO Indent DO
        ExitValue += '  ';

      ExitValue += Text;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2008/01/reportdefinition">
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>53e0dff6-1f24-4638-9816-ddf496dd0759</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="DataSet_Result">
      <Query>
        <DataSourceName>DataSource</DataSourceName>
        <CommandText />
      </Query>
      <Fields>
        <Field Name="USERID">
          <DataField>USERID</DataField>
        </Field>
        <Field Name="CurrReport_PAGENO">
          <DataField>CurrReport_PAGENO</DataField>
        </Field>
        <Field Name="FORMAT_TODAY_0_4_">
          <DataField>FORMAT_TODAY_0_4_</DataField>
        </Field>
        <Field Name="COMPANYNAME">
          <DataField>COMPANYNAME</DataField>
        </Field>
        <Field Name="IN___Export_Definition__Run_Codeunit_No__">
          <DataField>IN___Export_Definition__Run_Codeunit_No__</DataField>
        </Field>
        <Field Name="IN___Export_Definition__Save_to_Messages_">
          <DataField>IN___Export_Definition__Save_to_Messages_</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Filename">
          <DataField>IN___Export_Definition_Filename</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Location">
          <DataField>IN___Export_Definition_Location</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Headers">
          <DataField>IN___Export_Definition_Headers</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Description">
          <DataField>IN___Export_Definition_Description</DataField>
        </Field>
        <Field Name="IN___Export_Definition__File_Format_">
          <DataField>IN___Export_Definition__File_Format_</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Code">
          <DataField>IN___Export_Definition_Code</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Status">
          <DataField>IN___Export_Definition_Status</DataField>
        </Field>
        <Field Name="IN___Export_Definition__Field_Separator_">
          <DataField>IN___Export_Definition__Field_Separator_</DataField>
        </Field>
        <Field Name="IN___Export_Definition__Field_Delimiter_">
          <DataField>IN___Export_Definition__Field_Delimiter_</DataField>
        </Field>
        <Field Name="IN___Export_Definition__XML_Declaration_">
          <DataField>IN___Export_Definition__XML_Declaration_</DataField>
        </Field>
        <Field Name="IN___Export_Definition__One_File_per_Record_">
          <DataField>IN___Export_Definition__One_File_per_Record_</DataField>
        </Field>
        <Field Name="CurrReport_PAGENOCaption">
          <DataField>CurrReport_PAGENOCaption</DataField>
        </Field>
        <Field Name="ConnectIT_Export_DefinitionsCaption">
          <DataField>ConnectIT_Export_DefinitionsCaption</DataField>
        </Field>
        <Field Name="IN___Export_Definition__Run_Codeunit_No__Caption">
          <DataField>IN___Export_Definition__Run_Codeunit_No__Caption</DataField>
        </Field>
        <Field Name="IN___Export_Definition__Save_to_Messages_Caption">
          <DataField>IN___Export_Definition__Save_to_Messages_Caption</DataField>
        </Field>
        <Field Name="IN___Export_Definition_FilenameCaption">
          <DataField>IN___Export_Definition_FilenameCaption</DataField>
        </Field>
        <Field Name="IN___Export_Definition_LocationCaption">
          <DataField>IN___Export_Definition_LocationCaption</DataField>
        </Field>
        <Field Name="IN___Export_Definition_HeadersCaption">
          <DataField>IN___Export_Definition_HeadersCaption</DataField>
        </Field>
        <Field Name="IN___Export_Definition_DescriptionCaption">
          <DataField>IN___Export_Definition_DescriptionCaption</DataField>
        </Field>
        <Field Name="IN___Export_Definition__File_Format_Caption">
          <DataField>IN___Export_Definition__File_Format_Caption</DataField>
        </Field>
        <Field Name="IN___Export_Definition_CodeCaption">
          <DataField>IN___Export_Definition_CodeCaption</DataField>
        </Field>
        <Field Name="IN___Export_Definition_StatusCaption">
          <DataField>IN___Export_Definition_StatusCaption</DataField>
        </Field>
        <Field Name="IN___Export_Definition__Field_Separator_Caption">
          <DataField>IN___Export_Definition__Field_Separator_Caption</DataField>
        </Field>
        <Field Name="IN___Export_Definition__Field_Delimiter_Caption">
          <DataField>IN___Export_Definition__Field_Delimiter_Caption</DataField>
        </Field>
        <Field Name="IN___Export_Definition__XML_Declaration_Caption">
          <DataField>IN___Export_Definition__XML_Declaration_Caption</DataField>
        </Field>
        <Field Name="IN___Export_Definition__One_File_per_Record_Caption">
          <DataField>IN___Export_Definition__One_File_per_Record_Caption</DataField>
        </Field>
        <Field Name="IndentText__Tag_Name___Indent_">
          <DataField>IndentText__Tag_Name___Indent_</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line_Type">
          <DataField>IN___Export_Definition_Line_Type</DataField>
        </Field>
        <Field Name="PrintTable__Table_No_____Table_Name__">
          <DataField>PrintTable__Table_No_____Table_Name__</DataField>
        </Field>
        <Field Name="PrintTable__Field_No_____Field_Name__">
          <DataField>PrintTable__Field_No_____Field_Name__</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line__Conversion_Code_">
          <DataField>IN___Export_Definition_Line__Conversion_Code_</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line_Code">
          <DataField>IN___Export_Definition_Line_Code</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line__Data_Format_">
          <DataField>IN___Export_Definition_Line__Data_Format_</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line__As_Attribute_">
          <DataField>IN___Export_Definition_Line__As_Attribute_</DataField>
        </Field>
        <Field Name="TableFilter">
          <DataField>TableFilter</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line__Before_Field_">
          <DataField>IN___Export_Definition_Line__Before_Field_</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line__After_Field_">
          <DataField>IN___Export_Definition_Line__After_Field_</DataField>
        </Field>
        <Field Name="IndentText__Tag_Name___Indent__Control1000000121">
          <DataField>IndentText__Tag_Name___Indent__Control1000000121</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line_Type_Control1000000122">
          <DataField>IN___Export_Definition_Line_Type_Control1000000122</DataField>
        </Field>
        <Field Name="PrintTable__Table_No_____Table_Name___Control1000000123">
          <DataField>PrintTable__Table_No_____Table_Name___Control1000000123</DataField>
        </Field>
        <Field Name="PrintTable__Field_No_____Field_Name___Control1000000124">
          <DataField>PrintTable__Field_No_____Field_Name___Control1000000124</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line__Conversion_Code__Control1000000125">
          <DataField>IN___Export_Definition_Line__Conversion_Code__Control1000000125</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line_Code_Control1000000128">
          <DataField>IN___Export_Definition_Line_Code_Control1000000128</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line__Data_Format__Control1000000135">
          <DataField>IN___Export_Definition_Line__Data_Format__Control1000000135</DataField>
        </Field>
        <Field Name="TableFilter_Control1000000">
          <DataField>TableFilter_Control1000000</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line__After_Field__Control1000029">
          <DataField>IN___Export_Definition_Line__After_Field__Control1000029</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line__Before_Field__Control1000030">
          <DataField>IN___Export_Definition_Line__Before_Field__Control1000030</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line_Width">
          <DataField>IN___Export_Definition_Line_Width</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line__Conversion_Code__Control1000000157">
          <DataField>IN___Export_Definition_Line__Conversion_Code__Control1000000157</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line_Code_Control1000000159">
          <DataField>IN___Export_Definition_Line_Code_Control1000000159</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line__Data_Format__Control1000000163">
          <DataField>IN___Export_Definition_Line__Data_Format__Control1000000163</DataField>
        </Field>
        <Field Name="PrintTable__Field_No_____Field_Name___Control1000000165">
          <DataField>PrintTable__Field_No_____Field_Name___Control1000000165</DataField>
        </Field>
        <Field Name="PrintTable__Table_No_____Table_Name___Control1000000167">
          <DataField>PrintTable__Table_No_____Table_Name___Control1000000167</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line_Type_Control1000000169">
          <DataField>IN___Export_Definition_Line_Type_Control1000000169</DataField>
        </Field>
        <Field Name="IndentText__Tag_Name___Indent__Control1000000171">
          <DataField>IndentText__Tag_Name___Indent__Control1000000171</DataField>
        </Field>
        <Field Name="TableFilter_Control1000001">
          <DataField>TableFilter_Control1000001</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line__After_Field__Control1000031">
          <DataField>IN___Export_Definition_Line__After_Field__Control1000031</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line__Before_Field__Control1000032">
          <DataField>IN___Export_Definition_Line__Before_Field__Control1000032</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line_Alignment">
          <DataField>IN___Export_Definition_Line_Alignment</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line__As_Attribute_Caption">
          <DataField>IN___Export_Definition_Line__As_Attribute_Caption</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line__Conversion_Code_Caption">
          <DataField>IN___Export_Definition_Line__Conversion_Code_Caption</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line_CodeCaption">
          <DataField>IN___Export_Definition_Line_CodeCaption</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line__Data_Format_Caption">
          <DataField>IN___Export_Definition_Line__Data_Format_Caption</DataField>
        </Field>
        <Field Name="PrintTable__Field_No_____Field_Name__Caption">
          <DataField>PrintTable__Field_No_____Field_Name__Caption</DataField>
        </Field>
        <Field Name="PrintTable__Table_No_____Table_Name__Caption">
          <DataField>PrintTable__Table_No_____Table_Name__Caption</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line_TypeCaption">
          <DataField>IN___Export_Definition_Line_TypeCaption</DataField>
        </Field>
        <Field Name="IndentText__Tag_Name___Indent_Caption">
          <DataField>IndentText__Tag_Name___Indent_Caption</DataField>
        </Field>
        <Field Name="TableFilterCaption">
          <DataField>TableFilterCaption</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line__Before_Field_Caption">
          <DataField>IN___Export_Definition_Line__Before_Field_Caption</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line__After_Field_Caption">
          <DataField>IN___Export_Definition_Line__After_Field_Caption</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line__Conversion_Code__Control1000000125Caption">
          <DataField>IN___Export_Definition_Line__Conversion_Code__Control1000000125Caption</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line_Code_Control1000000128Caption">
          <DataField>IN___Export_Definition_Line_Code_Control1000000128Caption</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line__Data_Format__Control1000000135Caption">
          <DataField>IN___Export_Definition_Line__Data_Format__Control1000000135Caption</DataField>
        </Field>
        <Field Name="PrintTable__Field_No_____Field_Name___Control1000000124Caption">
          <DataField>PrintTable__Field_No_____Field_Name___Control1000000124Caption</DataField>
        </Field>
        <Field Name="PrintTable__Table_No_____Table_Name___Control1000000123Caption">
          <DataField>PrintTable__Table_No_____Table_Name___Control1000000123Caption</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line_Type_Control1000000122Caption">
          <DataField>IN___Export_Definition_Line_Type_Control1000000122Caption</DataField>
        </Field>
        <Field Name="IndentText__Tag_Name___Indent__Control1000000121Caption">
          <DataField>IndentText__Tag_Name___Indent__Control1000000121Caption</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line__Before_Field__Control1000030Caption">
          <DataField>IN___Export_Definition_Line__Before_Field__Control1000030Caption</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line__After_Field__Control1000029Caption">
          <DataField>IN___Export_Definition_Line__After_Field__Control1000029Caption</DataField>
        </Field>
        <Field Name="TableFilter_Control1000000Caption">
          <DataField>TableFilter_Control1000000Caption</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line_WidthCaption">
          <DataField>IN___Export_Definition_Line_WidthCaption</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line__Conversion_Code__Control1000000157Caption">
          <DataField>IN___Export_Definition_Line__Conversion_Code__Control1000000157Caption</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line_Code_Control1000000159Caption">
          <DataField>IN___Export_Definition_Line_Code_Control1000000159Caption</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line__Data_Format__Control1000000163Caption">
          <DataField>IN___Export_Definition_Line__Data_Format__Control1000000163Caption</DataField>
        </Field>
        <Field Name="PrintTable__Field_No_____Field_Name___Control1000000165Caption">
          <DataField>PrintTable__Field_No_____Field_Name___Control1000000165Caption</DataField>
        </Field>
        <Field Name="PrintTable__Table_No_____Table_Name___Control1000000167Caption">
          <DataField>PrintTable__Table_No_____Table_Name___Control1000000167Caption</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line_Type_Control1000000169Caption">
          <DataField>IN___Export_Definition_Line_Type_Control1000000169Caption</DataField>
        </Field>
        <Field Name="IndentText__Tag_Name___Indent__Control1000000171Caption">
          <DataField>IndentText__Tag_Name___Indent__Control1000000171Caption</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line_AlignmentCaption">
          <DataField>IN___Export_Definition_Line_AlignmentCaption</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line__Before_Field__Control1000032Caption">
          <DataField>IN___Export_Definition_Line__Before_Field__Control1000032Caption</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line__After_Field__Control1000031Caption">
          <DataField>IN___Export_Definition_Line__After_Field__Control1000031Caption</DataField>
        </Field>
        <Field Name="TableFilter_Control1000001Caption">
          <DataField>TableFilter_Control1000001Caption</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line_Export_Definition">
          <DataField>IN___Export_Definition_Line_Export_Definition</DataField>
        </Field>
        <Field Name="IN___Export_Definition_Line_Entry_No_">
          <DataField>IN___Export_Definition_Line_Entry_No_</DataField>
        </Field>
        <Field Name="Table_LinkCaption">
          <DataField>Table_LinkCaption</DataField>
        </Field>
        <Field Name="ExportDefinitionLineLinks__Link_to_Table__Tag_Name__Caption">
          <DataField>ExportDefinitionLineLinks__Link_to_Table__Tag_Name__Caption</DataField>
        </Field>
        <Field Name="ExportDefinitionLineLinks__Tag_Name_Caption">
          <DataField>ExportDefinitionLineLinks__Tag_Name_Caption</DataField>
        </Field>
        <Field Name="PrintTable__Main_Field_No_____Main_Field_Name__Caption">
          <DataField>PrintTable__Main_Field_No_____Main_Field_Name__Caption</DataField>
        </Field>
        <Field Name="PrintTable__Sub_Field_No_____Sub_Field_Name__Caption">
          <DataField>PrintTable__Sub_Field_No_____Sub_Field_Name__Caption</DataField>
        </Field>
        <Field Name="ExportDefinitionLineLinks_Export_Definition">
          <DataField>ExportDefinitionLineLinks_Export_Definition</DataField>
        </Field>
        <Field Name="ExportDefinitionLineLinks_Entry_No_">
          <DataField>ExportDefinitionLineLinks_Entry_No_</DataField>
        </Field>
        <Field Name="PrintTable__Main_Field_No_____Main_Field_Name__">
          <DataField>PrintTable__Main_Field_No_____Main_Field_Name__</DataField>
        </Field>
        <Field Name="PrintTable__Sub_Field_No_____Sub_Field_Name__">
          <DataField>PrintTable__Sub_Field_No_____Sub_Field_Name__</DataField>
        </Field>
        <Field Name="ExportDefinitionLineLinks__Tag_Name_">
          <DataField>ExportDefinitionLineLinks__Tag_Name_</DataField>
        </Field>
        <Field Name="ExportDefinitionLineLinks__Link_to_Table__Tag_Name__">
          <DataField>ExportDefinitionLineLinks__Link_to_Table__Tag_Name__</DataField>
        </Field>
        <Field Name="PrintTable__Main_Field_No_____Main_Field_Name___Control1000012">
          <DataField>PrintTable__Main_Field_No_____Main_Field_Name___Control1000012</DataField>
        </Field>
        <Field Name="PrintTable__Sub_Field_No_____Sub_Field_Name___Control1000013">
          <DataField>PrintTable__Sub_Field_No_____Sub_Field_Name___Control1000013</DataField>
        </Field>
        <Field Name="IN___Export_Def__Table_Link_Export_Definition">
          <DataField>IN___Export_Def__Table_Link_Export_Definition</DataField>
        </Field>
        <Field Name="IN___Export_Def__Table_Link_Export_Def__Entry_No_">
          <DataField>IN___Export_Def__Table_Link_Export_Def__Entry_No_</DataField>
        </Field>
        <Field Name="IN___Export_Def__Table_Link_Main_Field_No_">
          <DataField>IN___Export_Def__Table_Link_Main_Field_No_</DataField>
        </Field>
      </Fields>
      <rd:DataSetInfo>
        <rd:DataSetName>DataSet</rd:DataSetName>
        <rd:SchemaPath>Report.xsd</rd:SchemaPath>
        <rd:TableName>Result</rd:TableName>
      </rd:DataSetInfo>
    </DataSet>
  </DataSets>
  <Code>Public Function BlankZero(ByVal Value As Decimal)
    if Value = 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankPos(ByVal Value As Decimal)
    if Value &gt; 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankZeroAndPos(ByVal Value As Decimal)
    if Value &gt;= 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankNeg(ByVal Value As Decimal)
    if Value &lt; 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankNegAndZero(ByVal Value As Decimal)
    if Value &lt;= 0 then
        Return ""
    end if
    Return Value
End Function
</Code>
  <Language>=User!Language</Language>
  <ConsumeContainerWhitespace>true</ConsumeContainerWhitespace>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
  <rd:ReportID>6f8a4ff5-cd7f-4d47-b8cf-e50303f999d5</rd:ReportID>
  <Body>
    <ReportItems>
      <Tablix Name="Table1">
        <TablixBody>
          <TablixColumns>
            <TablixColumn>
              <Width>3.375cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1.2cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1.65cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>2.85cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>2.85cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>3.45cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1.35cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1.65cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1.95cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1.95cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1.2cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1.725cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>0.2cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>0.2cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>0.2cm</Width>
            </TablixColumn>
          </TablixColumns>
          <TablixRows>
            <TablixRow>
              <Height>0.846cm</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IndentText__Tag_Name___Indent_Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IndentText__Tag_Name___Indent_Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>0cm</Left>
                      <Height>0.846cm</Height>
                      <Width>3.3cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_Line_TypeCaption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Export_Definition_Line_TypeCaption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>3.45cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.05cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_Line_CodeCaption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Export_Definition_Line_CodeCaption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>4.65cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.5cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="PrintTable__Table_No_____Table_Name__Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!PrintTable__Table_No_____Table_Name__Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>6.3cm</Left>
                      <Height>0.846cm</Height>
                      <Width>2.7cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="PrintTable__Field_No_____Field_Name__Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!PrintTable__Field_No_____Field_Name__Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>9.15cm</Left>
                      <Height>0.846cm</Height>
                      <Width>2.7cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TableFilterCaption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!TableFilterCaption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>12cm</Left>
                      <Height>0.846cm</Height>
                      <Width>3.3cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_Line__Data_Format_Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Export_Definition_Line__Data_Format_Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>15.45cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.2cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_Line__Conversion_Code_Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Export_Definition_Line__Conversion_Code_Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>16.8cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.5cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_Line__Before_Field_Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Export_Definition_Line__Before_Field_Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>18.45cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.8cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_Line__After_Field_Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Export_Definition_Line__After_Field_Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>20.4cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.8cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_Line__As_Attribute_Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Export_Definition_Line__As_Attribute_Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>22.35cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.05cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox147">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox149">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                    <ColSpan>3</ColSpan>
                  </CellContents>
                </TablixCell>
                <TablixCell />
                <TablixCell />
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>0.423cm</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_CodeCaption">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition_CodeCaption.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>0cm</Left>
                      <Height>0.423cm</Height>
                      <Width>2.85cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_Code">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition_Code.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>3cm</Left>
                      <Height>0.423cm</Height>
                      <Width>4.5cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_StatusCaption">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition_StatusCaption.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>9.15cm</Left>
                      <Height>0.423cm</Height>
                      <Width>2.85cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_Status">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition_Status.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>12.15cm</Left>
                      <Height>0.423cm</Height>
                      <Width>4.5cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition__Run_Codeunit_No__Caption">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition__Run_Codeunit_No__Caption.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>18.45cm</Left>
                      <Height>0.423cm</Height>
                      <Width>2.85cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition__Run_Codeunit_No__">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition__Run_Codeunit_No__.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>21.45cm</Left>
                      <Height>0.423cm</Height>
                      <Width>4.5cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox11">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox12">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox13">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox14">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox15">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox16">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox150">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                    <ColSpan>3</ColSpan>
                  </CellContents>
                </TablixCell>
                <TablixCell />
                <TablixCell />
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>0.423cm</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_DescriptionCaption">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition_DescriptionCaption.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>0cm</Left>
                      <Height>0.423cm</Height>
                      <Width>2.85cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_Description">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition_Description.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>3cm</Left>
                      <Height>0.423cm</Height>
                      <Width>4.5cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition__File_Format_Caption">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition__File_Format_Caption.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>9.15cm</Left>
                      <Height>0.423cm</Height>
                      <Width>2.85cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition__File_Format_">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition__File_Format_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>12.15cm</Left>
                      <Height>0.423cm</Height>
                      <Width>4.5cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition__XML_Declaration_Caption">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition__XML_Declaration_Caption.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>18.45cm</Left>
                      <Height>0.423cm</Height>
                      <Width>2.85cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition__XML_Declaration_">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition__XML_Declaration_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>21.45cm</Left>
                      <Height>0.423cm</Height>
                      <Width>4.5cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox17">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox18">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox19">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox110">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox111">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox112">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox151">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                    <ColSpan>3</ColSpan>
                  </CellContents>
                </TablixCell>
                <TablixCell />
                <TablixCell />
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>0.423cm</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_LocationCaption">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition_LocationCaption.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.846cm</Top>
                      <Left>0cm</Left>
                      <Height>0.423cm</Height>
                      <Width>2.85cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_Location">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition_Location.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.846cm</Top>
                      <Left>3cm</Left>
                      <Height>0.423cm</Height>
                      <Width>4.5cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_HeadersCaption">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition_HeadersCaption.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.846cm</Top>
                      <Left>9.15cm</Left>
                      <Height>0.423cm</Height>
                      <Width>2.85cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_Headers">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition_Headers.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.846cm</Top>
                      <Left>12.15cm</Left>
                      <Height>0.423cm</Height>
                      <Width>4.5cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition__One_File_per_Record_Caption">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition__One_File_per_Record_Caption.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.846cm</Top>
                      <Left>18.45cm</Left>
                      <Height>0.423cm</Height>
                      <Width>2.85cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition__One_File_per_Record_">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition__One_File_per_Record_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.846cm</Top>
                      <Left>21.45cm</Left>
                      <Height>0.423cm</Height>
                      <Width>4.5cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox113">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox114">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox115">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox116">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox117">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox118">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox152">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                    <ColSpan>3</ColSpan>
                  </CellContents>
                </TablixCell>
                <TablixCell />
                <TablixCell />
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>0.423cm</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_FilenameCaption">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition_FilenameCaption.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>1.269cm</Top>
                      <Left>0cm</Left>
                      <Height>0.423cm</Height>
                      <Width>2.85cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_Filename">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition_Filename.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>1.269cm</Top>
                      <Left>3cm</Left>
                      <Height>0.423cm</Height>
                      <Width>4.5cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition__Save_to_Messages_Caption">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition__Save_to_Messages_Caption.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>1.269cm</Top>
                      <Left>9.15cm</Left>
                      <Height>0.423cm</Height>
                      <Width>2.85cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition__Save_to_Messages_">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition__Save_to_Messages_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <Top>1.269cm</Top>
                      <Left>12.15cm</Left>
                      <Height>0.423cm</Height>
                      <Width>4.5cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox119">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox120">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox121">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox122">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox123">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox124">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox125">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox126">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox153">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                    <ColSpan>3</ColSpan>
                  </CellContents>
                </TablixCell>
                <TablixCell />
                <TablixCell />
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>0.423cm</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition__Field_Delimiter_Caption">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition__Field_Delimiter_Caption.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>1.692cm</Top>
                      <Left>9.15cm</Left>
                      <Height>0.423cm</Height>
                      <Width>2.85cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition__Field_Delimiter_">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition__Field_Delimiter_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <Top>1.692cm</Top>
                      <Left>12.15cm</Left>
                      <Height>0.423cm</Height>
                      <Width>4.5cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox127">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox128">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox129">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox130">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox131">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox132">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox133">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox134">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox135">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox136">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox154">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                    <ColSpan>3</ColSpan>
                  </CellContents>
                </TablixCell>
                <TablixCell />
                <TablixCell />
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>0.423cm</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition__Field_Separator_Caption">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition__Field_Separator_Caption.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>2.115cm</Top>
                      <Left>9.15cm</Left>
                      <Height>0.423cm</Height>
                      <Width>2.85cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition__Field_Separator_">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition__Field_Separator_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <Top>2.115cm</Top>
                      <Left>12.15cm</Left>
                      <Height>0.423cm</Height>
                      <Width>4.5cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox137">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox138">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox139">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox140">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox141">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox142">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox143">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox144">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox145">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox146">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox155">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                    <ColSpan>3</ColSpan>
                  </CellContents>
                </TablixCell>
                <TablixCell />
                <TablixCell />
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>0.846cm</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IndentText__Tag_Name___Indent__Control1000000171Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IndentText__Tag_Name___Indent__Control1000000171Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>0cm</Left>
                      <Height>0.846cm</Height>
                      <Width>3.3cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_Line_Type_Control1000000169Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Export_Definition_Line_Type_Control1000000169Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>3.45cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.05cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_Line_Code_Control1000000159Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Export_Definition_Line_Code_Control1000000159Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>4.65cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.5cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="PrintTable__Table_No_____Table_Name___Control1000000167Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!PrintTable__Table_No_____Table_Name___Control1000000167Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>6.3cm</Left>
                      <Height>0.846cm</Height>
                      <Width>2.7cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="PrintTable__Field_No_____Field_Name___Control1000000165Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!PrintTable__Field_No_____Field_Name___Control1000000165Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>9.15cm</Left>
                      <Height>0.846cm</Height>
                      <Width>2.7cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TableFilter_Control1000001Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!TableFilter_Control1000001Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>12cm</Left>
                      <Height>0.846cm</Height>
                      <Width>3.3cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_Line__Data_Format__Control1000000163Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Export_Definition_Line__Data_Format__Control1000000163Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>15.45cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.2cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_Line__Conversion_Code__Control1000000157Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Export_Definition_Line__Conversion_Code__Control1000000157Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>16.8cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.5cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_Line__Before_Field__Control1000032Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Export_Definition_Line__Before_Field__Control1000032Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>18.45cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.8cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_Line__After_Field__Control1000031Caption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Export_Definition_Line__After_Field__Control1000031Caption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>20.4cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.8cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_Line_WidthCaption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Export_Definition_Line_WidthCaption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Right</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>22.35cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.05cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_Line_AlignmentCaption">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=First(Fields!IN___Export_Definition_Line_AlignmentCaption.Value)</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>23.55cm</Left>
                      <Height>0.846cm</Height>
                      <Width>1.65cm</Width>
                      <Style>
                        <VerticalAlign>Bottom</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox156">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                    <ColSpan>3</ColSpan>
                  </CellContents>
                </TablixCell>
                <TablixCell />
                <TablixCell />
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>0.423cm</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IndentText__Tag_Name___Indent_">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IndentText__Tag_Name___Indent_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>0cm</Left>
                      <Height>0.423cm</Height>
                      <Width>3.3cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_Line_Type">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition_Line_Type.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>3.45cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.05cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_Line_Code">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition_Line_Code.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>4.65cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.5cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="PrintTable__Table_No_____Table_Name__">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!PrintTable__Table_No_____Table_Name__.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>6.3cm</Left>
                      <Height>0.423cm</Height>
                      <Width>2.7cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="PrintTable__Field_No_____Field_Name__">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!PrintTable__Field_No_____Field_Name__.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>9.15cm</Left>
                      <Height>0.423cm</Height>
                      <Width>2.7cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TableFilter">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!TableFilter.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>12cm</Left>
                      <Height>0.423cm</Height>
                      <Width>3.3cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_Line__Data_Format_">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition_Line__Data_Format_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>15.45cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.2cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_Line__Conversion_Code_">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition_Line__Conversion_Code_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>16.8cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.5cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_Line__Before_Field_">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition_Line__Before_Field_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>18.45cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.8cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_Line__After_Field_">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition_Line__After_Field_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>20.4cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.8cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_Line__As_Attribute_">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition_Line__As_Attribute_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0cm</Top>
                      <Left>22.35cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.05cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox1">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="COMPANYNAME">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!COMPANYNAME.Value</Value>
                              <Style>
                                <Color>#ff0000</Color>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Visibility>
                        <Hidden>true</Hidden>
                      </Visibility>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="CurrReport_PAGENOCaption">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!CurrReport_PAGENOCaption.Value</Value>
                              <Style>
                                <Color>#ff0000</Color>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Visibility>
                        <Hidden>true</Hidden>
                      </Visibility>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="ConnectIT_Export_DefinitionsCaption">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!ConnectIT_Export_DefinitionsCaption.Value</Value>
                              <Style>
                                <Color>#ff0000</Color>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Visibility>
                        <Hidden>true</Hidden>
                      </Visibility>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>0.423cm</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IndentText__Tag_Name___Indent__Control1000000171">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IndentText__Tag_Name___Indent_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>0cm</Left>
                      <Height>0.423cm</Height>
                      <Width>3.3cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_Line_Type_Control1000000169">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition_Line_Type.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>3.45cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.05cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_Line_Code_Control1000000159">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition_Line_Code.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>4.65cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.5cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="PrintTable__Table_No_____Table_Name___Control1000000167">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!PrintTable__Table_No_____Table_Name__.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>6.3cm</Left>
                      <Height>0.423cm</Height>
                      <Width>2.7cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="PrintTable__Field_No_____Field_Name___Control1000000165">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!PrintTable__Field_No_____Field_Name__.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Left</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>9.15cm</Left>
                      <Height>0.423cm</Height>
                      <Width>2.7cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TableFilter_Control1000001">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!TableFilter.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>12cm</Left>
                      <Height>0.423cm</Height>
                      <Width>3.3cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_Line__Data_Format__Control1000000163">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition_Line__Data_Format_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>15.45cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.2cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_Line__Conversion_Code__Control1000000157">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition_Line__Conversion_Code_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>16.8cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.5cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_Line__Before_Field__Control1000032">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition_Line__Before_Field_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>18.45cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.8cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_Line__After_Field__Control1000031">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition_Line__After_Field_.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>20.4cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.8cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_Line_Width">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition_Line_Width.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>22.35cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.05cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>0.075cm</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="IN___Export_Definition_Line_Alignment">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!IN___Export_Definition_Line_Alignment.Value</Value>
                              <Style>
                                <FontSize>7pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Top>0.423cm</Top>
                      <Left>23.55cm</Left>
                      <Height>0.423cm</Height>
                      <Width>1.65cm</Width>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>0.075cm</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TextBox148">
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <VerticalAlign>Middle</VerticalAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                    <ColSpan>3</ColSpan>
                  </CellContents>
                </TablixCell>
                <TablixCell />
                <TablixCell />
              </TablixCells>
            </TablixRow>
          </TablixRows>
        </TablixBody>
        <TablixColumnHierarchy>
          <TablixMembers>
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
          </TablixMembers>
        </TablixColumnHierarchy>
        <TablixRowHierarchy>
          <TablixMembers>
            <TablixMember>
              <KeepWithGroup>After</KeepWithGroup>
              <RepeatOnNewPage>true</RepeatOnNewPage>
              <KeepTogether>true</KeepTogether>
            </TablixMember>
            <TablixMember>
              <Group Name="Table1_Group">
                <GroupExpressions>
                  <GroupExpression>=Fields!IN___Export_Definition_Code.Value</GroupExpression>
                </GroupExpressions>
              </Group>
              <TablixMembers>
                <TablixMember>
                  <KeepWithGroup>After</KeepWithGroup>
                  <KeepTogether>true</KeepTogether>
                </TablixMember>
                <TablixMember>
                  <KeepWithGroup>After</KeepWithGroup>
                  <KeepTogether>true</KeepTogether>
                </TablixMember>
                <TablixMember>
                  <KeepWithGroup>After</KeepWithGroup>
                  <KeepTogether>true</KeepTogether>
                </TablixMember>
                <TablixMember>
                  <KeepWithGroup>After</KeepWithGroup>
                  <KeepTogether>true</KeepTogether>
                </TablixMember>
                <TablixMember>
                  <KeepWithGroup>After</KeepWithGroup>
                  <KeepTogether>true</KeepTogether>
                </TablixMember>
                <TablixMember>
                  <KeepWithGroup>After</KeepWithGroup>
                  <KeepTogether>true</KeepTogether>
                </TablixMember>
                <TablixMember>
                  <KeepWithGroup>After</KeepWithGroup>
                  <KeepTogether>true</KeepTogether>
                </TablixMember>
                <TablixMember>
                  <Group Name="Table1_Details_Group">
                    <DataElementName>Detail</DataElementName>
                  </Group>
                  <TablixMembers>
                    <TablixMember />
                    <TablixMember />
                  </TablixMembers>
                  <DataElementName>Detail_Collection</DataElementName>
                  <DataElementOutput>Output</DataElementOutput>
                  <KeepTogether>true</KeepTogether>
                </TablixMember>
              </TablixMembers>
            </TablixMember>
          </TablixMembers>
        </TablixRowHierarchy>
        <DataSetName>DataSet_Result</DataSetName>
        <Top>0cm</Top>
        <Height>5.076cm</Height>
      </Tablix>
    </ReportItems>
    <Height>5cm</Height>
  </Body>
  <Width>25.95cm</Width>
  <Page>
    <PageHeader>
      <Height>1.269cm</Height>
      <PrintOnFirstPage>true</PrintOnFirstPage>
      <PrintOnLastPage>true</PrintOnLastPage>
      <ReportItems>
        <Textbox Name="PageNumberTextBox">
          <KeepTogether>true</KeepTogether>
          <Paragraphs>
            <Paragraph>
              <TextRuns>
                <TextRun>
                  <Value>=Globals!PageNumber</Value>
                  <Style>
                    <FontSize>7pt</FontSize>
                  </Style>
                </TextRun>
              </TextRuns>
              <Style>
                <TextAlign>Right</TextAlign>
              </Style>
            </Paragraph>
          </Paragraphs>
          <Top>0.423cm</Top>
          <Left>25.5cm</Left>
          <Height>0.423cm</Height>
          <Width>0.45cm</Width>
          <Style>
            <VerticalAlign>Middle</VerticalAlign>
          </Style>
        </Textbox>
        <Textbox Name="UserIdTextBox">
          <KeepTogether>true</KeepTogether>
          <Paragraphs>
            <Paragraph>
              <TextRuns>
                <TextRun>
                  <Value>=User!UserID</Value>
                  <Style>
                    <FontSize>7pt</FontSize>
                  </Style>
                </TextRun>
              </TextRuns>
              <Style>
                <TextAlign>Right</TextAlign>
              </Style>
            </Paragraph>
          </Paragraphs>
          <Top>0.846cm</Top>
          <Left>22.7cm</Left>
          <Height>0.423cm</Height>
          <Width>3.25cm</Width>
          <Style>
            <VerticalAlign>Middle</VerticalAlign>
          </Style>
        </Textbox>
        <Textbox Name="ExecutionTimeTextBox">
          <KeepTogether>true</KeepTogether>
          <Paragraphs>
            <Paragraph>
              <TextRuns>
                <TextRun>
                  <Value>=Globals!ExecutionTime</Value>
                  <Style>
                    <FontSize>7pt</FontSize>
                    <Format>g</Format>
                  </Style>
                </TextRun>
              </TextRuns>
              <Style>
                <TextAlign>Right</TextAlign>
              </Style>
            </Paragraph>
          </Paragraphs>
          <Top>0cm</Top>
          <Left>22.8cm</Left>
          <Height>0.423cm</Height>
          <Width>3.15cm</Width>
          <Style>
            <VerticalAlign>Middle</VerticalAlign>
          </Style>
        </Textbox>
        <Textbox Name="COMPANYNAME1">
          <KeepTogether>true</KeepTogether>
          <Paragraphs>
            <Paragraph>
              <TextRuns>
                <TextRun>
                  <Value>=ReportItems!COMPANYNAME.Value</Value>
                  <Style>
                    <FontSize>7pt</FontSize>
                  </Style>
                </TextRun>
              </TextRuns>
            </Paragraph>
          </Paragraphs>
          <Top>0.423cm</Top>
          <Left>0cm</Left>
          <Height>0.423cm</Height>
          <Width>7.5cm</Width>
          <Style>
            <VerticalAlign>Middle</VerticalAlign>
          </Style>
        </Textbox>
        <Textbox Name="CurrReport_PAGENOCaption1">
          <KeepTogether>true</KeepTogether>
          <Paragraphs>
            <Paragraph>
              <TextRuns>
                <TextRun>
                  <Value>=ReportItems!CurrReport_PAGENOCaption.Value</Value>
                  <Style>
                    <FontSize>7pt</FontSize>
                  </Style>
                </TextRun>
              </TextRuns>
            </Paragraph>
          </Paragraphs>
          <Top>0.423cm</Top>
          <Left>24.75cm</Left>
          <Height>0.423cm</Height>
          <Width>0.75cm</Width>
          <Style>
            <VerticalAlign>Middle</VerticalAlign>
          </Style>
        </Textbox>
        <Textbox Name="ConnectIT_Export_DefinitionsCaption1">
          <KeepTogether>true</KeepTogether>
          <Paragraphs>
            <Paragraph>
              <TextRuns>
                <TextRun>
                  <Value>=ReportItems!ConnectIT_Export_DefinitionsCaption.Value</Value>
                  <Style>
                    <FontSize>8pt</FontSize>
                    <FontWeight>Bold</FontWeight>
                  </Style>
                </TextRun>
              </TextRuns>
            </Paragraph>
          </Paragraphs>
          <Top>0cm</Top>
          <Left>0cm</Left>
          <Height>0.423cm</Height>
          <Width>7.5cm</Width>
          <Style>
            <VerticalAlign>Middle</VerticalAlign>
          </Style>
        </Textbox>
      </ReportItems>
    </PageHeader>
    <PageHeight>29.7cm</PageHeight>
    <PageWidth>28.75cm</PageWidth>
    <LeftMargin>2.1cm</LeftMargin>
    <RightMargin>0cm</RightMargin>
    <TopMargin>2cm</TopMargin>
    <BottomMargin>2cm</BottomMargin>
  </Page>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 11117005 CI - Process Tasks
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    CaptionML=ENU=IN - Process Tasks;
    ProcessingOnly=Yes;
    OnPostReport=VAR
                   ctNoOfRecordsProcessed@1000000 : TextConst 'ENU=%1 tasks processed.';
                 BEGIN
                   IF GUIALLOWED THEN
                     MESSAGE(ctNoOfRecordsProcessed, NoOfRecordsProcessed);
                 END;

  }
  DATASET
  {
    { 9126;    ;DataItem;                    ;
               DataItemTable=Table11148614;
               DataItemTableView=SORTING(Code)
                                 WHERE(Status=CONST(Automated));
               OnAfterGetRecord=BEGIN
                                  CALCFIELDS("Start Next Time");
                                  IF "Start Next Time" < CURRENTDATETIME THEN BEGIN
                                    Process;
                                    NoOfRecordsProcessed += 1;
                                  END;
                                END;

               OnPostDataItem=BEGIN
                                IF NoOfRecordsProcessed = 0 THEN BEGIN
                                  SETRANGE(Status, Status::Automated);
                                  FINDFIRST;
                                END;
                              END;

               ReqFilterFields=Code }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      NoOfRecordsProcessed@1000000 : Integer;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 11117006 CI - Process Sync. Inbox
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    CaptionML=ENU=Process Sync. Inbox;
    ProcessingOnly=Yes;
    OnPreReport=BEGIN
                  IF CurrReport.USEREQUESTPAGE THEN
                    Window.OPEN('#1##############');
                END;

    OnPostReport=VAR
                   ctNoOfRecordsProcessed@1000001 : TextConst 'ENU=%1 synchronisation. inbox items processed.';
                 BEGIN
                   IF GUIALLOWED THEN
                     MESSAGE(ctNoOfRecordsProcessed, NoOfRecords);
                 END;

  }
  DATASET
  {
    { 2240;    ;DataItem;                    ;
               DataItemTable=Table11148618;
               DataItemTableView=SORTING(Status)
                                 WHERE(Status=CONST(New));
               OnPreDataItem=BEGIN
                               NoOfRecords := COUNT;
                             END;

               OnAfterGetRecord=VAR
                                  SynchonizationInbox@1000004 : Record 11148618;
                                BEGIN
                                  RecordCounter += 1;

                                  IF CurrReport.USEREQUESTPAGE THEN
                                    Window.UPDATE(1, ROUND(RecordCounter / NoOfRecords * 10000, 1));

                                  SynchonizationInbox := "IN - Synchonization Inbox";
                                  SynchonizationInbox.Process;

                                  NoOfRecordsProcessed += 1
                                END;

               ReqFilterFields=Entry No. }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      Window@1000000 : Dialog;
      NoOfRecords@1000003 : Integer;
      NoOfRecordsProcessed@1000002 : Integer;
      RecordCounter@1000004 : Integer;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 11117007 CI - Start Connectors
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Start Connectors;
               NLD=Connectoren starten];
    ProcessingOnly=Yes;
  }
  DATASET
  {
    { 8972;    ;DataItem;                    ;
               DataItemTable=Table11148623;
               DataItemTableView=SORTING(Code);
               OnPreDataItem=BEGIN
                               SETRANGE(Status, Status::Automated);
                               FINDFIRST;
                             END;

               OnAfterGetRecord=BEGIN
                                  Start;
                                END;

               ReqFilterFields=Code }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 11117008 CI - Conversion 1.35
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Conversion 1.35;
               NLD=Conversie 1.35];
    ProcessingOnly=Yes;
    OnPostReport=BEGIN
                   MESSAGE('Conversion completed.\You can now import JPCON1.35');
                 END;

    UseRequestPage=No;
  }
  DATASET
  {
    { 7294;    ;DataItem;                    ;
               DataItemTable=Table2000000001;
               DataItemTableView=SORTING(Type,Company Name,ID)
                                 WHERE(Type=FILTER(2|Report|Codeunit),
                                       Name=FILTER(IN - *));
               OnAfterGetRecord=BEGIN
                                  IF (Type <> Type::Report) OR (ID <> REPORT::"CI - Conversion 1.35") THEN BEGIN
                                    Name := FORMAT(Type) + FORMAT(ID);
                                    MODIFY;
                                  END;
                                END;
                                 }

    { 5444;    ;DataItem;                    ;
               DataItemTable=Table2000000026;
               DataItemTableView=SORTING(Number)
                                 WHERE(Number=CONST(1));
               OnAfterGetRecord=BEGIN
                                  EmptyField(DATABASE::"IN - Import Definition", 7);
                                  EmptyField(DATABASE::"IN - Import Definition", 22);
                                  EmptyField(DATABASE::"IN - Import Definition", 23);
                                  EmptyField(DATABASE::"IN - Import Definition", 29);
                                END;
                                 }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {

    LOCAL PROCEDURE EmptyField@1000000(TableNo@1000000 : Integer;FieldNo@1000001 : Integer);
    VAR
      RecRef@1000003 : RecordRef;
      FldRef@1000002 : FieldRef;
    BEGIN
      RecRef.OPEN(TableNo);
      IF RecRef.FINDSET THEN
        REPEAT
          FldRef := RecRef.FIELD(FieldNo);
          FldRef.VALUE := '';
          RecRef.MODIFY;
        UNTIL RecRef.NEXT = 0;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 11117009 CI - Delete Logs
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Delete Logs;
               NLD=Log opschonen];
    ProcessingOnly=Yes;
    OnPreReport=BEGIN
                  Window.OPEN(Text001);
                END;

    OnPostReport=BEGIN
                   Window.CLOSE;
                 END;

  }
  DATASET
  {
    { 8776;    ;DataItem;DateFilter          ;
               DataItemTable=Table2000000007;
               DataItemTableView=SORTING(Period Type,Period Start)
                                 WHERE(Period Type=CONST(Date));
               ReqFilterHeadingML=[ENU=Date Filter;
                                   NLD=Datumfilter];
               OnPreDataItem=BEGIN
                               IF DateFilter.GETFILTER("Period Start") = '' THEN
                                 ERROR(Text002);
                             END;

               OnAfterGetRecord=BEGIN
                                  CurrReport.BREAK;
                                END;

               ReqFilterFields=Period Start }

    { 3184;    ;DataItem;MessageHeader       ;
               DataItemTable=Table11148609;
               DataItemTableView=SORTING(Entry No.);
               OnPreDataItem=BEGIN
                               Window.UPDATE(1, MessageHeader.TABLECAPTION);
                               MessageHeader.SETFILTER(Date, DateFilter.GETFILTER("Period Start"));
                               MessageHeader.DELETEALL(TRUE);
                             END;

               OnAfterGetRecord=BEGIN
                                  CurrReport.BREAK;
                                END;
                                 }

    { 5151;    ;DataItem;TaskLog             ;
               DataItemTable=Table11148617;
               DataItemTableView=SORTING(Entry No.);
               OnPreDataItem=BEGIN
                               Window.UPDATE(1, TaskLog.TABLECAPTION);
                               TaskLog.SETFILTER(Ended, DateFilter.GETFILTER("Period Start"));
                               TaskLog.DELETEALL(TRUE);
                             END;

               OnAfterGetRecord=BEGIN
                                  CurrReport.BREAK;
                                END;
                                 }

    { 5401;    ;DataItem;ExportJob           ;
               DataItemTable=Table11148608;
               DataItemTableView=SORTING(Entry No.);
               OnPreDataItem=BEGIN
                               Window.UPDATE(1, ExportJob.TABLECAPTION);
                               ExportJob.SETFILTER(Status, '<>%1', ExportJob.Status::New);
                               ExportJob.SETFILTER("DateTime Inserted", DateFilter.GETFILTER("Period Start"));
                               ExportJob.DELETEALL(TRUE);
                             END;

               OnAfterGetRecord=BEGIN
                                  CurrReport.BREAK;
                                END;
                                 }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      Window@1000000000 : Dialog;
      Text001@1000000001 : TextConst 'ENU=Deleting data...\Current table #1############################;NLD=Data aan het verwijderen...\Huidige tabel #1############################';
      Text002@1000000002 : TextConst 'ENU=You must enter a date filter. Processing cancelled.;NLD=U moet een datumfilter opgeven. De verwerking is geannuleerd.';

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 11117010 CI - Replace Paths
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Replace Paths;
               NLD=Paden vervangen];
    ProcessingOnly=Yes;
    OnPreReport=BEGIN
                  Window.OPEN(Text001);
                END;

    OnPostReport=BEGIN
                   Window.CLOSE;
                 END;

  }
  DATASET
  {
    { 5876;    ;DataItem;Import              ;
               DataItemTable=Table11148591;
               DataItemTableView=SORTING(Code);
               OnPreDataItem=BEGIN
                               IF NOT ReplaceImport THEN
                                 CurrReport.BREAK;
                             END;

               OnAfterGetRecord=BEGIN
                                  Location := Mgt.Replace(Location, FromPath, ToPath);
                                  "Processed Location" := Mgt.Replace("Processed Location", FromPath, ToPath);
                                  "Log Location" := Mgt.Replace("Log Location", FromPath, ToPath);
                                  "Error Location" := Mgt.Replace("Error Location", FromPath, ToPath);
                                  MODIFY;
                                END;
                                 }

    { 5108;    ;DataItem;Export              ;
               DataItemTable=Table11148599;
               DataItemTableView=SORTING(Code);
               OnPreDataItem=BEGIN
                               IF NOT ReplaceExport THEN
                                 CurrReport.BREAK;
                             END;

               OnAfterGetRecord=BEGIN
                                  Location := Mgt.Replace(Location, FromPath, ToPath);
                                  MODIFY;
                                END;
                                 }

    { 3589;    ;DataItem;Transport           ;
               DataItemTable=Table11148590;
               DataItemTableView=SORTING(Code);
               OnPreDataItem=BEGIN
                               IF NOT ReplaceTransport THEN
                                 CurrReport.BREAK;
                             END;

               OnAfterGetRecord=BEGIN
                                  "From Location" := Mgt.Replace("From Location", FromPath, ToPath);
                                  "To Location" := Mgt.Replace("To Location", FromPath, ToPath);
                                  "Archive Location" := Mgt.Replace("Archive Location", FromPath, ToPath);
                                  MODIFY;
                                END;
                                 }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1000000000;;Container;
                  CaptionML=[ENU=Search and Replace;
                             NLD=Zoeken en vervangen];
                  ContainerType=ContentArea }

      { 1000000001;1;Field  ;
                  CaptionML=[ENU=From Path;
                             NLD=Van pad];
                  SourceExpr=FromPath }

      { 1000000002;1;Field  ;
                  CaptionML=[ENU=To Path;
                             NLD=Naar pad];
                  SourceExpr=ToPath }

      { 1000000003;1;Field  ;
                  CaptionML=[ENU=Import;
                             NLD=In importdefinities];
                  SourceExpr=ReplaceImport }

      { 1000000004;1;Field  ;
                  CaptionML=[ENU=Export;
                             NLD=In exportdefinities];
                  SourceExpr=ReplaceExport }

      { 1000000005;1;Field  ;
                  CaptionML=[ENU=Transport;
                             NLD=In transportdefinities];
                  SourceExpr=ReplaceTransport }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      Text001@1000000000 : TextConst 'ENU=Replacing paths. Please wait...;NLD=Paden aan het vervangen. Even geduld a.u.b...';
      FromPath@1000000001 : Text[250];
      ToPath@1000000002 : Text[250];
      Mgt@1000000003 : Codeunit 11148589;
      Window@1000000004 : Dialog;
      ReplaceImport@1000000005 : Boolean;
      ReplaceExport@1000000006 : Boolean;
      ReplaceTransport@1000000007 : Boolean;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Codeunit 1 ApplicationManagement
{
  OBJECT-PROPERTIES
  {
    Date=14-07-14;
    Time=13:00:00;
    Version List=NAVW17.00,IDYN-CE5.60.1;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      DebuggerManagement@1017 : Codeunit 9500;
      LogInManagement@1027 : Codeunit 40;
      TextManagement@1003 : Codeunit 41;
      CaptionManagement@1000 : Codeunit 42;
      LanguageManagement@1002 : Codeunit 43;
      NASManagement@1001 : Codeunit 44;
      AutoFormatManagement@1012 : Codeunit 45;

    PROCEDURE CompanyOpen@30();
    BEGIN
      LogInManagement.CompanyOpen;
    END;

    PROCEDURE GetSystemIndicator@51(VAR Text@1000 : Text[250];VAR Style@1001 : 'Standard,Accent1,Accent2,Accent3,Accent4,Accent5,Accent6,Accent7,Accent8,Accent9');
    VAR
      CompanyInformation@1002 : Record 79;
    BEGIN
      IF CompanyInformation.GET THEN
        CompanyInformation.GetSystemIndicator(Text,Style);
    END;

    PROCEDURE CompanyClose@31();
    BEGIN
      LogInManagement.CompanyClose;
    END;

    PROCEDURE FindPrinter@11(ReportID@1000 : Integer) : Text[250];
    VAR
      PrinterSelection@1001 : Record 78;
    BEGIN
      CLEAR(PrinterSelection);

      IF NOT PrinterSelection.GET(USERID,ReportID) THEN
        IF NOT PrinterSelection.GET('',ReportID) THEN
          IF NOT PrinterSelection.GET(USERID,0) THEN
            IF PrinterSelection.GET('',0) THEN;

      EXIT(PrinterSelection."Printer Name");
    END;

    PROCEDURE ApplicationVersion@2() : Text[80];
    BEGIN
      // IDYN >>>>
      EXIT('W1 7.00' + "IDYN-GetVersionList");
      // IDYN <<<<
    END;

    PROCEDURE ApplicationBuild@3() : Text[80];
    BEGIN
      EXIT('33781');
    END;

    PROCEDURE ApplicationLanguage@4() : Integer;
    BEGIN
      EXIT(1033);
    END;

    PROCEDURE DefaultRoleCenter@50() : Integer;
    VAR
      ConfPersMgt@1000 : Codeunit 9170;
    BEGIN
      EXIT(ConfPersMgt.DefaultRoleCenterID);
    END;

    PROCEDURE MakeDateTimeText@114(VAR DateTimeText@1000 : Text[250]) : Integer;
    BEGIN
      EXIT(TextManagement.MakeDateTimeText(DateTimeText));
    END;

    PROCEDURE GetSeparateDateTime@10011(DateTimeText@1000 : Text[250];VAR Date@1005 : Date;VAR Time@1006 : Time) : Boolean;
    BEGIN
      EXIT(TextManagement.GetSeparateDateTime(DateTimeText,Date,Time));
    END;

    PROCEDURE MakeDateText@105(VAR DateText@1000 : Text[250]) : Integer;
    BEGIN
      EXIT(TextManagement.MakeDateText(DateText));
    END;

    PROCEDURE MakeTimeText@106(VAR TimeText@1000 : Text[250]) : Integer;
    BEGIN
      EXIT(TextManagement.MakeTimeText(TimeText));
    END;

    PROCEDURE MakeText@107(VAR Text@1000 : Text[250]) : Integer;
    BEGIN
      EXIT(TextManagement.MakeText(Text));
    END;

    PROCEDURE MakeDateTimeFilter@214(VAR DateTimeFilterText@1000 : Text[250]) : Integer;
    BEGIN
      EXIT(TextManagement.MakeDateTimeFilter(DateTimeFilterText));
    END;

    PROCEDURE MakeDateFilter@205(VAR DateFilterText@1000 : Text[1024]) : Integer;
    BEGIN
      EXIT(TextManagement.MakeDateFilter(DateFilterText));
    END;

    PROCEDURE MakeTextFilter@207(VAR TextFilterText@1000 : Text) : Integer;
    BEGIN
      EXIT(TextManagement.MakeTextFilter(TextFilterText));
    END;

    PROCEDURE MakeCodeFilter@209(VAR TextFilterText@1000 : Text) : Integer;
    BEGIN
      EXIT(TextManagement.MakeTextFilter(TextFilterText));
    END;

    PROCEDURE MakeTimeFilter@206(VAR TimeFilterText@1000 : Text[250]) : Integer;
    BEGIN
      EXIT(TextManagement.MakeTimeFilter(TimeFilterText));
    END;

    PROCEDURE AutoFormatTranslate@12(AutoFormatType@1000 : Integer;AutoFormatExpr@1001 : Text[80]) : Text[80];
    BEGIN
      EXIT(AutoFormatManagement.AutoFormatTranslate(AutoFormatType,AutoFormatExpr));
    END;

    PROCEDURE ReadRounding@14() : Decimal;
    BEGIN
      EXIT(AutoFormatManagement.ReadRounding);
    END;

    PROCEDURE CaptionClassTranslate@15(Language@1000 : Integer;CaptionExpr@1001 : Text[1024]) : Text[1024];
    BEGIN
      EXIT(CaptionManagement.CaptionClassTranslate(Language,CaptionExpr));
    END;

    PROCEDURE SetGlobalLanguage@5();
    BEGIN
      LanguageManagement.SetGlobalLanguage;
    END;

    PROCEDURE ValidateApplicationlLanguage@1102601001(LanguageID@1037 : Integer);
    BEGIN
      LanguageManagement.ValidateApplicationLanguage(LanguageID);
    END;

    PROCEDURE LookupApplicationlLanguage@1102601005(VAR LanguageID@1040 : Integer);
    BEGIN
      LanguageManagement.LookupApplicationLanguage(LanguageID);
    END;

    PROCEDURE NASHandler@99(NASID@1000 : Text[260]);
    BEGIN
      NASManagement.NASHandler(NASID);
    END;

    PROCEDURE GetDatabaseTableTriggerSetup@25(TableId@1000 : Integer;VAR OnDatabaseInsert@1001 : Boolean;VAR OnDatabaseModify@1002 : Boolean;VAR OnDatabaseDelete@1003 : Boolean;VAR OnDatabaseRename@1004 : Boolean);
    VAR
      IntegrationManagement@1005 : Codeunit 5150;
      ChangeLogMgt@1006 : Codeunit 423;
      DataChangeMgt@1000000000 : Codeunit 11148645;
    BEGIN
      ChangeLogMgt.GetDatabaseTableTriggerSetup(TableId,OnDatabaseInsert,OnDatabaseModify,OnDatabaseDelete,OnDatabaseRename);

      IntegrationManagement.GetDatabaseTableTriggerSetup(TableId,OnDatabaseInsert,OnDatabaseModify,OnDatabaseDelete,OnDatabaseRename);

      // IDYN >>>>
      DataChangeMgt.GetDatabaseTableTriggerSetup(TableId, OnDatabaseInsert, OnDatabaseModify, OnDatabaseDelete, OnDatabaseRename);
      // IDYN <<<<
    END;

    PROCEDURE OnDatabaseInsert@26(RecRef@1000 : RecordRef);
    VAR
      IntegrationManagement@1001 : Codeunit 5150;
      ChangeLogMgt@1002 : Codeunit 423;
      DataChangeMgt@1000000000 : Codeunit 11148645;
      Insert@1000000004 : Boolean;
      Modify@1000000003 : Boolean;
      Delete@1000000002 : Boolean;
      Rename@1000000001 : Boolean;
    BEGIN
      ChangeLogMgt.LogInsertion(RecRef);

      // IDYN >>>>
      IF DataChangeMgt.SetRecRefInChange(RecRef) THEN BEGIN
        IntegrationManagement.GetDatabaseTableTriggerSetup(RecRef.NUMBER,Insert,Modify,Delete,Rename);
        IF Insert THEN
        // IDYN <<<<
          IntegrationManagement.OnDatabaseInsert(RecRef);

        DataChangeMgt.OnInsertRecord(RecRef);
        DataChangeMgt.DeleteRecRefInChange(RecRef);
      END;
    END;

    PROCEDURE OnDatabaseModify@27(RecRef@1000 : RecordRef);
    VAR
      IntegrationManagement@1001 : Codeunit 5150;
      ChangeLogMgt@1002 : Codeunit 423;
      DataChangeMgt@1000000000 : Codeunit 11148645;
      xRecRef@1000000005 : RecordRef;
      Insert@1000000004 : Boolean;
      Modify@1000000003 : Boolean;
      Delete@1000000002 : Boolean;
      Rename@1000000001 : Boolean;
    BEGIN
      ChangeLogMgt.LogModification(RecRef);
      // IDYN >>>>
      IF DataChangeMgt.SetRecRefInChange(RecRef) THEN BEGIN
        IntegrationManagement.GetDatabaseTableTriggerSetup(RecRef.NUMBER,Insert,Modify,Delete,Rename);
        IF Modify THEN
        // IDYN <<<<
          IntegrationManagement.OnDatabaseModify(RecRef);

          // IDYN >>>>
          xRecRef := RecRef.DUPLICATE;
          IF xRecRef.FIND('=') THEN;
          DataChangeMgt.OnModifyRecord(RecRef, xRecRef);

          DataChangeMgt.DeleteRecRefInChange(RecRef);
      END;
      // IDYN <<<<
    END;

    PROCEDURE OnDatabaseDelete@28(RecRef@1000 : RecordRef);
    VAR
      IntegrationManagement@1001 : Codeunit 5150;
      ChangeLogMgt@1002 : Codeunit 423;
      DataChangeMgt@1000000000 : Codeunit 11148645;
      Insert@1000000004 : Boolean;
      Modify@1000000003 : Boolean;
      Delete@1000000002 : Boolean;
      Rename@1000000001 : Boolean;
    BEGIN
      ChangeLogMgt.LogDeletion(RecRef);
      // IDYN >>>>
      IF DataChangeMgt.SetRecRefInChange(RecRef) THEN BEGIN

        IntegrationManagement.GetDatabaseTableTriggerSetup(RecRef.NUMBER,Insert,Modify,Delete,Rename);
        IF Delete THEN
        // IDYN <<<<
      IntegrationManagement.OnDatabaseDelete(RecRef);

        // IDYN >>>>
        DataChangeMgt.OnDeleteRecord(RecRef);

        DataChangeMgt.DeleteRecRefInChange(RecRef);
      END;
      // IDYN <<<<
    END;

    PROCEDURE OnDatabaseRename@29(RecRef@1000 : RecordRef;xRecRef@1001 : RecordRef);
    VAR
      IntegrationManagement@1002 : Codeunit 5150;
      ChangeLogMgt@1003 : Codeunit 423;
      DataChangeMgt@1000000000 : Codeunit 11148645;
      Insert@1000000004 : Boolean;
      Modify@1000000003 : Boolean;
      Delete@1000000002 : Boolean;
      Rename@1000000001 : Boolean;
    BEGIN
      ChangeLogMgt.LogRename(RecRef,xRecRef);
      // IDYN >>>>
      IF DataChangeMgt.SetRecRefInChange(RecRef) THEN BEGIN

        IntegrationManagement.GetDatabaseTableTriggerSetup(RecRef.NUMBER,Insert,Modify,Delete,Rename);
        IF Rename THEN
        // IDYN <<<<
      IntegrationManagement.OnDatabaseRename(RecRef,xRecRef);

        // IDYN >>>>
        DataChangeMgt.OnRenameRecord(RecRef, xRecRef);

        DataChangeMgt.DeleteRecRefInChange(RecRef);
      END;
      // IDYN <<<<
    END;

    PROCEDURE "IDYN-GetVersionList"@1100543000() Result : Text[100];
    BEGIN
      // IDYN >>>>
      Result := ', ConnectIT 5.60 hotfix 1';
      // IDYN <<<<
    END;

    PROCEDURE OnDebuggerBreak@55(ErrorMessage@1000 : Text[1024]);
    BEGIN
      DebuggerManagement.ProcessDebuggerBreak(ErrorMessage);
    END;

    PROCEDURE LaunchDebugger@60();
    BEGIN
      PAGE.RUN(PAGE::"Session List");
    END;

    PROCEDURE CustomizeChart@70(VAR TempChart@1000 : TEMPORARY Record 2000000078) : Boolean;
    VAR
      GenericChartMgt@1001 : Codeunit 9180;
    BEGIN
      EXIT(GenericChartMgt.ChartCustomization(TempChart));
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 44 NASManagement
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=NAVW17.00,IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE NASHandler@1(NASID@1000 : Text[260]);
    VAR
      Parameter@1008 : Text[260];
      ParamStr@1007 : Text[260];
      SepPosition@1006 : Integer;
      ConnectITConnector@1002 : Record 11148623;
      TaskHandler@1001 : Codeunit 11148656;
    BEGIN
      ParamStr := UPPERCASE(NASID);
      REPEAT
        SepPosition := STRPOS(ParamStr,',');
        IF SepPosition > 0 THEN
          Parameter := COPYSTR(ParamStr,1,SepPosition - 1)
        ELSE
          Parameter := ParamStr;

        CASE Parameter OF
          'JOBQUEUE':
            CODEUNIT.RUN(CODEUNIT::"Job Queue - NAS Start Up");
        END;

        // IDYN EBK >>>>
        IF Parameter = 'CONNECTITTASK' THEN
          CODEUNIT.RUN(CODEUNIT::"IN - Task Handler");

        IF COPYSTR(Parameter, 1, 14) = 'CONNECTITTASK(' THEN BEGIN
          TaskHandler.SetTaskGroup(COPYSTR(Parameter, 15, STRLEN(Parameter) - 15));
          TaskHandler.RUN;
        END;

        IF Parameter = 'CONNECTITSYNC' THEN
          CODEUNIT.RUN(CODEUNIT::"IN - Sync. Inbox Handler");

        IF COPYSTR(Parameter, 1, 12) = 'CONNECTITCON' THEN
          IF COPYSTR(Parameter, 13) = '' THEN
            CODEUNIT.RUN(CODEUNIT::"IN - Connector Handler")
          ELSE BEGIN
            ConnectITConnector.GET(COPYSTR(Parameter, 13));
            ConnectITConnector.Start;
          END;
        // IDYN EBK <<<<

        ParamStr := COPYSTR(ParamStr,SepPosition + 1);
      UNTIL SepPosition = 0;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 50000 Custom Function Management
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=11:26:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    TableNo=11148603;
    OnRun=BEGIN
            IF Code = '' THEN BEGIN
               Initialize;
               EXIT;
            END;

            CASE Code OF

              'COUNTRYNAME' : FieldValue := GetCountryName(Rec);

            END;
          END;

  }
  CODE
  {

    PROCEDURE GetCountryName@1100543000(VAR FunctionTemp@1100543000 : Record 11148603) : Text[250];
    VAR
      Country@1100543001 : Record 9;
    BEGIN
      IF Country.GET(FunctionTemp.FieldValue) THEN
        EXIT(Country.Name);
    END;

    LOCAL PROCEDURE Initialize@1100543001();
    BEGIN
      CreateFunction('COUNTRYNAME', 'Gets the Country/Region name from Country table based on then Country/Region Code',  '', '' ,'');
    END;

    LOCAL PROCEDURE CreateFunction@1100543002(Code@1100543000 : Code[20];Description@1100543001 : Text[250];Parameter1@1100543002 : Text[50];Parameter2@1100543003 : Text[50];Parameter3@1100543004 : Text[50]);
    VAR
      FunctionMgt@1100543006 : Codeunit 11148593;
      FunctionTemp@1100543005 : Record 11148603;
    BEGIN
      FunctionTemp.Code := Code;
      FunctionTemp.Description := Description;
      FunctionTemp."Parameter 1" := Parameter1;
      FunctionTemp."Parameter 2" := Parameter2;
      FunctionTemp."Parameter 3" := Parameter3;
      FunctionMgt.CreateCustomFunction(FunctionTemp);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.

      Sample Codeunit for building a custom function library.
    }
    END.
  }
}

OBJECT Codeunit 50001 Sample Pre-& post-processing
{
  OBJECT-PROPERTIES
  {
    Date=24-05-13;
    Time=13:00:00;
    Version List=IDYN-CE5.50.0;
  }
  PROPERTIES
  {
    TableNo=11148608;
    OnRun=VAR
            ExportJob@11154640 : Record 11148608;
            Success@11154639 : Boolean;
          BEGIN
            ExportJob := Rec;
            Success := ProcessJob(Rec);
            SetStatusToExportJobs(ExportJob, Success);
          END;

  }
  CODE
  {
    VAR
      EntryNo@11154639 : Integer;

    LOCAL PROCEDURE ProcessJob@11154647(VAR ExportJob@11154639 : Record 11148608) Result : Boolean;
    BEGIN
      PreProcess(ExportJob);
      Result := RunExport(ExportJob);
      PostProcess(ExportJob);
    END;

    LOCAL PROCEDURE PreProcess@11154646(VAR ExportJob@11154639 : Record 11148608);
    VAR
      RecRef@11154648 : RecordRef;
      RecRef2@11154650 : RecordRef;
      Mgt@11154649 : Codeunit 11148589;
    BEGIN
      // Create code to insert the export lines.
      // Insert your custom code here.

      // COMMIT is required to make sure the data is applied in the database and export will run with correct data.
      // PostProcess method will be called after the "real" export and the generated data should be removed (when success or failed).
      COMMIT;
    END;

    LOCAL PROCEDURE RunExport@1100496001(VAR ExportJob@11154639 : Record 11148608) ExitValue : Boolean;
    VAR
      ExportDefinition@11154640 : Record 11148599;
      ExportXMLFile@1000000 : Codeunit 11148614;
      ExportFile@1000001 : Codeunit 11148615;
      ExportADO@1000005 : Codeunit 11148618;
      VariableMgt@11154641 : Codeunit 11148619;
      ConnectITWriter@1000000000 : Codeunit 11148617;
    BEGIN
      ExportDefinition.GET(ExportJob."Export Definition");

      IF ExportJob."Trigger Dest. Variable" <> '' THEN
        VariableMgt.SetVariable(ExportJob."Trigger Dest. Variable", FORMAT(ExportJob.Trigger));

      IF ExportJob."Job Entry No. Dest. Variable" <> '' THEN
        VariableMgt.SetVariable(ExportJob."Job Entry No. Dest. Variable", FORMAT(ExportJob."Entry No."));

      CASE ExportDefinition."File Format" OF

        ExportDefinition."File Format"::XML:
          BEGIN
            ExportXMLFile.SetTrigger(FORMAT(ExportJob.Trigger));
            ExportXMLFile.SetExportJobEntryNo(ExportJob."Entry No.");
            ExitValue := ExportXMLFile.RUN(ExportDefinition);
          END;

        ExportDefinition."File Format"::CSV,
        ExportDefinition."File Format"::"Fixed Width",
        ExportDefinition."File Format"::Excel :
          BEGIN
            ExportFile.SetTrigger(FORMAT(ExportJob.Trigger));
            ExportFile.SetExportJobEntryNo(ExportJob."Entry No.");
            ExitValue := ExportFile.RUN(ExportDefinition);

            IF NOT ExitValue THEN
              ConnectITWriter.Close;
          END;

        ExportDefinition."File Format"::ADO :
          BEGIN
            ExitValue := ExportADO.RUN(ExportDefinition);
          END;

      END;

      IF ExportJob."Trigger Dest. Variable" <> '' THEN
        VariableMgt.SetVariable(ExportJob."Trigger Dest. Variable", '');

      IF ExportJob."Job Entry No. Dest. Variable" <> '' THEN
        VariableMgt.SetVariable(ExportJob."Job Entry No. Dest. Variable", '');
    END;

    LOCAL PROCEDURE PostProcess@11154645(VAR ExportJob@11154639 : Record 11148608);
    BEGIN
      // Place your post processing code here
    END;

    LOCAL PROCEDURE SetStatusToExportJobs@1000008(VAR TmpExportJob@1000001 : Record 11148608;Succeeded@1000000 : Boolean);
    VAR
      ExportJob@1000002 : Record 11148608;
    BEGIN
      IF TmpExportJob.FINDSET THEN
        REPEAT
          ExportJob := TmpExportJob;
          IF Succeeded THEN BEGIN
            ExportJob.Status := ExportJob.Status::Exported;
            ExportJob."DateTime Exported" := CURRENTDATETIME;
          END ELSE
            ExportJob.Status := ExportJob.Status::Error;
          ExportJob.MODIFY;
        UNTIL TmpExportJob.NEXT = 0;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11116997 CI - Management
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148589 IN - Management
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    SingleInstance=Yes;
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      Setup@1000000 : Record 11148589;
      AnsiStr@1000003 : Text[250];
      AsciiStr@1000004 : Text[250];
      AnsiAsciiInitialized@1000005 : Boolean;
      SetupGet@1000001 : Boolean;

    PROCEDURE CheckCreateDirectory@1100495002(pDirectoryName@1100495000 : Text[1024]);
    VAR
      FSO@1100495001 : Automation "{420B2830-E718-11CF-893D-00A0C9054228} 1.0:{0D43FE01-F093-11CF-8940-00A0C9054228}:'Microsoft Scripting Runtime'.FileSystemObject";
      FolderToCreate@1000000002 : Text[1024];
      SubFolders@1000000000 : ARRAY [40] OF Text[120];
      i@1000000001 : Integer;
      ValidTillNo@1000000003 : Integer;
      Dir@1000000005 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Directory";
    BEGIN
      IF NOT ISSERVICETIER THEN BEGIN
        CREATE(FSO, FALSE, FALSE);
        IF NOT FSO.FolderExists(pDirectoryName) THEN BEGIN
          Split(pDirectoryName, DirectorySeparator, SubFolders);

          FolderToCreate := SubFolders[1];
          FOR i := 2 TO ARRAYLEN(SubFolders) DO BEGIN
            FolderToCreate += DirectorySeparator + SubFolders[i];
            IF FSO.FolderExists(FolderToCreate) THEN
              ValidTillNo := i;
          END;

          FolderToCreate := SubFolders[1];
          FOR i := 2 TO ARRAYLEN(SubFolders) DO BEGIN
            FolderToCreate += DirectorySeparator + SubFolders[i];
            IF (i > ValidTillNo) AND NOT FSO.FolderExists(FolderToCreate) THEN
              FSO.CreateFolder(FolderToCreate);
          END;
        END;
      END ELSE BEGIN
        IF NOT Dir.Exists(pDirectoryName) THEN BEGIN
          Dir.CreateDirectory(pDirectoryName);
        END;
      END;
    END;

    PROCEDURE BrowseForFolder@1000006(Title@1000000000 : Text[80];Root@1000000002 : Text[250]) ExitValue : Text[250];
    VAR
      FolderItem@1000000003 : Automation "{50A7E9B0-70EF-11D1-B75A-00A0C90564FE} 1.0:{FAC32C80-CBE4-11CE-8350-444553540000}:'Microsoft Shell Controls And Automation'.FolderItem";
      SelectedFolder@1000000001 : Automation "{50A7E9B0-70EF-11D1-B75A-00A0C90564FE} 1.0:{F0D2D8EF-3890-11D2-BF8B-00C04FB93661}:'Microsoft Shell Controls And Automation'.Folder2";
      WindowsShell@1000000004 : Automation "{50A7E9B0-70EF-11D1-B75A-00A0C90564FE} 1.0:{13709620-C279-11CE-A49E-444553540000}:'Microsoft Shell Controls And Automation'.Shell";
    BEGIN
      IF ISCLEAR(WindowsShell) THEN
        CREATE(WindowsShell, FALSE, TRUE);

      SelectedFolder := WindowsShell.BrowseForFolder(0, Title, 1, Root);

      IF NOT ISCLEAR(SelectedFolder) THEN BEGIN
        FolderItem := SelectedFolder.Self;
        ExitValue := FolderItem.Path;
        IF (ExitValue <> '') AND (ExitValue[STRLEN(ExitValue)] <> DirectorySeparator[1]) THEN
          ExitValue := ExitValue + DirectorySeparator;
      END;
    END;

    PROCEDURE OpenFolder@1000000002(Directory@1000000000 : Text[250]);
    VAR
      FSO@1000000 : Automation "{420B2830-E718-11CF-893D-00A0C9054228} 1.0:{0D43FE01-F093-11CF-8940-00A0C9054228}:'Microsoft Scripting Runtime'.FileSystemObject";
      WindowsShell@1000000004 : Automation "{50A7E9B0-70EF-11D1-B75A-00A0C90564FE} 1.0:{13709620-C279-11CE-A49E-444553540000}:'Microsoft Shell Controls And Automation'.Shell";
      ctFolderNotExist@1000001 : TextConst 'ENU=The folder does not exist.;NLD=De map bestaat niet.';
    BEGIN
      IF ISCLEAR(WindowsShell) THEN
        CREATE(WindowsShell, FALSE, TRUE);

      CREATE(FSO,FALSE,TRUE);
      IF NOT FSO.FolderExists(Directory) THEN
        ERROR(ctFolderNotExist);

      WindowsShell.Open(Directory);
    END;

    PROCEDURE OpenFolderToFile@1000000006(FileName@1000000000 : Text[250]);
    VAR
      FSO@1000000 : Automation "{420B2830-E718-11CF-893D-00A0C9054228} 1.0:{0D43FE01-F093-11CF-8940-00A0C9054228}:'Microsoft Scripting Runtime'.FileSystemObject";
      WindowsShell@1000000004 : Automation "{50A7E9B0-70EF-11D1-B75A-00A0C90564FE} 1.0:{13709620-C279-11CE-A49E-444553540000}:'Microsoft Shell Controls And Automation'.Shell";
      ctFolderNotExist@1000001 : TextConst 'ENU=The file does not exist.;NLD=Het bestand bestaat niet.';
    BEGIN
      IF ISCLEAR(WindowsShell) THEN
        CREATE(WindowsShell, FALSE, TRUE);

      CREATE(FSO, FALSE, TRUE);
      IF NOT FSO.FileExists(FileName) THEN
        ERROR(ctFolderNotExist);

      WindowsShell.ShellExecute('explorer.exe', '/select,' + FileName);
    END;

    LOCAL PROCEDURE Split@1000016(String@1000000000 : Text[1024];SplitCharacter@1000000001 : Text[1];VAR IntoArray@1000000002 : ARRAY [40] OF Text[120]);
    VAR
      i@1000000003 : Integer;
      NoOfEntries@1000000005 : Integer;
      PrevSplitPos@1000000004 : Integer;
    BEGIN
      CLEAR(IntoArray);

      FOR i := 1 TO STRLEN(String) DO
        IF String[i] = SplitCharacter[1] THEN BEGIN
          NoOfEntries += 1;
          IntoArray[NoOfEntries] := COPYSTR(String, PrevSplitPos + 1, i - PrevSplitPos - 1);
          PrevSplitPos := i;
        END;

      NoOfEntries += 1;
      IntoArray[NoOfEntries] := COPYSTR(String, PrevSplitPos + 1, STRLEN(String) - PrevSplitPos);
    END;

    PROCEDURE Replace@1100495000(String1@1100495000 : Text[1024];String2@1100495001 : Text[1024];String3@1100495004 : Text[1024]) RetValue : Text[1024];
    VAR
      LoopCounter@1100495003 : Integer;
      StringPosition@1100495002 : Integer;
    BEGIN
      RetValue := String1;

      StringPosition := STRPOS(RetValue, String2);
      WHILE (StringPosition > 0) AND (LoopCounter <= 100) DO BEGIN
        LoopCounter += 1;
        RetValue := COPYSTR(RetValue, 1, StringPosition - 1) + String3 + COPYSTR(RetValue, StringPosition + STRLEN(String2));
        StringPosition := STRPOS(RetValue, String2);
      END
    END;

    PROCEDURE ReplacePath@1000000016(String1@1100495000 : Text[1024];String2@1100495001 : Text[1024];String3@1100495004 : Text[1024]) RetValue : Text[1024];
    VAR
      LoopCounter@1100495003 : Integer;
      StringPosition@1100495002 : Integer;
    BEGIN
      RetValue := String1;

      StringPosition := STRPOS(RetValue, String2);
      WHILE (StringPosition > 0) AND (LoopCounter <= 100) DO BEGIN
        LoopCounter += 1;
        RetValue := COPYSTR(RetValue, 1, StringPosition - 1) + String3 + COPYSTR(RetValue, StringPosition + STRLEN(String2));
        StringPosition := STRPOS(RetValue, String2);
      END
    END;

    PROCEDURE Capitalize@1000000(Text@1000000 : Text[1024]) NewText : Text[1024];
    VAR
      i@1000003 : Integer;
      MakeCapital@1000001 : Boolean;
    BEGIN
      MakeCapital := TRUE;

      FOR i := 1 TO STRLEN(Text) DO
        IF ((Text[i] >= '0') AND (Text[i] <= '9')) OR
           ((Text[i] >= 'a') AND (Text[i] <= 'z')) OR
           ((Text[i] >= 'A') AND (Text[i] <= 'Z'))
        THEN BEGIN
          IF MakeCapital THEN
            NewText += UPPERCASE(FORMAT(Text[i]))
          ELSE
            NewText += LOWERCASE(FORMAT(Text[i]));
          MakeCapital := FALSE;
        END ELSE
          MakeCapital := TRUE;

      Text := NewText;
    END;

    PROCEDURE SetFilterOnRecordRef@1100496007(VAR RecRef@1100496000 : RecordRef;Filter@1100496001 : Text[1024]);
    VAR
      Fld@1100496002 : Record 2000000041;
      FldRef@1100496008 : FieldRef;
      CurrentField@1100496006 : Text[30];
      CurrentFilter@1100496003 : Text[1024];
      Pos@1100496005 : Integer;
      SectionStarted@1100496007 : Integer;
      Section@1100496004 : 'Table,Field,Filter';
    BEGIN
      Pos := 1;

      WHILE Pos <= STRLEN(Filter) DO BEGIN

        CASE Section OF
          Section::Table :
            BEGIN
              IF Filter[1] = '"' THEN BEGIN
                Pos += 1;
                WHILE Filter[Pos] <> '"' DO
                  Pos += 1;
                Pos += 2;
              END ELSE BEGIN
                WHILE Filter[Pos] <> ':' DO
                  Pos += 1;
                Pos += 1;
              END;
              Section := Section::Field;
            END;

          Section::Field :
            BEGIN
              SectionStarted := Pos;

              IF Filter[SectionStarted] = '"' THEN BEGIN

                Pos += 1;
                WHILE Filter[Pos] <> '"' DO
                  Pos += 1;
                Pos += 1;
                CurrentField := COPYSTR(Filter, SectionStarted + 1, Pos - SectionStarted - 2);

              END ELSE BEGIN
                WHILE Filter[Pos] <> '=' DO
                  Pos += 1;
                CurrentField := COPYSTR(Filter, SectionStarted, Pos - SectionStarted);
              END;
              Section := Section::Filter;

            END;

          Section::Filter :
            BEGIN
              SectionStarted := Pos;

              IF Filter[SectionStarted] = '"' THEN BEGIN

                Pos += 1;

                WHILE (Filter[Pos] = '"') AND (Filter[Pos + 1] = '"') DO
                  Pos += 2;

                WHILE Filter[Pos] <> '"' DO BEGIN
                  Pos += 1;
                  WHILE (Filter[Pos] = '"') AND (Filter[Pos + 1] = '"') DO
                    Pos += 2;
                END;

                Pos += 1;
                CurrentFilter := COPYSTR(Filter, SectionStarted + 1, Pos - SectionStarted - 2);
                CurrentFilter := Replace(CurrentFilter, '""', '"');

              END ELSE BEGIN
                WHILE (Filter[Pos] <> ',') AND (Pos <= STRLEN(Filter)) DO
                  Pos += 1;
                CurrentFilter := COPYSTR(Filter, SectionStarted, Pos - SectionStarted);
              END;

              Section := Section::Field;

              Fld.SETRANGE(TableNo, RecRef.NUMBER);
              Fld.SETRANGE("Field Caption", CurrentField);
              IF Fld.FINDFIRST THEN BEGIN
                FldRef := RecRef.FIELD(Fld."No.");
                FldRef.SETFILTER(CurrentFilter);
              END;

            END;

        END;

        Pos += 1;
      END;
    END;

    PROCEDURE Instr@1000007(StartPos@1100496002 : Integer;String@1100496000 : Text[250];SubString@1100496001 : Text[250]) ExitValue : Integer;
    BEGIN
      IF StartPos > 1 THEN BEGIN
        String := COPYSTR(String, StartPos);
        IF STRPOS(String, SubString) > 0 THEN
          ExitValue := STRPOS(String, SubString) + StartPos - 1;
      END ELSE
        EXIT(STRPOS(String, SubString));
    END;

    PROCEDURE EmptyTableFilter@1000001(TableNo@1000001 : Integer) : Text[1024];
    VAR
      ExportDefinition@1000000 : Record 11148599;
      Object@1000002 : Record 2000000001;
    BEGIN
      IF Object.GET(Object.Type::Table, '', TableNo) THEN
        ;

      IF EVALUATE(ExportDefinition."Main Table Filter", '"' + Object.Name + '":') THEN
        EXIT(FORMAT(ExportDefinition."Main Table Filter"))
      ELSE
        EXIT('');
    END;

    PROCEDURE FormatTableFilter@1000003(VAR Text@1000001 : Text[1024];TableNo@1000000 : Integer) : Text[1024];
    VAR
      Object@1000003 : Record 2000000001;
      EmptyTableFilter2@1000002 : Text[1024];
    BEGIN
      IF Object.GET(Object.Type::Table, '', TableNo) THEN
        ;

      EmptyTableFilter2 := EmptyTableFilter(TableNo);

      IF COPYSTR(Text, 1, STRLEN(EmptyTableFilter2)) = EmptyTableFilter2 THEN
        Text := COPYSTR(Text, STRLEN(EmptyTableFilter2) + 1);
    END;

    PROCEDURE AfterInputTableFilter@1000012(VAR Text@1000001 : Text[1024];TableNo@1000000 : Integer) : Text[1024];
    VAR
      Object@1000003 : Record 2000000001;
      EmptyTableFilter2@1000002 : Text[1024];
    BEGIN
      IF Object.GET(Object.Type::Table, '', TableNo) THEN
        ;

      EmptyTableFilter2 := EmptyTableFilter(TableNo);
      Text := EmptyTableFilter2 + Text;
    END;

    PROCEDURE AfterInputFolder@1000004(VAR Text@1000000 : Text[1024]);
    BEGIN
      Text := CompletePath(Text);
    END;

    PROCEDURE LookupObjectNo@1000000003(Type@1000001 : Option;VAR Text@1100496000 : Text[1024]) : Boolean;
    VAR
      Object@1100496001 : Record 2000000001;
      Objects@1100496002 : Page 11148599;
      ObjectNo@1000000 : Integer;
    BEGIN
      Object.FILTERGROUP(2);
      Object.SETRANGE(Type, Type);
      Object.SETFILTER("Company Name", '%1', '');
      Object.FILTERGROUP(0);

      Objects.SETTABLEVIEW(Object);
      Objects.SETRECORD(Object);

      IF EVALUATE(ObjectNo, Text) THEN
        IF Object.GET(Type, '', ObjectNo) THEN
          Objects.SETRECORD(Object);

      Object.SETFILTER(Name, '@' + Text);
      IF Object.FINDFIRST THEN
        Objects.SETRECORD(Object);
      Object.SETRANGE(Name);

      IF Objects.RUNMODAL = ACTION::LookupOK THEN BEGIN
        Objects.GETRECORD(Object);
        Text := SYSTEM.FORMAT(Object.ID);
        EXIT(TRUE);
      END;
    END;

    PROCEDURE FormatObjectNo@1000000001(Type@1000003 : Option;VAR Text@1000001 : Text[1024];ObjectNo@1000000 : Integer);
    VAR
      Object@1000002 : Record 2000000001;
    BEGIN
      GetSetup;

      IF (ObjectNo = 0) OR (Type < 1) THEN
        Text := ''
      ELSE
        IF Object.GET(Type, '', ObjectNo) THEN
          IF Setup."Captions of Fields and Tables" THEN BEGIN
            Object.CALCFIELDS(Caption);
            Text := Object.Caption;
          END ELSE
            Text := Object.Name;
    END;

    PROCEDURE AfterInputObjectNo@1000000000(Type@1000003 : Option;VAR Text@1000000 : Text[1024]);
    VAR
      Object@1000002 : Record 2000000001;
      ObjectNo@1000001 : Integer;
    BEGIN
      GetSetup;

      IF NOT EVALUATE(ObjectNo, Text) THEN
        IF Text <> '' THEN BEGIN
          Object.SETRANGE(Type, Type);
          Object.SETFILTER("Company Name", '%1', '');
          Object.SETFILTER(Name, '@' + Text);

          IF Object.FINDFIRST THEN
            Text := FORMAT(Object.ID)
          ELSE BEGIN
            Object.SETFILTER(Name, '@' + Text + '*');
            IF Object.FINDFIRST THEN
              Text := FORMAT(Object.ID);
          END;
        END;
    END;

    PROCEDURE LookupTableNo@1100496000(VAR Text@1100496000 : Text[1024]) : Boolean;
    VAR
      Object@1100496001 : Record 2000000001;
      Tables@1100496002 : Page 11148598;
      TableNo@1000000 : Integer;
    BEGIN
      Object.FILTERGROUP(2);
      Object.SETRANGE(Type, Object.Type::Table);
      Object.SETFILTER("Company Name", '%1', '');
      Object.FILTERGROUP(0);

      Tables.SETTABLEVIEW(Object);
      Tables.SETRECORD(Object);

      IF EVALUATE(TableNo, Text) THEN
        IF Object.GET(Object.Type::Table, '', TableNo) THEN
          Tables.SETRECORD(Object);

      GetSetup;
      IF Setup."Captions of Fields and Tables" THEN BEGIN
        Object.SETFILTER(Caption, '@' + Text);
        IF Object.FINDFIRST THEN
          Tables.SETRECORD(Object);
        Object.SETRANGE(Caption);
      END ELSE BEGIN
        Object.SETFILTER(Name, '@' + Text);
        IF Object.FINDFIRST THEN
          Tables.SETRECORD(Object);
        Object.SETRANGE(Name);
      END;

      IF Tables.RUNMODAL = ACTION::LookupOK THEN BEGIN
        Tables.GETRECORD(Object);
        Text := SYSTEM.FORMAT(Object.ID);
        EXIT(TRUE);
      END;
    END;

    PROCEDURE LookupRelatedTableNo@1100531001(VAR SourceTableNo@1100531000 : Integer;VAR Text@1100496000 : Text[1024]) : Boolean;
    VAR
      Relation@1100531001 : Record 11148625;
      Object@1100496001 : Record 2000000001;
      Tables@1100496002 : Page 11148598;
      TableNo@1000000 : Integer;
    BEGIN
      Object.FILTERGROUP(2);
      Object.SETRANGE(Type, Object.Type::Table);
      Object.SETFILTER("Company Name", '%1', '');
      Object.FILTERGROUP(0);

      Tables.SETTABLEVIEW(Object);

      Relation.SETCURRENTKEY("Table No.");
      Relation.SETRANGE("Table No.", SourceTableNo);
      IF Relation.FINDSET THEN
        REPEAT
          IF Object.GET(Object.Type::Table, '', Relation."Relation Table No.") THEN
            Tables.MarkRecord(Object);
        UNTIL Relation.NEXT = 0;
      Relation.SETRANGE("Table No.");

      Relation.SETCURRENTKEY("Relation Table No.");
      Relation.SETRANGE("Relation Table No.", SourceTableNo);
      IF Relation.FINDSET THEN
        REPEAT
          IF Object.GET(Object.Type::Table, '', Relation."Table No.") THEN BEGIN
            Tables.MarkRecord(Object);
            Tables.SetBold(Object);
          END;
        UNTIL Relation.NEXT = 0;

      IF EVALUATE(TableNo, Text) THEN
        IF Object.GET(Object.Type::Table, '', TableNo) THEN BEGIN
          Tables.MarkRecord(Object);
          Tables.SETRECORD(Object);
        END;

      Tables.SetMarkedOnly;

      Object.SETFILTER(Name, '@' + Text);
      IF Object.FINDFIRST THEN
        Tables.SETRECORD(Object);
      Object.SETRANGE(Name);

      IF Tables.RUNMODAL = ACTION::LookupOK THEN BEGIN
        Tables.GETRECORD(Object);
        Text := SYSTEM.FORMAT(Object.ID);
        EXIT(TRUE);
      END;
    END;

    PROCEDURE FormatTableNo@1000009(VAR Text@1000001 : Text[1024];TableNo@1000000 : Integer);
    VAR
      Object@1000002 : Record 2000000001;
    BEGIN
      GetSetup;

      IF TableNo = 0 THEN
        Text := ''
      ELSE
        IF Object.GET(Object.Type::Table, '', TableNo) THEN
          IF Setup."Captions of Fields and Tables" THEN BEGIN
            Object.CALCFIELDS(Caption);
            Text := Object.Caption;
          END ELSE
            Text := Object.Name;
    END;

    PROCEDURE AfterInputTableNo@1000005(VAR Text@1000000 : Text[1024]);
    VAR
      Object@1000002 : Record 2000000001;
      ObjectNo@1000001 : Integer;
    BEGIN
      GetSetup;

      IF NOT EVALUATE(ObjectNo, Text) THEN
        IF Text <> '' THEN BEGIN
          Object.SETRANGE(Type, Object.Type::Table);
          Object.SETFILTER("Company Name", '%1', '');

          IF Setup."Captions of Fields and Tables" THEN
            Object.SETFILTER(Caption, '@' + Text)
          ELSE
            Object.SETFILTER(Name, '@' + Text);

          IF Object.FINDFIRST THEN
            Text := FORMAT(Object.ID)
          ELSE BEGIN
            IF Setup."Captions of Fields and Tables" THEN
              Object.SETFILTER(Caption, '@' + Text + '*')
            ELSE
              Object.SETFILTER(Name, '@' + Text + '*');
            IF Object.FINDFIRST THEN
              Text := FORMAT(Object.ID);
          END;
        END;
    END;

    PROCEDURE AssistTableNo@1000013(TableNo@1000000 : Integer);
    VAR
      Object@1000002 : Record 2000000001;
      TableInfo@1000001 : Page 11148602;
    BEGIN
      IF TableNo = 0 THEN
        EXIT;
      Object.GET(Object.Type::Table, '', TableNo);
      TableInfo.SETRECORD(Object);
      TableInfo.RUNMODAL;
    END;

    PROCEDURE LookupFieldNo@1000002(VAR TableNo@1000000 : Integer;VAR Text@1100496000 : Text[1024];Import@1000002 : Boolean) : Boolean;
    VAR
      Field@1100496001 : Record 2000000041;
      Fields@1100496002 : Page 11148600;
      FieldNo@1000001 : Integer;
    BEGIN
      Field.FILTERGROUP(2);
      Field.SETRANGE(TableNo, TableNo);
      SetFieldTypeFilter(Field, Import);
      Field.FILTERGROUP(0);

      Fields.SETTABLEVIEW(Field);
      Fields.LOOKUPMODE(TRUE);

      IF Field.FINDFIRST THEN
        Fields.SETRECORD(Field);

      IF EVALUATE(FieldNo, Text) THEN
        IF Field.GET(TableNo, FieldNo) THEN
          Fields.SETRECORD(Field);

      GetSetup;
      IF Setup."Captions of Fields and Tables" THEN BEGIN
        Field.SETFILTER("Field Caption", '@' + Text);
        IF Field.FINDFIRST THEN
          Fields.SETRECORD(Field);
        Field.SETRANGE("Field Caption");
      END ELSE BEGIN
        Field.SETFILTER(FieldName, '@' + Text);
        IF Field.FINDFIRST THEN
          Fields.SETRECORD(Field);
        Field.SETRANGE(FieldName);
      END;

      IF Fields.RUNMODAL = ACTION::LookupOK THEN BEGIN
        Fields.GETRECORD(Field);
        Text := SYSTEM.FORMAT(Field."No.");
        EXIT(TRUE);
      END;
    END;

    PROCEDURE FormatFieldNo@1000010(VAR Text@1000001 : Text[1024];TableNo@1000000 : Integer;FieldNo@1000003 : Integer);
    VAR
      Field@1000002 : Record 2000000041;
    BEGIN
      GetSetup;

      IF (TableNo = 0) OR (FieldNo = 0) THEN
        Text := ''
      ELSE
        IF Field.GET(TableNo, FieldNo) THEN
          IF Setup."Captions of Fields and Tables" THEN
            Text := Field."Field Caption"
          ELSE
            Text := Field.FieldName;
    END;

    PROCEDURE AfterInputFieldNo@1000011(VAR Text@1000000 : Text[1024];TableNo@1000003 : Integer;Import@1000004 : Boolean);
    VAR
      Field@1000002 : Record 2000000041;
      FieldNo@1000001 : Integer;
    BEGIN
      GetSetup;

      IF NOT EVALUATE(FieldNo, Text) THEN
        IF Text <> '' THEN BEGIN
          Field.SETRANGE(TableNo, TableNo);
          SetFieldTypeFilter(Field, Import);
          IF Setup."Captions of Fields and Tables" THEN
            Field.SETFILTER("Field Caption", '@' + Text)
          ELSE
            Field.SETFILTER(FieldName, '@' + Text);
          IF Field.FINDFIRST THEN
            Text := FORMAT(Field."No.")
          ELSE BEGIN
            IF Setup."Captions of Fields and Tables" THEN
              Field.SETFILTER("Field Caption", '@' + Text + '*')
            ELSE
              Field.SETFILTER(FieldName, '@' + Text + '*');
            IF Field.FINDFIRST THEN
              Text := FORMAT(Field."No.");
          END;
        END;
    END;

    LOCAL PROCEDURE GetSetup@1000014();
    BEGIN
      IF NOT SetupGet THEN BEGIN
        Setup.GET;
        SetupGet := TRUE;
      END;
    END;

    PROCEDURE ResetSetup@1000015();
    BEGIN
      SetupGet := FALSE;
    END;

    PROCEDURE SendEmail@2(EmailAddress@1001 : Text[80];Subject@1003 : Text[260];Body@1000000009 : Text[1024];AttachFileName@1000000 : Text[260]) MailSent : Boolean;
    VAR
      BSTRConverterAttachFileName@1000000003 : Automation "{A378E78B-5DB6-45E9-B598-9ED74A7CCCE1} 1.0:{30E9A1F9-9B22-4D26-91CF-C6CC2D9BC2D9}:'Navision Attain Hash 1.0'.BSTRConverter";
      BSTRConverterBody@1000000004 : Automation "{A378E78B-5DB6-45E9-B598-9ED74A7CCCE1} 1.0:{30E9A1F9-9B22-4D26-91CF-C6CC2D9BC2D9}:'Navision Attain Hash 1.0'.BSTRConverter";
      OApplication@1000000008 : Automation "{03BC4F50-2ABB-48B3-B2A6-3F08EB1D013E} 1.7:{4DD4A3AB-B2FB-4852-A2C8-7C4691C536EA}:'NS Outlook Synchronization Handler'.OApplication";
      OAttachment@1000002 : Automation "{03BC4F50-2ABB-48B3-B2A6-3F08EB1D013E} 1.7:{3FEDE949-33CB-4EE0-8FA2-309003459254}:'NS Outlook Synchronization Handler'.OAttachment";
      OAttachments@1000001 : Automation "{03BC4F50-2ABB-48B3-B2A6-3F08EB1D013E} 1.7:{355ADBA4-2CE8-417A-B4F6-75A76E36C284}:'NS Outlook Synchronization Handler'.OAttachments";
      OSendMail@1000000005 : Automation "{03BC4F50-2ABB-48B3-B2A6-3F08EB1D013E} 1.7:{F3B45F48-1F4A-40C9-8DE6-5CC377BF4F82}:'NS Outlook Synchronization Handler'.OSendMail";
      MailGUIDValue@1000000000 : GUID;
      ErrorNo@1000000001 : Integer;
    BEGIN
      IF ISCLEAR(OApplication) THEN
        CREATE(OApplication, FALSE, TRUE);

      IF NOT OApplication.Logon(TRUE, '', '', FALSE, FALSE) THEN BEGIN
        OApplication.Logoff;
        EXIT;
      END;

      IF ISCLEAR(OSendMail) THEN
        CREATE(OSendMail, FALSE, TRUE);

      ErrorNo := 0;

      OSendMail."To" := EmailAddress;
      OSendMail.Subject := Subject;
      OSendMail.BodyFormat := 2;
      MailGUIDValue := CREATEGUID;
      OSendMail.SetUserProperty('Mail GUID', 1, FORMAT(MailGUIDValue));

      IF ISCLEAR(BSTRConverterBody) THEN
        CREATE(BSTRConverterBody,FALSE,TRUE);

      IF Body <> '' THEN BEGIN
        BSTRConverterBody.ResetBSTR;
        BSTRConverterBody.AppendNextStringPortion(Body);
      END;
      OSendMail.Body := BSTRConverterBody;

      IF AttachFileName <> '' THEN BEGIN
        IF ISCLEAR(BSTRConverterAttachFileName) THEN
          CREATE(BSTRConverterAttachFileName,FALSE,TRUE);

        BSTRConverterAttachFileName.ResetBSTR;
        BSTRConverterAttachFileName.AppendNextStringPortion(AttachFileName);
        OAttachments := OSendMail.Attachments;
        OAttachment := OAttachments.Add(BSTRConverterAttachFileName);
      END;

      OSendMail.OpenDialog := FALSE;

      MailSent := OSendMail.Send;
      ErrorNo := OSendMail.ErrorStatus;
      OApplication.Logoff;
    END;

    PROCEDURE ExcelColumn@1000017(ColumnNo@1000000000 : Integer) : Code[10];
    VAR
      Ch@1000000001 : Char;
      Ch2@1000000002 : Char;
    BEGIN
      IF ColumnNo > 26 THEN BEGIN
        Ch := 64 + (ROUND((ColumnNo - 1) / 26, 1, '<'));
        Ch2 := 64 + ((ColumnNo - 1) MOD 26) + 1;
        EXIT(FORMAT(Ch) + FORMAT(Ch2));
      END ELSE BEGIN
        Ch := 64 + ColumnNo;
        EXIT(FORMAT(Ch));
      END;
    END;

    PROCEDURE SetFieldTypeFilter@1100496006(VAR Fld@1100496000 : Record 2000000041;Import@1000000 : Boolean);
    VAR
      Filter@1100496001 : Text[1024];
    BEGIN
      Filter :=
        FORMAT(Fld.Type::RecordID) + '|' +
        FORMAT(Fld.Type::Text) + '|' +
        FORMAT(Fld.Type::Code) + '|' +
        FORMAT(Fld.Type::GUID) + '|' +
        FORMAT(Fld.Type::Date) + '|' +
        FORMAT(Fld.Type::Time) + '|' +
        FORMAT(Fld.Type::DateFormula) + '|' +
        FORMAT(Fld.Type::Decimal) + '|' +
        FORMAT(Fld.Type::Integer) + '|' +
        FORMAT(Fld.Type::Option) + '|' +
        FORMAT(Fld.Type::Boolean) + '|' +
        FORMAT(Fld.Type::BigInteger) + '|' +
        FORMAT(Fld.Type::Duration) + '|' +
        FORMAT(Fld.Type::DateTime);

      Fld.SETFILTER(Type, Filter);

      IF Import THEN
        Fld.SETRANGE(Class, Fld.Class::Normal)
      ELSE
        Fld.SETFILTER(Class, '%1|%2', Fld.Class::Normal, Fld.Class::FlowField)
    END;

    PROCEDURE Ansi2Ascii@9(TextToConvert@1000000 : Text[1024]) : Text[1024];
    BEGIN
      IF NOT AnsiAsciiInitialized THEN
        InitializeAnsiAscii;
      EXIT(CONVERTSTR(TextToConvert, AnsiStr, AsciiStr));
    END;

    PROCEDURE Ascii2Ansi@10(TextToConvert@1000000 : Text[1024]) : Text[1024];
    BEGIN
      IF NOT AnsiAsciiInitialized THEN
        InitializeAnsiAscii;
      EXIT(CONVERTSTR(TextToConvert, AsciiStr, AnsiStr));
    END;

    LOCAL PROCEDURE InitializeAnsiAscii@1();
    VAR
      CharVar@1000000 : ARRAY [32] OF Char;
    BEGIN
      AsciiStr := '++++--+-+++---+';
      AsciiStr := AsciiStr + 'i++_=';

      CharVar[1] := 196;
      CharVar[2] := 197;
      CharVar[3] := 201;
      CharVar[4] := 242;
      CharVar[5] := 220;
      CharVar[6] := 186;
      CharVar[7] := 191;
      CharVar[8] := 188;
      CharVar[9] := 187;
      CharVar[10] := 193;
      CharVar[11] := 194;
      CharVar[12] := 192;
      CharVar[13] := 195;
      CharVar[14] := 202;
      CharVar[15] := 203;
      CharVar[16] := 200;
      CharVar[17] := 205;
      CharVar[18] := 206;
      CharVar[19] := 204;
      CharVar[20] := 175;
      CharVar[21] := 223;
      CharVar[22] := 213;
      CharVar[23] := 254;
      CharVar[24] := 218;
      CharVar[25] := 219;
      CharVar[26] := 217;
      CharVar[27] := 180;
      CharVar[28] := 177;
      CharVar[29] := 176;
      CharVar[30] := 185;
      CharVar[31] := 179;
      CharVar[32] := 178;

      AnsiStr := '' + FORMAT(CharVar[1]) + FORMAT(CharVar[2]) + FORMAT(CharVar[3]) + '' + FORMAT(CharVar[4]);
      AnsiStr := AnsiStr + '' + FORMAT(CharVar[5]) + '' + FORMAT(CharVar[6]) + FORMAT(CharVar[7]);
      AnsiStr := AnsiStr + '' + FORMAT(CharVar[8]) + '' + FORMAT(CharVar[9]) + '___' + FORMAT(CharVar[10]) + FORMAT(CharVar[11]);
      AnsiStr := AnsiStr + FORMAT(CharVar[12]) + '++++--+-+' + FORMAT(CharVar[13]) + '++---+';
      AnsiStr := AnsiStr + FORMAT(CharVar[14]) + FORMAT(CharVar[15]) + FORMAT(CharVar[16]) + 'i' + FORMAT(CharVar[17]);
      AnsiStr := AnsiStr + FORMAT(CharVar[18]);
      AnsiStr := AnsiStr + '++__' + FORMAT(CharVar[19]) + FORMAT(CharVar[20]) + '' + FORMAT(CharVar[21]) + '';
      AnsiStr := AnsiStr + FORMAT(CharVar[22]) + '' + FORMAT(CharVar[23]) + '' + FORMAT(CharVar[24]) + FORMAT(CharVar[25]);
      AnsiStr :=
        AnsiStr + FORMAT(CharVar[26]) + '' + FORMAT(CharVar[27]) + '' + FORMAT(CharVar[28]) + '=' + FORMAT(CharVar[29]);
      AnsiStr := AnsiStr + '' + FORMAT(CharVar[30]) + FORMAT(CharVar[31]) + FORMAT(CharVar[32]) + '_ ';

      AnsiAsciiInitialized := TRUE;
    END;

    PROCEDURE AddDateStamp@1000018(FileName@1000000 : Text[1024]) : Text[1024];
    BEGIN
      EXIT(BuildPath(GetPath(FileName),
                     GetFilenameWithoutExtension(FileName) +
                     '_' + FORMAT(CURRENTDATETIME, 0, '<Year4><Month,2><Day,2><Hour,2><Minute,2><Second,2>') +
                     '.' + GetExtension(FileName)));
    END;

    PROCEDURE TableTagName@1000019(TableNo@1000002 : Integer) : Text[1024];
    VAR
      Object@1000001 : Record 2000000001;
    BEGIN
      IF NOT Object.GET(Object.Type::Table, '', TableNo) THEN
        EXIT('');

      GetSetup;
      IF Setup."Use Captions in Tag Names" THEN BEGIN
        Object.CALCFIELDS(Caption);
        EXIT(Capitalize(Object.Caption));
      END ELSE
        EXIT(Capitalize(Object.Name));
    END;

    PROCEDURE FieldTagName@1100531002(TableNo@1100531000 : Integer;FieldNo@1100531001 : Integer) : Text[1024];
    VAR
      Fld@1100531003 : Record 2000000041;
    BEGIN
      GetSetup;

      IF Fld.GET(TableNo, FieldNo) THEN
        IF Setup."Use Captions in Tag Names" THEN
          EXIT(Capitalize(Fld."Field Caption"))
        ELSE
          EXIT(Capitalize(Fld.FieldName));
    END;

    PROCEDURE VersionNo@1100496005() : Text[100];
    VAR
      Object@1100496001 : Record 2000000001;
      HighestVersionNumber@1100496008 : Text[30];
      RestVersion@1100496005 : Text[100];
      VersionNumber@1100496007 : Text[30];
      CommaPos@1100496006 : Integer;
      VersionIdPos@1100496004 : Integer;
    BEGIN
      Object.SETFILTER("Version List", '*' + 'JPCON' + '*');
      IF Object.FINDSET THEN
        REPEAT
          VersionIdPos := STRPOS(Object."Version List", 'JPCON');
          RestVersion := COPYSTR(Object."Version List", VersionIdPos);
          CommaPos := STRPOS(RestVersion, ',');
          IF CommaPos > 0 THEN
            VersionNumber := COPYSTR(Object."Version List", VersionIdPos + 5, CommaPos - 1)
          ELSE
            VersionNumber := COPYSTR(Object."Version List", VersionIdPos + 5);
          IF VersionNumber > HighestVersionNumber THEN
            HighestVersionNumber := VersionNumber;
        UNTIL Object.NEXT = 0;

      EXIT(HighestVersionNumber);
    END;

    PROCEDURE GetWidth@1000008(Fld@1000000 : Record 2000000041) : Integer;
    BEGIN
      WITH Fld DO
        CASE Type OF

          Type::TableFilter :
            EXIT(20);

          Type::RecordID :
            EXIT(20);

          Type::Text :
            EXIT(Len);

          Type::Date :
            EXIT(STRLEN('2099-12-31'));

          Type::Time :
            EXIT(STRLEN('12:00:00'));

          Type::DateFormula :
            EXIT(10);

          Type::Decimal :
            EXIT(12);

          Type::Boolean :
            EXIT(3);

          Type::Integer :
            EXIT(7);

          Type::Code :
            EXIT(Len);

          Type::Option :
            EXIT(10);

          Type::BigInteger :
            EXIT(7);

          Type::Duration :
            EXIT(20);

          Type::GUID :
            EXIT(STRLEN('{00000000-0000-0000-0000-000000000000}'));

          Type::DateTime :
            EXIT(STRLEN('2099-12-31 12:00:00'));

        END;
    END;

    PROCEDURE SplitFilenamePath@1000020(PathFilename@1000000 : Text[1024];VAR Path@1000001 : Text[1024];VAR Filename@1000002 : Text[1024]);
    VAR
      i@1000003 : Integer;
    BEGIN
      Path := '';
      Filename := PathFilename;

      i := STRLEN(PathFilename);
      WHILE i >= 1 DO BEGIN
        IF PathFilename[i] = DirectorySeparator[1] THEN BEGIN
          Path := COPYSTR(PathFilename, 1, i);
          Filename := COPYSTR(PathFilename, i + 1);
          EXIT;
        END;
        i -= 1;
      END;
    END;

    PROCEDURE TmpDir@1100531000() : Text[1024];
    VAR
      AutoMgt@1000000000 : Codeunit 419;
    BEGIN
      GetSetup;

      IF Setup."Temp Directory" = '' THEN BEGIN
        // CI-177.begin
        //ExitValue := AutoMgt.ServerTempFileName('');
        //IF ExitValue = '' THEN
        //  ERROR('Unable to access tempdir.');
        EXIT(TEMPORARYPATH);
        // CI-177.end
      END ELSE
        EXIT(Setup."Temp Directory");
    END;

    PROCEDURE QueryReplace@1100531003(Filename@1000000 : Text[1024]);
    VAR
      ctFileAlreadyExists@1000001 : TextConst 'ENU=The %1 file already exists.\Do you want to replace the existing file?;NLD=Bestand %1 bestaat reeds.\Wilt u het bestaande bestand vervangen?';
    BEGIN
      IF EXISTS(Filename) THEN BEGIN
        IF NOT CONFIRM(ctFileAlreadyExists, TRUE, Filename) THEN
          ERROR('');
        ERASE(Filename);
      END;
    END;

    PROCEDURE SendKeys@1000000004(Keys@1000000000 : Text[30]);
    VAR
      WinShell@1000000001 : Automation "{F935DC20-1CF0-11D0-ADB9-00C04FD58A0B} 1.0:{72C24DD5-D70A-438B-8A42-98424B88AFB8}:'Windows Script Host Object Model'.WshShell";
    BEGIN
      IF Keys = '' THEN
        EXIT;

      IF ISCLEAR(WinShell) THEN
        CREATE(WinShell,FALSE,TRUE);

      WinShell.SendKeys(Keys);
    END;

    PROCEDURE SetTableFilter@1000000005(_TableNo@1000000000 : Integer;_CurrTableFilter@1000000001 : Text[1024]) Result : Text[1024];
    VAR
      TableFilterRec@1000000003 : Record 11148641;
      TableFilterForm@1000000002 : Page 11148611;
    BEGIN
      TableFilterForm.SetTableNo(_TableNo);
      TableFilterForm.SetCurrentFilter(_CurrTableFilter);
      TableFilterForm.SETRECORD(TableFilterRec);

      Result := _CurrTableFilter;

      IF TableFilterForm.RUNMODAL = ACTION::OK THEN BEGIN
        TableFilterForm.GETRECORD(TableFilterRec);

        _CurrTableFilter := TableFilterRec.CreateTableFilter;
        TableFilterForm.ClearTable;
        Result := _CurrTableFilter;
      END;
    END;

    PROCEDURE GetPath@1000000014(Path@1000000000 : Text[1024]) Foldername : Text[1024];
    VAR
      FSO@1000000001 : Automation "{F935DC20-1CF0-11D0-ADB9-00C04FD58A0B} 1.0:{0D43FE01-F093-11CF-8940-00A0C9054228}:'Windows Script Host Object Model'.FileSystemObject";
      Dir@11154640 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Directory";
      DirInfo@11154641 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.DirectoryInfo";
    BEGIN
      IF ISSERVICETIER THEN BEGIN
        DirInfo := Dir.GetParent(Path);
        Foldername := DirInfo.FullName();
      END ELSE BEGIN
        CREATE(FSO, FALSE, FALSE);
        Foldername := FSO.GetParentFolderName(Path);
        CLEAR(FSO);
      END;
    END;

    PROCEDURE GetFilename@1000000013(Path@1000000000 : Text[1024]) Filename : Text[1024];
    VAR
      FSO@1000000001 : Automation "{F935DC20-1CF0-11D0-ADB9-00C04FD58A0B} 1.0:{0D43FE01-F093-11CF-8940-00A0C9054228}:'Windows Script Host Object Model'.FileSystemObject";
      PathInfo@11154641 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path";
    BEGIN
      IF ISSERVICETIER THEN BEGIN
        Filename := PathInfo.GetFileName(Path);
      END ELSE BEGIN
        CREATE(FSO, FALSE, FALSE);
        Filename := FSO.GetFileName(Path);
        CLEAR(FSO);
      END;
    END;

    PROCEDURE GetFilenameWithoutExtension@1000000012(Path@1000000000 : Text[1024]) FilenameWithoutExtension : Text[1024];
    VAR
      FSO@1000000001 : Automation "{F935DC20-1CF0-11D0-ADB9-00C04FD58A0B} 1.0:{0D43FE01-F093-11CF-8940-00A0C9054228}:'Windows Script Host Object Model'.FileSystemObject";
      PathInfo@11154639 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path";
    BEGIN
      IF ISSERVICETIER THEN BEGIN
        FilenameWithoutExtension := PathInfo.GetFileNameWithoutExtension(Path);
      END ELSE BEGIN
        CREATE(FSO, FALSE, FALSE);
        FilenameWithoutExtension := FSO.GetBaseName(Path);
        CLEAR(FSO);
      END;
    END;

    PROCEDURE GetExtension@1000000011(Path@1000000000 : Text[1024]) Extension : Text[1024];
    VAR
      FSO@1000000001 : Automation "{F935DC20-1CF0-11D0-ADB9-00C04FD58A0B} 1.0:{0D43FE01-F093-11CF-8940-00A0C9054228}:'Windows Script Host Object Model'.FileSystemObject";
      PathInfo@11154639 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path";
    BEGIN
      IF ISSERVICETIER THEN BEGIN
        Extension := PathInfo.GetExtension(Path);
      END ELSE BEGIN
        CREATE(FSO, FALSE, FALSE);
        Extension := FSO.GetExtensionName(Path);
        CLEAR(FSO);
      END;
    END;

    PROCEDURE PathExists@1000000007(Path@1000000000 : Text[1024]) : Boolean;
    VAR
      FSO@1000000002 : Automation "{F935DC20-1CF0-11D0-ADB9-00C04FD58A0B} 1.0:{0D43FE01-F093-11CF-8940-00A0C9054228}:'Windows Script Host Object Model'.FileSystemObject";
      Dir@1000000001 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Directory";
    BEGIN
      IF ISSERVICETIER THEN BEGIN
        EXIT(Dir.Exists(Path));
      END ELSE BEGIN
        CREATE(FSO, FALSE, FALSE);
        EXIT(FSO.FolderExists(Path));
      END;
    END;

    PROCEDURE FileExists@1000000009(Path@1000000000 : Text[1024]) : Boolean;
    VAR
      FSO@1000000002 : Automation "{F935DC20-1CF0-11D0-ADB9-00C04FD58A0B} 1.0:{0D43FE01-F093-11CF-8940-00A0C9054228}:'Windows Script Host Object Model'.FileSystemObject";
      File@1000000001 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.File";
    BEGIN
      IF ISSERVICETIER THEN BEGIN
        EXIT(File.Exists(Path));
      END ELSE BEGIN
        CREATE(FSO, FALSE, FALSE);
        EXIT(FSO.FileExists(Path));
      END;
    END;

    PROCEDURE BuildPath@1000000008(Path1@1000000000 : Text[1024];Path2@1000000001 : Text[1024]) : Text[1024];
    VAR
      FSO@1000000003 : Automation "{F935DC20-1CF0-11D0-ADB9-00C04FD58A0B} 1.0:{0D43FE01-F093-11CF-8940-00A0C9054228}:'Windows Script Host Object Model'.FileSystemObject";
      PathInfo@1000000002 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path";
    BEGIN
      IF ISSERVICETIER THEN BEGIN
        EXIT(PathInfo.Combine(Path1, Path2) + DirectorySeparator);
      END ELSE BEGIN
        CREATE(FSO, FALSE, FALSE);
        EXIT(FSO.BuildPath(Path1, Path2) + DirectorySeparator);
      END;
    END;

    PROCEDURE DirectorySeparator@1000000010() : Text[1];
    BEGIN
      EXIT('\');
    END;

    PROCEDURE CompletePath@1000000015(Path@1000000000 : Text[1024]) : Text[1024];
    BEGIN
      IF Path <> '' THEN
        IF Path[STRLEN(Path)] <> DirectorySeparator[1] THEN
          EXIT(Path + DirectorySeparator);

      EXIT(Path);
    END;

    PROCEDURE ShellCommand@1000000017(Command@1000001 : Text[1024]);
    VAR
      WSShell@1000000 : Automation "{F935DC20-1CF0-11D0-ADB9-00C04FD58A0B} 1.0:{72C24DD5-D70A-438B-8A42-98424B88AFB8}:'Windows Script Host Object Model'.WshShell";
      WindowStyle@1000002 : Integer;
      WaitForResponse@1000003 : Boolean;
    BEGIN
      CREATE(WSShell, TRUE, TRUE);
      WindowStyle := 1;
      WaitForResponse := TRUE;

      WSShell.Run(Command, WindowStyle, WaitForResponse);
    END;

    PROCEDURE SystemRoot@1000000018() ExitValue : Text[1024];
    VAR
      Environment@1000000001 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Environment";
      FileSystemObject@1000000000 : Automation "{420B2830-E718-11CF-893D-00A0C9054228} 1.0:{0D43FE01-F093-11CF-8940-00A0C9054228}:'Microsoft Scripting Runtime'.FileSystemObject";
      Folder@1000000002 : Automation "{420B2830-E718-11CF-893D-00A0C9054228} 1.0:{C7C3F5B3-88A3-11D0-ABCB-00A0C90FFFC0}:'Microsoft Scripting Runtime'.Folder";
      FolderSpec@1000000003 : 'WindowsFolder,SystemFolder,TemporaryFolder';
    BEGIN
      IF NOT ISSERVICETIER THEN BEGIN
        CREATE(FileSystemObject, TRUE, TRUE);
        Folder := FileSystemObject.GetSpecialFolder(FolderSpec::SystemFolder);
        ExitValue := Folder.Path;
      END ELSE BEGIN
        ExitValue := Environment.SystemDirectory;
      END;

      IF ExitValue = '' THEN
        ERROR('Unable to access systemroot.');
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148590 IN - Transport Management
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    TableNo=11148590;
    OnRun=BEGIN
            IF Status = Status::Blocked THEN
              FIELDERROR(Status);

            NoOfFilesTransported := -1;

            CASE Type OF

              Type::"FTP Download" :
                IF "FTP Type" = "FTP Type"::"Windows EXE" THEN
                  GetExecutableFTP(Rec)
                ELSE
                  NoOfFilesTransported := GetFTP(Rec);

              Type::"FTP Upload" :
                IF "FTP Type" = "FTP Type"::"Windows EXE" THEN
                  PutExecutableFTP(Rec)
                ELSE
                  NoOfFilesTransported := PutFTP(Rec);

              Type::Move :
                Move(Rec);

              Type::Executable :
                RunExecutable(Rec);

            END;
          END;

  }
  CODE
  {
    VAR
      NoOfFilesTransported@1000000 : Integer;

    LOCAL PROCEDURE GetExecutableFTP@1000007(VAR Transport@1100496006 : Record 11148590);
    VAR
      Setup@1100496005 : Record 11148589;
      File@1100496000 : Record 2000000022;
      Mgt@1100531000 : Codeunit 11148589;
      FTPFile@1100496002 : File;
      FTPFileName@1100496003 : Text[255];
    BEGIN
      Setup.GET;
      Setup.TESTFIELD("FTP Executable");

      Transport.TESTFIELD(Address);
      Transport.TESTFIELD(Account);

      FTPFileName := CombinePaths(Mgt.TmpDir, 'getfiles.txt', '\');
      IF EXISTS(FTPFileName) THEN
        ERASE(FTPFileName);

      FTPFile.CREATE(FTPFileName);
      FTPFile.WRITEMODE(TRUE);
      FTPFile.TEXTMODE(TRUE);

      CASE Transport."Custom Port" = 0 OF
        TRUE: FTPFile.WRITE('open ' + Transport.Address);
        FALSE: FTPFile.WRITE(STRSUBSTNO('open %1:%2', Transport.Address, Transport."Custom Port")); // CI-173
      END;

      FTPFile.WRITE(Transport.Account);
      FTPFile.WRITE(Transport.Password);
      FTPFile.WRITE('lcd "' + DELCHR(Transport."To Location", '>', '\') + '"');

      IF Transport."From Location" <> '' THEN
        FTPFile.WRITE('cd "' + Transport."From Location" + '"');

      IF Transport."Transfer Mode" = Transport."Transfer Mode"::Bin THEN
        FTPFile.WRITE('bin')
      ELSE
        FTPFile.WRITE('ascii');

      IF Transport.Filename = '' THEN
        FTPFile.WRITE('mget *')
      ELSE
        FTPFile.WRITE('mget "' + Transport.Filename + '"');
      FTPFile.WRITE('bye');
      FTPFile.CLOSE;
      Mgt.ShellCommand(Setup."FTP Executable" + ' -i -s:' + FTPFileName);

      FTPFileName := CombinePaths(Mgt.TmpDir, 'delfiles.txt', '\');
      IF EXISTS(FTPFileName) THEN
        ERASE(FTPFileName);

      FTPFile.CREATE(FTPFileName);
      FTPFile.WRITEMODE(TRUE);
      FTPFile.TEXTMODE(TRUE);
      CASE Transport."Custom Port" = 0 OF
        TRUE: FTPFile.WRITE('open ' + Transport.Address);
        FALSE: FTPFile.WRITE(STRSUBSTNO('open %1:%2', Transport.Address, Transport."Custom Port")); // CI-173
      END;
      FTPFile.WRITE(Transport.Account);
      FTPFile.WRITE(Transport.Password);

      IF Transport."From Location" <> '' THEN
        FTPFile.WRITE('cd "' + Transport."From Location" + '"');

      File.SETRANGE(Path, 'c:\');
      IF File.FINDFIRST THEN
        ;

      File.SETRANGE(Path, Transport."To Location");
      File.SETRANGE("Is a file", TRUE);

      IF Transport.Filename <> '' THEN
        File.SETFILTER(Name, '@' + Transport.Filename);

      IF File.FINDSET THEN
        REPEAT
          FTPFile.WRITE('delete "' + File.Name + '"');
        UNTIL File.NEXT = 0;
      FTPFile.WRITE('bye');

      FTPFile.CLOSE;

      Mgt.ShellCommand(Setup."FTP Executable" + ' -i -s:' + FTPFileName);
    END;

    LOCAL PROCEDURE PutExecutableFTP@1000006(VAR Transport@1100496006 : Record 11148590);
    VAR
      Setup@1100496005 : Record 11148589;
      FileRec@1100496000 : Record 2000000022;
      Mgt@1000000 : Codeunit 11148589;
      FTPFile@1100496002 : File;
      ArchiveLocation@1100496010 : Text[1024];
      BackupName@1100512000 : Text[1024];
      FromName@1100496008 : Text[1024];
      FTPFileName@1100496003 : Text[255];
      ToName@1100496007 : Text[1024];
    BEGIN
      Setup.GET;
      Setup.TESTFIELD("FTP Executable");

      Transport.TESTFIELD(Address);
      Transport.TESTFIELD(Account);
      Transport.TESTFIELD("From Location");
      Transport.TESTFIELD("Archive Location");

      FTPFileName := CombinePaths(Mgt.TmpDir, 'putfiles.txt', '\');
      IF EXISTS(FTPFileName) THEN
        ERASE(FTPFileName);

      FTPFile.CREATE(FTPFileName);
      FTPFile.WRITEMODE(TRUE);
      FTPFile.TEXTMODE(TRUE);
      CASE Transport."Custom Port" = 0 OF
        TRUE: FTPFile.WRITE('open ' + Transport.Address);
        FALSE: FTPFile.WRITE(STRSUBSTNO('open %1:%2', Transport.Address, Transport."Custom Port")); // CI-173
      END;
      FTPFile.WRITE(Transport.Account);
      FTPFile.WRITE(Transport.Password);
      FTPFile.WRITE('lcd "' + DELCHR(Transport."From Location", '>', '\') + '"');
      FTPFile.WRITE('cd "' + Transport."To Location" + '"');

      IF Transport."Transfer Mode" = Transport."Transfer Mode"::Bin THEN
        FTPFile.WRITE('bin')
      ELSE
        FTPFile.WRITE('ascii');

      IF Transport.Filename = '' THEN
        FTPFile.WRITE('mput *')
      ELSE
        FTPFile.WRITE('mput "' + Transport.Filename + '"');
      FTPFile.WRITE('bye');
      FTPFile.CLOSE;
      Mgt.ShellCommand(Setup."FTP Executable" + ' -i -s:' + FTPFileName);

      FileRec.SETRANGE(Path, 'c:\');
      IF FileRec.FINDFIRST THEN
        ;

      IF Transport."Archive Location" <> '' THEN BEGIN
        ArchiveLocation := FORMAT(TODAY, 0, Transport."Archive Location");
        Mgt.CheckCreateDirectory(ArchiveLocation);

        FileRec.SETRANGE(Path, Transport."From Location");
        IF Transport.Filename <> '' THEN
          FileRec.SETFILTER(Name, '@' + Transport.Filename);

        FileRec.SETRANGE("Is a file", TRUE);
        IF FileRec.FINDSET THEN
          REPEAT
            FromName := CombinePaths(FileRec.Path, FileRec.Name, '\');
            IF Transport."Archive add YYYYMMDD" THEN
              ToName := Mgt.AddDateStamp(CombinePaths(ArchiveLocation, FileRec.Name, '\'))
            ELSE
              ToName := CombinePaths(ArchiveLocation, FileRec.Name, '\');

            IF LOWERCASE(FromName) <> LOWERCASE(ToName) THEN BEGIN
              IF EXISTS(ToName) THEN BEGIN
                BackupName := Mgt.AddDateStamp(ToName);
                FILE.RENAME(ToName, BackupName);
              END;
              FILE.RENAME(FromName, ToName);
            END;
          UNTIL FileRec.NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE GetFTP@1000000(VAR Transport@1100496006 : Record 11148590) ExitValue : Integer;
    VAR
      FTP@1000000001 : Codeunit 11148597;
      DirectoryList@1000000002 : Codeunit 11148598;
      Mgt@1000009 : Codeunit 11148589;
      ArchiveFilename@1000008 : Text[1024];
      ArchiveLocation@1000005 : Text[1024];
      CurrentFilename@1000004 : Text[1024];
      LocalFilename@1000006 : Text[1024];
      RemoteFilename@1000007 : Text[1024];
      i@1000002 : Integer;
      Binary@1000003 : Boolean;
      LastError@1000000000 : Text[1024];
    BEGIN
      Transport.TESTFIELD(Address);
      Transport.TESTFIELD(Account);
      Transport.TESTFIELD("From Location");
      Transport.TESTFIELD("To Location");

      FTP.Create(TRUE, FALSE);
      FTP.SetHostName(Transport.Address);
      // CI-173.begin
      IF Transport."Custom Port" <> 0 THEN
        FTP.SetPort(Transport."Custom Port");
      // CI-173.end
      FTP.SetUserName(Transport.Account);
      FTP.SetPassword(Transport.Password);

      CASE Transport."FTP Type" OF
        Transport."FTP Type"::"SFTP (ssl)": FTP.SetEnableSsl(TRUE);
        Transport."FTP Type"::"SFTP (ssh)": FTP.SetEnableSsh(TRUE);
      END;

      IF Transport.Filename = '' THEN
        FTP.GetDirectoryContents(Transport."From Location", DirectoryList)
      ELSE
        FTP.GetDirectoryContents(CombinePaths(Transport."From Location", Transport.Filename, '/'), DirectoryList);

      IF (DirectoryList.Count = 0) THEN BEGIN
        LastError := FTP.LastError;
        IF (LastError <> '') AND (NOT (STRPOS(LastError, '(450)') > 0)) THEN
          MESSAGE(LastError);
      END;

      Binary := Transport."Transfer Mode" = Transport."Transfer Mode"::Bin;

      ArchiveLocation := FORMAT(TODAY, 0, Transport."Archive Location");

      FOR i := 0 TO DirectoryList.Count DO
        IF DirectoryList.GetItem(i) <> '' THEN BEGIN
          CurrentFilename := DirectoryList.GetItem(i);

          IF CurrentFilename[STRLEN(CurrentFilename)] = 13 THEN
            CurrentFilename := COPYSTR(CurrentFilename, 1, STRLEN(CurrentFilename) - 1);

          LocalFilename := CombinePaths(Transport."To Location", CurrentFilename, '\');
          RemoteFilename := CombinePaths(Transport."From Location", CurrentFilename, '/');

          IF Transport."Archive add YYYYMMDD" THEN
            ArchiveFilename := Mgt.AddDateStamp(CombinePaths(ArchiveLocation, CurrentFilename, '\'))
          ELSE
            ArchiveFilename := CombinePaths(ArchiveLocation, CurrentFilename, '\');

          IF FTP.DownloadFile(LocalFilename, RemoteFilename, Binary) THEN BEGIN
            ExitValue += 1;

            IF ArchiveLocation = '' THEN BEGIN
              IF NOT FTP.DeleteFile(RemoteFilename) THEN
                MESSAGE(FTP.LastError);
            END ELSE
              IF NOT FTP.MoveFile(RemoteFilename, ArchiveFilename) THEN
                MESSAGE(FTP.LastError);

          END ELSE
            MESSAGE(FTP.LastError);

        END;
    END;

    LOCAL PROCEDURE PutFTP@1000011(VAR Transport@1100496006 : Record 11148590) ExitValue : Integer;
    VAR
      Mgt@1000000 : Codeunit 11148589;
      Directory@1000 : Codeunit 11148652;
      Ftp@1000007 : Codeunit 11148597;
      FileName@1001 : Text[260];
      ArchiveFilename@1000001 : Text[1024];
      ArchiveFilenameStamp@1000005 : Text[1024];
      ArchiveLocation@1000002 : Text[1024];
      LocalFilename@1000004 : Text[1024];
      RemoteFilename@1000003 : Text[1024];
      Binary@1000006 : Boolean;
    BEGIN
      // CI-170.begin
      // Setup.GET;
      // Setup.TESTFIELD("FTP Executable");
      // CI-170.end

      Transport.TESTFIELD(Address);
      Transport.TESTFIELD(Account);
      Transport.TESTFIELD("From Location");
      Transport.TESTFIELD("Archive Location");

      Ftp.Create(TRUE, FALSE);
      Ftp.SetHostName(Transport.Address);
      // CI-173.begin
      IF Transport."Custom Port" <> 0 THEN
        Ftp.SetPort(Transport."Custom Port");
      // CI-173.end
      Ftp.SetUserName(Transport.Account);
      Ftp.SetPassword(Transport.Password);

      CASE Transport."FTP Type" OF
        Transport."FTP Type"::"SFTP (ssl)" : Ftp.SetEnableSsl(TRUE);
        Transport."FTP Type"::"SFTP (ssh)" : Ftp.SetEnableSsh(TRUE);
      END;

      Binary := Transport."Transfer Mode" = Transport."Transfer Mode"::Bin;

      IF Transport."Archive Location" <> '' THEN BEGIN
        ArchiveLocation := FORMAT(TODAY, 0, Transport."Archive Location");
        Mgt.CheckCreateDirectory(ArchiveLocation);
      END;

      Directory.FindFiles(FALSE, Transport."From Location", Transport.Filename);

      WHILE Directory.FindNextFile(FileName) DO BEGIN
        LocalFilename := CombinePaths(Transport."From Location", FileName, '\');
        RemoteFilename := CombinePaths(Transport."To Location", FileName, '/');

        IF Ftp.UploadFile(LocalFilename, RemoteFilename, Binary) THEN BEGIN
          ExitValue += 1;

          IF Transport."Archive add YYYYMMDD" THEN
            ArchiveFilename := Mgt.AddDateStamp(CombinePaths(ArchiveLocation, FileName, '\'))
          ELSE
            ArchiveFilename := CombinePaths(ArchiveLocation, FileName, '\');

          IF LOWERCASE(LocalFilename) <> LOWERCASE(ArchiveFilename) THEN BEGIN
            IF EXISTS(ArchiveFilename) THEN BEGIN
              ArchiveFilenameStamp := Mgt.AddDateStamp(ArchiveFilename);
              FILE.RENAME(ArchiveFilename, ArchiveFilenameStamp);
            END;
            FILE.RENAME(LocalFilename, ArchiveFilename);
          END;
        END ELSE
          MESSAGE(Ftp.LastError);
      END;
    END;

    LOCAL PROCEDURE Move@1000002(VAR Transport@1000000 : Record 11148590);
    VAR
      FileRec@1000001 : Record 2000000022;
      Mgt@1000000000 : Codeunit 11148589;
      FromName@1000002 : Text[1024];
      ToName@1000003 : Text[1024];
    BEGIN
      FileRec.SETRANGE(Path, Transport."From Location");
      FileRec.SETRANGE("Is a file", TRUE);
      IF Transport.Filename <> '' THEN
        FileRec.SETFILTER(Name, '@' + Transport.Filename);

      IF FileRec.FINDSET THEN
        REPEAT

          FromName := CombinePaths(FileRec.Path, FileRec.Name, '\');
          IF Transport."Archive add YYYYMMDD" THEN
            ToName :=  Mgt.AddDateStamp(CombinePaths(Transport."To Location", FileRec.Name, '\'))
          ELSE
            ToName := CombinePaths(Transport."To Location", FileRec.Name, '\');
          FILE.RENAME(FromName, ToName);

        UNTIL FileRec.NEXT = 0;
    END;

    LOCAL PROCEDURE RunExecutable@1000001(VAR Transport@1000000 : Record 11148590);
    VAR
      Mgt@1100531000 : Codeunit 11148589;
      BatFile@1000003 : File;
      BatFileName@1000002 : Text[1024];
      Command@1000001 : Text[1024];
      WScriptCommand@1000004 : Text[1024];
    BEGIN
      Command := STRSUBSTNO(Transport.Executable, Transport.Code);

      IF TRUE THEN BEGIN

        BatFileName := CombinePaths(Mgt.TmpDir, 'executable.vbs', '\');

        BatFile.CREATE(BatFileName);
        BatFile.WRITEMODE(TRUE);
        BatFile.TEXTMODE(TRUE);
        BatFile.WRITE('Option Explicit');
        BatFile.WRITE('Dim objShell,strCommand');
        BatFile.WRITE('strCommand = Chr(34)&"' + Command + '"&Chr(34)');
        BatFile.WRITE('Set objShell = CreateObject("WScript.Shell")');
        BatFile.WRITE('objShell.Run (strCommand)');
        BatFile.CLOSE;

        WScriptCommand := Mgt.SystemRoot + '\WScript.exe "' + BatFileName + '"';

        Mgt.ShellCommand(Mgt.SystemRoot + '\WScript.exe' + ' "' + BatFileName + '"');
      END ELSE
        Mgt.ShellCommand(Command);

      IF Mgt.FileExists(BatFileName) THEN
        FILE.ERASE(BatFileName);
    END;

    PROCEDURE GetNoOfFilesTransported@1000009() : Integer;
    BEGIN
      EXIT(NoOfFilesTransported);
    END;

    PROCEDURE CombinePaths@1000000000(Path1@1000000000 : Text[512];Path2@1000000001 : Text[512];PathSep@1000000002 : Text[1]) : Text[1024];
    BEGIN
      IF Path1 = '' THEN
        EXIT(PathSep + Path2);

      IF (Path1[STRLEN(Path1)] = PathSep[1]) THEN
        EXIT(Path1 + Path2)
      ELSE
        EXIT(Path1 + PathSep + Path2);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148591 IN - Import Def. Management
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      gDestinationCompany@1000000 : Text[1024];

    PROCEDURE GetImportDefinitionLines@1000000(VAR ImportDefinition@1000000 : Record 11148591;VAR ImportDefinitionLine@1000001 : Record 11148592;VAR ImportDefTableLink@1000005 : Record 11148593;VAR ImportDefFunction@1100531001 : Record 11148594);
    VAR
      ImportDefinitionLine2@1000002 : Record 11148592;
      ImportDefTableLink2@1000003 : Record 11148593;
      ImportDefFunction2@1100531000 : Record 11148594;
    BEGIN
      IF gDestinationCompany <> '' THEN BEGIN
        ImportDefinitionLine2.CHANGECOMPANY(gDestinationCompany);
        ImportDefTableLink2.CHANGECOMPANY(gDestinationCompany);
      END;

      ImportDefinitionLine2.SETRANGE("Import Definition", ImportDefinition.Code);
      IF ImportDefinitionLine2.FINDSET THEN
        REPEAT
          ImportDefinitionLine := ImportDefinitionLine2;
          ImportDefinitionLine.INSERT;
        UNTIL ImportDefinitionLine2.NEXT = 0;

      ImportDefTableLink2.SETRANGE("Import Definition", ImportDefinition.Code);
      IF ImportDefTableLink2.FINDSET THEN
        REPEAT
          ImportDefTableLink := ImportDefTableLink2;
          ImportDefTableLink.INSERT;
        UNTIL ImportDefTableLink2.NEXT = 0;

      ImportDefFunction2.SETRANGE("Import Definition", ImportDefinition.Code);
      IF ImportDefFunction2.FINDSET THEN
        REPEAT
          ImportDefFunction := ImportDefFunction2;
          ImportDefFunction.INSERT;
        UNTIL ImportDefFunction2.NEXT = 0;
    END;

    PROCEDURE ConvertOptionValue@1000010(VAR FldRef@1000002 : FieldRef;VAR ImportDefinitionLine@1000000 : Record 11148592;Value@1000001 : Text[1024]) : Text[1024];
    VAR
      OptionString@1000003 : Text[1024];
      i@1000006 : Integer;
      OptionValue@1000005 : Integer;
      StrPosOfOption@1000004 : Integer;
    BEGIN
      IF Value = '' THEN
        EXIT('');

      CASE ImportDefinitionLine."Option Type" OF
        ImportDefinitionLine."Option Type"::Value :
          EXIT(Value);

        ImportDefinitionLine."Option Type"::Name :
          BEGIN
            OptionString := ',' + LOWERCASE(FldRef.OPTIONSTRING) + ',';
            StrPosOfOption := STRPOS(OptionString, ',' + LOWERCASE(Value) + ',');
            IF StrPosOfOption > 0 THEN
              FOR i := 2 TO StrPosOfOption DO
                IF OptionString[i] = ',' THEN
                  OptionValue += 1;
            EXIT(FORMAT(OptionValue));
          END;

        ImportDefinitionLine."Option Type"::Caption :
          BEGIN
            OptionString := ',' + LOWERCASE(FldRef.OPTIONCAPTION) + ',';
            StrPosOfOption := STRPOS(OptionString, ',' + LOWERCASE(Value) + ',');
            IF StrPosOfOption > 0 THEN
              FOR i := 2 TO StrPosOfOption DO
                IF OptionString[i] = ',' THEN
                  OptionValue += 1;
            EXIT(FORMAT(OptionValue));
          END;

      END;
    END;

    PROCEDURE EvaluateFieldRefValue@1000000005(VAR FldRef@1000000000 : FieldRef;FieldType@1000000001 : Option;Value@1000000003 : Text[1024];Validate@1100496001 : Boolean);
    VAR
      Fld@1000000 : Record 2000000041;
      DateFormula@1000000004 : DateFormula;
      Date@1000000007 : Date;
      DateTime@1000000009 : DateTime;
      Time@1000000008 : Time;
      Duration@1100496004 : Duration;
      Decimal@1000000005 : Decimal;
      BigInteger@1100496006 : BigInteger;
      Boolean@1000000006 : Boolean;
      ctEvaluationError@1100496000 : TextConst 'ENU=Field Type %1 can not be evaluated.;NLD=Veldtype %1 kan niet worden geevalueerd.';
      RecordID@1100496005 : RecordID;
    BEGIN
      CASE FieldType OF

        Fld.Type::RecordID :
          BEGIN
            IF NOT EVALUATE(RecordID, Value, 9) THEN // CI-121
              EVALUATE(RecordID, Value);
            IF Validate THEN
              FldRef.VALIDATE(RecordID)
            ELSE
              FldRef.VALUE := RecordID;
          END;

        Fld.Type::Text, Fld.Type::Code, Fld.Type::GUID :
          BEGIN
            IF FldRef.LENGTH < STRLEN(Value) THEN
              Value := COPYSTR(Value, 1, FldRef.LENGTH);
            IF Validate THEN
              FldRef.VALIDATE(Value)
            ELSE
              FldRef.VALUE := Value;
          END;

        Fld.Type::Date :
          BEGIN
            IF NOT EVALUATE(Date, Value, 9) THEN // CI-121
              EVALUATE(Date, Value);
            IF Validate THEN
              FldRef.VALIDATE(Date)
            ELSE
              FldRef.VALUE := Date;
          END;

        Fld.Type::Time :
          BEGIN
            IF NOT EVALUATE(Time, Value, 9) THEN // CI-121
              EVALUATE(Time, Value);
            IF Validate THEN
              FldRef.VALIDATE(Time)
            ELSE
              FldRef.VALUE := Time;
          END;

        Fld.Type::DateFormula :
          BEGIN
            IF NOT EVALUATE(Time, Value, 9) THEN // CI-121
              EVALUATE(DateFormula, Value);
            IF Validate THEN
              FldRef.VALIDATE(DateFormula)
            ELSE
              FldRef.VALUE := DateFormula;
          END;

        Fld.Type::Decimal, Fld.Type::Integer :
          BEGIN
            IF Value <> '' THEN
              IF NOT EVALUATE(Decimal, Value, 9) THEN // CI-121
                EVALUATE(Decimal, Value);
            IF Validate THEN
              FldRef.VALIDATE(Decimal)
            ELSE
              FldRef.VALUE := Decimal;
          END;

        Fld.Type::Option :
          BEGIN
            IF NOT EVALUATE(Decimal, Value, 9) THEN // CI-121
              IF EVALUATE(Decimal, Value) THEN;
            IF Validate THEN
              FldRef.VALIDATE(Decimal)
            ELSE
              FldRef.VALUE := Decimal;
          END;

        Fld.Type::Boolean :
          BEGIN
            IF NOT EVALUATE(Boolean, Value, 9) THEN // CI-121
              EVALUATE(Boolean, Value);
            IF Validate THEN
              FldRef.VALIDATE(Boolean)
            ELSE
              FldRef.VALUE := Boolean;
          END;

        Fld.Type::BigInteger :
          BEGIN
            IF NOT EVALUATE(BigInteger, Value, 9) THEN // CI-121
              EVALUATE(BigInteger, Value);
            IF Validate THEN
              FldRef.VALIDATE(BigInteger)
            ELSE
              FldRef.VALUE := BigInteger;
          END;

        Fld.Type::Duration :
          BEGIN
            IF NOT EVALUATE(Duration, Value, 9) THEN // CI-121
              EVALUATE(Duration, Value);
            IF Validate THEN
              FldRef.VALIDATE(Duration)
            ELSE
              FldRef.VALUE := Duration;
          END;

        Fld.Type::DateTime :
          BEGIN
            IF NOT EVALUATE(DateTime, Value, 9) THEN // CI-121
              EVALUATE(DateTime, Value);
            IF Validate THEN
              // CI-134.begin
              // FldRef.VALUE := DateTime
              FldRef.VALIDATE(DateTime)
              // CI-134.end
            ELSE
              FldRef.VALUE := DateTime;
          END;

        Fld.Type::BLOB, Fld.Type::TableFilter :
          ; // Do nothing

        ELSE
          ERROR(ctEvaluationError, FldRef.TYPE);

      END;
    END;

    PROCEDURE CheckRestrictions@1000001(VAR ImportDefinitionLine@1000000 : Record 11148592;VAR FieldValue@1000002 : Text[1024];RelationCompanyName@1000012 : Text[30]);
    VAR
      ImportRestriction@1000001 : Record 11148596;
      ImportRestrictionValue@1000009 : Record 11148597;
      ImportRestrVarFilter@1000017 : Record 11148598;
      MessageHistComment@1000011 : Record 11148612;
      Mgt@1000004 : Codeunit 11148589;
      VariableMgt@1000018 : Codeunit 11148619;
      CommentMgt@1000006 : Codeunit 11148622;
      RecRef@1000003 : RecordRef;
      FldRef@1000005 : FieldRef;
      CompareValue@1000013 : Decimal;
      tCannotBeLonger@1000016 : TextConst 'ENU=%1 cannot be longer then %2.;NLD=%1 kan niet langer dan %2 zijn';
      tNotAnAllowedOption@1000010 : TextConst 'ENU=''%1'' is not an allowed option;NLD=%1 is geen toegestane optie';
      tNotBetween@1000014 : TextConst 'ENU=''%1'' is not between ''%2'' and ''%3'';NLD=''%1'' is niet tussen ''%2'' and ''%3''';
      tNotFillled@1000015 : TextConst 'ENU=%1 is not filled.;NLD=%1 is niet gevuld.';
      tRecordNotExist@1000008 : TextConst 'ENU="%1 %2=''%3'' does not exist";NLD="%1 %2=''%3'' is niet aanwezig"';
      tRecordNotExistFilters@1000007 : TextConst 'ENU="%1 %2=''%3'' %4 does not exist";NLD=%1 %2 ''%3'' %4 is niet aanwezig';
    BEGIN
      IF (FieldValue = '') AND ImportDefinitionLine.Mandatory THEN
        CommentMgt.AddError(
          ImportDefinitionLine."Error No. Field Mandatory",
          MessageHistComment."Error Type"::"Field Mandatory",
          STRSUBSTNO(tNotFillled, ImportDefinitionLine."Tag Name"));

      ImportRestriction.SETRANGE("Import Definition", ImportDefinitionLine."Import Definition");
      ImportRestriction.SETRANGE("Import Def. Entry No.", ImportDefinitionLine."Entry No.");
      ImportRestriction.SETRANGE("Import Def. Entry No.", ImportDefinitionLine."Entry No.");
      IF ImportRestriction.FINDSET THEN
        REPEAT
          CASE ImportRestriction.Type OF

            ImportRestriction.Type::"Table Relation" :
              IF ImportRestriction."Table No." <> 0 THEN BEGIN
                ImportRestriction.TESTFIELD("Table No.");
                IF RelationCompanyName = '' THEN
                  RecRef.OPEN(ImportRestriction."Table No.")
                ELSE
                  RecRef.OPEN(ImportRestriction."Table No.", FALSE, RelationCompanyName);

                IF NOT (FORMAT(ImportRestriction."Table Filter") IN ['', Mgt.EmptyTableFilter(ImportRestriction."Table No.")]) THEN
                  Mgt.SetFilterOnRecordRef(RecRef, FORMAT(ImportRestriction."Table Filter"));

                ImportRestrVarFilter.SETRANGE("Import Definition", ImportRestriction."Import Definition");
                ImportRestrVarFilter.SETRANGE("Import Def. Entry No.", ImportRestriction."Import Def. Entry No.");
                ImportRestrVarFilter.SETRANGE("Import Restriction Entry No.", ImportRestriction."Entry No.");
                ImportRestrVarFilter.SETFILTER(Variable, '<>%1', '');
                IF ImportRestrVarFilter.FINDSET THEN
                  REPEAT
                    FldRef := RecRef.FIELD(ImportRestrVarFilter."Field No.");
                    FldRef.SETRANGE := VariableMgt.GetVariable(ImportRestrVarFilter.Variable);
                  UNTIL ImportRestrVarFilter.NEXT = 0;

                RecRef.FILTERGROUP(10);
                FldRef := RecRef.FIELD(ImportRestriction."Field No.");
                FldRef.SETFILTER(FieldValue);
                RecRef.FILTERGROUP(0);

                IF NOT RecRef.FINDFIRST THEN
                  IF ImportRestriction."Alternative Value" <> '' THEN
                    FieldValue := ImportRestriction."Alternative Value"
                  ELSE
                    IF RecRef.GETFILTERS = '' THEN
                      CommentMgt.AddError(
                        ImportRestriction."Error No.",
                        ImportRestriction.Type + 1,
                        STRSUBSTNO(tRecordNotExist, RecRef.CAPTION, FldRef.CAPTION, FieldValue))
                    ELSE
                      CommentMgt.AddError(
                        ImportRestriction."Error No.",
                        ImportRestriction.Type + 1,
                        STRSUBSTNO(
                          tRecordNotExistFilters, RecRef.CAPTION, FldRef.CAPTION, FieldValue, RecRef.GETFILTERS));

                RecRef.CLOSE;
              END;

            ImportRestriction.Type::Option :
              BEGIN
                ImportRestrictionValue.RESET;
                ImportRestrictionValue.SETRANGE("Import Definition", ImportRestriction."Import Definition");
                ImportRestrictionValue.SETRANGE("Import Def. Entry No.", ImportRestriction."Import Def. Entry No.");
                ImportRestrictionValue.SETRANGE("Import Restriction Entry No.", ImportRestriction."Entry No.");
                ImportRestrictionValue.SETRANGE(Value, FieldValue);
                IF ImportRestrictionValue.ISEMPTY THEN
                  IF ImportRestriction."Alternative Value" <> '' THEN
                    FieldValue := ImportRestriction."Alternative Value"
                  ELSE
                    CommentMgt.AddError(
                      ImportRestriction."Error No.",
                      ImportRestriction.Type + 1,
                      STRSUBSTNO(tNotAnAllowedOption, FieldValue));
              END;

            ImportRestriction.Type::"Min/Max" :
              BEGIN
                EVALUATE(CompareValue, FieldValue);
                IF (CompareValue < ImportRestriction."Min. Value") OR (CompareValue > ImportRestriction."Max. Value") THEN
                  IF ImportRestriction."Alternative Value" <> '' THEN
                    FieldValue := ImportRestriction."Alternative Value"
                  ELSE
                    CommentMgt.AddError(
                      ImportRestriction."Error No.",
                      ImportRestriction.Type + 1,
                      STRSUBSTNO(tNotBetween, FieldValue, ImportRestriction."Min. Value", ImportRestriction."Max. Value"));
              END;

            ImportRestriction.Type::"Max. Length" :
              IF STRLEN(FieldValue) > ImportRestriction."Max. Length" THEN
                IF ImportRestriction."Alternative Value" <> '' THEN
                  FieldValue := ImportRestriction."Alternative Value"
                ELSE
                  CommentMgt.AddError(
                    ImportRestriction."Error No.",
                    ImportRestriction.Type + 1,
                    STRSUBSTNO(tCannotBeLonger, ImportDefinitionLine."Tag Name", ImportRestriction."Max. Length"));

          END;
        UNTIL ImportRestriction.NEXT = 0;
    END;

    PROCEDURE GetAlternativeValue@1000008(VAR ImportDefinitionLine@1000000 : Record 11148592;VAR FieldValue@1000002 : Text[1024];RelationCompanyName@1000012 : Text[30]);
    VAR
      ImportRestriction@1000001 : Record 11148596;
      ImportRestrictionValue@1000009 : Record 11148597;
      ImportRestrVarFilter@1000017 : Record 11148598;
      Mgt@1000004 : Codeunit 11148589;
      VariableMgt@1000018 : Codeunit 11148619;
      RecRef@1000003 : RecordRef;
      FldRef@1000005 : FieldRef;
      CompareValue@1000013 : Decimal;
    BEGIN
      ImportRestriction.SETRANGE("Import Definition", ImportDefinitionLine."Import Definition");
      ImportRestriction.SETRANGE("Import Def. Entry No.", ImportDefinitionLine."Entry No.");
      ImportRestriction.SETRANGE("Import Def. Entry No.", ImportDefinitionLine."Entry No.");
      ImportRestriction.SETFILTER("Alternative Value", '<>%1', '');
      IF ImportRestriction.FINDSET THEN
        REPEAT
          CASE ImportRestriction.Type OF

            ImportRestriction.Type::"Table Relation" :
              IF ImportRestriction."Table No." <> 0 THEN BEGIN
                ImportRestriction.TESTFIELD("Table No.");
                IF RelationCompanyName = '' THEN
                  RecRef.OPEN(ImportRestriction."Table No.")
                ELSE
                  RecRef.OPEN(ImportRestriction."Table No.", FALSE, RelationCompanyName);

                IF NOT (FORMAT(ImportRestriction."Table Filter") IN ['', Mgt.EmptyTableFilter(ImportRestriction."Table No.")]) THEN
                  Mgt.SetFilterOnRecordRef(RecRef, FORMAT(ImportRestriction."Table Filter"));

                ImportRestrVarFilter.SETRANGE("Import Definition", ImportRestriction."Import Definition");
                ImportRestrVarFilter.SETRANGE("Import Def. Entry No.", ImportRestriction."Import Def. Entry No.");
                ImportRestrVarFilter.SETRANGE("Import Restriction Entry No.", ImportRestriction."Entry No.");
                ImportRestrVarFilter.SETFILTER(Variable, '<>%1', '');
                IF ImportRestrVarFilter.FINDSET THEN
                  REPEAT
                    FldRef := RecRef.FIELD(ImportRestrVarFilter."Field No.");
                    FldRef.SETRANGE := VariableMgt.GetVariable(ImportRestrVarFilter.Variable);
                  UNTIL ImportRestrVarFilter.NEXT = 0;

                RecRef.FILTERGROUP(10);
                FldRef := RecRef.FIELD(ImportRestriction."Field No.");
                FldRef.SETFILTER(FieldValue);
                RecRef.FILTERGROUP(0);

                IF NOT RecRef.FINDFIRST THEN
                  FieldValue := ImportRestriction."Alternative Value";
                RecRef.CLOSE;
              END;

            ImportRestriction.Type::Option :
              BEGIN
                ImportRestrictionValue.RESET;
                ImportRestrictionValue.SETRANGE("Import Definition", ImportRestriction."Import Definition");
                ImportRestrictionValue.SETRANGE("Import Def. Entry No.", ImportRestriction."Import Def. Entry No.");
                ImportRestrictionValue.SETRANGE("Import Restriction Entry No.", ImportRestriction."Entry No.");
                ImportRestrictionValue.SETRANGE(Value, FieldValue);
                IF ImportRestrictionValue.ISEMPTY THEN
                  FieldValue := ImportRestriction."Alternative Value";
              END;

            ImportRestriction.Type::"Min/Max" :
              BEGIN
                EVALUATE(CompareValue, FieldValue);
                IF (CompareValue < ImportRestriction."Min. Value") OR (CompareValue > ImportRestriction."Max. Value") THEN
                  FieldValue := ImportRestriction."Alternative Value";
              END;

            ImportRestriction.Type::"Max. Length" :
              IF STRLEN(FieldValue) > ImportRestriction."Max. Length" THEN
                FieldValue := ImportRestriction."Alternative Value";

          END;
        UNTIL ImportRestriction.NEXT = 0;
    END;

    PROCEDURE MoveProcessedFile@1100495009(VAR ImportDefinition@1100496000 : Record 11148591;Path@1100495001 : Text[260];Name@1000 : Text[260]);
    VAR
      Setup@1000002 : Record 11148589;
      Mgt@1100495002 : Codeunit 11148589;
      CommentMgt@1000001 : Codeunit 11148622;
      FormatProcessedLocation@1000003 : Text[1024];
      FromName@1100496001 : Text[1024];
      ToName@1100496002 : Text[1024];
      ctFileMoved@1000000 : TextConst 'ENU=Moved to %1;NLD=Verplaatst naar %1';
    BEGIN
      IF ImportDefinition."Processed Location" = '' THEN
        EXIT;

      FormatProcessedLocation := FORMAT(TODAY, 0, ImportDefinition."Processed Location");

      Mgt.CheckCreateDirectory(FormatProcessedLocation);

      FromName := Path + Name;
      ToName := FormatProcessedLocation + Name;

      IF LOWERCASE(FromName) <> LOWERCASE(ToName) THEN BEGIN
        Setup.GET;
        IF EXISTS(ToName) OR ImportDefinition."Archive add YYYYMMDD" THEN
          ToName := STRSUBSTNO('%1\%2_%3.%4',
                      Mgt.GetPath(ToName),
                      Mgt.GetFilenameWithoutExtension(ToName),
                      FORMAT(CURRENTDATETIME, 0, '<Year4><Month,2><Day,2><Hour,2><Minute,2><Second,2>'),
                      Mgt.GetExtension(ToName));

        FILE.RENAME(FromName, ToName);
      END;

      CommentMgt.AddComment(STRSUBSTNO(ctFileMoved, ToName));
    END;

    PROCEDURE MoveErrorFile@1000009(VAR ImportDefinition@1100496000 : Record 11148591;Path@1100495001 : Text[260];Name@1000 : Text[260]);
    VAR
      Setup@1000002 : Record 11148589;
      Mgt@1100495002 : Codeunit 11148589;
      CommentMgt@1000001 : Codeunit 11148622;
      FormatErrorLocation@1000003 : Text[1024];
      FromName@1100496001 : Text[1024];
      ToName@1100496002 : Text[1024];
      ctFileMoved@1000000 : TextConst 'ENU=Moved to %1;NLD=Verplaatst naar %1';
    BEGIN
      IF ImportDefinition."Error Location" = '' THEN
        EXIT;

      FormatErrorLocation := FORMAT(TODAY, 0, ImportDefinition."Error Location");

      Mgt.CheckCreateDirectory(FormatErrorLocation);

      FromName := Path + Name;
      ToName := FormatErrorLocation + Name;

      IF LOWERCASE(FromName) <> LOWERCASE(ToName) THEN BEGIN
        Setup.GET;
        IF EXISTS(ToName) OR ImportDefinition."Archive add YYYYMMDD" THEN
          ToName := STRSUBSTNO('%1\%2_%3.%4',
                      Mgt.GetPath(ToName),
                      Mgt.GetFilenameWithoutExtension(ToName),
                      FORMAT(CURRENTDATETIME, 0, '<Year4><Month,2><Day,2><Hour,2><Minute,2><Second,2>'),
                      Mgt.GetExtension(ToName));

        FILE.RENAME(FromName, ToName);
      END;

      CommentMgt.AddComment(STRSUBSTNO(ctFileMoved, ToName));
    END;

    PROCEDURE CheckRecordAction@1000005(VAR ImportDefinitionLine@1000000 : Record 11148592;VAR RecRef@1000001 : RecordRef) : Boolean;
    VAR
      ImportDef@1000000003 : Record 11148591;
      MessageHistComment@1000008 : Record 11148612;
      CommentMgt@1000004 : Codeunit 11148622;
      RecRef2@1000002 : RecordRef;
      IsExistingRecord@1000005 : Boolean;
      tAlreadyExist@1000003 : TextConst 'ENU=%1 %2 already exists.;NLD=%1 %2 is reeds aanwezig.';
      tNotExist@1000006 : TextConst 'ENU=%1 %2 does not exist.;NLD=%1 %2 is niet aanwezig.';
      FldRef@1000000000 : FieldRef;
      FldRef2@1000000001 : FieldRef;
      i@1000000002 : Integer;
    BEGIN
      ImportDef.GET(ImportDefinitionLine."Import Definition");

      IF ImportDef."File Format" <> ImportDef."File Format"::XML THEN BEGIN
        RecRef2 := RecRef.DUPLICATE;
        IsExistingRecord := RecRef2.FIND('=');
      END ELSE
        IsExistingRecord := RecRef.FIND('=');

      IF IsExistingRecord THEN
        CASE ImportDefinitionLine."Existing Record" OF

          ImportDefinitionLine."Existing Record"::Update :
            BEGIN
              IF ImportDef."File Format" <> ImportDef."File Format"::XML THEN BEGIN
                ImportDefinitionLine."Existing Record" := ImportDefinitionLine."Existing Record"::Nothing;
                FOR i := 1 TO RecRef.FIELDCOUNT DO BEGIN
                  FldRef := RecRef.FIELDINDEX(i);
                  FldRef2 := RecRef2.FIELDINDEX(i);
                  IF (UPPERCASE(FORMAT(FldRef.CLASS)) = 'NORMAL') THEN
                    IF (FldRef.VALUE <> FldRef2.VALUE) THEN BEGIN
                      ImportDefinitionLine."Existing Record" := ImportDefinitionLine."Existing Record"::Update;
                      EXIT(IsExistingRecord);
                    END;
                END;
              END;
            END;

          ImportDefinitionLine."Existing Record"::Create :
            IF ImportDef."File Format" = ImportDef."File Format"::XML THEN
              RecRef.INIT;

          ImportDefinitionLine."Existing Record"::Error :
            BEGIN
              RecRef2 := RecRef.DUPLICATE;
              IF RecRef2.FIND('=') THEN BEGIN
                RecRef2.SETRECFILTER;
                CommentMgt.AddError(
                  ImportDefinitionLine."Error No. Existing Record",
                  MessageHistComment."Error Type"::"Existing Record",
                  STRSUBSTNO(tAlreadyExist, RecRef.CAPTION, RecRef2.GETFILTERS));
              END;
            END;
        END

      ELSE
        CASE ImportDefinitionLine."New Record" OF

          ImportDefinitionLine."New Record"::Create :
            IF ImportDef."File Format" = ImportDef."File Format"::XML THEN
              RecRef.INIT;

          ImportDefinitionLine."New Record"::Error :
            BEGIN
              RecRef2 := RecRef.DUPLICATE;
              IF NOT RecRef2.FIND('=') THEN BEGIN
                RecRef2.SETRECFILTER;
                CommentMgt.AddError(
                  ImportDefinitionLine."Error No. New Record",
                  MessageHistComment."Error Type"::"New Record",
                  STRSUBSTNO(tNotExist, RecRef.CAPTION, RecRef2.GETFILTERS));
              END;
            END;
        END;

      EXIT(IsExistingRecord);
    END;

    PROCEDURE ConvertFieldValue@1000011(VAR Value@1000000 : Text[1024];VAR ImportDefinitionLine@1000001 : Record 11148592;VAR Fld@1000003 : Record 2000000041) ExitValue : Text[1024];
    VAR
      ConversionLine@1000002 : Record 11148606;
      DecimalChar@1000007 : Text[30];
      Decimal@1000008 : Decimal;
    BEGIN
      CASE Fld.Type OF

        Fld.Type::Boolean :
          IF Value = '' THEN
            Value := FORMAT(FALSE)
          ELSE
            IF LOWERCASE(FORMAT(Value[1])) IN ['1', '-', 'j', 't', 'w', 'y'] THEN
              Value := FORMAT(TRUE)
            ELSE
              Value := FORMAT(FALSE);

        Fld.Type::Date :
          ConvertDateFieldValue(
            Value,
            ImportDefinitionLine."Data Format",
            ImportDefinitionLine."Custom Date Order",
            ImportDefinitionLine."Custom Date Separator"); // CI-133

        // CI-133.begin
        Fld.Type::DateTime:
          ConvertDateTimeFieldValue(
            Value,
            ImportDefinitionLine."Data Format",
            ImportDefinitionLine."Custom Date Order",
            ImportDefinitionLine."Custom Date Separator");
        // CI-133.end

        Fld.Type::Decimal :
          IF Value = '' THEN
            Value := '0'
          ELSE
            IF ImportDefinitionLine."Data Format" IN [ImportDefinitionLine."Data Format"::" ", ImportDefinitionLine."Data Format"::XML]
             THEN
             BEGIN
              DecimalChar := COPYSTR(FORMAT(1.1), 2, 1);
              EVALUATE(Decimal, CONVERTSTR(Value, '.', DecimalChar));
              Value := FORMAT(Decimal);
            END;
      END;

      ExitValue := Value;

      IF ImportDefinitionLine."Conversion Code" <> '' THEN BEGIN
        ConversionLine.SETCURRENTKEY("Conversion Code", "Extern Value");
        ConversionLine.SETFILTER("Conversion Code", '@' + ImportDefinitionLine."Conversion Code");
        ConversionLine.SETFILTER("Extern Value", '@' + Value);
        IF ConversionLine.FINDFIRST THEN
          ExitValue := ConversionLine."NAV Value";
      END;
    END;

    LOCAL PROCEDURE ConvertDateFieldValue@1000000001(VAR Value@1000000001 : Text[1024];DateFormat@1000000003 : Integer;CustomDateOrder@1000000000 : Integer;CustomDateSeparator@1000000002 : Text[1]);
    VAR
      ImportDefinitionLine@1000000004 : Record 11148592;
    BEGIN
      // CI-133
      CASE DateFormat OF
        ImportDefinitionLine."Data Format"::" ": ConvertDateFieldValueXML(Value);
        ImportDefinitionLine."Data Format"::XML: ConvertDateFieldValueXML(Value);
        ImportDefinitionLine."Data Format"::Custom: ConvertDateFieldValueCustom(Value, CustomDateOrder, CustomDateSeparator);
      END;
    END;

    LOCAL PROCEDURE ConvertDateFieldValueXML@1000000002(VAR Value@1000000001 : Text[1024]);
    VAR
      Day@1000000004 : Integer;
      Month@1000000003 : Integer;
      Year@1000000002 : Integer;
    BEGIN
      // CI-133; original logic
      IF Value <> '' THEN BEGIN
        IF COPYSTR(Value, 1, 4) <> '' THEN
          EVALUATE(Year, COPYSTR(Value, 1, 4));
        IF COPYSTR(Value, 6, 2) <> '' THEN
          EVALUATE(Month, COPYSTR(Value, 6, 2));
        IF COPYSTR(Value, 9, 2) <> '' THEN
          EVALUATE(Day, COPYSTR(Value, 9, 2));
        IF (Day <> 0) AND (Month <> 0) AND (Year <> 0) THEN
          Value := FORMAT(DMY2DATE(Day, Month, Year));
      END;
    END;

    LOCAL PROCEDURE ConvertDateFieldValueCustom@1000000003(VAR Value@1000000001 : Text[1024];DateOrder@1000000000 : Integer;DateSeparator@1000000005 : Text[1]);
    VAR
      Day@1000000004 : Integer;
      Month@1000000003 : Integer;
      Year@1000000002 : Integer;
    BEGIN
      // CI-133; new logic
      IF Value <> '' THEN BEGIN
        IF FindExactlyThreeDateComponents(
          Value,
          DateOrder,
          DateSeparator,
          Day,
          Month,
          Year)
        THEN
          IF (Day <> 0) AND (Month <> 0) AND (Year <> 0) THEN
            Value := FORMAT(DMY2DATE(Day, Month, Year));
      END;
    END;

    LOCAL PROCEDURE ConvertDateTimeFieldValue@1000000000(VAR Value@1000000003 : Text[1024];DateFormat@1000000002 : Integer;CustomDateOrder@1000000001 : Integer;CustomDateSeparator@1000000000 : Text[1]);
    VAR
      ImportDefinitionLine@1000000004 : Record 11148592;
    BEGIN
      // CI-133
      CASE DateFormat OF
        ImportDefinitionLine."Data Format"::" ":; // original logic (being none)
        ImportDefinitionLine."Data Format"::XML:; // original logic (being none)
        ImportDefinitionLine."Data Format"::Custom: ConvDateTimeFldValueCustom(Value, CustomDateOrder, CustomDateSeparator);
      END;
    END;

    PROCEDURE ConvDateTimeFldValueCustom@1000000004(VAR Value@1000000006 : Text[1024];DateOrder@1000000004 : Integer;DateSeparator@1000000003 : Text[1]);
    VAR
      DateValue@1000000000 : Text[1024];
      TimeValue@1000000001 : Text[1024];
      SeparatorPos@1000000002 : Integer;
    BEGIN
      // CI-133
      IF Value <> '' THEN BEGIN
        SeparatorPos := STRPOS(Value, ' ');
        IF NOT (SeparatorPos IN [0, 1, STRLEN(Value)]) THEN BEGIN
          DateValue := COPYSTR(Value, 1, SeparatorPos - 1);
          TimeValue := COPYSTR(Value, SeparatorPos + 1);

          ConvertDateFieldValueCustom(DateValue, DateOrder, DateSeparator);

          Value := STRSUBSTNO('%1 %2', DateValue, TimeValue);
        END;
      END;
    END;

    LOCAL PROCEDURE FindExactlyThreeDateComponents@1000000006(Value@1000000003 : Text[1024];DateOrder@1000000005 : Integer;DateSeparator@1000000002 : Text[1];VAR Day@1000000000 : Integer;VAR Month@1000000001 : Integer;VAR Year@1000000004 : Integer) Result : Boolean;
    VAR
      ImportDefinitionLine@1000000009 : Record 11148592;
      Component@1000000008 : ARRAY [3] OF Text[4];
      ComponentOffset@1000000007 : ARRAY [3] OF Integer;
      ComponentLength@1000000006 : ARRAY [3] OF Integer;
    BEGIN
      // CI-133
      CASE DateSeparator = '' OF
        TRUE:
          IF NOT FindDateCompntsNoSeparator(Value, DateOrder, DateSeparator, ComponentOffset, ComponentLength) THEN
            EXIT(FALSE);
        FALSE:
          IF NOT FindDateCompntsWithSeparator(Value, DateOrder, DateSeparator, ComponentOffset, ComponentLength) THEN
            EXIT(FALSE);
      END;

      Component[1] := COPYSTR(Value, ComponentOffset[1], ComponentLength[1]);
      Component[2] := COPYSTR(Value, ComponentOffset[2], ComponentLength[2]);
      Component[3] := COPYSTR(Value, ComponentOffset[3], ComponentLength[3]);

      CASE DateOrder OF
        ImportDefinitionLine."Custom Date Order"::DMY:
          BEGIN
            Result := EVALUATE(Day, Component[1]);
            Result := Result AND EVALUATE(Month, Component[2]);
            Result := Result AND EVALUATE(Year, Component[3]);
          END;
        ImportDefinitionLine."Custom Date Order"::MDY:
          BEGIN
            Result := EVALUATE(Month, Component[1]);
            Result := Result AND EVALUATE(Day, Component[2]);
            Result := Result AND EVALUATE(Year, Component[3]);
          END;
        ImportDefinitionLine."Custom Date Order"::YMD:
          BEGIN
            Result := EVALUATE(Year, Component[1]);
            Result := Result AND EVALUATE(Month, Component[2]);
            Result := Result AND EVALUATE(Day, Component[3]);
          END;
      END;

      // DMY2Date expects a 4-digit year
      IF Year < 100 THEN
        CASE Year OF
          30..99: Year := Year + 1900;
          0..29: Year := Year + 2000;
        END;
    END;

    LOCAL PROCEDURE FindDateCompntsNoSeparator@1000000012(Value@1000000000 : Text[1024];DateOrder@1000000006 : Integer;DateSeparator@1000000001 : Text[1];VAR ComponentOffset@1000000003 : ARRAY [3] OF Integer;VAR ComponentLength@1000000002 : ARRAY [3] OF Integer) : Boolean;
    VAR
      ImportDefinitionLine@1000000007 : Record 11148592;
    BEGIN
      // CI-133
      ComponentOffset[1] := 1;
      ComponentOffset[2] := 3;
      ComponentOffset[3] := 5;

      ComponentLength[1] := 2;
      ComponentLength[2] := 2;
      ComponentLength[3] := 2;

      CASE STRLEN(Value) OF
        STRLEN('DDMMYY'):
          EXIT(TRUE);
        STRLEN('DDMMYYYY'):
          BEGIN
            CASE DateOrder OF
              ImportDefinitionLine."Custom Date Order"::DMY:
                BEGIN
                  ComponentLength[3] := 4;
                END;
              ImportDefinitionLine."Custom Date Order"::MDY:
                BEGIN
                  ComponentLength[3] := 4;
                END;
              ImportDefinitionLine."Custom Date Order"::YMD:
                BEGIN
                  ComponentLength[1] := 4;
                  ComponentOffset[2] := 5;
                  ComponentOffset[3] := 7;
                END;
            END;

            EXIT(TRUE);
          END;
      ELSE
        EXIT(FALSE);
      END;
    END;

    LOCAL PROCEDURE FindDateCompntsWithSeparator@1000000015(Value@1000000005 : Text[1024];DateOrder@1000000004 : Integer;DateSeparator@1000000003 : Text[1];VAR ComponentOffset@1000000000 : ARRAY [3] OF Integer;VAR ComponentLength@1000000001 : ARRAY [3] OF Integer) : Boolean;
    VAR
      NoOfSeparators@1000000002 : Integer;
      CurrentIndex@1000000007 : Integer;
      CurrentComponentIndex@1000000006 : Integer;
    BEGIN
      // CI-133 :FIXME
      NoOfSeparators := STRLEN(DELCHR(Value, '=', DELCHR(Value, '=', DateSeparator)));
      IF NoOfSeparators <> 2 THEN
        EXIT(FALSE);

      CLEAR(ComponentOffset);
      CLEAR(ComponentLength);

      CurrentComponentIndex := 1;
      ComponentOffset[CurrentComponentIndex] := 1;

      FOR CurrentIndex := 1 TO STRLEN(Value) DO BEGIN
        CASE COPYSTR(Value, CurrentIndex, 1) = DateSeparator OF
          TRUE:
            BEGIN
              CurrentComponentIndex += 1;
              CurrentIndex += 1;
              ComponentOffset[CurrentComponentIndex] := CurrentIndex;
              ComponentLength[CurrentComponentIndex] := 1;
            END;
          FALSE:
            BEGIN
              ComponentLength[CurrentComponentIndex] += 1;
            END;
        END;
      END;

      EXIT(TRUE);
    END;

    PROCEDURE ExecuteFunctions@1100531000(VAR ImportDefinitionLine@1100531000 : Record 11148592;VAR ImportDefFunction@1100531001 : Record 11148594;VAR ExitValue@1100531002 : Text[1024]);
    VAR
      FunctionMgt@1100531004 : Codeunit 11148593;
    BEGIN
      ImportDefFunction.SETRANGE("Import Definition", ImportDefinitionLine."Import Definition");
      ImportDefFunction.SETRANGE("Import Def. Entry No.", ImportDefinitionLine."Entry No.");
      IF ImportDefFunction.FINDSET THEN
        REPEAT
          FunctionMgt.ImportProcessRun(ImportDefinitionLine, ImportDefFunction, ExitValue);
        UNTIL ImportDefFunction.NEXT = 0;
    END;

    PROCEDURE ExecuteIncrementMethod@1000007(VAR Value@1000003 : Text[1024];VAR ImportDefinitionLine@1000001 : Record 11148592;VAR Fld@1000000 : Record 2000000041;VAR RecRef@1000002 : RecordRef;VAR LastId@1000005 : Integer) ExitValue : Text[1024];
    VAR
      RecRef2@1000004 : RecordRef;
      FldRef@1000006 : FieldRef;
    BEGIN
      CASE ImportDefinitionLine."Increment Method" OF

        ImportDefinitionLine."Increment Method"::" ":
          EXIT(Value);

        ImportDefinitionLine."Increment Method"::"1":
          BEGIN
            LastId += 1;
            ExitValue := FORMAT(LastId);
          END;

        ImportDefinitionLine."Increment Method"::"10000":
          BEGIN
            LastId += 10000;
            ExitValue := FORMAT(LastId);
          END;

        ImportDefinitionLine."Increment Method"::"Max. + 1":
          BEGIN
            RecRef2 := RecRef.DUPLICATE;
            RecRef2.SETRECFILTER;
            FldRef := RecRef2.FIELD(Fld."No.");
            FldRef.SETRANGE;
            IF RecRef2.FINDLAST THEN
              EVALUATE(LastId, FORMAT(FldRef.VALUE))
            ELSE
              LastId := 0;
            LastId += 1;
            ExitValue := FORMAT(LastId);
          END;

        ImportDefinitionLine."Increment Method"::"Max. + 10000":
          BEGIN
            RecRef2 := RecRef.DUPLICATE;
            RecRef2.SETRECFILTER;
            FldRef := RecRef2.FIELD(Fld."No.");
            FldRef.SETRANGE;
            IF RecRef2.FINDLAST THEN
              EVALUATE(LastId, FORMAT(FldRef.VALUE))
            ELSE
              LastId := 0;
            LastId += 10000;
            ExitValue := FORMAT(LastId);
          END;

      END;
    END;

    PROCEDURE GetFld@1000012(VAR ImportDefinitionLine@1000000 : Record 11148592;VAR Fld@1000001 : Record 2000000041);
    BEGIN
      IF ImportDefinitionLine."Field No." <> 0 THEN
        Fld.GET(ImportDefinitionLine."Table No.", ImportDefinitionLine."Field No.");
    END;

    PROCEDURE SetDestinationCompany@1000004(NewValue@1000000 : Text[1024]);
    BEGIN
      gDestinationCompany := NewValue;
    END;

    PROCEDURE AddUnknownError@1000002();
    VAR
      CommentMgt@1000000 : Codeunit 11148622;
      ErrorMgt@1000002 : Codeunit 11148630;
    BEGIN
      CommentMgt.AddError(
        0,
        0,
        ErrorMgt.GetError);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148592 IN - Process Import Definition
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    TableNo=11148591;
    OnRun=BEGIN
            Rec.SetHideMessage(HideMessage);
            Process;
          END;

  }
  CODE
  {
    VAR
      HideMessage@1000000 : Boolean;

    PROCEDURE SetHideMessage@1000000(NewValue@1000000 : Boolean);
    BEGIN
      HideMessage := NewValue;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148593 IN - Function Management
{
  OBJECT-PROPERTIES
  {
    Date=05-11-13;
    Time=13:00:00;
    Version List=IDYN-CE5.50.8;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE ImportFileValidRun@1000000000();
    BEGIN
    END;

    PROCEDURE ImportProcessRun@1000000001(VAR ImportDefinitionLine@1000000000 : Record 11148592;VAR ImportDefFunction@1100531000 : Record 11148594;VAR FieldValue@1000000004 : Text[1024]);
    BEGIN
      ExecuteFunction(
        FieldValue,
        ImportDefFunction.Code,
        ImportDefFunction."Parameter 1",
        ImportDefFunction."Parameter 2",
        ImportDefFunction."Parameter 3",
        ImportDefFunction."Source Variable",
        ImportDefFunction."Dest. Variable",
        '');
    END;

    PROCEDURE ExportFileValidRun@1100531003();
    BEGIN
    END;

    PROCEDURE ExportProcessRun@1100531002(VAR ExportDefinitionLine@1000000000 : Record 11148600;VAR ExportDefFunction@1100531000 : Record 11148602;VAR FieldValue@1000000004 : Text[1024]);
    BEGIN
      ExecuteFunction(
        FieldValue,
        ExportDefFunction.Code,
        ExportDefFunction."Parameter 1",
        ExportDefFunction."Parameter 2",
        ExportDefFunction."Parameter 3",
        ExportDefFunction."Source Variable",
        ExportDefFunction."Dest. Variable",
        ExportDefinitionLine."Data Format");
    END;

    LOCAL PROCEDURE ExecuteFunction@1100531000(VAR FieldValue@1100531000 : Text[1024];FunctionCode@1100531001 : Code[20];Par1@1100531002 : Text[50];Par2@1100531003 : Text[50];Par3@1100531004 : Text[50];SourceVariable@1100531010 : Code[20];DestVariable@1100531011 : Code[20];OutputFormat@1000000001 : Text[250]);
    VAR
      AutoMgt@1000000000 : Codeunit 419;
      VariableMgt@1100531012 : Codeunit 11148619;
      Setup@1100543001 : Record 11148589;
      FunctionTemp@1100543000 : TEMPORARY Record 11148603;
      FieldValueDate@1100531009 : Date;
      CharToSearch@1100531007 : Char;
      FieldValueDecimal@1100531006 : Decimal;
      Par1Decimal@1100531008 : Decimal;
      Position@1100531005 : Integer;
    BEGIN
      IF SourceVariable <> '' THEN
        FieldValue := VariableMgt.GetVariable(SourceVariable);

      InsertVariableValue(Par1);
      InsertVariableValue(Par2);
      InsertVariableValue(Par3);

      CASE FunctionCode OF

        'ABS' :
          FieldValue := FormatDecimal(ABS(ConvertDecimal(Par1)), 0, OutputFormat);

        'ADD' :
          IF EVALUATE(FieldValueDecimal, FieldValue) THEN
            FieldValue := FormatDecimal(FieldValueDecimal + ConvertDecimal(Par1), 0, OutputFormat);

        'APPLICATIONPATH' :
          FieldValue := APPLICATIONPATH;

        'CALCDATE' :
          IF EVALUATE(FieldValueDate, FieldValue) THEN
            FieldValue := FormatDate(CALCDATE(Par1, FieldValueDate), 0, OutputFormat);

        'COMPANYNAME' :
          FieldValue := COMPANYNAME;

        'CONCAT' :
          FieldValue := Par1 + FieldValue + Par2;

        'CONTEXTURL' :
          IF NOT ISSERVICETIER THEN
            FieldValue := CONTEXTURL;

        'CONVERTSTR' :
          FieldValue := CONVERTSTR(FieldValue, Par1, Par2);

        'COPYSTR' :
          IF Par2 = '' THEN
            FieldValue := COPYSTR(FieldValue, ConvertDecimal(Par1))
          ELSE
            FieldValue := COPYSTR(FieldValue, ConvertDecimal(Par1), ConvertDecimal(Par2));

        'CREATEGUID' :
          FieldValue := CREATEGUID;

        'DATETIME' :
          FieldValue := FormatDateTime(CURRENTDATETIME, 0, OutputFormat);

        'DATE2DMY' :
          FieldValue := FormatDecimal(DATE2DMY(ConvertDate(Par1), ConvertDecimal(Par2)), 0, OutputFormat);

        'DATE2DWY' :
          FieldValue := FormatDecimal(DATE2DWY(ConvertDate(Par1), ConvertDecimal(Par2)), 0, OutputFormat);

        'DT2DATE' :
          FieldValue := FormatDate(DT2DATE(ConvertDateTime(FieldValue)), 0, OutputFormat);

        'DT2TIME' :
          FieldValue := FormatTime(DT2TIME(ConvertDateTime(FieldValue)), 0, OutputFormat);

        'DMY2DATE' :
          CASE TRUE OF
            Par2 <> '' :
              FieldValue := FormatDate(DMY2DATE(ConvertDecimal(Par1), ConvertDecimal(Par2), ConvertDecimal(Par3)), 0, OutputFormat);
            Par1 <> '' :
              FieldValue := FormatDate(DMY2DATE(ConvertDecimal(Par1), ConvertDecimal(Par2)), 0, OutputFormat);
            ELSE
              FieldValue := FormatDate(DMY2DATE(ConvertDecimal(Par1)), 0, OutputFormat);
          END;

        'DWY2DATE' :
          CASE TRUE OF
            Par2 <> '' :
              FieldValue := FormatDate(DWY2DATE(ConvertDecimal(Par1), ConvertDecimal(Par2), ConvertDecimal(Par3)), 0, OutputFormat);
            Par1 <> '' :
              FieldValue := FormatDate(DWY2DATE(ConvertDecimal(Par1), ConvertDecimal(Par2)), 0, OutputFormat);
            ELSE
              FieldValue := FormatDate(DWY2DATE(ConvertDecimal(Par1)), 0, OutputFormat);
          END;

        'DELCHR' :
          CASE TRUE OF
            Par2 <> '' :
              FieldValue := DELCHR(FieldValue, Par1, Par2);
            Par1 <> '' :
              FieldValue := DELCHR(FieldValue, Par1);
            ELSE
              FieldValue := DELCHR(FieldValue);
          END;

        'DELSTR' :
          IF Par2 = '' THEN
            FieldValue := DELSTR(FieldValue, ConvertDecimal(Par1))
          ELSE
            FieldValue := DELSTR(FieldValue, ConvertDecimal(Par1), ConvertDecimal(Par2));

        'DIVIDE' :
          IF EVALUATE(FieldValueDecimal, FieldValue) THEN
            FieldValue := FormatDecimal(FieldValueDecimal / ConvertDecimal(Par1), 0, OutputFormat);

        'ENVIRON' :
          // IDYN EBK >>>> Commented the next line
          //FieldValue := AutoMgt.EnvironFileName(Par1,'');
          FieldValue := AutoMgt.ServerTempFileName(''); //added line
          // IDYN EBK <<<<

        'FILLVARIABLE' :
          VariableMgt.SetVariable(Par1, FieldValue);

        'FORMAT' :
          CASE TRUE OF
            Par2 <> '' :
              FieldValue := FORMAT(FieldValue, ConvertDecimal(Par1), Par2);
            Par1 <> '' :
              FieldValue := FORMAT(FieldValue, ConvertDecimal(Par1));
            ELSE
              FieldValue := FORMAT(FieldValue);
          END;

        'GETVARIABLE' :
          FieldValue := VariableMgt.GetVariable(Par1);

        'GLOBALLANGUAGE' :
          FieldValue := FormatDecimal(GLOBALLANGUAGE, 0, OutputFormat);

        'INCSTR' :
          FieldValue := INCSTR(FieldValue);

        'INSSTR' :
          FieldValue := INSSTR(FieldValue, Par1, ConvertDecimal(Par2));

        'LOWERCASE' :
          FieldValue := LOWERCASE(FieldValue);

        'MULTIPLY' :
          IF EVALUATE(FieldValueDecimal, FieldValue) THEN
            FieldValue := FormatDecimal(FieldValueDecimal * ConvertDecimal(Par1), 0, OutputFormat);

        'OSVERSION' :
          IF NOT ISSERVICETIER THEN
            FieldValue := OSVERSION;

        'PADSTR' :
          IF Par2 = '' THEN
            FieldValue := PADSTR(FieldValue, ConvertDecimal(Par1))
          ELSE
            FieldValue := PADSTR(FieldValue, ConvertDecimal(Par1), Par2);

        'POWER' :
          FieldValue := FormatDecimal(POWER(ConvertDecimal(FieldValue), ConvertDecimal(Par1)), 0, OutputFormat);

        'RANDOM' :
          FieldValue := FormatDecimal(RANDOM(ConvertDecimal(Par1)), 0, OutputFormat);

        'RANDOMIZE' :
          RANDOMIZE;

        'ROUND' :
          CASE TRUE OF
            Par2 <> '' :
              FieldValue := FormatDecimal(ROUND(ConvertDecimal(FieldValue), ConvertDecimal(Par1), Par2), 0, OutputFormat);
            Par1 <> '' :
              FieldValue := FormatDecimal(ROUND(ConvertDecimal(FieldValue), ConvertDecimal(Par1)), 0, OutputFormat);
            ELSE
              FieldValue := FormatDecimal(ROUND(ConvertDecimal(FieldValue)), 0, OutputFormat);
          END;

        'ROUNDDATETIME' :
          CASE TRUE OF
            Par2 <> '' :
              FieldValue := FormatDateTime(ROUNDDATETIME(ConvertDateTime(FieldValue), ConvertDecimal(Par1), Par2), 0, OutputFormat);
            Par1 <> '' :
              FieldValue := FormatDateTime(ROUNDDATETIME(ConvertDateTime(FieldValue), ConvertDecimal(Par1)), 0, OutputFormat);
            ELSE
              FieldValue := FormatDateTime(ROUNDDATETIME(ConvertDateTime(FieldValue)), 0, OutputFormat);
          END;

        'SERIALNUMBER' :
          FieldValue := SERIALNUMBER;

        'SLEEP' :
          SLEEP(ConvertDecimal(Par1));

        'SPLITDESCRIPTION' :
          BEGIN
            Par1Decimal := ConvertDecimal(Par1);
            IF STRLEN(FieldValue) <= Par1Decimal THEN
              EXIT
            ELSE BEGIN
              IF STRPOS(COPYSTR(FieldValue, 1, Par1Decimal + 1), FORMAT(Par2[1])) > 0 THEN
                CharToSearch := Par2[1]
              ELSE
                CharToSearch := ' ';
              Position := Par1Decimal + 1;
              WHILE Position <> 0 DO BEGIN
                IF FieldValue[Position] = CharToSearch THEN BEGIN
                  FieldValue := COPYSTR(FieldValue, 1, Position - 1);
                  EXIT;
                END;
                Position -= 1;
              END;
              IF Position = 0 THEN
                FieldValue := COPYSTR(FieldValue, 1, Par1Decimal);
            END;
          END;

        'STRLEN' :
          FieldValue := FormatDecimal(STRLEN(FieldValue), 0, OutputFormat);

        'STRPOS' :
          FieldValue := FormatDecimal(STRPOS(FieldValue, Par1), 0, OutputFormat);

        'SUBTRACT','SUBSTRACT' :
          IF EVALUATE(FieldValueDecimal, FieldValue) THEN
            FieldValue := FormatDecimal(FieldValueDecimal - ConvertDecimal(Par1), 0, OutputFormat);

        'TIME' :
          FieldValue := FormatTime(TIME, 0, OutputFormat);

        'TODAY' :
          FieldValue := FormatDate(TODAY, 0, OutputFormat);

        'UPPERCASE' :
          FieldValue := UPPERCASE(FieldValue);

        'USERID' :
          FieldValue := USERID;

        'WINDOWSLANGUAGE' :
          FieldValue := FormatDecimal(WINDOWSLANGUAGE, 0, OutputFormat);

        'WORKDATE' :
          FieldValue := FormatDate(WORKDATE, 0, OutputFormat);

        ELSE BEGIN
          Setup.GET;
          IF Setup."Custom Function Codeunit" <> 0 THEN BEGIN
            FunctionTemp.Code := FunctionCode;
            FunctionTemp."Parameter 1" := Par1;
            FunctionTemp."Parameter 2" := Par2;
            FunctionTemp."Parameter 3" := Par3;
            FunctionTemp."Source Variable" := SourceVariable;
            FunctionTemp."Dest. Variable" := DestVariable;
            FunctionTemp.FieldValue := FieldValue;
            FunctionTemp.INSERT;
            CODEUNIT.RUN(Setup."Custom Function Codeunit", FunctionTemp);
            FieldValue := FunctionTemp.FieldValue;
          END;
        END;

      END;

      IF DestVariable <> '' THEN
        VariableMgt.SetVariable(DestVariable, FieldValue);
    END;

    PROCEDURE InsertVariableValue@1100531006(VAR Parameter@1100531000 : Text[50]);
    VAR
      VariableMgt@1100531001 : Codeunit 11148619;
    BEGIN
      IF Parameter = '' THEN
        EXIT;

      IF Parameter[1] <> '#' THEN
        EXIT;

      Parameter := DELCHR(Parameter, '<>', '#');
      Parameter := VariableMgt.GetVariable(Parameter);
    END;

    LOCAL PROCEDURE ConvertDecimal@1100531001(Parameter@1100531000 : Text[50]) ExitValue : Decimal;
    BEGIN
      IF NOT EVALUATE(ExitValue, Parameter) THEN
        ; // Error handling?
    END;

    LOCAL PROCEDURE ConvertDate@1100531008(Parameter@1100531000 : Text[50]) ExitValue : Date;
    BEGIN
      IF NOT EVALUATE(ExitValue, Parameter) THEN
        ; // Error handling?
    END;

    LOCAL PROCEDURE ConvertDateTime@1100531022(Parameter@1100531000 : Text[50]) ExitValue : DateTime;
    BEGIN
      IF NOT EVALUATE(ExitValue, Parameter) THEN
        ; // Error handling?
    END;

    LOCAL PROCEDURE FormatDecimal@1000000005(Value@1000000000 : Decimal;Length@1000000001 : Integer;FormatString@1000000002 : Text[250]) Result : Text[1024];
    BEGIN
      IF FormatString = '' THEN
        // CI-130.begin
        // EXIT(FORMAT(Value))
        // Force format that doesn't contain thousand grouping symbols
        EXIT(FORMAT(Value, Length, 1))
        // CI-130.end
      ELSE
        EXIT(FORMAT(Value, Length, FormatString));
    END;

    LOCAL PROCEDURE FormatDate@1000000003(Value@1000000000 : Date;Length@1000000001 : Integer;FormatString@1000000002 : Text[250]) Result : Text[1024];
    BEGIN
      IF FormatString = '' THEN
        EXIT(FORMAT(Value))
      ELSE
        EXIT(FORMAT(Value, Length, FormatString));
    END;

    LOCAL PROCEDURE FormatTime@1000000004(Value@1000000000 : Time;Length@1000000001 : Integer;FormatString@1000000002 : Text[250]) Result : Text[1024];
    BEGIN
      IF FormatString = '' THEN
        EXIT(FORMAT(Value))
      ELSE
        EXIT(FORMAT(Value, Length, FormatString));
    END;

    LOCAL PROCEDURE FormatDateTime@1000000002(Value@1000000000 : DateTime;Length@1000000001 : Integer;FormatString@1000000002 : Text[250]) Result : Text[1024];
    BEGIN
      IF FormatString = '' THEN
        EXIT(FORMAT(Value))
      ELSE
        EXIT(FORMAT(Value, Length, FormatString));
    END;

    PROCEDURE Initialize@1100531005();
    VAR
      Setup@1100543001 : Record 11148589;
      FunctionTemp@1100543000 : TEMPORARY Record 11148603;
    BEGIN
      CreateFunction(
        'ABS', 'Use this function to calculate the absolute value of a number. ABS always returns a positive numeric value or zero.',
        '', '', '');

      CreateFunction(
        'APPLICATIONPATH',
        'Use this function to return the path to the directory where the executable file for Microsoft Dynamics NAV is installed.',
        '', '', '');

      CreateFunction(
        'ADD', 'Returns the value added with the given value.',
        'AddWidth', '', '');

      CreateFunction(
        'CALCDATE', 'Calculates a new date based on a date expression and a reference date.',
        'DateExpression', '', '');

      CreateFunction(
        'COMPANYNAME', 'Use this function to have the system return the active company.',
        '', '', '');

      CreateFunction(
        'CONCAT',
        'Use this function to concatenate strings.',
        'ConcatBefore', 'ConcatAfter', '');

      CreateFunction(
        'CONTEXTURL', 'Use this function to return a context string that defines the current position of the running objects.',
        '', '', '');

      CreateFunction(
        'CONVERTSTR',
        'Use this function to convert the characters in a string based on the characters in the strings' +
        'FromCharacters and ToCharacters, which serve as conversion tables.',
        'FromCharacters', 'ToCharacters', '');

      CreateFunction(
        'COPYSTR',
        'Use this function to copy a substring of any length from a specific position in a string (text or code) to a new string.',
        'Position', '[Length]', '');

      CreateFunction(
        'CREATEGUID', 'Use this function to create a new unique GUID.',
        '', '', '');

      CreateFunction(
        'DATETIME', 'Use this function to return the current datetime.',
        '', '', '');

      CreateFunction(
        'DATE2DMY', 'Returns the day, month, or year based on a date.',
        'What', '', '');

      CreateFunction(
        'DATE2DWY', 'Returns the day of the week, week number, and year based on the input Date.',
        'What', '', '');

      CreateFunction(
        'DT2DATE', 'Use this function to return the date part of a datetime',
        '', '', '');

      CreateFunction(
        'DT2TIME', 'Use this function to return the time part of a datetime.',
        '', '', '');

      CreateFunction(
        'DMY2DATE', 'Use this function to return a Date based on a day, month, and year.',
        'Day', '[Month]', '[Year]');

      CreateFunction(
        'DWY2DATE', 'Use this function to return a Date based on a weekday, a week, and a year.',
        'WeekDay', '[Week]', '[Year]');

      CreateFunction(
        'DELCHR', 'Use this function to delete one or more characters in a string.',
        '[Where]', '[Which]', '');

      CreateFunction(
        'DELSTR', 'Use this function to delete a substring inside a string (text or code).',
        'Position', '[Length]', '');

      CreateFunction(
        'DIVIDE', 'Returns the value divided with the given value.',
        'DivideBy', '', '');

      CreateFunction(
        'ENVIRON', 'Use this function to return a string associated with an environment variable.',
        'Name', '', '');

      CreateFunction(
        'FILLVARIABLE', 'Use this function to fill a variable.',
        'Variable', '', '');

      CreateFunction(
        'FORMAT', 'Use this function to format a value into a string',
        '[Length]', '[FormatStr]', '');

      CreateFunction(
        'GETVARIABLE', 'Use this function to retrieve a variable.',
        'Variable', '', '');

      CreateFunction(
        'GLOBALLANGUAGE', 'Use this function to retrieve the current C/SIDE global language setting.',
        '', '', '');

      CreateFunction(
        'INCSTR', 'Use this function to increase a positive number or decrease a negative number inside a string by one (1).',
        '', '', '');

      CreateFunction(
        'INSSTR', 'Use this function to insert a substring into a string.',
        'SubString', 'Position', '');

      CreateFunction(
        'LOWERCASE', 'Use this function to convert all letters in a string to lowercase.',
        '', '', '');

      CreateFunction(
        'MULTIPLY', 'Returns the value muliplied with the given value.',
        'MultiplyWidth', '', '');

      CreateFunction(
        'OSVERSION',
        'Use this function to return a string which contains the name ' +
        'and version of the operating system or operating environment.',
        '', '', '');

      CreateFunction(
        'PADSTR',
        'Use this function to change the length of a string to a length you define. ' +
        'The system does this by either truncating the string or adding filler characters at the end of the string.',
        'Length', '[FillCharacter]', '');

      CreateFunction(
        'POWER',
        'Use this function to raise a number to a power. ' +
        'For instance you can use this function to square the number 2 to get the result, 4.',
        'Power', '', '');

      CreateFunction(
        'RANDOM', 'Use this function to return a pseudo-random number.',
        'MaxNumber', '', '');

      CreateFunction(
        'RANDOMIZE', 'Use this function to generate a set of random numbers, from which RANDOM will select a random number.',
        '', '', '');

      CreateFunction(
        'ROUND', 'Use this function to round the value of a number variable.',
        '[Precision]', '[Direction]', '');

      CreateFunction(
        'ROUNDDATETIME', 'Use this function to round a datetime.',
        '[Precision]', '[Direction]', '');

      CreateFunction(
        'SERIALNUMBER',
        'Use this function to return a string which contains the serial number ' +
        'of the license file for your Microsoft Dynamics NAV system.',
        '', '', '');

      CreateFunction(
        'SLEEP', 'Use this function to return control to the operating system for a specifiable amount of time.',
        'Milliseconds', '', '');

      CreateFunction(
        'SPLITDESCRIPTION', 'Splits the value at the last space or splitcharacter.',
        'MaxLength', 'SplitCharacter', '');

      CreateFunction(
        'STRLEN', 'Use this function to return the length of a string you define.',
        '', '', '');

      CreateFunction(
        'STRPOS', 'Use this function to search for a substring inside a string.',
        'SubString', '', '');

      CreateFunction(
        'SUBSTRACT', 'Returns the value minus the given value.',
        'SubstractWith', '', '');

      CreateFunction(
        'TIME', 'Use this function to retrieve the current time from the operating system.',
        '', '', '');

      CreateFunction(
        'TODAY', 'Use this function to return the current date set in the operating system.',
        '', '', '');

      CreateFunction(
        'USERID', 'Use this function to have the system return the ID of the current user.',
        '', '', '');

      CreateFunction(
        'UPPERCASE', 'Use this function to convert the letters in a string to uppercase.',
        '', '', '');

      CreateFunction(
        'WINDOWSLANGUAGE', 'Use this function to retrieve the current Windows language setting.',
        '', '', '');

      CreateFunction(
        'WORKDATE', 'Use this function to return the current work date.',
        '', '', '');

      // Run initialization of Custom Function Library.
      Setup.GET;
      IF Setup."Custom Function Codeunit" <> 0 THEN BEGIN
        FunctionTemp.DELETEALL;
        CODEUNIT.RUN(Setup."Custom Function Codeunit", FunctionTemp);
      END;
    END;

    LOCAL PROCEDURE CreateFunction@1100531004(Code@1100531000 : Code[20];Description@1100531001 : Text[250];Par1@1100531002 : Text[50];Par2@1100531003 : Text[50];Par3@1100531004 : Text[50]);
    VAR
      INFunction@1100531005 : Record 11148595;
      Parameters@1100531007 : Text[1024];
      ctParameters@1100531008 : TextConst 'ENU=%1, %2, %3;NLD=%1, %2, %3';
      cDescription2@1100531009 : TextConst 'ENU=%1(%2);NLD=%1(%2)';
    BEGIN
      INFunction.Code := Code;
      INFunction.Description := Description;

      Parameters := Par1;
      IF Par2 <> '' THEN
        Parameters += ', ' + Par2;
      IF Par3 <> '' THEN
        Parameters += ', ' + Par3;
      INFunction."Description 2" := STRSUBSTNO(cDescription2, Code, Parameters);
      INFunction."Parameter 1" := Par1;
      INFunction."Parameter 2" := Par2;
      INFunction."Parameter 3" := Par3;
      IF NOT INFunction.INSERT THEN
        INFunction.MODIFY;
    END;

    PROCEDURE CreateCustomFunction@1100543000(VAR FunctionTemp@1100543000 : Record 11148603);
    BEGIN
      CreateFunction(FunctionTemp.Code, FunctionTemp.Description,
          FunctionTemp."Parameter 1", FunctionTemp."Parameter 2", FunctionTemp."Parameter 3");
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148594 IN - Import Definitions
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    OnRun=VAR
            ImportDefinition@1000000 : Record 11148591;
          BEGIN
            ImportDefinition.SETRANGE(Status, ImportDefinition.Status::Edit);
            IF ImportDefinition.FINDSET THEN
              REPEAT
                ImportDefinition.Process;
              UNTIL ImportDefinition.NEXT = 0;
          END;

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148595 IN - Start Import XML File
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    TableNo=11148591;
    OnRun=VAR
            ImportDefMgt@1000000 : Codeunit 11148591;
          BEGIN
            IF NOT gImportXMLFile.RUN(Rec) THEN
              ImportDefMgt.AddUnknownError;
          END;

  }
  CODE
  {
    VAR
      gImportXMLFile@1000000 : Codeunit 11148600;

    PROCEDURE SetFilename@1000001(Path@1000000 : Text[1024];Filename@1000001 : Text[1024]);
    BEGIN
      gImportXMLFile.SetFilename(Path, Filename);
    END;

    PROCEDURE SetDoc@1000011(VAR lDoc@1000001 : Codeunit 11148637);
    BEGIN
      gImportXMLFile.SetDoc(lDoc);
    END;

    PROCEDURE SetInstream@1000009(VAR InStr@1000000 : InStream);
    BEGIN
      gImportXMLFile.SetInstream(InStr);
    END;

    PROCEDURE SetMessageEntryNo@1000016(NewValue@1000000 : Integer);
    BEGIN
      gImportXMLFile.SetMessageEntryNo(NewValue);
    END;

    PROCEDURE SetDestinationCompany@1000012(NewValue@1000000 : Text[1024]);
    BEGIN
      gImportXMLFile.SetDestinationCompany(NewValue);
    END;

    PROCEDURE SetWebServiceCall@1000000000(IsWebServiceCall@1000000000 : Boolean);
    BEGIN
      gImportXMLFile.SetIsWebServiceCall(IsWebServiceCall);
    END;

    PROCEDURE TestFile@1000018(VAR lRec@1000000 : Record 11148591);
    BEGIN
      gImportXMLFile.TestFile(lRec);
    END;

    PROCEDURE NoOfRecordsProcessed@1100531000() : Integer;
    BEGIN
      EXIT(gImportXMLFile.NoOfRecordsProcessed);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148596 IN - Start Import File
{
  OBJECT-PROPERTIES
  {
    Date=24-05-13;
    Time=13:00:00;
    Version List=IDYN-CE5.50.0;
  }
  PROPERTIES
  {
    TableNo=11148591;
    OnRun=VAR
            ImportDefMgt@1000000 : Codeunit 11148591;
            ConnectITReader@1000000000 : Codeunit 11148602;
          BEGIN
            IF NOT ImportFile.RUN(Rec) THEN BEGIN
              ConnectITReader.Close;
              ImportDefMgt.AddUnknownError;
            END;
          END;

  }
  CODE
  {
    VAR
      ImportFile@1000000 : Codeunit 11148601;

    PROCEDURE SetFilename@1000001(Path@1000000 : Text[1024];Filename@1000001 : Text[1024]);
    BEGIN
      ImportFile.SetFilename(Path, Filename);
    END;

    PROCEDURE TestFile@1000018(VAR lRec@1000000 : Record 11148591);
    BEGIN
      ImportFile.TestFile(lRec);
    END;

    PROCEDURE NoOfRecordsProcessed@1100531000() : Integer;
    BEGIN
      EXIT(ImportFile.NoOfRecordsProcessed);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148597 IN - FTP
{
  OBJECT-PROPERTIES
  {
    Date=14-07-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.1;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      FTPAutomation@1000000000 : Automation "{75E053EA-4A5A-4210-9188-699CF98212FE} 2.7:{EF0B441B-3941-42A8-9D75-4B0858ABA629}:'IDYN.Components'.Ftp";
      FtpDotNetOnRTC@1000000002 : DotNet "'IDYN.Components, Version=2.7.1.712, Culture=neutral, PublicKeyToken=0f5532c6f6903616'.IDYN.Components.Ftp" RUNONCLIENT;
      FtpDotNetOnNST@1000000003 : DotNet "'IDYN.Components, Version=2.7.1.712, Culture=neutral, PublicKeyToken=0f5532c6f6903616'.IDYN.Components.Ftp";
      Mode@1000000001 : 'Automation,DotNet on RTC,DotNet on NST';

    PROCEDURE Create@1000000000(NewServer@1000000000 : Boolean;ClientSide@1000000001 : Boolean) : Boolean;
    BEGIN
      SetMode(ClientSide);

      CASE Mode OF
        Mode::Automation: EXIT(CreateAutomation(NewServer, ClientSide));
        Mode::"DotNet on RTC": EXIT(CreateDotNetOnRTC(NewServer, ClientSide));
        Mode::"DotNet on NST": EXIT(CreateDotNetOnNST(NewServer, ClientSide));
      END;
    END;

    LOCAL PROCEDURE CreateAutomation@1000000024(NewServer@1000000001 : Boolean;ClientSide@1000000000 : Boolean) : Boolean;
    BEGIN
      IF NOT ISCLEAR(FTPAutomation) THEN
        CLEAR(FTPAutomation);

      EXIT(CREATE(FTPAutomation, NewServer, ClientSide));
    END;

    LOCAL PROCEDURE CreateDotNetOnRTC@1000000025(NewServer@1000000001 : Boolean;ClientSide@1000000000 : Boolean) : Boolean;
    BEGIN
      FtpDotNetOnRTC := FtpDotNetOnRTC.Ftp();
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE CreateDotNetOnNST@1000000026(NewServer@1000000001 : Boolean;ClientSide@1000000000 : Boolean) : Boolean;
    BEGIN
      FtpDotNetOnNST := FtpDotNetOnNST.Ftp();
      EXIT(TRUE);
    END;

    PROCEDURE GetHostName@1000000005() : Text[1024];
    BEGIN
      CASE Mode OF
        Mode::Automation: EXIT(FTPAutomation.HostName);
        Mode::"DotNet on RTC": EXIT(FtpDotNetOnRTC.HostName);
        Mode::"DotNet on NST": EXIT(FtpDotNetOnNST.HostName);
      END;
    END;

    PROCEDURE SetHostName@1000000002(HostName@1000000000 : Text[1024]);
    BEGIN
      CASE Mode OF
        Mode::Automation: FTPAutomation.HostName := HostName;
        Mode::"DotNet on RTC": FtpDotNetOnRTC.HostName := HostName;
        Mode::"DotNet on NST": FtpDotNetOnNST.HostName := HostName;
      END;
    END;

    PROCEDURE GetPort@1() : Integer;
    BEGIN
      // CI-173
      CASE Mode OF
        Mode::Automation: EXIT(FTPAutomation.Port);
        Mode::"DotNet on RTC": EXIT(FtpDotNetOnRTC.Port);
        Mode::"DotNet on NST": EXIT(FtpDotNetOnNST.Port);
      END;
    END;

    PROCEDURE SetPort@2(Port@1000 : Integer);
    BEGIN
      // CI-173
      CASE Mode OF
        Mode::Automation: FTPAutomation.Port := Port;
        Mode::"DotNet on RTC": FtpDotNetOnRTC.Port := Port;
        Mode::"DotNet on NST": FtpDotNetOnNST.Port := Port;
      END;
    END;

    PROCEDURE GetUserName@1000000006() : Text[1024];
    BEGIN
      CASE Mode OF
        Mode::Automation: EXIT(FTPAutomation.UserName);
        Mode::"DotNet on RTC": EXIT(FtpDotNetOnRTC.UserName);
        Mode::"DotNet on NST": EXIT(FtpDotNetOnNST.UserName);
      END;
    END;

    PROCEDURE SetUserName@1000000003(UserName@1000000000 : Text[1024]);
    BEGIN
      CASE Mode OF
        Mode::Automation: FTPAutomation.UserName := UserName;
        Mode::"DotNet on RTC": FtpDotNetOnRTC.UserName := UserName;
        Mode::"DotNet on NST": FtpDotNetOnNST.UserName := UserName;
      END;
    END;

    PROCEDURE GetPassword@1000000007() : Text[1024];
    BEGIN
      CASE Mode OF
        Mode::Automation: EXIT(FTPAutomation.Password);
        Mode::"DotNet on RTC": EXIT(FtpDotNetOnRTC.Password);
        Mode::"DotNet on NST": EXIT(FtpDotNetOnNST.Password);
      END;
    END;

    PROCEDURE SetPassword@1000000004(Password@1000000000 : Text[1024]);
    BEGIN
      CASE Mode OF
        Mode::Automation: FTPAutomation.Password := Password;
        Mode::"DotNet on RTC": FtpDotNetOnRTC.Password := Password;
        Mode::"DotNet on NST": FtpDotNetOnNST.Password := Password;
      END;
    END;

    PROCEDURE GetEnableSsl@1000000008() : Boolean;
    BEGIN
      CASE Mode OF
        Mode::Automation: EXIT(FTPAutomation.EnableSsl);
        Mode::"DotNet on RTC": EXIT(FtpDotNetOnRTC.EnableSsl);
        Mode::"DotNet on NST": EXIT(FtpDotNetOnNST.EnableSsl);
      END;
    END;

    PROCEDURE SetEnableSsl@1000000009(EnableSsl@1000000000 : Boolean);
    BEGIN
      CASE Mode OF
        Mode::Automation: FTPAutomation.EnableSsl := EnableSsl;
        Mode::"DotNet on RTC": FtpDotNetOnRTC.EnableSsl := EnableSsl;
        Mode::"DotNet on NST": FtpDotNetOnNST.EnableSsl := EnableSsl;
      END;
    END;

    PROCEDURE GetEnableSsh@1000000010() : Boolean;
    BEGIN
      CASE Mode OF
        Mode::Automation: EXIT(FTPAutomation.EnableSsh);
        Mode::"DotNet on RTC": EXIT(FtpDotNetOnRTC.EnableSsh);
        Mode::"DotNet on NST": EXIT(FtpDotNetOnNST.EnableSsh);
      END;
    END;

    PROCEDURE SetEnableSsh@1000000011(EnableSsh@1000000000 : Boolean);
    BEGIN
      CASE Mode OF
        Mode::Automation: FTPAutomation.EnableSsh := EnableSsh;
        Mode::"DotNet on RTC": FtpDotNetOnRTC.EnableSsh := EnableSsh;
        Mode::"DotNet on NST": FtpDotNetOnNST.EnableSsh := EnableSsh;
      END;
    END;

    PROCEDURE GetDirectoryContents@1000000001(FromDirectory@1000000001 : Text[1024];VAR DirectoryList@1000000000 : Codeunit 11148598);
    VAR
      DirectoryListAutomation@1000000002 : Automation "{75E053EA-4A5A-4210-9188-699CF98212FE} 2.7:{CCCF3C18-E03C-43EE-96BA-FF9DC2294EE5}:'IDYN.Components'.DirectoryList";
      DirectoryListDotNetOnRTC@1000000003 : DotNet "'IDYN.Components, Version=2.7.1.712, Culture=neutral, PublicKeyToken=0f5532c6f6903616'.IDYN.Components.DirectoryList" RUNONCLIENT;
      DirectoryListDotNetOnNST@1000000004 : DotNet "'IDYN.Components, Version=2.7.1.712, Culture=neutral, PublicKeyToken=0f5532c6f6903616'.IDYN.Components.DirectoryList";
    BEGIN
      CASE Mode OF
        Mode::Automation:
          BEGIN
            DirectoryListAutomation := FTPAutomation.GetDirectoryContents(FromDirectory);
            DirectoryList.SetAutomation(DirectoryListAutomation);
          END;
        Mode::"DotNet on RTC":
          BEGIN
            DirectoryListDotNetOnRTC := FtpDotNetOnRTC.GetDirectoryContents(FromDirectory);
            DirectoryList.SetDotNetOnRTC(DirectoryListDotNetOnRTC);
          END;
        Mode::"DotNet on NST":
          BEGIN
            DirectoryListDotNetOnNST := FtpDotNetOnNST.GetDirectoryContents(FromDirectory);
            DirectoryList.SetDotNetOnNST(DirectoryListDotNetOnNST);
          END;
      END;
    END;

    PROCEDURE UploadFile@1000000016(LocalFileName@1000000000 : Text[1024];RemoteFileName@1000000001 : Text[1024];Binary@1000000002 : Boolean) : Boolean;
    BEGIN
      CASE Mode OF
        Mode::Automation: EXIT(FTPAutomation.UploadFile(LocalFileName, RemoteFileName, Binary));
        Mode::"DotNet on RTC": EXIT(FtpDotNetOnRTC.UploadFile(LocalFileName, RemoteFileName, Binary));
        Mode::"DotNet on NST": EXIT(FtpDotNetOnNST.UploadFile(LocalFileName, RemoteFileName, Binary));
      END;
    END;

    PROCEDURE DownloadFile@1000000013(LocalFileName@1000000000 : Text[1024];RemoteFileName@1000000001 : Text[1024];Binary@1000000002 : Boolean) : Boolean;
    BEGIN
      CASE Mode OF
        Mode::Automation: EXIT(FTPAutomation.DownloadFile(LocalFileName, RemoteFileName, Binary));
        Mode::"DotNet on RTC": EXIT(FtpDotNetOnRTC.DownloadFile(LocalFileName, RemoteFileName, Binary));
        Mode::"DotNet on NST": EXIT(FtpDotNetOnNST.DownloadFile(LocalFileName, RemoteFileName, Binary));
      END;
    END;

    PROCEDURE MoveFile@1000000015(RemoteFileName@1000000000 : Text[1024];ArchiveFileName@1000000001 : Text[1024]) : Boolean;
    BEGIN
      CASE Mode OF
        Mode::Automation: EXIT(FTPAutomation.MoveFile(RemoteFileName, ArchiveFileName));
        Mode::"DotNet on RTC": EXIT(FtpDotNetOnRTC.MoveFile(RemoteFileName, ArchiveFileName));
        Mode::"DotNet on NST": EXIT(FtpDotNetOnNST.MoveFile(RemoteFileName, ArchiveFileName));
      END;
    END;

    PROCEDURE DeleteFile@1000000014(RemoteFileName@1000000000 : Text[1024]) : Boolean;
    BEGIN
      CASE Mode OF
        Mode::Automation: EXIT(FTPAutomation.DeleteFile(RemoteFileName));
        Mode::"DotNet on RTC": EXIT(FtpDotNetOnRTC.DeleteFile(RemoteFileName));
        Mode::"DotNet on NST": EXIT(FtpDotNetOnNST.DeleteFile(RemoteFileName));
      END;
    END;

    PROCEDURE LastError@1000000012() : Text[1024];
    BEGIN
      CASE Mode OF
        Mode::Automation: EXIT(FTPAutomation.LastError);
        Mode::"DotNet on RTC": EXIT(FtpDotNetOnRTC.LastError);
        Mode::"DotNet on NST": EXIT(FtpDotNetOnNST.LastError);
      END;
    END;

    PROCEDURE GetMode@1000000018() : Integer;
    BEGIN
      EXIT(Mode);
    END;

    LOCAL PROCEDURE SetMode@1000000019(ClientSide@1000000000 : Boolean);
    BEGIN
      IF NOT ISSERVICETIER THEN BEGIN
        Mode := Mode::Automation;
        EXIT;
      END;

      IF ClientSide THEN BEGIN
        Mode := Mode::"DotNet on RTC";
        EXIT;
      END;

      Mode := Mode::"DotNet on NST";
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148598 IN - DirectoryList
{
  OBJECT-PROPERTIES
  {
    Date=14-07-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.1;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      DirectoryListAutomation@1000000000 : Automation "{75E053EA-4A5A-4210-9188-699CF98212FE} 2.7:{CCCF3C18-E03C-43EE-96BA-FF9DC2294EE5}:'IDYN.Components'.DirectoryList";
      DirectoryListDotNetOnRTC@1000000002 : DotNet "'IDYN.Components, Version=2.7.1.712, Culture=neutral, PublicKeyToken=0f5532c6f6903616'.IDYN.Components.DirectoryList" RUNONCLIENT;
      DirectoryListDotNetOnNST@1000000003 : DotNet "'IDYN.Components, Version=2.7.1.712, Culture=neutral, PublicKeyToken=0f5532c6f6903616'.IDYN.Components.DirectoryList";
      Mode@1000000001 : 'Automation,DotNet on RTC,DotNet on NST';

    PROCEDURE GetAutomation@1000000000(VAR DirectoryList2@1000000000 : Automation "{75E053EA-4A5A-4210-9188-699CF98212FE} 2.7:{CCCF3C18-E03C-43EE-96BA-FF9DC2294EE5}:'IDYN.Components'.DirectoryList");
    BEGIN
      DirectoryList2 := DirectoryListAutomation;
    END;

    PROCEDURE SetAutomation@1000000001(VAR DirectoryList2@1000000000 : Automation "{75E053EA-4A5A-4210-9188-699CF98212FE} 2.7:{CCCF3C18-E03C-43EE-96BA-FF9DC2294EE5}:'IDYN.Components'.DirectoryList");
    BEGIN
      DirectoryListAutomation := DirectoryList2;
      Mode := Mode::Automation;
    END;

    PROCEDURE GetDotNetOnRTC@1000000006(VAR DirectoryList2@1000000000 : DotNet "'IDYN.Components, Version=2.7.1.712, Culture=neutral, PublicKeyToken=0f5532c6f6903616'.IDYN.Components.DirectoryList" RUNONCLIENT);
    BEGIN
      DirectoryList2 := DirectoryListDotNetOnRTC;
    END;

    PROCEDURE SetDotNetOnRTC@1000000007(VAR DirectoryList2@1000000000 : DotNet "'IDYN.Components, Version=2.7.1.712, Culture=neutral, PublicKeyToken=0f5532c6f6903616'.IDYN.Components.DirectoryList" RUNONCLIENT);
    BEGIN
      DirectoryListDotNetOnRTC := DirectoryList2;
      Mode := Mode::"DotNet on RTC";
    END;

    PROCEDURE GetDotNetOnNST@1000000008(VAR DirectoryList2@1000000000 : DotNet "'IDYN.Components, Version=2.7.1.712, Culture=neutral, PublicKeyToken=0f5532c6f6903616'.IDYN.Components.DirectoryList");
    BEGIN
      DirectoryList2 := DirectoryListDotNetOnNST;
    END;

    PROCEDURE SetDotNetOnNST@1000000009(VAR DirectoryList2@1000000000 : DotNet "'IDYN.Components, Version=2.7.1.712, Culture=neutral, PublicKeyToken=0f5532c6f6903616'.IDYN.Components.DirectoryList");
    BEGIN
      DirectoryListDotNetOnNST := DirectoryList2;
      Mode := Mode::"DotNet on NST";
    END;

    PROCEDURE GetItem@1000000003(Index@1000000000 : Integer) : Text[1024];
    BEGIN
      CASE Mode OF
        Mode::Automation: EXIT(DirectoryListAutomation.GetItem(Index));
        Mode::"DotNet on RTC": EXIT(DirectoryListDotNetOnRTC.GetItem(Index));
        Mode::"DotNet on NST": EXIT(DirectoryListDotNetOnNST.GetItem(Index));
      END;
    END;

    PROCEDURE Count@1000000002() : Integer;
    BEGIN
      CASE Mode OF
        Mode::Automation: EXIT(DirectoryListAutomation.Count);
        Mode::"DotNet on RTC": EXIT(DirectoryListDotNetOnRTC.Count);
        Mode::"DotNet on NST": EXIT(DirectoryListDotNetOnNST.Count);
      END;
    END;

    PROCEDURE GetMode@1000000004() : Integer;
    BEGIN
      EXIT(Mode);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148599 IN - Start Import ADO
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    TableNo=11148591;
    OnRun=BEGIN
            ImportADO.RUN(Rec);
            //IF NOT ImportADO.RUN(Rec) THEN
            //  ImportDefMgt.AddUnknownError;
          END;

  }
  CODE
  {
    VAR
      ImportADO@1000000 : Codeunit 11148604;

    PROCEDURE NoOfRecordsProcessed@1100531000() : Integer;
    BEGIN
      EXIT(ImportADO.NoOfRecordsProcessed);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148600 IN - Import XML File
{
  OBJECT-PROPERTIES
  {
    Date=14-07-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.1;
  }
  PROPERTIES
  {
    TableNo=11148591;
    OnRun=VAR
            Task@1000000 : Record 11148614;
          BEGIN
            gRec := Rec;

            ClearBuffers;
            FirstTableLineNo := 0;

            FillBuffers(Rec);
            IF FileIsValid THEN BEGIN
              ProcessFile;
              COMMIT;

              IF "Run Task" <> '' THEN BEGIN
                Task.GET("Run Task");
                Task.Process;
              END;

            END;
          END;

  }
  CODE
  {
    VAR
      gRec@1000004 : Record 11148591;
      gTmpImportDefinitionLine@1000005 : TEMPORARY Record 11148592;
      gTmpImportDefinitionLine2@1000006 : TEMPORARY Record 11148592;
      gTmpImportDefTableLink@1000008 : TEMPORARY Record 11148593;
      gTmpImportDefFunction@1100531000 : TEMPORARY Record 11148594;
      gDoc@1000012 : Codeunit 11148637;
      gRecRefPerIndent@1000003 : ARRAY [100] OF RecordRef;
      gxRecRefPerIndent@1000018 : ARRAY [100] OF RecordRef;
      gDestinationCompany@1000014 : Text[1024];
      gFilename@1000009 : Text[1024];
      gPath@1000007 : Text[1024];
      FirstTableLineNo@1000002 : Integer;
      gIdPerIndent@1000015 : ARRAY [100] OF Integer;
      gMessageEntryNo@1000013 : Integer;
      gNoOfRecordsProcessed@1100531001 : Integer;
      LineCounter@1000001 : Integer;
      gRecRefAction@1000010 : ARRAY [100] OF 'Insert,Update,Delete,None';
      gSourceType@1000011 : 'File,Connector';
      gProcessRun@1000000 : Boolean;
      gRenameKeyPerIndent@1000016 : ARRAY [100] OF Boolean;
      gFromWebServiceCall@1000000000 : Boolean;

    LOCAL PROCEDURE FileIsValid@1000000() : Boolean;
    VAR
      TmpBlob@1000008 : TEMPORARY Record 11148609;
      CommentMgt@1000006 : Codeunit 11148622;
      LogMgt@1000003 : Codeunit 11148623;
      Doc@1000002 : Codeunit 11148637;
      RootNode@1000001 : Codeunit 11148611;
      DocAsNode@1000000001 : Codeunit 11148611;
      OutStr@1000009 : OutStream;
      ctNoFilenameSpecified@1000007 : TextConst 'ENU=No filename specified.;NLD=Geen bestandsnaam opgegeven.';
      ctTheRootElementNotFound@1000010 : TextConst 'ENU=Element %1 not found.;NLD=Element %1 niet gevonden.';
      DocNotCreated@1000005 : TextConst 'ENU=The XML Document cannot be created.;NLD=Het XML document kan niet worden aangemaakt.';
      ToManyRootElements@1000004 : TextConst 'ENU=Only one root element allowed.;NLD=Er mag maar een hoofdelement aanwezig zijn.';
      VariableMgt@1000000000 : Codeunit 11148619;
    BEGIN
      WITH gRec DO BEGIN

        TESTFIELD("File Format", "File Format"::XML);
        IF Status = Status::Blocked THEN
          FIELDERROR(Status);

        IF gFromWebServiceCall THEN
          TESTFIELD(Status, Status::"Web Service");

        IF NOT Doc.Create(TRUE, FALSE) THEN
          ERROR(DocNotCreated);

        gTmpImportDefinitionLine.SETCURRENTKEY("Import Definition", "Line No.");
        gTmpImportDefinitionLine.SETRANGE("Import Definition", Code);
        gTmpImportDefinitionLine.SETRANGE(Indent, 0);
        IF gTmpImportDefinitionLine.COUNT > 1 THEN
          ERROR(ToManyRootElements);

        gTmpImportDefinitionLine.FINDFIRST;
        gTmpImportDefinitionLine.TESTFIELD("Tag Name");

        CASE gSourceType OF

          gSourceType::File :
            BEGIN
              IF gPath + gFilename = '' THEN
                ERROR(ctNoFilenameSpecified);
              Doc.SetAsync(FALSE); // CI-146
              Doc.SetProhibitDTD(FALSE); // CI-210
              Doc.SetResolveExternals(TRUE); // CI-210
              Doc.SetValidateOnParse(gRec."Validate XML on Parse"); // CI-210
              Doc.LoadFromFile(gPath + gFilename);

              VariableMgt.SetVariable('#FILENAME#', gPath + gFilename);
              VariableMgt.SetVariable('#PATH#', gPath);
              VariableMgt.SetVariable('#DEF_CODE#', gRec.Code);
              VariableMgt.SetVariable('#DEF_DESCRIPTION#', gRec.Description);
            END;

          gSourceType::Connector :
            Doc := gDoc;

        END;

        gProcessRun := FALSE;

        Doc.AsNode(DocAsNode);

        IF NOT FindNode(DocAsNode, BuildXPath(gTmpImportDefinitionLine), RootNode) THEN
          ERROR(ctTheRootElementNotFound, BuildXPath(gTmpImportDefinitionLine));

        IF gTmpImportDefinitionLine.Type = gTmpImportDefinitionLine.Type::Table THEN
          ProcessTableLine(gTmpImportDefinitionLine, DocAsNode, TRUE)
        ELSE BEGIN
          gTmpImportDefinitionLine.SETRANGE(Indent, 1);
          IF gTmpImportDefinitionLine.FINDSET THEN
            REPEAT
              ProcessLine(gTmpImportDefinitionLine, RootNode, TRUE);
            UNTIL gTmpImportDefinitionLine.NEXT = 0;
        END;

        IF "Save to Messages" THEN
          IF gMessageEntryNo = 0 THEN BEGIN
            TmpBlob.BLOB.CREATEOUTSTREAM(OutStr);
            Doc.SaveToStream(OutStr);
            LogMgt.SaveMessageToLog(0, Code, gPath, gFilename, TmpBlob, FALSE, FALSE);
          END ELSE
            LogMgt.UpdateMessage(gMessageEntryNo);

        CLEAR(Doc);

        EXIT(NOT CommentMgt.ErrorOccured);
      END;
    END;

    LOCAL PROCEDURE ProcessFile@1000014();
    VAR
      Doc@1000002 : Codeunit 11148637;
      DocAsNode@1000000000 : Codeunit 11148611;
      RootNode@1000001 : Codeunit 11148611;
    BEGIN
      WITH gRec DO BEGIN
        Doc.Create(TRUE, FALSE);

        CASE gSourceType OF

          gSourceType::File :
            BEGIN
              Doc.SetAsync(FALSE); // CI-146
              Doc.SetProhibitDTD(FALSE); // CI-210
              Doc.SetResolveExternals(TRUE); // CI-210
              Doc.SetValidateOnParse(gRec."Validate XML on Parse"); // CI-210
              Doc.LoadFromFile(gPath + gFilename);
            END;

          gSourceType::Connector :
            Doc := gDoc;

        END;

        gTmpImportDefinitionLine.SETRANGE(Indent, 0);
        gTmpImportDefinitionLine.FINDFIRST;

        CLEAR(gIdPerIndent);
        gProcessRun := TRUE;

        Doc.AsNode(DocAsNode);

        FindNode(DocAsNode, BuildXPath(gTmpImportDefinitionLine), RootNode);
        IF gTmpImportDefinitionLine.Type = gTmpImportDefinitionLine.Type::Table THEN
          ProcessTableLine(gTmpImportDefinitionLine, DocAsNode, TRUE)
        ELSE BEGIN
          gTmpImportDefinitionLine.SETRANGE(Indent, 1);
          IF gTmpImportDefinitionLine.FINDSET THEN
            REPEAT
              ProcessLine(gTmpImportDefinitionLine, RootNode, TRUE);
            UNTIL gTmpImportDefinitionLine.NEXT = 0;
        END;

      END;
    END;

    PROCEDURE SetFilename@1000001(Path@1000000 : Text[1024];Filename@1000001 : Text[1024]);
    BEGIN
      gSourceType := gSourceType::File;
      gPath := Path;
      gFilename := Filename;
    END;

    PROCEDURE SetDoc@1000011(VAR lDoc@1000001 : Codeunit 11148637);
    BEGIN
      gSourceType := gSourceType::Connector;

      gDoc := lDoc;
    END;

    PROCEDURE SetInstream@1000009(VAR InStr@1000000 : InStream);
    BEGIN
      gSourceType := gSourceType::Connector;

      gDoc.Create(TRUE, FALSE);
      gDoc.SetAsync(FALSE); // CI-146
      gDoc.LoadFromStream(InStr);
    END;

    PROCEDURE SetIsWebServiceCall@1000000000(IsWebServiceCall@1000000000 : Boolean);
    BEGIN
      gFromWebServiceCall := IsWebServiceCall;
    END;

    LOCAL PROCEDURE ClearBuffers@1000002();
    BEGIN
      gTmpImportDefinitionLine.RESET;
      gTmpImportDefinitionLine.DELETEALL;

      gTmpImportDefinitionLine2.RESET;
      gTmpImportDefinitionLine2.DELETEALL;

      gTmpImportDefTableLink.RESET;
      gTmpImportDefTableLink.DELETEALL;

      gTmpImportDefFunction.RESET;
      gTmpImportDefFunction.DELETEALL;
    END;

    LOCAL PROCEDURE FillBuffers@1000010(VAR ImportDefinition@1000002 : Record 11148591);
    VAR
      TmpImportDefinitionLine@1000001 : TEMPORARY Record 11148592;
      TmpImportDefTableLink@1000000 : TEMPORARY Record 11148593;
      TmpImportDefFunction@1100531000 : TEMPORARY Record 11148594;
      ImportDefMgt@1000005 : Codeunit 11148591;
    BEGIN
      ImportDefMgt.SetDestinationCompany(gDestinationCompany);
      ImportDefMgt.GetImportDefinitionLines(
        ImportDefinition, TmpImportDefinitionLine, TmpImportDefTableLink, TmpImportDefFunction);

      IF TmpImportDefinitionLine.FINDSET THEN
        REPEAT
          gTmpImportDefinitionLine := TmpImportDefinitionLine;
          gTmpImportDefinitionLine.Functions := FALSE;
          gTmpImportDefinitionLine.INSERT;

          gTmpImportDefinitionLine2 := TmpImportDefinitionLine;
          gTmpImportDefinitionLine2.Functions := FALSE;
          gTmpImportDefinitionLine2.INSERT;

        UNTIL TmpImportDefinitionLine.NEXT = 0;

      IF TmpImportDefTableLink.FINDSET THEN
        REPEAT
          gTmpImportDefTableLink := TmpImportDefTableLink;
          gTmpImportDefTableLink.INSERT;
        UNTIL TmpImportDefTableLink.NEXT = 0;

      IF TmpImportDefFunction.FINDSET THEN
        REPEAT
          gTmpImportDefFunction := TmpImportDefFunction;
          gTmpImportDefFunction.INSERT;
        UNTIL TmpImportDefFunction.NEXT = 0;
    END;

    LOCAL PROCEDURE ProcessLine@1000008(VAR ImportDefinitionLine@1000000 : Record 11148592;VAR ParentNode@1000002 : Codeunit 11148611;Recursive@1000004 : Boolean);
    VAR
      CommentMgt@1000001 : Codeunit 11148622;
      tLine@1000003 : TextConst 'ENU=Line;NLD=Regel';
    BEGIN
      LineCounter += 1;
      CommentMgt.SetKey(tLine + ' ' + FORMAT(LineCounter));

      WITH ImportDefinitionLine DO
        CASE Type OF

          Type::Tag :
            ProcessTagLine(ImportDefinitionLine, ParentNode, Recursive);

          Type::Table :
            ProcessTableLine(ImportDefinitionLine, ParentNode, Recursive);

          Type::Value :
            ProcessValueLine(ImportDefinitionLine, ParentNode, Recursive);

          Type::Const :
            ProcessConstLine(ImportDefinitionLine, Recursive);

          Type::Variable :
            ProcessVariableLine(ImportDefinitionLine, Recursive);

        END;
    END;

    LOCAL PROCEDURE ProcessTagLine@1000005(VAR ImportDefinitionLine@1000000 : Record 11148592;VAR ParentNode@1000001 : Codeunit 11148611;Recursive@1000005 : Boolean);
    VAR
      TmpImportDefinitionLine@1000003 : TEMPORARY Record 11148592;
      NodeList@1000004 : Codeunit 11148612;
      SubNode@1000002 : Codeunit 11148611;
    BEGIN
      GetChildLines(ImportDefinitionLine, TmpImportDefinitionLine);

      IF FindNodes(ParentNode, BuildXPath(ImportDefinitionLine), NodeList) THEN BEGIN
        NodeList.Reset;
        NodeList.NextNode(SubNode);
        WHILE NOT SubNode.IsClear DO BEGIN

          IF Recursive THEN
            IF TmpImportDefinitionLine.FINDSET THEN
              REPEAT
                ProcessLine(TmpImportDefinitionLine, SubNode, Recursive);
              UNTIL TmpImportDefinitionLine.NEXT = 0;

          NodeList.NextNode(SubNode);

        END;
      END;
    END;

    LOCAL PROCEDURE ProcessTableLine@1000006(VAR ImportDefinitionLine@1000000 : Record 11148592;VAR ParentNode@1000001 : Codeunit 11148611;Recursive@1000007 : Boolean);
    VAR
      TmpImportDefinitionLine@1000011 : TEMPORARY Record 11148592;
      ImportDefMgt@1000016 : Codeunit 11148591;
      Progressbar@1000017 : Codeunit 11148624;
      NodeList@1000006 : Codeunit 11148612;
      SubNode@1000002 : Codeunit 11148611;
      MainRecRef@1000010 : RecordRef;
      RecRef@1000003 : RecordRef;
      MainFldRef@1000008 : FieldRef;
      ThisFldRef@1000009 : FieldRef;
      LastIdBefore@1000020 : Integer;
      FirstRecord@1000021 : Boolean;
      IsExistingRecord@1000012 : Boolean;
      tProcessing@1000019 : TextConst 'ENU=Processing %1;NLD=Verwerken %1';
      tValidating@1000018 : TextConst 'ENU=Validating %1;NLD=Valideren %1';
    BEGIN
      FirstRecord := TRUE;

      GetChildLines(ImportDefinitionLine, TmpImportDefinitionLine);

      IF FindNodes(ParentNode, BuildXPath(ImportDefinitionLine), NodeList) THEN BEGIN
        IF FirstTableLineNo = 0 THEN BEGIN
          FirstTableLineNo := ImportDefinitionLine."Line No.";
          Progressbar.InitializeBar(1, NodeList.GetLength * 2);
        END;

        NodeList.Reset;
        NodeList.NextNode(SubNode);

        WHILE NOT SubNode.IsClear DO BEGIN
          IF FirstRecord OR ImportDefinitionLine."Clear Every Record" THEN BEGIN
            RecRef.CLOSE;
            CASE TRUE OF
              gDestinationCompany <> '' :
                RecRef.OPEN(ImportDefinitionLine."Table No.", FALSE, gDestinationCompany);
              gRec."Company Name" <> '' :
                RecRef.OPEN(ImportDefinitionLine."Table No.", FALSE, gRec."Company Name");
              ELSE
                RecRef.OPEN(ImportDefinitionLine."Table No.");
            END;
          END;

          IF ImportDefinitionLine."Link to Table (Tag Name)" <> '' THEN BEGIN

            gTmpImportDefinitionLine2.RESET;
            gTmpImportDefinitionLine2.SETRANGE("Import Definition", ImportDefinitionLine."Import Definition");
            gTmpImportDefinitionLine2.SETRANGE("Tag Name", ImportDefinitionLine."Link to Table (Tag Name)");
            gTmpImportDefinitionLine2.SETRANGE(Type, gTmpImportDefinitionLine2.Type::Table);
            gTmpImportDefinitionLine2.FINDFIRST;
            MainRecRef := gRecRefPerIndent[gTmpImportDefinitionLine2.Indent + 1];

            IF gProcessRun THEN
              SaveRecRef(gTmpImportDefinitionLine2.Indent);

            gTmpImportDefTableLink.SETRANGE("Import Definition", ImportDefinitionLine."Import Definition");
            gTmpImportDefTableLink.SETRANGE("Import Def. Entry No.", ImportDefinitionLine."Entry No.");
            IF gTmpImportDefTableLink.FINDSET THEN
              REPEAT
                MainFldRef := MainRecRef.FIELD(gTmpImportDefTableLink."Main Field No.");
                ThisFldRef := RecRef.FIELD(gTmpImportDefTableLink."Sub Field No.");
                ThisFldRef.VALUE := MainFldRef.VALUE;
              UNTIL gTmpImportDefTableLink.NEXT = 0;
          END;

          gRecRefPerIndent[ImportDefinitionLine.Indent + 1] := RecRef;

          IF TmpImportDefinitionLine.FINDSET THEN BEGIN
            LastIdBefore := gIdPerIndent[TmpImportDefinitionLine.Indent + 1];
            REPEAT
              ProcessLine(TmpImportDefinitionLine, SubNode, FALSE);
            UNTIL TmpImportDefinitionLine.NEXT = 0;

            TmpImportDefinitionLine.SETRANGE("Original Value", TRUE);
            IF TmpImportDefinitionLine.FINDSET THEN BEGIN
              gRenameKeyPerIndent[ImportDefinitionLine.Indent + 1] := TRUE;
              REPEAT
                ProcessLine(TmpImportDefinitionLine, SubNode, FALSE);
              UNTIL TmpImportDefinitionLine.NEXT = 0;
              gxRecRefPerIndent[ImportDefinitionLine.Indent + 1] := RecRef.DUPLICATE;
            END;

            gIdPerIndent[TmpImportDefinitionLine.Indent + 1] := LastIdBefore;

          END;

          IsExistingRecord := ImportDefMgt.CheckRecordAction(ImportDefinitionLine, RecRef);
          CASE TRUE OF

            IsExistingRecord AND (ImportDefinitionLine."Existing Record" = ImportDefinitionLine."Existing Record"::Delete) :
              gRecRefAction[ImportDefinitionLine.Indent + 1] := gRecRefAction[ImportDefinitionLine.Indent + 1]::Delete;

            // CI-191.begin
            IsExistingRecord AND (ImportDefinitionLine."Existing Record" = ImportDefinitionLine."Existing Record"::Nothing):
              gRecRefAction[ImportDefinitionLine.Indent + 1] := gRecRefAction[ImportDefinitionLine.Indent + 1]::None;
            // CI-191.end

            IsExistingRecord AND (ImportDefinitionLine."Existing Record" <> ImportDefinitionLine."Existing Record"::Delete) :
              gRecRefAction[ImportDefinitionLine.Indent + 1] := gRecRefAction[ImportDefinitionLine.Indent + 1]::Update;

            NOT IsExistingRecord AND (ImportDefinitionLine."New Record" = ImportDefinitionLine."New Record"::Skip) :
              gRecRefAction[ImportDefinitionLine.Indent + 1] := gRecRefAction[ImportDefinitionLine.Indent + 1]::None;

            NOT IsExistingRecord AND (ImportDefinitionLine."New Record" <> ImportDefinitionLine."New Record"::Skip) :
              gRecRefAction[ImportDefinitionLine.Indent + 1] := gRecRefAction[ImportDefinitionLine.Indent + 1]::Insert;

          END;

          IF FirstTableLineNo = ImportDefinitionLine."Line No." THEN
            IF gProcessRun THEN BEGIN
              gNoOfRecordsProcessed += 1;
              Progressbar.AddRecordCounter(1, 1, STRSUBSTNO(tProcessing, RecRef.RECORDID));
            END ELSE
              Progressbar.AddRecordCounter(1, 1, STRSUBSTNO(tValidating, RecRef.RECORDID));

          TmpImportDefinitionLine.SETRANGE("Original Value", FALSE);
          IF TmpImportDefinitionLine.FINDSET THEN
            REPEAT
              ProcessLine(TmpImportDefinitionLine, SubNode, TRUE);
            UNTIL TmpImportDefinitionLine.NEXT = 0;

          IF gProcessRun THEN
            SaveRecRef(ImportDefinitionLine.Indent);

          NodeList.NextNode(SubNode);
          FirstRecord := FALSE;

        END;
      END;
    END;

    LOCAL PROCEDURE ProcessValueLine@1000007(VAR ImportDefinitionLine@1000000 : Record 11148592;VAR ParentNode@1000001 : Codeunit 11148611;Recursive@1000009 : Boolean);
    VAR
      TmpImportDefinitionLine@1000003 : TEMPORARY Record 11148592;
      Fld@1000007 : Record 2000000041;
      Mgt@1000004 : Codeunit 11148591;
      SubNode@1000002 : Codeunit 11148611;
      ChildNode@1000000003 : Codeunit 11148611;
      SubNodeChildNodes@1000000001 : Codeunit 11148612;
      TextNode@1000000002 : Codeunit 11148648;
      FieldValue@1000008 : Text[1024];
      i@1000000000 : Integer;
    BEGIN
      Mgt.GetFld(ImportDefinitionLine, Fld);

      IF ImportDefinitionLine."As Attribute" THEN BEGIN
        FieldValue := FindAttribute(ParentNode, ImportDefinitionLine."Tag Name")
      END ELSE BEGIN
        IF FindNode(ParentNode, BuildXPath(ImportDefinitionLine), SubNode) THEN BEGIN
          // CI-133 : Deal with values longer than 1024 characters
          // FieldValue := SubNode.text;

          IF SubNode.HasChildNodes THEN BEGIN
            SubNode.ChildNodes(SubNodeChildNodes);
            FOR i := 0 TO SubNodeChildNodes.GetLength - 1 DO BEGIN
              SubNodeChildNodes.GetItem(i, ChildNode);
              // Please note:
              // - LOWERCASE(NodeTypeString) in MSXML returns 'cdatasection',
              // - LOWERCASE(NodeType.ToString()) in .NET returns 'cdata'.
              IF FORMAT(ChildNode.GetNodeTypeString) IN ['text', 'cdatasection', 'cdata'] THEN BEGIN
                TextNode.FromNode(ChildNode);
                FieldValue := TextNode.SubStringData(0, MAXSTRLEN(FieldValue));
              END;
            END;
          END;
        END;
      END;

      FieldValue := Mgt.ConvertFieldValue(FieldValue, ImportDefinitionLine, Fld);
      Mgt.ExecuteFunctions(ImportDefinitionLine, gTmpImportDefFunction, FieldValue);

      IF ImportDefinitionLine."Field No." <> 0 THEN BEGIN
        gTmpImportDefinitionLine2.RESET;
        gTmpImportDefinitionLine2.SETCURRENTKEY("Import Definition", "Line No.");
        gTmpImportDefinitionLine2.SETRANGE("Import Definition", ImportDefinitionLine."Import Definition");
        gTmpImportDefinitionLine2.SETFILTER("Line No.", '<%1', ImportDefinitionLine."Line No.");
        gTmpImportDefinitionLine2.SETRANGE(Type, gTmpImportDefinitionLine2.Type::Table);
        gTmpImportDefinitionLine2.SETRANGE("Table No.", ImportDefinitionLine."Table No.");
        gTmpImportDefinitionLine2.FINDLAST;

        FieldValue :=
          Mgt.ExecuteIncrementMethod(
            FieldValue, ImportDefinitionLine, Fld,
            gRecRefPerIndent[gTmpImportDefinitionLine2.Indent + 1],
            gIdPerIndent[ImportDefinitionLine.Indent + 1]);
      END;

      FillField(ImportDefinitionLine, Recursive, FieldValue);

      IF Recursive THEN BEGIN
        GetChildLines(ImportDefinitionLine, TmpImportDefinitionLine);
        IF TmpImportDefinitionLine.FINDSET THEN
          REPEAT
            ProcessLine(TmpImportDefinitionLine, SubNode, TRUE);
          UNTIL TmpImportDefinitionLine.NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE ProcessConstLine@1000020(VAR ImportDefinitionLine@1000000 : Record 11148592;Recursive@1000008 : Boolean);
    VAR
      Fld@1000002 : Record 2000000041;
      Mgt@1000004 : Codeunit 11148591;
      FieldValue@1000001 : Text[1024];
    BEGIN
      Mgt.GetFld(ImportDefinitionLine, Fld);

      FieldValue := Mgt.ConvertFieldValue(ImportDefinitionLine.Code, ImportDefinitionLine, Fld);
      Mgt.ExecuteFunctions(ImportDefinitionLine, gTmpImportDefFunction, FieldValue);

      FillField(ImportDefinitionLine, Recursive, FieldValue);
    END;

    LOCAL PROCEDURE ProcessVariableLine@1000017(VAR ImportDefinitionLine@1000000 : Record 11148592;Recursive@1000008 : Boolean);
    VAR
      Fld@1000002 : Record 2000000041;
      Mgt@1000004 : Codeunit 11148591;
      VariableMgt@1000003 : Codeunit 11148619;
      FieldValue@1000001 : Text[1024];
    BEGIN
      Mgt.GetFld(ImportDefinitionLine, Fld);

      FieldValue := VariableMgt.GetVariable(ImportDefinitionLine.Code);
      FieldValue := Mgt.ConvertFieldValue(FieldValue, ImportDefinitionLine, Fld);
      Mgt.ExecuteFunctions(ImportDefinitionLine, gTmpImportDefFunction, FieldValue);

      FillField(ImportDefinitionLine, Recursive, FieldValue);
    END;

    LOCAL PROCEDURE FillField@1000013(VAR ImportDefinitionLine@1000001 : Record 11148592;Recursive@1000000 : Boolean;FieldValue@1000002 : Text[1024]);
    VAR
      Fld@1000004 : Record 2000000041;
      Mgt@1000007 : Codeunit 11148591;
      VariableMgt@1000006 : Codeunit 11148619;
      RecRef@1000008 : RecordRef;
      FldRef@1000005 : FieldRef;
      SaveVariable@1000003 : Boolean;
    BEGIN
      SaveVariable := ImportDefinitionLine."Dest. Variable" <> '';

      IF ImportDefinitionLine."Field No." <> 0 THEN BEGIN
        gTmpImportDefinitionLine2.RESET;
        gTmpImportDefinitionLine2.SETCURRENTKEY("Import Definition", "Line No.");
        gTmpImportDefinitionLine2.SETRANGE("Import Definition", ImportDefinitionLine."Import Definition");
        gTmpImportDefinitionLine2.SETFILTER("Line No.", '<%1', ImportDefinitionLine."Line No.");
        gTmpImportDefinitionLine2.SETRANGE(Type, gTmpImportDefinitionLine2.Type::Table);
        gTmpImportDefinitionLine2.SETRANGE("Table No.", ImportDefinitionLine."Table No.");
        gTmpImportDefinitionLine2.FINDLAST;
        RecRef := gRecRefPerIndent[gTmpImportDefinitionLine2.Indent + 1];

        FldRef := RecRef.FIELD(ImportDefinitionLine."Field No.");

        Fld.GET(RecRef.NUMBER, FldRef.NUMBER);

        IF (FieldValue <> '') OR NOT ImportDefinitionLine."Skip If Empty" THEN
          IF gProcessRun THEN BEGIN
            Mgt.GetAlternativeValue(ImportDefinitionLine, FieldValue, gRec."Company Name");

            IF Fld.Type = Fld.Type::Option THEN
              FieldValue := Mgt.ConvertOptionValue(FldRef, ImportDefinitionLine, FieldValue);

            Mgt.EvaluateFieldRefValue(FldRef, Fld.Type, FieldValue, ImportDefinitionLine."Validate Field" AND Recursive);

            IF ImportDefinitionLine."Save Record" AND Recursive THEN
              SaveRecRef(gTmpImportDefinitionLine2.Indent);

            IF ImportDefinitionLine."Dest. Variable" <> '' THEN BEGIN
              FldRef := RecRef.FIELD(ImportDefinitionLine."Field No.");
              VariableMgt.SetVariable(ImportDefinitionLine."Dest. Variable", FORMAT(FldRef.VALUE));
              SaveVariable := FALSE;
            END;

          END ELSE BEGIN

            IF Fld.Type = Fld.Type::Option THEN
              FieldValue := Mgt.ConvertOptionValue(FldRef, ImportDefinitionLine, FieldValue);

            Mgt.EvaluateFieldRefValue(FldRef, Fld.Type, FieldValue, FALSE);
            IF Recursive THEN
              Mgt.CheckRestrictions(ImportDefinitionLine, FieldValue, gRec."Company Name");
          END;

      END ELSE
        IF Recursive THEN
          Mgt.CheckRestrictions(ImportDefinitionLine, FieldValue, gRec."Company Name");

      IF SaveVariable THEN
        VariableMgt.SetVariable(ImportDefinitionLine."Dest. Variable", FieldValue);
    END;

    LOCAL PROCEDURE GetChildLines@1000004(VAR ImportDefinitionLine@1000001 : Record 11148592;VAR ImportDefChildLine@1000000 : Record 11148592);
    VAR
      StopLoop@1000002 : Boolean;
    BEGIN
      gTmpImportDefinitionLine2.RESET;
      gTmpImportDefinitionLine2.SETCURRENTKEY("Import Definition", "Line No.");
      gTmpImportDefinitionLine2.SETRANGE("Import Definition", ImportDefinitionLine."Import Definition");
      gTmpImportDefinitionLine2.SETFILTER("Line No.", '>%1', ImportDefinitionLine."Line No.");
      IF gTmpImportDefinitionLine2.FINDSET THEN
        REPEAT
          IF gTmpImportDefinitionLine2.Indent = ImportDefinitionLine.Indent + 1 THEN BEGIN
            ImportDefChildLine := gTmpImportDefinitionLine2;
            ImportDefChildLine.INSERT;
          END;

          IF gTmpImportDefinitionLine2.Indent <= ImportDefinitionLine.Indent THEN
            StopLoop := TRUE;

          IF gTmpImportDefinitionLine2.NEXT = 0 THEN
            StopLoop := TRUE;

          IF gTmpImportDefinitionLine2.Indent <= ImportDefinitionLine.Indent THEN
            StopLoop := TRUE;

        UNTIL StopLoop;

      ImportDefChildLine.SETCURRENTKEY("Import Definition", "Line No.");
    END;

    LOCAL PROCEDURE FindNode@3(VAR XMLRootNode@1000 : Codeunit 11148611;NodePath@1001 : Text[250];VAR FoundXMLNode@1002 : Codeunit 11148611) : Boolean;
    BEGIN
      IF NodePath = '' THEN
        EXIT(FALSE);

      AddAllNamespacesToNamespaceMgr(XMLRootNode); // CI-140
      XMLRootNode.SelectSingleNode(NodePath, FoundXMLNode);

      IF FoundXMLNode.IsClear THEN
        EXIT(FALSE)
      ELSE
        EXIT(TRUE);
    END;

    LOCAL PROCEDURE FindNodes@4(VAR XMLRootNode@1000 : Codeunit 11148611;NodePath@1001 : Text[250];VAR ReturnedXMLNodeList@1002 : Codeunit 11148612) : Boolean;
    BEGIN
      IF NodePath = '' THEN
        EXIT(FALSE);

      AddAllNamespacesToNamespaceMgr(XMLRootNode); // CI-140
      XMLRootNode.SelectNodes(NodePath, ReturnedXMLNodeList);

      IF ReturnedXMLNodeList.IsClear THEN
        EXIT(FALSE);

      IF ReturnedXMLNodeList.GetLength() = 0 THEN
        EXIT(FALSE);

      EXIT(TRUE);
    END;

    LOCAL PROCEDURE FindAttribute@1000003(XMLRootNode@1000 : Codeunit 11148611;NodePath@1001 : Text[250]) : Text[1024];
    VAR
      AttributeNode@1000000000 : Codeunit 11148611;
      NamedNodeMap@1000001 : Codeunit 11148649;
      i@1000000 : Integer;
    BEGIN
      XMLRootNode.Attributes(NamedNodeMap);

      FOR i := 0 TO NamedNodeMap.GetLength - 1 DO BEGIN
        NamedNodeMap.GetItem(i, AttributeNode);
        IF AttributeNode.GetNodeName = NodePath THEN
          EXIT(AttributeNode.GetText);
      END;
    END;

    LOCAL PROCEDURE SaveRecRef@1000015(Indent@1000000 : Integer);
    VAR
      Monitoring@1000003 : Codeunit 11148620;
      DataChangeMgt@1000000000 : Codeunit 11148645;
      RecRef@1000001 : RecordRef;
      xRecRef@1000002 : RecordRef;
    BEGIN
      RecRef := gRecRefPerIndent[Indent + 1];

      CASE gRecRefAction[Indent + 1] OF

        gRecRefAction[Indent + 1]::Insert :
          BEGIN
            RecRef.INSERT(TRUE);
            gRecRefAction[Indent + 1] := gRecRefAction[Indent + 1]::Update;
            IF gRec."Monitor Modifications" AND DataChangeMgt.SupportsIntegrationManagement THEN
              Monitoring.InsertRecord(RecRef);
          END;

        gRecRefAction[Indent + 1]::Update :
          IF gRenameKeyPerIndent[Indent + 1] THEN BEGIN
            xRecRef := gxRecRefPerIndent[Indent + 1];
            xRecRef.DELETE;
            RecRef.INSERT;

            IF gRec."Monitor Modifications" AND DataChangeMgt.SupportsIntegrationManagement THEN
              Monitoring.ModifyRecord(RecRef, RecRef);

          END ELSE BEGIN
            RecRef.MODIFY(TRUE);

            IF gRec."Monitor Modifications" AND DataChangeMgt.SupportsIntegrationManagement THEN
              Monitoring.ModifyRecord(RecRef, RecRef);
          END;

        gRecRefAction[Indent + 1]::Delete :
          BEGIN
            RecRef.DELETE(TRUE);
            gRecRefAction[Indent + 1] := gRecRefAction[Indent + 1]::None;

            IF gRec."Monitor Modifications" AND DataChangeMgt.SupportsIntegrationManagement THEN
              Monitoring.DeleteRecord(RecRef);
          END;

      END;
    END;

    PROCEDURE SetMessageEntryNo@1000016(NewValue@1000000 : Integer);
    BEGIN
      gMessageEntryNo := NewValue;
    END;

    PROCEDURE SetDestinationCompany@1000012(NewValue@1000000 : Text[1024]);
    BEGIN
      gDestinationCompany := NewValue;
    END;

    PROCEDURE TestFile@1000018(VAR lRec@1000000 : Record 11148591);
    BEGIN
      gRec := lRec;

      ClearBuffers;
      FirstTableLineNo := 0;

      FillBuffers(gRec);
      IF FileIsValid THEN
        ;
    END;

    PROCEDURE NoOfRecordsProcessed@1100531000() : Integer;
    BEGIN
      EXIT(gNoOfRecordsProcessed);
    END;

    PROCEDURE AddAllNamespacesToNamespaceMgr@1(VAR XMLNode@1000 : Codeunit 11148611);
    VAR
      ImportDefinitionLineBuffer@1001 : TEMPORARY Record 11148592;
    BEGIN
      // CI-140
      XMLNode.ResetSelectionNamespaces();
      ImportDefinitionLineBuffer.COPY(gTmpImportDefinitionLine, TRUE);

      ImportDefinitionLineBuffer.RESET;
      ImportDefinitionLineBuffer.SETCURRENTKEY("XML Namespace Prefix");

      IF ImportDefinitionLineBuffer.FINDSET THEN
        REPEAT
          XMLNode.AddSelectionNamespace(ImportDefinitionLineBuffer."XML Namespace Prefix", ImportDefinitionLineBuffer."XML Namespace");

          // Skip to next distinct namespace prefix (if any)
          ImportDefinitionLineBuffer.SETRANGE("XML Namespace Prefix", ImportDefinitionLineBuffer."XML Namespace Prefix");
          ImportDefinitionLineBuffer.FINDLAST;
          ImportDefinitionLineBuffer.SETRANGE("XML Namespace Prefix");
        UNTIL ImportDefinitionLineBuffer.NEXT = 0;
    END;

    LOCAL PROCEDURE BuildXPath@2(ImportDefinitionLine@1000 : Record 11148592) : Text[1024];
    BEGIN
      IF ImportDefinitionLine."XML Namespace Prefix" = '' THEN
        EXIT(ImportDefinitionLine."Tag Name");

      EXIT(STRSUBSTNO('%1:%2', ImportDefinitionLine."XML Namespace Prefix", ImportDefinitionLine."Tag Name"));
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148601 IN - Import File
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    TableNo=11148591;
    OnRun=VAR
            Task@1000000 : Record 11148614;
          BEGIN
            NoSeriesStoreMgt.ClearAll;

            ImportDef := Rec;
            CheckDefinition;
            PrepareImportProcess;

            IF FileIsValid THEN BEGIN
              ProcessFile;
              COMMIT;

              IF "Run Task" <> '' THEN BEGIN
                Task.GET("Run Task");
                Task.Process;
              END;

            END;

            NoSeriesStoreMgt.ClearAll;
          END;

  }
  CODE
  {
    VAR
      ImportDef@1000000009 : Record 11148591;
      ImportDefLineTemp@1000000013 : TEMPORARY Record 11148592;
      ImportDefLineTemp2@1000000012 : TEMPORARY Record 11148592;
      ImportDefLineTemp3@1000000027 : TEMPORARY Record 11148592;
      ImportDefTableLinkTemp@1000000011 : TEMPORARY Record 11148593;
      ImportDefFunctionTemp@1000000010 : TEMPORARY Record 11148594;
      RecRefs@1000000006 : ARRAY [100] OF RecordRef;
      Mgt@1000000016 : Codeunit 11148589;
      Progressbar@1000000001 : Codeunit 11148624;
      FileName@1000000014 : Text[1024];
      Path@1000000015 : Text[1024];
      ImportFileName@1000000023 : Text[1024];
      IdentifierRecord@1000000005 : Text[50];
      LineCount@1000000020 : Integer;
      LinesProcessed@1000000021 : Integer;
      CurrentColumn@1000000022 : Integer;
      IncrementId@1000000000 : Integer;
      TableIds@1000000007 : ARRAY [100] OF Integer;
      RecordAction@1000000024 : ARRAY [100] OF 'Insert,Update,Delete,None';
      ImportStage@1000000008 : Boolean;
      ConnectITReader@1000000018 : Codeunit 11148602;
      Text001@1000000002 : TextConst 'ENU=Processing;NLD=Verwerken';
      Text002@1000000003 : TextConst 'ENU=Validating;NLD=Valideren';
      Text003@1000000004 : TextConst 'ENU=The number of columns in line %1 does not match the definition.;NLD=Het aantal kolommen in de definitie komt niet overeen met het bestand in regel %1.';
      Text004@1000000017 : TextConst 'ENU=No filename specified.;NLD=Geen bestandsnaam opgegeven.';
      Text005@1000000019 : TextConst 'ENU=You must specify an empty code for all Tables in Import Definition %1;NLD=U dient overal een lege code op te geven in Import Definitie %1';
      Text006@1000000025 : TextConst 'ENU=All table records in Import Definition %1 must have the same indentation when Code is empty.;NLD=All tabel records in Import Definition %1 moeten dezelfde inpsringing hebben als Code leeg is.';
      Text007@1000000026 : TextConst 'ENU=One of the columns in Import Definition %1 must have a identifier field.;NLD=Een van de kolommen in Import Definitie %1 moet identificatie aan staan.';
      NoSeriesStoreMgt@1000000028 : Codeunit 11148603;

    PROCEDURE CheckDefinition@1000000005();
    VAR
      ImportDefLine@1000000000 : Record 11148592;
      ImportDefLine2@1000000001 : Record 11148592;
    BEGIN
      IF ImportDef.Status = ImportDef.Status::Blocked THEN
        ImportDef.FIELDERROR(Status);

      ImportDefLine.SETCURRENTKEY("Import Definition", "Line No.");
      ImportDefLine.SETRANGE("Import Definition", ImportDef.Code);
      ImportDefLine.SETRANGE(Type, ImportDefLine.Type::Table);
      IF ImportDefLine.FINDSET THEN
        REPEAT
          IF ImportDefLine.Code = '' THEN BEGIN
            ImportDefLine2.COPYFILTERS(ImportDefLine);
            ImportDefLine2.SETFILTER(Code, '<>%1', '');
            IF NOT ImportDefLine2.ISEMPTY THEN
              ERROR(Text005, ImportDef.Code);

            ImportDefLine2.SETFILTER(Indent, '<>%1', ImportDefLine.Indent);
            IF NOT ImportDefLine2.ISEMPTY THEN
              ERROR(Text006, ImportDef.Code);
          END ELSE BEGIN
            ImportDefLine2.SETRANGE(Type);
            ImportDefLine2.SETRANGE(Indent, ImportDefLine.Indent +1);
            ImportDefLine2.SETRANGE(Identifier, TRUE);
            IF ImportDefLine2.ISEMPTY THEN
              ERROR(Text007, ImportDef.Code)
          END;
        UNTIL ImportDefLine.NEXT = 0;
    END;

    LOCAL PROCEDURE PrepareImportProcess@1000000004();
    BEGIN
      ClearBuffers;
      FillBuffers(ImportDef);

      ImportFileName := Path + FileName;
      IF ImportFileName = '' THEN
        ERROR(Text004);

      IF ImportDef."File Format" = ImportDef."File Format"::CSV THEN
        SetupCsvFileReader
      ELSE IF ImportDef."File Format" = ImportDef."File Format"::"Fixed Width" THEN
        SetupFixedWidthFileReader
      ELSE IF ImportDef."File Format" = ImportDef."File Format"::Excel THEN
        SetupExcelFileReader;
    END;

    LOCAL PROCEDURE SetupCsvFileReader@1000000002();
    VAR
      ColumnIdentifier@1000000000 : Integer;
      ColumnCount@1000000001 : Integer;
    BEGIN
      ImportDef.TESTFIELD("File Format", ImportDef."File Format"::CSV);

      ConnectITReader.OpenCSVReader(ImportFileName);
      IF (ImportDef.Headers) THEN
        ConnectITReader.SetHeaderLines(1)
      ELSE
        ConnectITReader.SetHeaderLines(0);

      ConnectITReader.SetFieldSeparator(ImportDef."Field Separator");
      ConnectITReader.SetFieldDelimiter(ImportDef."Field Delimiter");

      ImportDefLineTemp.RESET;
      ImportDefLineTemp.SETCURRENTKEY("Import Definition", "Line No.");
      ImportDefLineTemp.SETRANGE("Import Definition", ImportDef.Code);
      ImportDefLineTemp.SETRANGE(Type, ImportDefLineTemp.Type::Table);
      IF ImportDefLineTemp.FINDSET THEN
        REPEAT
          ColumnIdentifier := -1;
          ColumnCount := 0;

          ImportDefLineTemp3.COPY(ImportDefLineTemp);
          ImportDefLineTemp3.NEXT;

          ImportDefLineTemp2.RESET;
          ImportDefLineTemp2.SETCURRENTKEY("Import Definition", "Line No.");
          ImportDefLineTemp2.SETRANGE("Import Definition", ImportDef.Code);
          ImportDefLineTemp2.SETFILTER(Type, '%1|%2', ImportDefLineTemp2.Type::Value, ImportDefLineTemp2.Type::Skip);
          ImportDefLineTemp2.SETRANGE(Indent, ImportDefLineTemp.Indent + 1);
          IF (ImportDefLineTemp."Line No." = ImportDefLineTemp3."Line No.") THEN
            ImportDefLineTemp2.SETFILTER("Line No.", '%1..', ImportDefLineTemp."Line No.")
          ELSE
            ImportDefLineTemp2.SETFILTER("Line No.", '%1..%2', ImportDefLineTemp."Line No.", ImportDefLineTemp3."Line No.");

          IF ImportDefLineTemp2.FINDSET THEN
            REPEAT
              IF ImportDefLineTemp2.Identifier THEN
                ColumnIdentifier := ColumnCount;
              ColumnCount += 1;
            UNTIL ImportDefLineTemp2.NEXT = 0;

          ConnectITReader.AddRecordDefinition(ColumnIdentifier, ImportDefLineTemp.Code, ColumnCount);
        UNTIL ImportDefLineTemp.NEXT = 0;
    END;

    LOCAL PROCEDURE SetupFixedWidthFileReader@1000000000();
    VAR
      ColumnIdentifier@1000000000 : Integer;
      ColumnCount@1000000001 : Integer;
    BEGIN
      ImportDef.TESTFIELD("File Format", ImportDef."File Format"::"Fixed Width");

      ConnectITReader.OpenFixedWidthReader(ImportFileName);
      IF (ImportDef.Headers) THEN
        ConnectITReader.SetHeaderLines(1)
      ELSE
        ConnectITReader.SetHeaderLines(0);

      ImportDefLineTemp.RESET;
      ImportDefLineTemp.SETCURRENTKEY("Import Definition", "Line No.");
      ImportDefLineTemp.SETRANGE("Import Definition", ImportDef.Code);
      ImportDefLineTemp.SETRANGE(Type, ImportDefLineTemp.Type::Table);
      IF ImportDefLineTemp.FINDSET THEN
        REPEAT
          ColumnIdentifier := -1;
          ColumnCount := 0;

          ImportDefLineTemp3.COPY(ImportDefLineTemp);
          ImportDefLineTemp3.NEXT;

          ImportDefLineTemp2.RESET;
          ImportDefLineTemp2.SETCURRENTKEY("Import Definition", "Line No.");
          ImportDefLineTemp2.SETRANGE("Import Definition", ImportDef.Code);
          ImportDefLineTemp2.SETFILTER(Type, '%1|%2', ImportDefLineTemp2.Type::Value, ImportDefLineTemp2.Type::Skip);
          ImportDefLineTemp2.SETRANGE(Indent, ImportDefLineTemp.Indent + 1);
          IF (ImportDefLineTemp."Line No." = ImportDefLineTemp3."Line No.") THEN
            ImportDefLineTemp2.SETFILTER("Line No.", '%1..', ImportDefLineTemp."Line No.")
          ELSE
            ImportDefLineTemp2.SETFILTER("Line No.", '%1..%2', ImportDefLineTemp."Line No.", ImportDefLineTemp3."Line No.");

          IF ImportDefLineTemp2.FINDSET THEN
            REPEAT
              IF ImportDefLineTemp2.Identifier THEN
                ColumnIdentifier := ColumnCount;
              ColumnCount += 1;
            UNTIL ImportDefLineTemp2.NEXT = 0;

          IF ConnectITReader.AddRecordDefinition(ColumnIdentifier, ImportDefLineTemp.Code, ColumnCount) THEN BEGIN

            IF ImportDefLineTemp2.FINDSET THEN
              REPEAT
                ConnectITReader.AddColumnParameters(ImportDefLineTemp.Code, ImportDefLineTemp2.Width, 0);
              UNTIL ImportDefLineTemp2.NEXT = 0;

          END;
        UNTIL ImportDefLineTemp.NEXT = 0;
    END;

    LOCAL PROCEDURE SetupExcelFileReader@1000000003();
    VAR
      ColumnIdentifier@1000000000 : Integer;
      ColumnCount@1000000001 : Integer;
    BEGIN
      ImportDef.TESTFIELD("File Format", ImportDef."File Format"::Excel);

      ConnectITReader.OpenExcelReader(ImportFileName);
      IF (ImportDef.Headers) THEN
        ConnectITReader.SetHeaderLines(1)
      ELSE
        ConnectITReader.SetHeaderLines(0);

      ImportDefLineTemp.RESET;
      ImportDefLineTemp.SETCURRENTKEY("Import Definition", "Line No.");
      ImportDefLineTemp.SETRANGE("Import Definition", ImportDef.Code);
      ImportDefLineTemp.SETRANGE(Type, ImportDefLineTemp.Type::Table);
      IF ImportDefLineTemp.FINDSET THEN
        REPEAT
          ColumnIdentifier := -1;
          ColumnCount := 0;

          ImportDefLineTemp3.COPY(ImportDefLineTemp);
          ImportDefLineTemp3.NEXT;

          ImportDefLineTemp2.RESET;
          ImportDefLineTemp2.SETCURRENTKEY("Import Definition", "Line No.");
          ImportDefLineTemp2.SETRANGE("Import Definition", ImportDef.Code);
          ImportDefLineTemp2.SETFILTER(Type, '%1|%2', ImportDefLineTemp2.Type::Value, ImportDefLineTemp2.Type::Skip);
          ImportDefLineTemp2.SETRANGE(Indent, ImportDefLineTemp.Indent + 1);
          IF (ImportDefLineTemp."Line No." = ImportDefLineTemp3."Line No.") THEN
            ImportDefLineTemp2.SETFILTER("Line No.", '%1..', ImportDefLineTemp."Line No.")
          ELSE
            ImportDefLineTemp2.SETFILTER("Line No.", '%1..%2', ImportDefLineTemp."Line No.", ImportDefLineTemp3."Line No.");

          IF ImportDefLineTemp2.FINDSET THEN
            REPEAT
              IF ImportDefLineTemp2.Identifier THEN
                ColumnIdentifier := ColumnCount;
              ColumnCount += 1;
            UNTIL ImportDefLineTemp2.NEXT = 0;

          ConnectITReader.AddRecordDefinition(ColumnIdentifier, ImportDefLineTemp.Code, ColumnCount);
        UNTIL ImportDefLineTemp.NEXT = 0;
    END;

    LOCAL PROCEDURE FileIsValid@1000000() : Boolean;
    VAR
      CommentMgt@1000006 : Codeunit 11148622;
      ConnectITRecord@1000000002 : Codeunit 11148635;
      ColumnCount@1000000000 : Integer;
    BEGIN
      ImportStage := FALSE;
      ConnectITReader.Reset;

      LineCount := 0;

      WHILE NOT ConnectITReader.EndOfFile DO BEGIN
        ConnectITReader.ReadLine(ConnectITRecord);
        LineCount += 1;
      END;

      EXIT(NOT CommentMgt.ErrorOccured);
    END;

    LOCAL PROCEDURE ProcessFile@1000014();
    VAR
      ConnectITRecord@1000000003 : Codeunit 11148635;
      "----"@1000000002 : Integer;
      ImportDefMgt@1000006 : Codeunit 11148591;
      CurrentIdentifier@1000009 : Integer;
      CurrentIndent@1000008 : Integer;
      IsExistingRecord@1000005 : Boolean;
      LastLine@1000004 : Boolean;
      Stop@1000002 : Boolean;
      "---"@1000000000 : Integer;
      I@1000000001 : Integer;
      TmpBlob@1000000008 : Record 11148609;
      LogMgt@1000000007 : Codeunit 11148623;
      File@1000000006 : File;
      InStr@1000000005 : InStream;
      OutStr@1000000004 : OutStream;
    BEGIN
      ConnectITReader.Reset;
      ImportStage := TRUE;
      LinesProcessed := 0;

      Progressbar.InitializeBar(1, LineCount);

      WHILE NOT ConnectITReader.EndOfFile DO BEGIN
        ConnectITReader.ReadLine(ConnectITRecord);
        IdentifierRecord := ConnectITRecord.GetIdentifier;
        CurrentColumn := 0;

        ImportDefLineTemp.SETCURRENTKEY("Import Definition", "Line No.");
        ImportDefLineTemp.SETRANGE(Type);
        ImportDefLineTemp.FINDSET;
        REPEAT
          ProcessImportDefinitionLine(ConnectITRecord, ImportDefLineTemp);
        UNTIL ImportDefLineTemp.NEXT = 0;

        LinesProcessed += 1;
        Progressbar.AddRecordCounter(1, 1, STRSUBSTNO(Text001));

        ImportDefLineTemp2.RESET;
        ImportDefLineTemp2.SETCURRENTKEY("Import Definition", "Line No.");
        ImportDefLineTemp2.SETRANGE("Import Definition", ImportDef.Code);
        ImportDefLineTemp2.SETRANGE(Type, ImportDefLineTemp2.Type::Table);
        ImportDefLineTemp2.SETRANGE(Code, ConnectITRecord.GetIdentifier);
        IF ImportDefLineTemp2.FINDSET THEN
          REPEAT
            FOR I := 1 TO 100 DO BEGIN
              IF TableIds[I] = ImportDefLineTemp2."Table No." THEN
                SaveRecRef(I, FALSE)
              ELSE IF TableIds[I] = 0 THEN
                I := 100;
            END;
          UNTIL ImportDefLineTemp2.NEXT = 0;

      END;

      ConnectITReader.Close;

      IF ImportDef."Save to Messages" THEN BEGIN
        File.OPEN(ImportFileName);
        File.CREATEINSTREAM(InStr);
        TmpBlob.BLOB.CREATEOUTSTREAM(OutStr);
        COPYSTREAM(OutStr, InStr);
        LogMgt.SaveMessageToLog(0, ImportDef.Code, Path, FileName, TmpBlob, FALSE, TRUE);
        File.CLOSE;
      END;
    END;

    LOCAL PROCEDURE ProcessImportDefinitionLine@1000002(VAR ConnectITRecord@1000000006 : Codeunit 11148635;VAR ImportDefLine@1000000 : Record 11148592);
    VAR
      Fld@1000006 : Record 2000000041;
      VariableMgt@1000005 : Codeunit 11148619;
      MainRecRef@1000010 : RecordRef;
      MainFldRef@1000011 : FieldRef;
      ThisFldRef@1000013 : FieldRef;
      FieldValue@1000003 : Text[1024];
      i@1000008 : Integer;
      MainIndex@1000000000 : Integer;
      SubIndex@1000000001 : Integer;
      SubRecRef@1000000002 : RecordRef;
      Identifier@1000000003 : Integer;
      IsExistingRecord@1000000004 : Boolean;
      ImportDefMgt@1000000005 : Codeunit 11148591;
      RecRef@1000000007 : RecordRef;
      RecRefIndex@1000000008 : Integer;
      RecRef2@1000000009 : RecordRef;
    BEGIN
      IF ImportDefLine.Type = ImportDefLine.Type::Table THEN BEGIN
        IF (ImportDefLine.Code <> '') THEN
          IdentifierRecord := ImportDefLine.Code;
        FOR i := 1 TO 100 DO BEGIN
          IF TableIds[i] = 0 THEN BEGIN
            TableIds[i] := ImportDefLine."Table No.";

            IF ImportDef."Company Name" = '' THEN
              RecRefs[i].OPEN(ImportDefLine."Table No.")
            ELSE
              RecRefs[i].OPEN(ImportDefLine."Table No.", FALSE, ImportDef."Company Name");

            i := 100;
          END ELSE IF TableIds[i] = ImportDefLine."Table No." THEN
            i := 100;
        END;

        IF ImportDefLine."Link to Table (Tag Name)" <> '' THEN BEGIN

          ImportDefLineTemp2.RESET;
          ImportDefLineTemp2.SETCURRENTKEY("Import Definition", "Line No.");
          ImportDefLineTemp2.SETRANGE("Import Definition", ImportDefLine."Import Definition");
          ImportDefLineTemp2.SETRANGE("Tag Name", ImportDefLine."Link to Table (Tag Name)");
          ImportDefLineTemp2.FINDFIRST;

          MainIndex := FindRecRef(ImportDefLineTemp2."Table No.");
          SubIndex := FindRecRef(ImportDefLine."Table No.");

          MainRecRef := RecRefs[MainIndex];
          SubRecRef := RecRefs[SubIndex];

          IF ImportStage THEN
            SaveRecRef(MainIndex, FALSE);

          ImportDefTableLinkTemp.SETRANGE("Import Definition", ImportDefLine."Import Definition");
          ImportDefTableLinkTemp.SETRANGE("Import Def. Entry No.", ImportDefLine."Entry No.");
          IF ImportDefTableLinkTemp.FINDSET THEN
            REPEAT
              MainFldRef := MainRecRef.FIELD(ImportDefTableLinkTemp."Main Field No.");
              ThisFldRef := SubRecRef.FIELD(ImportDefTableLinkTemp."Sub Field No.");
              ThisFldRef.VALUE := MainFldRef.VALUE;
            UNTIL ImportDefTableLinkTemp.NEXT = 0;

        END;

        IF ConnectITRecord.GetIdentifier = ImportDefLine.Code THEN BEGIN
          RecRefIndex := FindRecRef(ImportDefLine."Table No.");
          RecRef := RecRefs[RecRefIndex];
          RecRef2 := RecRef.DUPLICATE;
          IF RecRef2.FIND('=') AND (ConnectITRecord.GetIdentifier <> '') THEN
            RecRef.INIT;
        END;

        EXIT;
      END;

      Identifier := FindRecRef(ImportDefLine."Table No.");

      IF  ConnectITRecord.GetIdentifier = IdentifierRecord THEN BEGIN
        CASE ImportDefLine.Type OF

          ImportDefLine.Type::Value :
            // CI-167.begin
            // NextFieldValue(ConnectITRecord, FieldValue);
            IF NOT NextFieldValue(ConnectITRecord, FieldValue) THEN
              ERROR(ConnectITRecord.LastError);
            // CI-167.end

          ImportDefLine.Type::Const :
            FieldValue := ImportDefLine.Code;

          ImportDefLine.Type::Variable :
            FieldValue := VariableMgt.GetVariable(ImportDefLine.Code);

          ImportDefLine.Type::Skip :
            BEGIN
              CurrentColumn += 1;
              FieldValue := '';
            END;
        END;

        ImportDefMgt.GetFld(ImportDefLine, Fld);
        FieldValue :=
          ImportDefMgt.ExecuteIncrementMethod(
            FieldValue, ImportDefLine, Fld, RecRefs[Identifier], IncrementId);

        FillField(ImportDefLine, FieldValue, Identifier);
      END;
    END;

    PROCEDURE SetFilename@1000001(PathToSet@1000000 : Text[1024];FileNameToSet@1000001 : Text[1024]);
    BEGIN
      Path := PathToSet;
      FileName := FileNameToSet;
    END;

    LOCAL PROCEDURE ClearBuffers@1000003();
    BEGIN
      ImportDefLineTemp.RESET;
      ImportDefLineTemp.DELETEALL;

      ImportDefLineTemp2.RESET;
      ImportDefLineTemp2.DELETEALL;

      ImportDefLineTemp3.RESET;
      ImportDefLineTemp3.DELETEALL;

      ImportDefTableLinkTemp.RESET;
      ImportDefTableLinkTemp.DELETEALL;

      ImportDefFunctionTemp.RESET;
      ImportDefFunctionTemp.DELETEALL;
    END;

    LOCAL PROCEDURE FillBuffers@1000007(VAR ImportDefinition@1000002 : Record 11148591);
    VAR
      ImportDefLineTempLocal@1000001 : TEMPORARY Record 11148592;
      ImportDefTableLinkTempLocal@1000000 : TEMPORARY Record 11148593;
      ImportDefFunctionTempLocal@1100531001 : TEMPORARY Record 11148594;
      ImportDefMgt@1000005 : Codeunit 11148591;
    BEGIN
      ImportDefMgt.GetImportDefinitionLines(
        ImportDefinition, ImportDefLineTempLocal, ImportDefTableLinkTempLocal, ImportDefFunctionTempLocal);

      IF ImportDefLineTempLocal.FINDSET THEN
        REPEAT
          ImportDefLineTemp := ImportDefLineTempLocal;
          ImportDefLineTemp.Functions := FALSE;
          ImportDefLineTemp.INSERT;

          ImportDefLineTemp2 := ImportDefLineTempLocal;
          ImportDefLineTemp2.Functions := FALSE;
          ImportDefLineTemp2.INSERT;

          ImportDefLineTemp3 := ImportDefLineTempLocal;
          ImportDefLineTemp3.Functions := FALSE;
          ImportDefLineTemp3.INSERT;

        UNTIL ImportDefLineTempLocal.NEXT = 0;

      IF ImportDefTableLinkTempLocal.FINDSET THEN
        REPEAT
          ImportDefTableLinkTemp := ImportDefTableLinkTempLocal;
          ImportDefTableLinkTemp.INSERT;
        UNTIL ImportDefTableLinkTempLocal.NEXT = 0;

      IF ImportDefFunctionTempLocal.FINDSET THEN
        REPEAT
          ImportDefFunctionTemp := ImportDefFunctionTempLocal;
          ImportDefFunctionTemp.INSERT;
        UNTIL ImportDefFunctionTempLocal.NEXT = 0;
    END;

    LOCAL PROCEDURE FillField@1000013(VAR ImportDefLine@1000001 : Record 11148592;FieldValue@1000002 : Text[1024];Identifier@1000000 : Integer);
    VAR
      Fld@1000004 : Record 2000000041;
      Mgt@1000007 : Codeunit 11148591;
      VariableMgt@1000006 : Codeunit 11148619;
      FldRef@1000005 : FieldRef;
      SaveVariable@1000003 : Boolean;
      PrimaryKeyRef@1000000000 : KeyRef;
      I@1000000001 : Integer;
    BEGIN
      SaveVariable := ImportDefLine."Dest. Variable" <> '';

      IF ImportDefLine."Field No." <> 0 THEN BEGIN

        FldRef := RecRefs[Identifier].FIELD(ImportDefLine."Field No.");

        Fld.GET(RecRefs[Identifier].NUMBER, FldRef.NUMBER);
        FieldValue := Mgt.ConvertFieldValue(FieldValue, ImportDefLine, Fld);
        Mgt.ExecuteFunctions(ImportDefLine, ImportDefFunctionTemp, FieldValue);

        IF (FieldValue <> '') OR NOT ImportDefLine."Skip If Empty" THEN
          IF ImportStage THEN BEGIN

            IF Fld.Type = Fld.Type::Option THEN
              FieldValue := Mgt.ConvertOptionValue(FldRef, ImportDefLine, FieldValue);

            IF ((NOT ImportDefLine."No. Series") AND (FORMAT(FldRef.VALUE) <> FieldValue)) OR
               (ImportDefLine."No. Series" AND (FORMAT(FldRef.VALUE) <> NoSeriesStoreMgt.GetValue(FieldValue))) THEN
            BEGIN // Optimization, do not duplicate value entry.
              PrimaryKeyRef := RecRefs[Identifier].KEYINDEX(1);
              FOR I := 1 TO PrimaryKeyRef.FIELDCOUNT DO
                IF PrimaryKeyRef.FIELDINDEX(I).NUMBER = FldRef.NUMBER THEN
                  RecRefs[Identifier].INIT;

              Mgt.EvaluateFieldRefValue(FldRef, Fld.Type, FieldValue, ImportDefLine."Validate Field");
            END ELSE IF ImportDefLine."No. Series" THEN
              Mgt.EvaluateFieldRefValue(FldRef, Fld.Type, FieldValue, ImportDefLine."Validate Field");

            IF ImportDefLine."Save Record" THEN
              SaveRecRef(Identifier, ImportDefLine."No. Series");

            IF ImportDefLine."Dest. Variable" <> '' THEN BEGIN
              VariableMgt.SetVariable(ImportDefLine."Dest. Variable", FORMAT(FldRef.VALUE));
              SaveVariable := FALSE;
            END;

          END ELSE BEGIN

            IF Fld.Type = Fld.Type::Option THEN
              FieldValue := Mgt.ConvertOptionValue(FldRef, ImportDefLine, FieldValue);

            IF (FORMAT(FldRef.VALUE) <> FieldValue) THEN // Optimization, do not duplicate value entry.
              Mgt.EvaluateFieldRefValue(FldRef, Fld.Type, FieldValue, FALSE);
            Mgt.CheckRestrictions(ImportDefLine, FieldValue, ImportDef."Company Name");
          END;

      END;

      IF SaveVariable THEN
        VariableMgt.SetVariable(ImportDefLine."Dest. Variable", FieldValue);
    END;

    PROCEDURE NextFieldValue@3(VAR ConnectITRecord@1000000000 : Codeunit 11148635;VAR ExitValue@1000001 : Text[1024]) Result : Boolean;
    BEGIN
      // CI-167.begin
      // ExitValue := ConnectITRecord.GetValue(CurrentColumn);
      Result := ConnectITRecord.TryGetValue(CurrentColumn, ExitValue);
      // CI-167.end

      CurrentColumn += 1;

      // CI-167.begin
      // EXIT(TRUE);
      EXIT(Result);
      // CI-167.end
    END;

    LOCAL PROCEDURE SaveRecRef@1000015(Indent@1000000 : Integer;FromNoSeriesField@1000000008 : Boolean);
    VAR
      ImportDefLine@1000000002 : Record 11148592;
      ImportDefLine2@1000000004 : Record 11148592;
      ImportDefMgt@1000000001 : Codeunit 11148591;
      Monitoring@1000002 : Codeunit 11148620;
      DataChangeMgt@1000000003 : Codeunit 11148645;
      VariableMgt@1000000006 : Codeunit 11148619;
      RecRef@1000001 : RecordRef;
      RecRef2@1000000010 : RecordRef;
      FldRef@1000000005 : FieldRef;
      FldRef2@1000000011 : FieldRef;
      IsExistingRecord@1000000000 : Boolean;
      VarName@1000000007 : Code[20];
      VarValue@1000000009 : Text[1024];
    BEGIN
      RecRef := RecRefs[Indent];

      ImportDefLine.SETRANGE("Import Definition", ImportDef.Code);
      ImportDefLine.SETRANGE(Type, ImportDefLine.Type::Table);
      ImportDefLine.SETRANGE("Table No.", TableIds[Indent]);
      ImportDefLine.FINDFIRST;

      // GRO
      IF FromNoSeriesField THEN BEGIN
        ImportDefLine2.SETRANGE("Import Definition", ImportDef.Code);
        ImportDefLine2.SETRANGE("Table No.",  TableIds[Indent]);
        ImportDefLine2.SETRANGE("No. Series", TRUE);
        IF ImportDefLine2.FINDFIRST THEN BEGIN
          FldRef := RecRef.FIELD(ImportDefLine2."Field No.");
          VarName := FORMAT(FldRef.VALUE);
          FldRef.VALUE := NoSeriesStoreMgt.GetValue(VarName);
        END;
      END;
      //GRO

      IsExistingRecord := ImportDefMgt.CheckRecordAction(ImportDefLine, RecRefs[Indent]);
      CASE TRUE OF

        IsExistingRecord AND (ImportDefLine."Existing Record" = ImportDefLine."Existing Record"::Delete) :
          RecordAction[Indent] := RecordAction::Delete;

        IsExistingRecord AND (ImportDefLine."Existing Record" = ImportDefLine."Existing Record"::Nothing) :
          RecordAction[Indent] := RecordAction::None;

        IsExistingRecord AND (ImportDefLine."Existing Record" <> ImportDefLine."Existing Record"::Delete) :
          RecordAction[Indent] := RecordAction::Update;

        NOT IsExistingRecord AND (ImportDefLine."New Record" = ImportDefLine."New Record"::Skip) :
          RecordAction[Indent] := RecordAction::None;

        NOT IsExistingRecord AND (ImportDefLine."New Record" <> ImportDefLine."New Record"::Skip) :
          RecordAction[Indent] := RecordAction::Insert;

      END;

      CASE RecordAction[Indent] OF
        RecordAction[Indent]::Insert :
          BEGIN
            RecRef.INSERT(TRUE);
            //GRO
            IF FromNoSeriesField THEN
              IF VarName <> '' THEN BEGIN
                NoSeriesStoreMgt.SetValue(VarName, FORMAT(FldRef.VALUE));
              END;
            RecRefs[Indent] := RecRef;
            //GRO
            RecordAction[Indent] := RecordAction[Indent]::Update;
            IF ImportDef."Monitor Modifications" AND DataChangeMgt.SupportsIntegrationManagement THEN
              Monitoring.InsertRecord(RecRef);
          END;

        RecordAction[Indent]::Update :
          BEGIN
            //GRO.HF2
            RecRef2 := RecRef.DUPLICATE;
            RecRef.FIND('=');
            ImportDefLine2.SETCURRENTKEY("Import Definition", "Line No.");
            ImportDefLine2.SETRANGE("Import Definition", ImportDef.Code);
            ImportDefLine2.SETRANGE("Table No.",  TableIds[Indent]);
            ImportDefLine2.SETFILTER(Type, '%1|%2|%3',
                                     ImportDefLine2.Type::Value, ImportDefLine2.Type::Variable, ImportDefLine2.Type::Const);
            IF ImportDefLine2.FINDSET THEN
              REPEAT
                FldRef := RecRef.FIELD(ImportDefLine2."Field No.");
                FldRef2 := RecRef2.FIELD(ImportDefLine2."Field No.");
                IF ImportDefLine2."Validate Field" THEN
                  FldRef.VALIDATE(FldRef2.VALUE)
                ELSE
                  FldRef.VALUE := FldRef2.VALUE;
              UNTIL ImportDefLine2.NEXT = 0;
            //GRO.HF2

            RecRef.MODIFY(TRUE);
            RecordAction[Indent] := RecordAction[Indent]::None;
            IF ImportDef."Monitor Modifications" AND DataChangeMgt.SupportsIntegrationManagement THEN
              Monitoring.ModifyRecord(RecRef, RecRef);
          END;

        RecordAction[Indent]::Delete :
          BEGIN
            RecRef.DELETE(TRUE);
            RecordAction[Indent] := RecordAction[Indent]::None;

            IF ImportDef."Monitor Modifications" AND DataChangeMgt.SupportsIntegrationManagement THEN
              Monitoring.DeleteRecord(RecRef);
          END;
      END;
    END;

    PROCEDURE TestFile@1000018(VAR Rec@1000000 : Record 11148591);
    BEGIN
      ImportDef := Rec;
      PrepareImportProcess;

      IF FileIsValid THEN
        ;
    END;

    PROCEDURE SetImportDefinition@1100531000(VAR ImportDefinition@1100531000 : Record 11148591);
    BEGIN
      ImportDef := ImportDefinition;
    END;

    PROCEDURE NoOfRecordsProcessed@1100531001() : Integer;
    BEGIN
      EXIT(LinesProcessed);
    END;

    LOCAL PROCEDURE FindRecRef@1000000001(TableNo@1000000000 : Integer) Result : Integer;
    VAR
      I@1000000001 : Integer;
    BEGIN
      FOR I := 1 TO 100 DO
        IF TableIds[I] = TableNo THEN
          EXIT(I);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148602 IN - ConnectIT Reader
{
  OBJECT-PROPERTIES
  {
    Date=14-07-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.1;
  }
  PROPERTIES
  {
    SingleInstance=Yes;
    OnRun=BEGIN
            Instantiate; // For testing purposes
          END;

  }
  CODE
  {
    VAR
      ConnectITReaderAutomation@1000000000 : Automation "{75E053EA-4A5A-4210-9188-699CF98212FE} 2.7:{4C4F3A49-2FF1-48E0-83F6-56D269092B9B}:'IDYN.Components'.ConnectITReader";
      ConnectITReaderDotNetOnRTC@1000000001 : DotNet "'IDYN.Components, Version=2.7.1.712, Culture=neutral, PublicKeyToken=0f5532c6f6903616'.IDYN.Components.FileManagement.ConnectITReader" RUNONCLIENT;
      ConnectITReaderDotNetOnNST@1000000002 : DotNet "'IDYN.Components, Version=2.7.1.712, Culture=neutral, PublicKeyToken=0f5532c6f6903616'.IDYN.Components.FileManagement.ConnectITReader";
      Mode@1000000003 : 'Automation,DotNet on RTC,DotNet on NST';
      ClientSide@1000000004 : Boolean;

    PROCEDURE OpenCSVReader@1000000000(FileName@1000000000 : Text[1024]) : Boolean;
    BEGIN
      Instantiate;

      CASE Mode OF
        Mode::Automation: EXIT(ConnectITReaderAutomation.OpenCsvReader(FileName));
        Mode::"DotNet on RTC": EXIT(ConnectITReaderDotNetOnRTC.OpenCsvReader(FileName));
        Mode::"DotNet on NST": EXIT(ConnectITReaderDotNetOnNST.OpenCsvReader(FileName));
      END;
    END;

    PROCEDURE OpenFixedWidthReader@1000000001(FileName@1000000000 : Text[1024]) : Boolean;
    BEGIN
      Instantiate;

      CASE Mode OF
        Mode::Automation: EXIT(ConnectITReaderAutomation.OpenFixedWidthReader(FileName));
        Mode::"DotNet on RTC": EXIT(ConnectITReaderDotNetOnRTC.OpenFixedWidthReader(FileName));
        Mode::"DotNet on NST": EXIT(ConnectITReaderDotNetOnNST.OpenFixedWidthReader(FileName));
      END;
    END;

    PROCEDURE OpenExcelReader@1000000002(FileName@1000000000 : Text[1024]) : Boolean;
    BEGIN
      Instantiate;

      CASE Mode OF
        Mode::Automation: EXIT(ConnectITReaderAutomation.OpenExcelReader(FileName));
        Mode::"DotNet on RTC": EXIT(ConnectITReaderDotNetOnRTC.OpenExcelReader(FileName));
        Mode::"DotNet on NST": EXIT(ConnectITReaderDotNetOnNST.OpenExcelReader(FileName));
      END;
    END;

    PROCEDURE AddRecordDefinition@1000000003(IdentifierTag@1000000000 : Integer;IdentifierValue@1000000001 : Text[1024];ColumnCount@1000000002 : Integer) : Boolean;
    BEGIN
      IF IsInstantiated THEN BEGIN
        CASE Mode OF
          Mode::Automation: EXIT(ConnectITReaderAutomation.AddRecordDefinition(IdentifierTag, IdentifierValue, ColumnCount));
          Mode::"DotNet on RTC": EXIT(ConnectITReaderDotNetOnRTC.AddRecordDefinition(IdentifierTag, IdentifierValue, ColumnCount));
          Mode::"DotNet on NST": EXIT(ConnectITReaderDotNetOnNST.AddRecordDefinition(IdentifierTag, IdentifierValue, ColumnCount));
        END;
      END;
    END;

    PROCEDURE AddColumnParameters@1000000004(IdentifierValue@1000000000 : Text[1024];ColumnWidth@1000000001 : Integer;Alignment@1000000002 : Integer);
    BEGIN
      IF IsInstantiated THEN BEGIN
        CASE Mode OF
          Mode::Automation: ConnectITReaderAutomation.AddColumnParameters(IdentifierValue, ColumnWidth, Alignment);
          Mode::"DotNet on RTC": ConnectITReaderDotNetOnRTC.AddColumnParameters(IdentifierValue, ColumnWidth, Alignment);
          Mode::"DotNet on NST": ConnectITReaderDotNetOnNST.AddColumnParameters(IdentifierValue, ColumnWidth, Alignment);
        END;
      END;
    END;

    PROCEDURE ReadLine@1000000005(VAR ConnectITRecord@1000000000 : Codeunit 11148635);
    BEGIN
      IF IsInstantiated THEN BEGIN
        CASE Mode OF
          Mode::Automation: ConnectITRecord.SetAutomation(ConnectITReaderAutomation.ReadLine);
          Mode::"DotNet on RTC": ConnectITRecord.SetDotNetOnRTC(ConnectITReaderDotNetOnRTC.ReadLine);
          Mode::"DotNet on NST": ConnectITRecord.SetDotNetOnNST(ConnectITReaderDotNetOnNST.ReadLine);
        END;
      END;
    END;

    PROCEDURE Reset@1000000010();
    BEGIN
      IF IsInstantiated THEN BEGIN
        CASE Mode OF
          Mode::Automation: ConnectITReaderAutomation.Reset;
          Mode::"DotNet on RTC": ConnectITReaderDotNetOnRTC.Reset;
          Mode::"DotNet on NST": ConnectITReaderDotNetOnNST.Reset;
        END;
      END;
    END;

    PROCEDURE Close@1000000006();
    BEGIN
      Instantiate;

      CASE Mode OF
        Mode::Automation: ConnectITReaderAutomation.Close;
        Mode::"DotNet on RTC": ConnectITReaderDotNetOnRTC.Close;
        Mode::"DotNet on NST": ConnectITReaderDotNetOnNST.Close;
      END;
    END;

    PROCEDURE SetFieldSeparator@1000000007(Separator@1000000000 : Text[1]);
    BEGIN
      IF IsInstantiated THEN BEGIN
        CASE Mode OF
          Mode::Automation: ConnectITReaderAutomation.FieldSeparator := Separator;
          Mode::"DotNet on RTC": ConnectITReaderDotNetOnRTC.FieldSeparator := Separator;
          Mode::"DotNet on NST": ConnectITReaderDotNetOnNST.FieldSeparator := Separator;
        END;
      END;
    END;

    PROCEDURE SetFieldDelimiter@1000000008(Delimiter@1000000000 : Text[1]);
    BEGIN
      IF IsInstantiated THEN BEGIN
        CASE Mode OF
          Mode::Automation: ConnectITReaderAutomation.FieldDelimiter := Delimiter;
          Mode::"DotNet on RTC": ConnectITReaderDotNetOnRTC.FieldDelimiter := Delimiter;
          Mode::"DotNet on NST": ConnectITReaderDotNetOnNST.FieldDelimiter := Delimiter;
        END;
      END;
    END;

    PROCEDURE SetHeaderLines@1000000011(HeaderLines@1000000000 : Integer);
    BEGIN
      IF IsInstantiated THEN BEGIN
        CASE Mode OF
          Mode::Automation: ConnectITReaderAutomation.HeaderLines := HeaderLines;
          Mode::"DotNet on RTC": ConnectITReaderDotNetOnRTC.HeaderLines := HeaderLines;
          Mode::"DotNet on NST": ConnectITReaderDotNetOnNST.HeaderLines := HeaderLines;
        END;
      END;
    END;

    PROCEDURE EndOfFile@1000000014() : Boolean;
    BEGIN
      CASE Mode OF
        Mode::Automation: EXIT(ConnectITReaderAutomation.EndOfFile);
        Mode::"DotNet on RTC": EXIT(ConnectITReaderDotNetOnRTC.EndOfFile);
        Mode::"DotNet on NST": EXIT(ConnectITReaderDotNetOnNST.EndOfFile);
      END;
    END;

    PROCEDURE Instantiate@1000000012() : Boolean;
    BEGIN
      SetMode;

      IF IsInstantiated THEN
        EXIT(TRUE);

      CASE Mode OF
        Mode::Automation: EXIT(InstantiateAutomation);
        Mode::"DotNet on RTC": EXIT(InstantiateDotNetOnRTC);
        Mode::"DotNet on NST": EXIT(InstantiateDotNetOnNST);
      END;
    END;

    LOCAL PROCEDURE InstantiateAutomation@1000000018() : Boolean;
    BEGIN
      EXIT(CREATE(ConnectITReaderAutomation, TRUE, ClientSide));
    END;

    LOCAL PROCEDURE InstantiateDotNetOnRTC@1000000019() : Boolean;
    BEGIN
      ConnectITReaderDotNetOnRTC := ConnectITReaderDotNetOnRTC.ConnectITReader();
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE InstantiateDotNetOnNST@1000000020() : Boolean;
    BEGIN
      ConnectITReaderDotNetOnNST := ConnectITReaderDotNetOnNST.ConnectITReader();
      EXIT(TRUE);
    END;

    PROCEDURE IsInstantiated@1000000013() : Boolean;
    BEGIN
      CASE Mode OF
        Mode::Automation: EXIT(NOT ISCLEAR(ConnectITReaderAutomation));
        Mode::"DotNet on RTC": EXIT(NOT ISNULL(ConnectITReaderDotNetOnRTC));
        Mode::"DotNet on NST": EXIT(NOT ISNULL(ConnectITReaderDotNetOnNST));
      END;
    END;

    PROCEDURE SetClientSide@1000000016(ClientSide2@1000000000 : Boolean);
    BEGIN
      ClientSide := ClientSide2;
    END;

    PROCEDURE GetMode@1000000009() : Integer;
    BEGIN
      EXIT(Mode);
    END;

    LOCAL PROCEDURE SetMode@1000000015();
    BEGIN
      IF NOT ISSERVICETIER THEN BEGIN
        Mode := Mode::Automation;
        EXIT;
      END;

      IF ClientSide THEN BEGIN
        Mode := Mode::"DotNet on RTC";
        EXIT;
      END;

      Mode := Mode::"DotNet on NST";
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148603 IN - No. Series Store Mgt.
{
  OBJECT-PROPERTIES
  {
    Date=05-06-13;
    Time=13:00:00;
    Version List=IDYN-CE5.50.1;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      NoSeriesStoreTemp@1000000000 : TEMPORARY Record 11148645;

    PROCEDURE ClearAll@1000000002();
    BEGIN
      NoSeriesStoreTemp.DELETEALL;
    END;

    PROCEDURE GetValue@1000000000(Key@1000000000 : Text[250]) : Text[250];
    BEGIN
      IF NoSeriesStoreTemp.GET(Key) THEN
        EXIT(NoSeriesStoreTemp.Value);

      EXIT('');
    END;

    PROCEDURE SetValue@1000000001(Key@1000000000 : Text[250];Value@1000000001 : Text[250]);
    BEGIN
      NoSeriesStoreTemp.Key := Key;
      NoSeriesStoreTemp.Value := Value;
      IF NOT NoSeriesStoreTemp.INSERT THEN
        NoSeriesStoreTemp.MODIFY;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148604 IN - Import ADO
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    TableNo=11148591;
    OnRun=VAR
            Task@1000000 : Record 11148614;
            Connection@1000012 : Automation "{2A75196C-D9EB-4129-B803-931327F72D5C} 2.8:{00000514-0000-0010-8000-00AA006D2EA4}:'Microsoft ActiveX Data Objects 2.8 Library'.Connection";
            ctADONotFound@1000003 : TextConst 'ENU=ADO not found.;NLD=ADO niet gevonden.';
          BEGIN
            gRec := Rec;

            ClearBuffers;
            FillBuffers(gRec);

            gTmpImportDefinitionLine.FINDFIRST;

            IF NOT CREATE(Connection,FALSE,TRUE) THEN
              ERROR(ctADONotFound);

            Connection.Open("Connection String");

            IF FileIsValid(Connection) THEN BEGIN
              ProcessFile(Connection);
              COMMIT;

              IF "Run Task" <> '' THEN BEGIN
                Task.GET("Run Task");
                Task.Process;
              END;

            END;

            Connection.Close;
            CLEAR(Connection);
          END;

  }
  CODE
  {
    VAR
      gRec@1000004 : Record 11148591;
      gTmpImportDefinitionLine@1000005 : TEMPORARY Record 11148592;
      gTmpImportDefinitionLine2@1000016 : TEMPORARY Record 11148592;
      gTmpImportDefFunction@1100531000 : TEMPORARY Record 11148594;
      gRecRef@1000017 : RecordRef;
      gFieldnameArray@1000001 : ARRAY [100] OF Text[1024];
      gNoOfFields@1000007 : Integer;
      gNoOfRecordsProcessed@1100531001 : Integer;
      gTableNo@1000002 : Integer;
      IncrementId@1000006 : Integer;
      gRecordAction@1000018 : 'Insert,Update,Delete,None';
      FindRecordRun@1000008 : Boolean;
      gProcessRun@1000000 : Boolean;

    LOCAL PROCEDURE FileIsValid@1000000(VAR Connection@1000004 : Automation "{2A75196C-D9EB-4129-B803-931327F72D5C} 2.8:{00000514-0000-0010-8000-00AA006D2EA4}:'Microsoft ActiveX Data Objects 2.8 Library'.Connection") : Boolean;
    VAR
      ImportDefMgt@1000012 : Codeunit 11148591;
      CommentMgt@1000006 : Codeunit 11148622;
      Recordset@1000000 : Automation "{2A75196C-D9EB-4129-B803-931327F72D5C} 2.8:{00000535-0000-0010-8000-00AA006D2EA4}:'Microsoft ActiveX Data Objects 2.8 Library'.Recordset";
      i@1000018 : Integer;
      LineCounter@1000002 : Integer;
      IsExistingRecord@1000009 : Boolean;
      tLine@1000011 : TextConst 'ENU=Line;NLD=Regel';
    BEGIN
      WITH gRec DO BEGIN

        TESTFIELD("File Format", "File Format"::ADO);
        IF Status = Status::Blocked THEN
          FIELDERROR(Status);
        gProcessRun := FALSE;

        CREATE(Recordset,FALSE,TRUE);
        Recordset.Open("SQL String", Connection);

        gNoOfFields := Recordset.Fields.Count;
        FOR i := 1 TO gNoOfFields DO
          gFieldnameArray[i] := Recordset.Fields.Item(i - 1).Name;

        WHILE NOT Recordset.EOF DO BEGIN

          LineCounter += 1;

          CommentMgt.SetKey(tLine + ' ' + FORMAT(LineCounter));

          gTableNo := 0;
          gTmpImportDefinitionLine.SETCURRENTKEY("Import Definition", "Line No.");
          gTmpImportDefinitionLine.FINDSET;
          REPEAT
            ProcessImportDefinitionLine(Recordset, gTmpImportDefinitionLine);
          UNTIL gTmpImportDefinitionLine.NEXT = 0;

          IF gTableNo <> 0 THEN BEGIN
            gTmpImportDefinitionLine.FINDFIRST;
            IsExistingRecord := ImportDefMgt.CheckRecordAction(gTmpImportDefinitionLine, gRecRef);
          END;

          gTableNo := 0;

          Recordset.MoveNext;

        END;

        EXIT(NOT CommentMgt.ErrorOccured);
      END;
    END;

    LOCAL PROCEDURE ProcessFile@1000014(VAR Connection@1000004 : Automation "{2A75196C-D9EB-4129-B803-931327F72D5C} 2.8:{00000514-0000-0010-8000-00AA006D2EA4}:'Microsoft ActiveX Data Objects 2.8 Library'.Connection");
    VAR
      ImportDefMgt@1000006 : Codeunit 11148591;
      Recordset@1000003 : Automation "{2A75196C-D9EB-4129-B803-931327F72D5C} 2.8:{00000535-0000-0010-8000-00AA006D2EA4}:'Microsoft ActiveX Data Objects 2.8 Library'.Recordset";
      IsExistingRecord@1000005 : Boolean;
    BEGIN
      WITH gRec DO BEGIN

        gProcessRun := TRUE;

        CREATE(Recordset,FALSE,TRUE);
        Recordset.Open("SQL String", Connection);

        WHILE NOT Recordset.EOF DO BEGIN

          FindRecordRun := TRUE;

          gTableNo := 0;
          gTmpImportDefinitionLine.SETCURRENTKEY("Import Definition", "Line No.");
          gTmpImportDefinitionLine.FINDSET;
          REPEAT
            ProcessImportDefinitionLine(Recordset, gTmpImportDefinitionLine);
          UNTIL gTmpImportDefinitionLine.NEXT = 0;

          IF gTableNo <> 0 THEN BEGIN
            gTmpImportDefinitionLine.FINDFIRST;
            IsExistingRecord := ImportDefMgt.CheckRecordAction(gTmpImportDefinitionLine, gRecRef);
            CASE TRUE OF

              IsExistingRecord AND (gTmpImportDefinitionLine."Existing Record" = gTmpImportDefinitionLine."Existing Record"::Delete) :
                gRecordAction := gRecordAction::Delete;

              IsExistingRecord AND (gTmpImportDefinitionLine."Existing Record" <> gTmpImportDefinitionLine."Existing Record"::Delete) :
                gRecordAction := gRecordAction::Update;

              NOT IsExistingRecord AND (gTmpImportDefinitionLine."New Record" = gTmpImportDefinitionLine."New Record"::Skip) :
                gRecordAction := gRecordAction::None;

              NOT IsExistingRecord AND (gTmpImportDefinitionLine."New Record" <> gTmpImportDefinitionLine."New Record"::Skip) :
                gRecordAction := gRecordAction::Insert;

            END;
          END;

          gNoOfRecordsProcessed += 1;

          FindRecordRun := FALSE;

          gTmpImportDefinitionLine.SETCURRENTKEY("Import Definition", "Line No.");
          gTmpImportDefinitionLine.FINDSET;
          REPEAT
            ProcessImportDefinitionLine(Recordset, gTmpImportDefinitionLine);
          UNTIL gTmpImportDefinitionLine.NEXT = 0;

          IF gTableNo <> 0 THEN
            SaveRecRef;

          Recordset.MoveNext;

        END;

      END;
    END;

    LOCAL PROCEDURE ProcessImportDefinitionLine@1000002(VAR Recordset@1000001 : Automation "{2A75196C-D9EB-4129-B803-931327F72D5C} 2.8:{00000535-0000-0010-8000-00AA006D2EA4}:'Microsoft ActiveX Data Objects 2.8 Library'.Recordset";VAR ImportDefinitionLine@1000000 : Record 11148592);
    VAR
      Fld@1000006 : Record 2000000041;
      ImportDefManagement@1000007 : Codeunit 11148591;
      VariableMgt@1000005 : Codeunit 11148619;
      FieldValue@1000003 : Text[1024];
    BEGIN
      IF (ImportDefinitionLine."Table No." <> gTableNo) AND
         (ImportDefinitionLine."Table No." <> 0)
      THEN BEGIN
        gRecRef.CLOSE;
        IF gRec."Company Name" = '' THEN
          gRecRef.OPEN(ImportDefinitionLine."Table No.")
        ELSE
          gRecRef.OPEN(ImportDefinitionLine."Table No.", FALSE, gRec."Company Name");
        gTableNo := ImportDefinitionLine."Table No.";

      END;

      CASE ImportDefinitionLine.Type OF

        ImportDefinitionLine.Type::Tag :
          ;

        ImportDefinitionLine.Type::Table :
          IF FieldExist(ImportDefinitionLine."Tag Name") THEN
            FieldValue := FORMAT(Recordset.Fields.Item(ImportDefinitionLine."Tag Name").Value);

        ImportDefinitionLine.Type::Value :
          IF FieldExist(ImportDefinitionLine."Tag Name") THEN
            FieldValue := FORMAT(Recordset.Fields.Item(ImportDefinitionLine."Tag Name").Value);

        ImportDefinitionLine.Type::Const :
          FieldValue := ImportDefinitionLine.Code;

        ImportDefinitionLine.Type::Variable :
          VariableMgt.GetVariable(ImportDefinitionLine.Code);

      END;

      ImportDefManagement.GetFld(ImportDefinitionLine, Fld);
      FieldValue :=
        ImportDefManagement.ExecuteIncrementMethod(FieldValue, ImportDefinitionLine, Fld, gRecRef, IncrementId);
      ImportDefManagement.ExecuteFunctions(ImportDefinitionLine, gTmpImportDefFunction, FieldValue);

      FillField(ImportDefinitionLine, FieldValue);
    END;

    LOCAL PROCEDURE ClearBuffers@1000001();
    BEGIN
      gTmpImportDefinitionLine.RESET;
      gTmpImportDefinitionLine.DELETEALL;

      gTmpImportDefinitionLine2.RESET;
      gTmpImportDefinitionLine2.DELETEALL;

      gTmpImportDefFunction.RESET;
      gTmpImportDefFunction.DELETEALL;
    END;

    LOCAL PROCEDURE FillBuffers@1000007(VAR ImportDefinition@1000002 : Record 11148591);
    VAR
      TmpImportDefinitionLine@1000001 : TEMPORARY Record 11148592;
      TmpImportDefTableLink@1000000 : TEMPORARY Record 11148593;
      TmpImportDefFunction@1100531000 : TEMPORARY Record 11148594;
      ImportDefMgt@1000005 : Codeunit 11148591;
    BEGIN
      ImportDefMgt.GetImportDefinitionLines(
        ImportDefinition, TmpImportDefinitionLine, TmpImportDefTableLink, TmpImportDefFunction);

      IF TmpImportDefinitionLine.FINDSET THEN
        REPEAT
          gTmpImportDefinitionLine := TmpImportDefinitionLine;
          gTmpImportDefinitionLine.Functions := FALSE;
          gTmpImportDefinitionLine.INSERT;

          gTmpImportDefinitionLine2 := TmpImportDefinitionLine;
          gTmpImportDefinitionLine2.Functions := FALSE;
          gTmpImportDefinitionLine2.INSERT;

        UNTIL TmpImportDefinitionLine.NEXT = 0;

      IF TmpImportDefFunction.FINDSET THEN
        REPEAT
          gTmpImportDefFunction := TmpImportDefFunction;
          gTmpImportDefFunction.INSERT;
        UNTIL TmpImportDefFunction.NEXT = 0;
    END;

    LOCAL PROCEDURE FillField@1000013(VAR ImportDefinitionLine@1000001 : Record 11148592;FieldValue@1000002 : Text[1024]);
    VAR
      Fld@1000004 : Record 2000000041;
      Mgt@1000007 : Codeunit 11148591;
      VariableMgt@1000006 : Codeunit 11148619;
      FldRef@1000005 : FieldRef;
      SaveVariable@1000003 : Boolean;
    BEGIN
      SaveVariable := ImportDefinitionLine."Dest. Variable" <> '';

      IF ImportDefinitionLine."Field No." <> 0 THEN BEGIN

        FldRef := gRecRef.FIELD(ImportDefinitionLine."Field No.");

        Fld.GET(gRecRef.NUMBER, FldRef.NUMBER);
        FieldValue := Mgt.ConvertFieldValue(FieldValue, ImportDefinitionLine, Fld);
        Mgt.ExecuteFunctions(ImportDefinitionLine, gTmpImportDefFunction, FieldValue);

        IF (FieldValue <> '') OR NOT ImportDefinitionLine."Skip If Empty" THEN
          IF gProcessRun THEN BEGIN

            IF Fld.Type = Fld.Type::Option THEN
              FieldValue := Mgt.ConvertOptionValue(FldRef, ImportDefinitionLine, FieldValue);

            Mgt.EvaluateFieldRefValue(FldRef, Fld.Type, FieldValue, ImportDefinitionLine."Validate Field" AND NOT FindRecordRun);

            IF ImportDefinitionLine."Save Record" AND NOT FindRecordRun THEN
              SaveRecRef;

            IF ImportDefinitionLine."Dest. Variable" <> '' THEN BEGIN
              FldRef := gRecRef.FIELD(ImportDefinitionLine."Field No.");
              VariableMgt.SetVariable(ImportDefinitionLine."Dest. Variable", FORMAT(FldRef.VALUE));
              SaveVariable := FALSE;
            END;

          END ELSE BEGIN

            IF Fld.Type = Fld.Type::Option THEN
              FieldValue := Mgt.ConvertOptionValue(FldRef, ImportDefinitionLine, FieldValue);

            Mgt.EvaluateFieldRefValue(FldRef, Fld.Type, FieldValue, FALSE);
            Mgt.CheckRestrictions(ImportDefinitionLine, FieldValue, gRec."Company Name");
          END;

      END;

      IF SaveVariable THEN
        VariableMgt.SetVariable(ImportDefinitionLine."Dest. Variable", FieldValue);
    END;

    LOCAL PROCEDURE SaveRecRef@1000015();
    VAR
      Monitoring@1000000 : Codeunit 11148620;
      RecRef@1000001 : RecordRef;
    BEGIN
      RecRef := gRecRef;

      CASE gRecordAction OF
        gRecordAction::Insert :
          BEGIN
            RecRef.INSERT(TRUE);
            gRecordAction := gRecordAction::Update;
            IF gRec."Monitor Modifications" THEN
              Monitoring.InsertRecord(RecRef);
          END;

        gRecordAction::Update :
          BEGIN
            //IF gRenameKeyPerIndent[Indent + 1] THEN BEGIN
            //  xRecRef := gxRecRefPerIndent[Indent + 1];
            //  xRecRef.DELETE;
            //  RecRef.INSERT;
            //END ELSE

            RecRef.MODIFY(TRUE);
            IF gRec."Monitor Modifications" THEN
              Monitoring.ModifyRecord(RecRef, RecRef);
          END;

        gRecordAction::Delete :
          BEGIN
            RecRef.DELETE(TRUE);
            gRecordAction := gRecordAction::None;

            IF gRec."Monitor Modifications" THEN
              Monitoring.DeleteRecord(RecRef);

          END;

      END;
    END;

    PROCEDURE GetFieldsFromConnection@1000003(VAR ImportDefinition@1000000 : Record 11148591;VAR NoOfFields@1000003 : Integer;VAR FieldnameArray@1000004 : ARRAY [100] OF Text[1024]);
    VAR
      Connection@1000002 : Automation "{2A75196C-D9EB-4129-B803-931327F72D5C} 2.8:{00000514-0000-0010-8000-00AA006D2EA4}:'Microsoft ActiveX Data Objects 2.8 Library'.Connection";
      Recordset@1000001 : Automation "{2A75196C-D9EB-4129-B803-931327F72D5C} 2.8:{00000535-0000-0010-8000-00AA006D2EA4}:'Microsoft ActiveX Data Objects 2.8 Library'.Recordset";
      i@1000005 : Integer;
    BEGIN
      WITH ImportDefinition DO BEGIN
        TESTFIELD("Connection String");
        TESTFIELD("SQL String");

        CREATE(Connection,FALSE,TRUE);
        Connection.Open("Connection String");

        CREATE(Recordset,FALSE,TRUE);
        Recordset.Open("SQL String", Connection);

        NoOfFields := Recordset.Fields.Count;
        FOR i := 1 TO NoOfFields DO
          FieldnameArray[i] := Recordset.Fields.Item(i - 1).Name;

      END;

      Connection.Close;
    END;

    LOCAL PROCEDURE FieldExist@1000004(FieldnameToCheck@1000000 : Text[1024]) : Boolean;
    VAR
      i@1000001 : Integer;
    BEGIN
      FOR i := 1 TO gNoOfFields DO
        IF FieldnameToCheck = gFieldnameArray[i] THEN
          EXIT(TRUE);
    END;

    PROCEDURE NoOfRecordsProcessed@1100531000() : Integer;
    BEGIN
      EXIT(gNoOfRecordsProcessed);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148605 IN - Export Def. Management
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE CheckFileExist@1000004(Filename@1000000 : Text[1024]);
    VAR
      Setup@1000001 : Record 11148589;
      ctFileAlreadyExist@1000002 : TextConst 'ENU=File %1 already exists.\Overwrite?;NLD=Bestandsnaam %1 bestaat reeds.\Overschrijven?';
    BEGIN
      Setup.GET;
      IF NOT Setup."Confirm Overwrite" OR NOT GUIALLOWED THEN
        EXIT;

      IF FILE.EXISTS(Filename) THEN BEGIN
        IF NOT CONFIRM(ctFileAlreadyExist, TRUE, Filename) THEN
          ERROR('');
        ERASE(Filename);
      END;
    END;

    PROCEDURE CreateFilename@1000005(VAR ExportDefinition@1000000 : Record 11148599;VAR RecRef@1000001 : RecordRef;VAR Path@1000004 : Text[1024];VAR Filename@1000005 : Text[1024];Trigger@1000013 : Text[1024];ExportJobEntryNo@1000014 : Integer);
    VAR
      ExportDefinitionLine@1000007 : Record 11148600;
      Project@1000003 : Record 11148620;
      Mgt@1000002 : Codeunit 11148589;
      VariableMgt@1000009 : Codeunit 11148619;
      FldRef@1000011 : FieldRef;
      KeyRef@1000010 : KeyRef;
      Supplement@1000008 : Text[1024];
      i@1000012 : Integer;
      ProjectEntryNo@1000006 : Integer;
    BEGIN
      IF STRPOS(LOWERCASE(ExportDefinition.Location + ExportDefinition.Filename), '#pentryno#') > 0 THEN BEGIN
        Project.GET(ExportDefinition."Project Code");
        ProjectEntryNo := Project."Export Entry No.";
      END;

      Path :=
        ReplaceFieldFields(
          RecRef,
          ExportDefinition.Location, ExportDefinition.Code, ExportDefinition."Export Entry No.",
          ProjectEntryNo, Trigger, ExportJobEntryNo);

      Path := FORMAT(CURRENTDATETIME, 0, Path);

      IF Path <> '' THEN
        Mgt.CheckCreateDirectory(Path);

      Filename := ExportDefinition.Filename;

      CASE ExportDefinition."Filename Type" OF

        ExportDefinition."Filename Type"::" " :
          BEGIN
            Filename :=
              ReplaceFieldFields(
                RecRef, ExportDefinition.Filename, ExportDefinition.Code, ExportDefinition."Export Entry No.",
                ProjectEntryNo, Trigger, ExportJobEntryNo);
            Filename := FORMAT(CURRENTDATETIME, 0, Filename);
          END;

        ExportDefinition."Filename Type"::YYYYMMDDHHMMSS :
          Supplement :=
            FORMAT(CURRENTDATETIME, 0, '<Year4><Month,2><Day,2><Hours24,2><Minutes,2><Seconds,2>');

        ExportDefinition."Filename Type"::YYYYMMDD :
          Supplement := FORMAT(CURRENTDATETIME, 0, '<Year4><Month,2><Day,2>');

        ExportDefinition."Filename Type"::"Dest. Variable" :
          BEGIN
            ExportDefinitionLine.SETRANGE("Export Definition", ExportDefinition.Code);
            ExportDefinitionLine.SETFILTER("Dest. Variable", '<>%1', '');
            ExportDefinitionLine.FINDFIRST;
            Supplement := VariableMgt.GetVariable(ExportDefinitionLine."Dest. Variable");
          END;

        ExportDefinition."Filename Type"::Key :
          BEGIN
            KeyRef := RecRef.KEYINDEX(1);
            FOR i := 1 TO KeyRef.FIELDCOUNT DO BEGIN
              FldRef := KeyRef.FIELDINDEX(i);
              IF i > 1 THEN
                Supplement := Supplement + '-';
              Supplement := Supplement + FORMAT(FldRef.VALUE);
            END;
          END;

        ExportDefinition."Filename Type"::"Entry No." :
          Supplement := FORMAT(ExportDefinition."Export Entry No.");

        ExportDefinition."Filename Type"::"Project Entry No." :
          Supplement := FORMAT(ProjectEntryNo);

        ExportDefinition."Filename Type"::Trigger :
          Supplement := Trigger;

        ExportDefinition."Filename Type"::Companyname :
          Supplement := COMPANYNAME;

        ExportDefinition."Filename Type"::"Table No." :
          Supplement := FORMAT(RecRef.NUMBER);

        ExportDefinition."Filename Type"::"Exp. Job Entry. No." :
          Supplement := FORMAT(ExportJobEntryNo);

      END;

      IF Supplement <> '' THEN
        IF Filename = '' THEN
          Filename := Supplement + '.' + ExportDefinition.Extension(ExportDefinition)
        ELSE
          IF STRPOS(Filename, '.') > 0 THEN
            Filename := COPYSTR(Filename, 1, STRPOS(Filename, '.') - 1) + Supplement + COPYSTR(Filename, STRPOS(Filename, '.'))
          ELSE
            Filename := Filename + Supplement;
    END;

    LOCAL PROCEDURE ReplaceFieldFields@1000008(VAR RecRef@1000000001 : RecordRef;Text@1100495000 : Text[1024];ExportDefinitionCode@1000006 : Code[20];EntryNo@1100512000 : Integer;ProjectEntryNo@1000004 : Integer;Trigger@1000005 : Text[1024];ExportJobEntryNo@1000011 : Integer) : Text[1024];
    VAR
      ExportDefinitionLine@1000007 : Record 11148600;
      Fld@1000000 : Record 2000000041;
      Mgt@1000010 : Codeunit 11148589;
      VariableMgt@1000001 : Codeunit 11148619;
      FldRef@1100495003 : FieldRef;
      KeyRef@1000008 : KeyRef;
      NewValue@1100496010 : Text[250];
      VariableToReplace@1100496004 : Text[250];
      i@1000009 : Integer;
      VariableEndPos@1100496001 : Integer;
      VariableStartPos@1100496000 : Integer;
      FieldFound@1000002 : Boolean;
    BEGIN
      WHILE STRPOS(Text, '#') > 0 DO BEGIN

        VariableStartPos := STRPOS(Text, '#');
        VariableEndPos := Mgt.Instr(VariableStartPos + 1, Text, '#');
        IF VariableEndPos > VariableStartPos THEN BEGIN
          VariableToReplace := COPYSTR(Text, VariableStartPos + 1, VariableEndPos - VariableStartPos - 1);

          FieldFound := FALSE;

          Fld.SETRANGE(TableNo, RecRef.NUMBER);
          Fld.SETRANGE(FieldName, VariableToReplace);
          IF Fld.FINDFIRST THEN BEGIN
            FldRef := RecRef.FIELD(Fld."No.");
            NewValue := FORMAT(FldRef.VALUE);
            FieldFound := TRUE;
          END;

          IF NOT FieldFound THEN BEGIN
            NewValue := VariableMgt.GetVariable(VariableToReplace);

            CASE LOWERCASE(VariableToReplace) OF

              'yyyymmddhhmmss' :
                NewValue := FORMAT(TODAY, 0, '<Year4><Month,2><Day,2><Hours24><Minutes,2><Seconds,2>');

              'yyyymmdd' :
                NewValue := FORMAT(TODAY, 0, '<Year4><Month,2><Day,2>');

              'dest. variable' :
                BEGIN
                  ExportDefinitionLine.SETRANGE("Export Definition", ExportDefinitionCode);
                  ExportDefinitionLine.SETFILTER("Dest. Variable", '<>%1', '');
                  ExportDefinitionLine.FINDFIRST;
                  NewValue := VariableMgt.GetVariable(ExportDefinitionLine."Dest. Variable");
                END;

              'key' :
                BEGIN
                  KeyRef := RecRef.KEYINDEX(1);
                  FOR i := 1 TO KeyRef.FIELDCOUNT DO BEGIN
                    FldRef := KeyRef.FIELDINDEX(i);
                    IF i > 1 THEN
                      NewValue := NewValue + '-';
                    NewValue := NewValue + FORMAT(FldRef.VALUE);
                  END;
                END;

              'entry no.' :
                NewValue := FORMAT(EntryNo);

              'project entry No.' :
                NewValue := FORMAT(ProjectEntryNo);

              'trigger' :
                NewValue := Trigger;

              'companyname' :
                NewValue := COMPANYNAME;

              'table no.' :
                NewValue := FORMAT(RecRef.NUMBER);

              'exp. job entry. no.' :
                NewValue := FORMAT(ExportJobEntryNo);

            END;

          END;

        END ELSE BEGIN
          VariableEndPos := VariableStartPos;
          NewValue := '';
        END;

        Text := COPYSTR(Text, 1, VariableStartPos - 1) + NewValue + COPYSTR(Text, VariableEndPos + 1);

      END;

      EXIT(Text);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148606 IN - Process Export Definition
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    TableNo=11148599;
    OnRun=BEGIN
            Process;
          END;

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148607 IN - Reversed Data Mapping
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    OnRun=VAR
            ExportDefinition@1100531000 : Record 11148599;
          BEGIN
          END;

  }
  CODE
  {

    PROCEDURE ExportDef@1100531005(VAR ExportDefinition@1100531000 : Record 11148599);
    BEGIN
      WITH ExportDefinition DO
        CASE "File Format" OF

          "File Format"::XML :
            ExportXML(ExportDefinition);

          "File Format"::"Fixed Width" :
            FIELDERROR("File Format");

          "File Format"::CSV :
            FIELDERROR("File Format");

          "File Format"::Excel :
            FIELDERROR("File Format");

          "File Format"::ADO :
            ExportADO(ExportDefinition);

        END;
    END;

    LOCAL PROCEDURE ExportXML@1100531000(VAR ExportDefinition@1100531000 : Record 11148599);
    VAR
      ExportDefinitionLine@1100531005 : Record 11148600;
      gDoc@1100531001 : Codeunit 11148637;
      gDocAsNode@1000000000 : Codeunit 11148611;
      FileName2@1100531003 : Text[1024];
      DocNotCreated@1100531002 : TextConst 'ENU=The XML Document cannot be created.;NLD=Het XML document kan niet worden aangemaakt.';
    BEGIN
      IF ExportGetFilename(ExportDefinition, FileName2) THEN
        WITH ExportDefinition DO BEGIN

          IF NOT gDoc.Create(FALSE, TRUE) THEN
            ERROR(DocNotCreated);

          gDoc.SetAsync(FALSE); // CI-146
          gDoc.LoadFromFile(FileName2);

          ConfirmExistingLinesDeleted;

          ExportDefinitionLine."Export Definition" := Code;
          ExportDefinitionLine."Entry No." := 0;

          gDoc.AsNode(gDocAsNode);
          ExportXMLLoopNodes(gDocAsNode, ExportDefinitionLine, 0, ExportDefinitionLine);

          ExportMapTablesAndFields(ExportDefinition);
        END;
    END;

    LOCAL PROCEDURE ExportXMLLoopNodes@1100531004(VAR ParentNode@1100531001 : Codeunit 11148611;VAR ExportDefinitionLine@1100531007 : Record 11148600;Indent@1100531003 : Integer;VAR ParentExportDefinitionLine@1100531016 : Record 11148600) HasFields : Boolean;
    VAR
      PrevExportDefinitionLine@1100531008 : Record 11148600;
      Attributes@1000000001 : Codeunit 11148649;
      Attribute@1100531005 : Codeunit 11148611;
      ChildNodes@1000000002 : Codeunit 11148612;
      ChildNode@1100531002 : Codeunit 11148611;
      GrandchildNodes@1000000000 : Codeunit 11148612;
      GrandchildNode@1000000003 : Codeunit 11148611;
      NodeNameArray@1100531006 : ARRAY [100] OF Text[1024];
      i@1100531004 : Integer;
      j@1100531009 : Integer;
    BEGIN
      IF ParentNode.GetNodeTypeString = 'element' THEN BEGIN
        ParentNode.Attributes(Attributes);
        FOR i := 0 TO Attributes.GetLength - 1 DO BEGIN
          Attributes.GetItem(i, Attribute);

          ExportDefinitionLine."Entry No." += 1;
          ExportDefinitionLine."Line No." += 10000;
          ExportDefinitionLine.Indent := Indent;
          ExportDefinitionLine."Tag Name" := Attribute.GetNodeName;
          ExportDefinitionLine.Type := ExportDefinitionLine.Type::Field;
          ExportDefinitionLine."As Attribute" := TRUE;
          ExportDefinitionLine.INSERT;

          HasFields := TRUE;
          IF Indent > 0 THEN BEGIN
            ParentExportDefinitionLine.Type := ParentExportDefinitionLine.Type::Field;
            ParentExportDefinitionLine.MODIFY;
          END;
        END;
      END;

      ParentNode.ChildNodes(ChildNodes);
      FOR i := 0 TO ChildNodes.GetLength - 1 DO BEGIN
        ChildNodes.GetItem(i, ChildNode);
        CASE FORMAT(ChildNode.GetNodeTypeString) OF
          'element' :
            IF NewValueInArray(NodeNameArray, ChildNode.GetNodeName) THEN BEGIN
              ExportDefinitionLine."Entry No." += 1;
              ExportDefinitionLine."Line No." += 10000;
              ExportDefinitionLine.Indent := Indent;
              ExportDefinitionLine."Tag Name" := ChildNode.GetNodeName;
              ExportDefinitionLine.Type := ExportDefinitionLine.Type::Tag;
              ExportDefinitionLine."As Attribute" := FALSE;
              ExportDefinitionLine.INSERT;

              PrevExportDefinitionLine := ExportDefinitionLine;
              IF ExportXMLLoopNodes(ChildNode, ExportDefinitionLine, Indent + 1, ExportDefinitionLine) THEN BEGIN
                PrevExportDefinitionLine.Type := PrevExportDefinitionLine.Type::Table;
                PrevExportDefinitionLine.MODIFY;
              END;

              ChildNode.ChildNodes(GrandchildNodes);
              IF GrandchildNodes.GetLength = 0 THEN BEGIN
                PrevExportDefinitionLine.Type := PrevExportDefinitionLine.Type::Field;
                PrevExportDefinitionLine.MODIFY;
              END ELSE
                FOR j := 0 TO GrandchildNodes.GetLength - 1 DO BEGIN
                  GrandchildNodes.GetItem(j, GrandchildNode);
                  IF GrandchildNode.GetNodeTypeString = 'text' THEN BEGIN
                    HasFields := TRUE;
                    IF Indent > 0 THEN BEGIN
                      ParentExportDefinitionLine.Type := ParentExportDefinitionLine.Type::Field;
                      ParentExportDefinitionLine.MODIFY;
                    END;
                  END;
                END;
            END;
        END;
      END;
    END;

    LOCAL PROCEDURE ExportADO@1000011(VAR ExportDefinition@1100531000 : Record 11148599);
    VAR
      ExportDefinitionLine@1000004 : Record 11148600;
      ExportDefinitionLine2@1000005 : Record 11148600;
      ExportADO@1000000 : Codeunit 11148618;
      FieldnameArray@1000002 : ARRAY [100] OF Text[1024];
      i@1000003 : Integer;
      NoOfFields@1000001 : Integer;
    BEGIN
      ExportADO.GetFieldsFromConnection(ExportDefinition, NoOfFields, FieldnameArray);

      WITH ExportDefinition DO
        FOR i := 1 TO NoOfFields DO BEGIN
          ExportDefinitionLine.SETCURRENTKEY("Export Definition", "Tag Name");
          ExportDefinitionLine.SETRANGE("Export Definition", Code);
          ExportDefinitionLine.SETRANGE("Tag Name", FieldnameArray[i]);
          IF ExportDefinitionLine.ISEMPTY THEN BEGIN

            ExportDefinitionLine2.RESET;
            ExportDefinitionLine2.SETCURRENTKEY("Export Definition", "Line No.");
            ExportDefinitionLine2.SETRANGE("Export Definition", Code);
            IF ExportDefinitionLine2.FINDLAST THEN
              ExportDefinitionLine2.SetupNewLine(ExportDefinitionLine2, TRUE)
            ELSE BEGIN
              ExportDefinitionLine2."Export Definition" := Code;
              ExportDefinitionLine2."Entry No." := 1;
              ExportDefinitionLine2."Line No." := 10000;
            END;
            ExportDefinitionLine2.VALIDATE(Type, ExportDefinitionLine2.Type::Field);
            ExportDefinitionLine2."Tag Name" := FieldnameArray[i];
            ExportDefinitionLine2.INSERT(TRUE);

          END;
        END;
    END;

    LOCAL PROCEDURE ExportGetFilename@1100531006(VAR ExportDefinition@1100531000 : Record 11148599;VAR FileName2@1100531003 : Text[1024]) : Boolean;
    VAR
      LogMgt@1100531004 : Codeunit 11148623;
      ctExtensions@1100531001 : TextConst 'ENU=Interface Files (*.%1)|*.%1|All Files (*.*)|*.*;NLD=Interface Files (*.%1)|*.%1|All Files (*.*)|*.*';
      ctTitleText@1100531002 : TextConst 'ENU=Open File...;NLD=Bestand openen...';
    BEGIN
      WITH ExportDefinition DO BEGIN

        LogMgt.SetDialogProperties(FORMAT(ctTitleText), STRSUBSTNO(ctExtensions, Extension(ExportDefinition)), '', 1);
        IF NOT LogMgt.RUN THEN
          EXIT;

        FileName2 := LogMgt.GetDialogFilename;
        IF FileName2 <> '' THEN
          EXIT(TRUE);
      END;
    END;

    LOCAL PROCEDURE ExportMapTablesAndFields@1100531008(VAR ExportDefinition@1100531000 : Record 11148599);
    VAR
      ExportDefinitionLine@1100531001 : Record 11148600;
      ExportDefinitionLine2@1100531004 : Record 11148600;
      Object@1100531002 : Record 2000000001;
      Fld@1100531005 : Record 2000000041;
      Mgt@1100531003 : Codeunit 11148589;
    BEGIN
      WITH ExportDefinition DO BEGIN
        ExportDefinitionLine.SETRANGE("Export Definition", Code);
        ExportDefinitionLine.SETRANGE(Type, ExportDefinitionLine.Type::Table);
        IF ExportDefinitionLine.FINDSET THEN
          REPEAT
            Object.SETRANGE(Type, Object.Type::Table);
            Object.SETFILTER("Company Name", '%1', '');
            Object.SETFILTER(Name, '@' + FORMAT(ExportDefinitionLine."Tag Name"[1]) + '*');
            IF Object.FINDSET THEN
              REPEAT
                IF LOWERCASE(Mgt.TableTagName(Object.ID)) = LOWERCASE(ExportDefinitionLine."Tag Name") THEN BEGIN
                  ExportDefinitionLine.VALIDATE("Table No.", Object.ID);
                  ExportDefinitionLine.MODIFY;
                END;
                ExportDefinitionLine2.SETRANGE("Export Definition", Code);
                ExportDefinitionLine2.SETRANGE(Type, ExportDefinitionLine2.Type::Table);
                ExportDefinitionLine2.SETFILTER(Indent, '<%1', ExportDefinitionLine.Indent);
                IF ExportDefinitionLine2.FINDLAST THEN BEGIN
                  ExportDefinitionLine.VALIDATE("Link to Table (Tag Name)", ExportDefinitionLine2."Tag Name");
                  ExportDefinitionLine.MODIFY;
                END;

              UNTIL Object.NEXT = 0;

          UNTIL ExportDefinitionLine.NEXT = 0;

        ExportDefinitionLine.SETRANGE(Type, ExportDefinitionLine.Type::Field);
        IF ExportDefinitionLine.FINDSET THEN
          REPEAT
            ExportDefinitionLine2.SETRANGE("Export Definition", Code);
            ExportDefinitionLine2.SETRANGE(Type, ExportDefinitionLine2.Type::Table);
            ExportDefinitionLine2.SETRANGE(Indent, ExportDefinitionLine.Indent - 1);
            IF ExportDefinitionLine2.FINDLAST THEN BEGIN
              ExportDefinitionLine.VALIDATE("Table No.", ExportDefinitionLine2."Table No.");
              Fld.SETRANGE(TableNo, ExportDefinitionLine."Table No.");
              IF Fld.FINDSET THEN
                REPEAT
                  IF LOWERCASE(Mgt.FieldTagName(Fld.TableNo, Fld."No.")) =
                     LOWERCASE(ExportDefinitionLine."Tag Name")
                  THEN BEGIN
                    ExportDefinitionLine.VALIDATE("Field No.", Fld."No.");
                    ExportDefinitionLine.MODIFY;
                  END;
                UNTIL Fld.NEXT = 0;
            END;

          UNTIL ExportDefinitionLine.NEXT = 0;

      END;
    END;

    PROCEDURE ImportDef@1100531016(VAR ImportDefinition@1100531000 : Record 11148591);
    BEGIN
      WITH ImportDefinition DO
        CASE "File Format" OF

          "File Format"::XML :
            ImportXML(ImportDefinition);

          "File Format"::"Fixed Width" :
            FIELDERROR("File Format");

          "File Format"::CSV :
            FIELDERROR("File Format");

          "File Format"::Excel :
            FIELDERROR("File Format");

          "File Format"::ADO :
            ImportADO(ImportDefinition);

        END;
    END;

    LOCAL PROCEDURE ImportXML@1100531015(VAR ImportDefinition@1100531000 : Record 11148591);
    VAR
      ImportDefinitionLine@1100531005 : Record 11148592;
      gDoc@1100531001 : Codeunit 11148637;
      gDocAsNode@1000000000 : Codeunit 11148611;
      FileName2@1100531003 : Text[1024];
      DocNotCreated@1100531002 : TextConst 'ENU=The XML Document cannot be created.;NLD=Het XML document kan niet worden aangemaakt.';
    BEGIN
      IF ImportGetFilename(ImportDefinition, FileName2) THEN
        WITH ImportDefinition DO BEGIN

          IF NOT gDoc.Create(FALSE, TRUE) THEN
            ERROR(DocNotCreated);

          gDoc.SetAsync(FALSE); // CI-146
          gDoc.LoadFromFile(FileName2);

          ConfirmExistingLinesDeleted;

          ImportDefinitionLine."Import Definition" := Code;
          ImportDefinitionLine."Entry No." := 0;

          gDoc.AsNode(gDocAsNode);
          ImportXMLLoopNodes(gDocAsNode, ImportDefinitionLine, 0, ImportDefinitionLine);

          ImportMapTablesAndFields(ImportDefinition);
        END;
    END;

    LOCAL PROCEDURE ImportXMLLoopNodes@1100531014(VAR ParentNode@1100531001 : Codeunit 11148611;VAR ImportDefinitionLine@1100531007 : Record 11148592;Indent@1100531003 : Integer;VAR ParentImportDefinitionLine@1100531016 : Record 11148592) HasFields : Boolean;
    VAR
      PrevImportDefinitionLine@1100531008 : Record 11148592;
      Attributes@1000000000 : Codeunit 11148649;
      Attribute@1100531005 : Codeunit 11148611;
      ChildNodes@1000000001 : Codeunit 11148612;
      ChildNode@1100531002 : Codeunit 11148611;
      GrandchildNodes@1000000002 : Codeunit 11148612;
      GrandchildNode@1000000003 : Codeunit 11148611;
      NodeNameArray@1100531006 : ARRAY [100] OF Text[1024];
      i@1100531004 : Integer;
      j@1100531009 : Integer;
    BEGIN
      IF ParentNode.GetNodeTypeString = 'element' THEN BEGIN
        ParentNode.Attributes(Attributes);
        FOR i := 0 TO Attributes.GetLength - 1 DO BEGIN
          Attributes.GetItem(i, Attribute);

          ImportDefinitionLine."Entry No." += 1;
          ImportDefinitionLine."Line No." += 10000;
          ImportDefinitionLine.Indent := Indent;
          ImportDefinitionLine."Tag Name" := Attribute.GetNodeName;
          ImportDefinitionLine.Type := ImportDefinitionLine.Type::Value;
          ImportDefinitionLine."As Attribute" := TRUE;
          ImportDefinitionLine.INSERT;

          HasFields := TRUE;
          IF Indent > 0 THEN BEGIN
            ParentImportDefinitionLine.Type := ParentImportDefinitionLine.Type::Value;
            ParentImportDefinitionLine.MODIFY;
          END;
        END;
      END;

      ParentNode.ChildNodes(ChildNodes);
      FOR i := 0 TO ChildNodes.GetLength - 1 DO BEGIN
        ChildNodes.GetItem(i, ChildNode);
        CASE ChildNode.GetNodeTypeString OF
          'element' :
            IF NewValueInArray(NodeNameArray, ChildNode.GetNodeName) THEN BEGIN
              ImportDefinitionLine."Entry No." += 1;
              ImportDefinitionLine."Line No." += 10000;
              ImportDefinitionLine.Indent := Indent;
              ImportDefinitionLine."Tag Name" := ChildNode.GetNodeName;
              ImportDefinitionLine.Type := ImportDefinitionLine.Type::Tag;
              ImportDefinitionLine."As Attribute" := FALSE;
              ImportDefinitionLine.INSERT;

              PrevImportDefinitionLine := ImportDefinitionLine;
              IF ImportXMLLoopNodes(ChildNode, ImportDefinitionLine, Indent + 1, ImportDefinitionLine) THEN BEGIN
                PrevImportDefinitionLine.Type := PrevImportDefinitionLine.Type::Table;
                PrevImportDefinitionLine.MODIFY;
              END;

              ChildNode.ChildNodes(GrandchildNodes);
              IF GrandchildNodes.GetLength = 0 THEN BEGIN
                PrevImportDefinitionLine.Type := PrevImportDefinitionLine.Type::Value;
                PrevImportDefinitionLine.MODIFY;
              END ELSE
                FOR j := 0 TO GrandchildNodes.GetLength - 1 DO
                  GrandchildNodes.GetItem(j, GrandchildNode);
                  IF GrandchildNode.GetNodeTypeString = 'text' THEN BEGIN
                    HasFields := TRUE;
                    IF Indent > 0 THEN BEGIN
                      ParentImportDefinitionLine.Type := ParentImportDefinitionLine.Type::Value;
                      ParentImportDefinitionLine.MODIFY;
                    END;
                  END;

            END;
        END;
      END;
    END;

    LOCAL PROCEDURE ImportADO@1100531010(VAR ImportDefinition@1100531000 : Record 11148591);
    VAR
      ImportDefinitionLine@1000004 : Record 11148592;
      ImportDefinitionLine2@1000005 : Record 11148592;
      ImportADO@1000000 : Codeunit 11148604;
      FieldnameArray@1000002 : ARRAY [100] OF Text[1024];
      i@1000003 : Integer;
      NoOfFields@1000001 : Integer;
    BEGIN
      ImportADO.GetFieldsFromConnection(ImportDefinition, NoOfFields, FieldnameArray);

      WITH ImportDefinition DO
        FOR i := 1 TO NoOfFields DO BEGIN
          ImportDefinitionLine.SETCURRENTKEY("Import Definition", "Tag Name");
          ImportDefinitionLine.SETRANGE("Import Definition", Code);
          ImportDefinitionLine.SETRANGE("Tag Name", FieldnameArray[i]);
          IF ImportDefinitionLine.ISEMPTY THEN BEGIN

            ImportDefinitionLine2.RESET;
            ImportDefinitionLine2.SETCURRENTKEY("Import Definition", "Line No.");
            ImportDefinitionLine2.SETRANGE("Import Definition", Code);
            IF ImportDefinitionLine2.FINDLAST THEN
              ImportDefinitionLine2.SetupNewLine(ImportDefinitionLine2, TRUE)
            ELSE BEGIN
              ImportDefinitionLine2."Import Definition" := Code;
              ImportDefinitionLine2."Entry No." := 1;
              ImportDefinitionLine2."Line No." := 10000;
            END;
            ImportDefinitionLine2.VALIDATE(Type, ImportDefinitionLine2.Type::Value);
            ImportDefinitionLine2."Tag Name" := FieldnameArray[i];
            ImportDefinitionLine2.INSERT(TRUE);

          END;
        END;
    END;

    LOCAL PROCEDURE ImportGetFilename@1100531009(VAR ImportDefinition@1100531000 : Record 11148591;VAR FileName2@1100531003 : Text[1024]) : Boolean;
    VAR
      LogMgt@1100531004 : Codeunit 11148623;
      ctExtensions@1100531001 : TextConst 'ENU=Interface Files (*.%1)|*.%1|All Files (*.*)|*.*;NLD=Interface Files (*.%1)|*.%1|All Files (*.*)|*.*';
      ctTitleText@1100531002 : TextConst 'ENU=Open File...;NLD=Bestand openen...';
    BEGIN
      WITH ImportDefinition DO BEGIN

        LogMgt.SetDialogProperties(FORMAT(ctTitleText), STRSUBSTNO(ctExtensions, Extension("File Format")), '', 1);
        IF NOT LogMgt.RUN THEN
          EXIT;

        FileName2 := LogMgt.GetDialogFilename;
        IF FileName2 <> '' THEN
          EXIT(TRUE);
      END;
    END;

    LOCAL PROCEDURE ImportMapTablesAndFields@1100531002(VAR ImportDefinition@1100531000 : Record 11148591);
    VAR
      ImportDefinitionLine@1100531001 : Record 11148592;
      ImportDefinitionLine2@1100531004 : Record 11148592;
      Object@1100531002 : Record 2000000001;
      Fld@1100531005 : Record 2000000041;
      Mgt@1100531003 : Codeunit 11148589;
    BEGIN
      WITH ImportDefinition DO BEGIN
        ImportDefinitionLine.SETRANGE("Import Definition", Code);
        ImportDefinitionLine.SETRANGE(Type, ImportDefinitionLine.Type::Table);
        IF ImportDefinitionLine.FINDSET THEN
          REPEAT
            Object.SETRANGE(Type, Object.Type::Table);
            Object.SETFILTER("Company Name", '%1', '');
            Object.SETFILTER(Name, '@' + FORMAT(ImportDefinitionLine."Tag Name"[1]) + '*');
            IF Object.FINDSET THEN
              REPEAT
                IF LOWERCASE(Mgt.TableTagName(Object.ID)) = LOWERCASE(ImportDefinitionLine."Tag Name") THEN BEGIN
                  ImportDefinitionLine.VALIDATE("Table No.", Object.ID);
                  ImportDefinitionLine.MODIFY;
                END;
                ImportDefinitionLine2.SETRANGE("Import Definition", Code);
                ImportDefinitionLine2.SETRANGE(Type, ImportDefinitionLine2.Type::Table);
                ImportDefinitionLine2.SETFILTER(Indent, '<%1', ImportDefinitionLine.Indent);
                IF ImportDefinitionLine2.FINDLAST THEN BEGIN
                  ImportDefinitionLine.VALIDATE("Link to Table (Tag Name)", ImportDefinitionLine2."Tag Name");
                  ImportDefinitionLine.MODIFY;
                END;

              UNTIL Object.NEXT = 0;

          UNTIL ImportDefinitionLine.NEXT = 0;

        ImportDefinitionLine.SETRANGE(Type, ImportDefinitionLine.Type::Value);
        IF ImportDefinitionLine.FINDSET THEN
          REPEAT
            ImportDefinitionLine2.SETRANGE("Import Definition", Code);
            ImportDefinitionLine2.SETRANGE(Type, ImportDefinitionLine2.Type::Table);
            ImportDefinitionLine2.SETRANGE(Indent, ImportDefinitionLine.Indent - 1);
            IF ImportDefinitionLine2.FINDLAST THEN BEGIN
              ImportDefinitionLine.VALIDATE("Table No.", ImportDefinitionLine2."Table No.");
              Fld.SETRANGE(TableNo, ImportDefinitionLine."Table No.");
              IF Fld.FINDSET THEN
                REPEAT
                  IF LOWERCASE(Mgt.FieldTagName(Fld.TableNo, Fld."No.")) =
                     LOWERCASE(ImportDefinitionLine."Tag Name")
                  THEN BEGIN
                    ImportDefinitionLine.VALIDATE("Field No.", Fld."No.");
                    ImportDefinitionLine.MODIFY;
                  END;
                UNTIL Fld.NEXT = 0;
            END;

          UNTIL ImportDefinitionLine.NEXT = 0;

      END;
    END;

    LOCAL PROCEDURE NewValueInArray@1100531007(VAR NodeNameArray@1100531000 : ARRAY [100] OF Text[1024];NodeName@1100531001 : Text[1024]) : Boolean;
    VAR
      i@1100531002 : Integer;
    BEGIN
      IF NodeName = '' THEN
        EXIT(FALSE);

      FOR i := 1 TO ARRAYLEN(NodeNameArray) DO
        CASE NodeNameArray[i] OF

          '' :
            BEGIN
              NodeNameArray[i] := NodeName;
              EXIT(TRUE);
            END;

          NodeName :
            EXIT(FALSE);
        END;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.

      16.01.2014 jhoek: At the time of this writing, the non-local functions in the codeunit are
                        ExportDef and ImportDef. ExportDef is called exclusively from the
                        ReversedDataMapping function in table 11148599 IN - Export Definition.
                        ImportDef is called exclusively from the ReversedDataMapping function
                        in table 11148591 IN - Import Definition. Since either ReversedDataMapping
                        function is called only from the OnAction triggers in Page objects, it is
                        safe to call gDoc.Create with ClientSide = true. See also CI-156 in JIRA.
    }
    END.
  }
}

OBJECT Codeunit 11148608 IN - Export Definitions
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    OnRun=VAR
            ExportDefinition@1000000 : Record 11148599;
          BEGIN
            ExportDefinition.SETRANGE(Status, ExportDefinition.Status::Edit);
            IF ExportDefinition.FINDSET THEN
              REPEAT
                ExportDefinition.Process;
              UNTIL ExportDefinition.NEXT = 0;
          END;

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148609 IN - Start Export XML File
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    TableNo=11148599;
    OnRun=BEGIN
            gExportXMLFile.RUN(Rec);
          END;

  }
  CODE
  {
    VAR
      gExportXMLFile@1000000 : Codeunit 11148614;

    PROCEDURE SetRecRef@1000002(VAR NewRecRef@1000000 : RecordRef;EntryNo@1100531000 : Integer);
    BEGIN
      gExportXMLFile.SetRecRef(NewRecRef, EntryNo);
    END;

    PROCEDURE SetxRecRef@1000020(VAR NewxRecRef@1000000 : RecordRef;EntryNo@1100531000 : Integer);
    BEGIN
      gExportXMLFile.SetxRecRef(NewxRecRef, EntryNo);
    END;

    PROCEDURE FillOutStream@1000016(VAR OutStr@1000000 : OutStream);
    BEGIN
      gExportXMLFile.FillOutStream(OutStr);
    END;

    PROCEDURE SetKeepDocumentOpen@1000017(NewValue@1000000 : Boolean);
    BEGIN
      gExportXMLFile.SetKeepDocumentOpen(NewValue);
    END;

    PROCEDURE SetTrigger@1000021(NewValue@1000000 : Text[1024]);
    BEGIN
      gExportXMLFile.SetTrigger(NewValue);
    END;

    PROCEDURE SetExportJobEntryNo@1000023(NewValue@1000000 : Integer);
    BEGIN
      gExportXMLFile.SetExportJobEntryNo(NewValue);
    END;

    PROCEDURE NoOfRecordsProcessed@1100531000() : Integer;
    BEGIN
      EXIT(gExportXMLFile.NoOfRecordsProcessed);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148610 IN - Start Export File
{
  OBJECT-PROPERTIES
  {
    Date=24-05-13;
    Time=13:00:00;
    Version List=IDYN-CE5.50.0;
  }
  PROPERTIES
  {
    TableNo=11148599;
    OnRun=VAR
            ConnectITWriter@1000000000 : Codeunit 11148617;
          BEGIN
            IF NOT ExportFile.RUN(Rec) THEN BEGIN
              ConnectITWriter.Close;
              ERROR(GETLASTERRORTEXT);
            END;
          END;

  }
  CODE
  {
    VAR
      ExportFile@1000000 : Codeunit 11148615;

    PROCEDURE SetRecRef@1000002(VAR NewRecRef@1000000 : RecordRef);
    BEGIN
      ExportFile.SetRecRef(NewRecRef);
    END;

    PROCEDURE SetxRecRef@1000020(VAR NewxRecRef@1000000 : RecordRef);
    BEGIN
      ExportFile.SetxRecRef(NewxRecRef);
    END;

    PROCEDURE SetTrigger@1000021(NewValue@1000000 : Text[1024]);
    BEGIN
      ExportFile.SetTrigger(NewValue);
    END;

    PROCEDURE SetExportJobEntryNo@1000023(NewValue@1000000 : Integer);
    BEGIN
      ExportFile.SetExportJobEntryNo(NewValue);
    END;

    PROCEDURE NoOfRecordsProcessed@1100531000() : Integer;
    BEGIN
      EXIT(ExportFile.NoOfRecordsProcessed);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148611 IN - XML Node
{
  OBJECT-PROPERTIES
  {
    Date=14-07-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.1;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      XMLNode@1000000000 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{2933BF80-7B36-11D2-B20E-00C04F983E60}:'Microsoft XML, v6.0'.IXMLDOMNode";
      XmlNodeOnRTC@1000000002 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode" RUNONCLIENT;
      XmlNodeOnNST@1000000003 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode";
      XmlNamespaceManagerOnRTC@1000000004 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNamespaceManager" RUNONCLIENT;
      XmlNamespaceManagerOnNST@1000000005 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNamespaceManager";
      Mode@1000000001 : 'Automation,DotNet on RTC,DotNet on NST';

    PROCEDURE GetAutomation@1000000000(VAR XMLNode2@1000000000 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{2933BF80-7B36-11D2-B20E-00C04F983E60}:'Microsoft XML, v6.0'.IXMLDOMNode");
    BEGIN
      XMLNode2 := XMLNode;
    END;

    PROCEDURE SetAutomation@1000000001(XMLNode2@1000000000 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{2933BF80-7B36-11D2-B20E-00C04F983E60}:'Microsoft XML, v6.0'.IXMLDOMNode");
    BEGIN
      XMLNode := XMLNode2;
      Mode := Mode::Automation;
    END;

    PROCEDURE GetDotNetOnRTC@1000000014(VAR XmlNode2@1000000000 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode" RUNONCLIENT);
    BEGIN
      XmlNode2 := XmlNodeOnRTC;
    END;

    PROCEDURE SetDotNetOnRTC@1000000015(XmlNode2@1000000000 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode" RUNONCLIENT);
    BEGIN
      XmlNodeOnRTC := XmlNode2;
      Mode := Mode::"DotNet on RTC";
    END;

    PROCEDURE GetDotNetOnNST@1000000016(VAR XmlNode2@1000000000 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode");
    BEGIN
      XmlNode2 := XmlNodeOnNST;
    END;

    PROCEDURE SetDotNetOnNST@1000000017(XmlNode2@1000000000 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode");
    BEGIN
      XmlNodeOnNST := XmlNode2;
      Mode := Mode::"DotNet on NST";
    END;

    PROCEDURE Clone@1000000011(VAR TargetNode@1000000001 : Codeunit 11148611);
    BEGIN
      CASE Mode OF
        Mode::Automation: TargetNode.SetAutomation(XMLNode);
        Mode::"DotNet on RTC": TargetNode.SetDotNetOnRTC(XmlNodeOnRTC);
        Mode::"DotNet on NST": TargetNode.SetDotNetOnNST(XmlNodeOnNST);
      END;
    END;

    PROCEDURE IsClear@1000000002() : Boolean;
    BEGIN
      CASE Mode OF
        Mode::Automation: EXIT(ISCLEAR(XMLNode));
        // CI-228.begin
        // Mode::"DotNet on RTC": EXIT(ISNULL(XmlNodeOnRTC));
        Mode::"DotNet on RTC": EXIT(FORMAT(XmlNodeOnRTC) = 'null');
        // Mode::"DotNet on NST": EXIT(ISNULL(XmlNodeOnNST));
        Mode::"DotNet on NST": EXIT(FORMAT(XmlNodeOnNST) = 'null');
        // CI-228
      END;
    END;

    PROCEDURE ChildNodes@1000000004(VAR XMLNodeList@1000000000 : Codeunit 11148612);
    BEGIN
      CASE Mode OF
        Mode::Automation: XMLNodeList.SetAutomation(XMLNode.childNodes);
        Mode::"DotNet on RTC": XMLNodeList.SetDotNetOnRTC(XmlNodeOnRTC.ChildNodes);
        Mode::"DotNet on NST": XMLNodeList.SetDotNetOnNST(XmlNodeOnNST.ChildNodes);
      END;
    END;

    PROCEDURE HasChildNodes@1000000003() : Boolean;
    BEGIN
      CASE Mode OF
        Mode::Automation: EXIT(XMLNode.hasChildNodes);
        Mode::"DotNet on RTC": EXIT(XmlNodeOnRTC.HasChildNodes);
        Mode::"DotNet on NST": EXIT(XmlNodeOnNST.HasChildNodes);
      END;
    END;

    PROCEDURE GetNodeTypeString@1000000005() : Text[1024];
    BEGIN
      CASE Mode OF
        Mode::Automation: EXIT(XMLNode.nodeTypeString);
        Mode::"DotNet on RTC": EXIT(NodeTypeStringFromNodeType(XmlNodeOnRTC.NodeType));
        Mode::"DotNet on NST": EXIT(NodeTypeStringFromNodeType(XmlNodeOnNST.NodeType));
      END;
    END;

    PROCEDURE SelectSingleNode@1000000006(Path@1000000000 : Text[1024];VAR Node@1000000001 : Codeunit 11148611);
    BEGIN
      CASE Mode OF
        Mode::Automation: Node.SetAutomation(XMLNode.selectSingleNode(Path));
        Mode::"DotNet on RTC":
          BEGIN
            CASE ISNULL(XmlNamespaceManagerOnRTC) OF
              TRUE: Node.SetDotNetOnRTC(XmlNodeOnRTC.SelectSingleNode(Path));
              FALSE: Node.SetDotNetOnRTC(XmlNodeOnRTC.SelectSingleNode(Path, XmlNamespaceManagerOnRTC));
            END;
          END;
        Mode::"DotNet on NST":
          BEGIN
            CASE ISNULL(XmlNamespaceManagerOnNST) OF
              TRUE: Node.SetDotNetOnNST(XmlNodeOnNST.SelectSingleNode(Path));
              FALSE: Node.SetDotNetOnNST(XmlNodeOnNST.SelectSingleNode(Path, XmlNamespaceManagerOnNST));
            END;
          END;
      END;
    END;

    PROCEDURE SelectNodes@1000000007(Path@1000000000 : Text[1024];VAR NodeList@1000000001 : Codeunit 11148612);
    BEGIN
      CASE Mode OF
        Mode::Automation: NodeList.SetAutomation(XMLNode.selectNodes(Path));
        Mode::"DotNet on RTC":
          BEGIN
            CASE ISNULL(XmlNamespaceManagerOnRTC) OF
              TRUE: NodeList.SetDotNetOnRTC(XmlNodeOnRTC.SelectNodes(Path));
              FALSE: NodeList.SetDotNetOnRTC(XmlNodeOnRTC.SelectNodes(Path, XmlNamespaceManagerOnRTC));
            END;
          END;
        Mode::"DotNet on NST":
          BEGIN
            CASE ISNULL(XmlNamespaceManagerOnNST) OF
              TRUE: NodeList.SetDotNetOnNST(XmlNodeOnNST.SelectNodes(Path));
              FALSE: NodeList.SetDotNetOnNST(XmlNodeOnNST.SelectNodes(Path, XmlNamespaceManagerOnNST));
            END;
          END;
      END;
    END;

    PROCEDURE Attributes@1000000008(VAR XMLNamedNodeMap@1000000000 : Codeunit 11148649);
    BEGIN
      CASE Mode OF
        Mode::Automation: XMLNamedNodeMap.SetAutomation(XMLNode.attributes);
        Mode::"DotNet on RTC": XMLNamedNodeMap.SetDotNetOnRTC(XmlNodeOnRTC.Attributes);
        Mode::"DotNet on NST": XMLNamedNodeMap.SetDotNetOnNST(XmlNodeOnNST.Attributes);
      END;
    END;

    PROCEDURE GetNodeName@1000000009() : Text[1024];
    BEGIN
      CASE Mode OF
        Mode::Automation: EXIT(XMLNode.nodeName);
        Mode::"DotNet on RTC": EXIT(XmlNodeOnRTC.Name);
        Mode::"DotNet on NST": EXIT(XmlNodeOnNST.Name);
      END;
    END;

    PROCEDURE GetText@1000000010() : Text[1024];
    BEGIN
      CASE Mode OF
        Mode::Automation: EXIT(XMLNode.text);
        Mode::"DotNet on RTC": EXIT(XmlNodeOnRTC.InnerText);
        Mode::"DotNet on NST": EXIT(XmlNodeOnNST.InnerText);
      END;
    END;

    PROCEDURE SetText@1000000012(Text@1000000000 : Text[1024]);
    BEGIN
      CASE Mode OF
        Mode::Automation: XMLNode.text := Text;
        Mode::"DotNet on RTC": XmlNodeOnRTC.InnerText := Text;
        Mode::"DotNet on NST": XmlNodeOnNST.InnerText := Text;
      END;
    END;

    PROCEDURE AppendChild@1000000013(VAR ChildNode@1000000000 : Codeunit 11148611);
    VAR
      XMLDOMNode@1000000001 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{2933BF80-7B36-11D2-B20E-00C04F983E60}:'Microsoft XML, v6.0'.IXMLDOMNode";
      XmlDomNodeOnRTC@1000000002 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode" RUNONCLIENT;
      XmlDomNodeOnNST@1000000003 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode";
    BEGIN
      CASE Mode OF
        Mode::Automation:
          BEGIN
            ChildNode.GetAutomation(XMLDOMNode);
            XMLNode.appendChild(XMLDOMNode);
          END;
        Mode::"DotNet on RTC":
          BEGIN
            ChildNode.GetDotNetOnRTC(XmlDomNodeOnRTC);
            XmlNodeOnRTC.AppendChild(XmlDomNodeOnRTC);
          END;
        Mode::"DotNet on NST":
          BEGIN
            ChildNode.GetDotNetOnNST(XmlDomNodeOnNST);
            XmlNodeOnNST.AppendChild(XmlDomNodeOnNST);
          END;
      END;
    END;

    LOCAL PROCEDURE NodeTypeStringFromNodeType@1000000018(NodeType@1000000000 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNodeType") : Text[1024];
    BEGIN
      EXIT(LOWERCASE(NodeType.ToString));
    END;

    PROCEDURE GetMode@1000000019() : Integer;
    BEGIN
      EXIT(Mode);
    END;

    PROCEDURE AddSelectionNamespace@1000000020(NamespacePrefix@1000000000 : Text[30];NamespaceURI@1000000001 : Text[30]);
    VAR
      XmlDocumentOnRTC@1000 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlDocument" RUNONCLIENT;
      XmlDocumentOnNST@1001 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlDocument";
    BEGIN
      // CI-140
      CASE Mode OF
        Mode::"DotNet on RTC":
          BEGIN
            IF ISNULL(XmlNamespaceManagerOnRTC) THEN BEGIN
              CASE GetNodeTypeString = 'document' OF
                TRUE: XmlDocumentOnRTC := XmlNodeOnRTC;
                FALSE: XmlDocumentOnRTC := XmlNodeOnRTC.OwnerDocument;
              END;

              XmlNamespaceManagerOnRTC := XmlNamespaceManagerOnRTC.XmlNamespaceManager(XmlDocumentOnRTC.NameTable);
            END;

            XmlNamespaceManagerOnRTC.AddNamespace(NamespacePrefix, NamespaceURI);
          END;
        Mode::"DotNet on NST":
          BEGIN
            IF ISNULL(XmlNamespaceManagerOnNST) THEN BEGIN
              CASE GetNodeTypeString = 'document' OF
                TRUE: XmlDocumentOnNST := XmlNodeOnNST;
                FALSE: XmlDocumentOnNST := XmlNodeOnNST.OwnerDocument;
              END;

              XmlNamespaceManagerOnNST := XmlNamespaceManagerOnNST.XmlNamespaceManager(XmlDocumentOnNST.NameTable);
            END;

            XmlNamespaceManagerOnNST.AddNamespace(NamespacePrefix, NamespaceURI);
          END;
      END;
    END;

    PROCEDURE ResetSelectionNamespaces@1000000021();
    BEGIN
      // CI-140
      CASE Mode OF
        Mode::"DotNet on RTC": CLEAR(XmlNamespaceManagerOnRTC);
        Mode::"DotNet on NST": CLEAR(XmlNamespaceManagerOnNST);
      END;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148612 IN - XML Node List
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      XMLNodeList@1000000000 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{2933BF82-7B36-11D2-B20E-00C04F983E60}:'Microsoft XML, v6.0'.IXMLDOMNodeList";
      XmlNodeListOnRTC@1000000001 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNodeList" RUNONCLIENT;
      XmlNodeListOnNST@1000000002 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNodeList";
      IEnumeratorOnRTC@1000000004 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Collections.IEnumerator" RUNONCLIENT;
      IEnumeratorOnNST@1000000005 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Collections.IEnumerator";
      Mode@1000000003 : 'Automation,DotNet on NST,DotNet on RTC';

    PROCEDURE GetAutomation@1000000000(VAR XMLNodeList2@1000000000 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{2933BF82-7B36-11D2-B20E-00C04F983E60}:'Microsoft XML, v6.0'.IXMLDOMNodeList");
    BEGIN
      XMLNodeList2 := XMLNodeList;
    END;

    PROCEDURE SetAutomation@1000000001(XMLNodeList2@1000000000 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{2933BF82-7B36-11D2-B20E-00C04F983E60}:'Microsoft XML, v6.0'.IXMLDOMNodeList");
    BEGIN
      XMLNodeList := XMLNodeList2;
      Mode := Mode::Automation;
    END;

    PROCEDURE GetDotNetOnRTC@1000000012(VAR XmlNodeList2@1000000000 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNodeList");
    BEGIN
      XmlNodeList2 := XmlNodeListOnRTC;
    END;

    PROCEDURE SetDotNetOnRTC@1000000013(XmlNodeList2@1000000000 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNodeList");
    BEGIN
      XmlNodeListOnRTC := XmlNodeList2;
      Mode := Mode::"DotNet on RTC";
    END;

    PROCEDURE GetDotNetOnNST@1000000014(VAR XmlNodeList2@1000000000 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNodeList");
    BEGIN
      XmlNodeList2 := XmlNodeListOnNST;
    END;

    PROCEDURE SetDotNetOnNST@1000000015(XmlNodeList2@1000000000 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNodeList");
    BEGIN
      XmlNodeListOnNST := XmlNodeList2;
      Mode := Mode::"DotNet on NST";
    END;

    PROCEDURE IsClear@1000000006() : Boolean;
    BEGIN
      CASE Mode OF
        Mode::Automation: EXIT(ISCLEAR(XMLNodeList));
        Mode::"DotNet on RTC": EXIT(ISNULL(XmlNodeListOnRTC));
        Mode::"DotNet on NST": EXIT(ISNULL(XmlNodeListOnNST));
      END;
    END;

    PROCEDURE GetItem@1000000002(Index@1000000001 : Integer;VAR XMLNode@1000000000 : Codeunit 11148611);
    BEGIN
      CASE Mode OF
        Mode::Automation: XMLNode.SetAutomation(XMLNodeList.item(Index));
        Mode::"DotNet on RTC": XMLNode.SetDotNetOnRTC(XmlNodeListOnRTC.Item(Index));
        Mode::"DotNet on NST": XMLNode.SetDotNetOnNST(XmlNodeListOnNST.Item(Index));
      END;
    END;

    PROCEDURE GetLength@1000000003() : Integer;
    BEGIN
      CASE Mode OF
        Mode::Automation: EXIT(XMLNodeList.length);
        Mode::"DotNet on RTC": EXIT(XmlNodeListOnRTC.Count);
        Mode::"DotNet on NST": EXIT(XmlNodeListOnNST.Count);
      END;
    END;

    PROCEDURE NextNode@1000000004(VAR XMLNode@1000000000 : Codeunit 11148611);
    BEGIN
      CASE Mode OF
        Mode::Automation:
          XMLNode.SetAutomation(XMLNodeList.nextNode);
        Mode::"DotNet on RTC":
          BEGIN
            IF ISNULL(IEnumeratorOnRTC) THEN
              Reset;
            IEnumeratorOnRTC.MoveNext;
            XMLNode.SetDotNetOnRTC(IEnumeratorOnRTC.Current);
          END;
        Mode::"DotNet on NST":
          BEGIN
            IF ISNULL(IEnumeratorOnNST) THEN
              Reset;
            IEnumeratorOnNST.MoveNext;
            XMLNode.SetDotNetOnNST(IEnumeratorOnNST.Current);
          END;
      END;
    END;

    PROCEDURE Reset@1000000005();
    BEGIN
      CASE Mode OF
        Mode::Automation: XMLNodeList.reset;
        Mode::"DotNet on RTC": IEnumeratorOnRTC := XmlNodeListOnRTC.GetEnumerator;
        Mode::"DotNet on NST": IEnumeratorOnNST := XmlNodeListOnNST.GetEnumerator;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148613 IN - Start Export ADO
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    TableNo=11148599;
    OnRun=BEGIN
            gExportADO.RUN(Rec);
          END;

  }
  CODE
  {
    VAR
      gExportADO@1000000 : Codeunit 11148618;

    PROCEDURE SetRecRef@1000002(VAR NewRecRef@1000000 : RecordRef);
    BEGIN
      gExportADO.SetRecRef(NewRecRef);
    END;

    PROCEDURE SetxRecRef@1000020(VAR NewxRecRef@1000000 : RecordRef);
    BEGIN
      gExportADO.SetxRecRef(NewxRecRef);
    END;

    PROCEDURE SetTrigger@1000021(NewValue@1000000 : Text[1024]);
    BEGIN
      gExportADO.SetTrigger(NewValue);
    END;

    PROCEDURE NoOfRecordsProcessed@1100531000() : Integer;
    BEGIN
      EXIT(gExportADO.NoOfRecordsProcessed);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148614 IN - Export XML File
{
  OBJECT-PROPERTIES
  {
    Date=14-07-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.1;
  }
  PROPERTIES
  {
    TableNo=11148599;
    OnRun=VAR
            Task@1000002 : Record 11148614;
            Project@1000001 : Record 11148620;
            RootNode@1000009 : Codeunit 11148611;
            TooManyRootElements@1000018 : TextConst 'ENU=Only one root element allowed.;NLD=Er mag maar een hoofdelement aanwezig zijn.';
            RecRef@1000000000 : RecordRef;
            ExportDefMgt@1000000001 : Codeunit 11148605;
            VariableMgt@1000000002 : Codeunit 11148619;
            CommentMgt@1000000003 : Codeunit 11148622;
          BEGIN
            ExportDef := Rec;

            TESTFIELD("File Format", "File Format"::XML);
            IF Status = Status::Blocked THEN
              FIELDERROR(Status);

            IF FromWebService THEN
              TESTFIELD(Status, Status::"Web Service");

            CommentMgt.ResetError;

            FirstTableLineNo := 0;
            FillBuffers(Rec);

            ExportDefLineTemp.SETCURRENTKEY("Export Definition", "Line No.");
            ExportDefLineTemp.SETRANGE("Export Definition", Code);
            ExportDefLineTemp.SETRANGE(Indent, 0);
            IF ExportDefLineTemp.COUNT > 1 THEN
              ERROR(TooManyRootElements);

            InitOneFilePerRecordLoop;
            WHILE OneFilePerRecordLoop DO BEGIN

              ExportDefLineTemp.RESET;
              ExportDefLineTemp.SETCURRENTKEY("Export Definition", "Line No.");
              ExportDefLineTemp.SETRANGE("Export Definition", Code);
              ExportDefLineTemp.SETRANGE(Indent, 0);
              ExportDefLineTemp.FINDFIRST;
              ExportDefLineTemp.TESTFIELD("Tag Name");

              CreateDoc(RootNode);

              IF (STRPOS(LOWERCASE(Location + Filename2), '#entryno#') > 0) OR
                 ("Filename Type" = "Filename Type"::"Entry No.")
              THEN BEGIN
                "Export Entry No." += 1;
                MODIFY;
                ExportDef := Rec;
              END;

              IF (STRPOS(LOWERCASE(Location + Filename2), '#pentryno#') > 0) OR
                 ("Filename Type" = "Filename Type"::"Project Entry No.")
              THEN BEGIN
                TESTFIELD("Project Code");
                Project.GET("Project Code");
                Project."Export Entry No." += 1;
                Project.MODIFY;
              END;

              IF Filename2 = '' THEN BEGIN
                RecRef.GETTABLE(Rec);
                ExportDefMgt.CreateFilename(ExportDef, RecRef, Path, Filename2, Trigger, ExportJobEntryNo);
              END;

              VariableMgt.SetVariable('#FILENAME#', Path + Filename2);
              VariableMgt.SetVariable('#PATH#', Path);
              VariableMgt.SetVariable('#DEF_CODE#', ExportDef.Code);
              VariableMgt.SetVariable('#DEF_DESCRIPTION#', ExportDef.Description);

              IF ExportDefLineTemp.Type = ExportDefLineTemp.Type::Table THEN BEGIN
                ExportDefLineTemp."Tag Name" := '';
                ProcessLine(ExportDefLineTemp, RootNode);
              END ELSE BEGIN
                ExportDefLineTemp.SETRANGE(Indent, 1);

                IF ExportDefLineTemp.FINDSET THEN
                  REPEAT
                    ProcessLine(ExportDefLineTemp, RootNode);
                  UNTIL ExportDefLineTemp.NEXT = 0;
              END;

              SaveDoc;

              IF Synchronize THEN
                DoSynchronize(Rec);

              IF NOT KeepDocumentOpen THEN
                CLEAR(XmlDoc);

            END;

            IF "Run Task" <> '' THEN BEGIN
              Task.GET("Run Task");
              Task.Process;
            END;
          END;

  }
  CODE
  {
    VAR
      ExportDef@1000004 : Record 11148599;
      ExportDefLineTemp@1000005 : TEMPORARY Record 11148600;
      ExportDefLineTemp2@1000006 : TEMPORARY Record 11148600;
      ExportDefTableLinkTemp@1000008 : TEMPORARY Record 11148601;
      ExportDefFunctionTemp@1100531001 : TEMPORARY Record 11148602;
      ExportValueProcessing@1000000001 : Codeunit 11148616;
      XmlDoc@1000009 : Codeunit 11148637;
      RecRef@1000000 : ARRAY [100] OF RecordRef;
      RecRefOneFilePerRecord@1000012 : RecordRef;
      Filename2@1000002 : Text[1024];
      Path@1000011 : Text[1024];
      Trigger@1000017 : Text[30];
      FirstTableEntryNo@1000013 : Integer;
      FirstTableLineNo@1000007 : Integer;
      ExportJobEntryNo@1000019 : Integer;
      RecordsProcessed@1100531000 : Integer;
      OneFilePerRecordCounter@1000010 : Integer;
      FromConnector@1000018 : Boolean;
      KeepDocumentOpen@1000014 : Boolean;
      RecRefSet@1000001 : Boolean;
      xRecRefSet@1000015 : Boolean;
      NoOfRecRefSet@1100531003 : Integer;
      NoOfxRecRefSet@1100531007 : Integer;
      RecRefSetEntryNo@1100531004 : ARRAY [100] OF Integer;
      xRecRefSetEntryNo@1100531006 : ARRAY [100] OF Integer;
      SettedRecRef@1100531002 : ARRAY [100] OF RecordRef;
      SettedxRecRef@1100531005 : ARRAY [100] OF RecordRef;
      RecRefPerIndent@1100531008 : ARRAY [100] OF RecordRef;
      FromWebService@1000000000 : Boolean;

    LOCAL PROCEDURE InitOneFilePerRecordLoop@1000018();
    BEGIN
      OneFilePerRecordCounter := 0;

      IF NOT ExportDef."One File per Record" THEN
        EXIT;

      ExportDefLineTemp2.RESET;
      ExportDefLineTemp2.SETCURRENTKEY("Export Definition", "Line No.");
      ExportDefLineTemp2.SETRANGE("Export Definition", ExportDef.Code);
      ExportDefLineTemp2.SETRANGE(Type, ExportDefLineTemp2.Type::Table);
      IF ExportDefLineTemp2.FINDFIRST THEN BEGIN

        FirstTableEntryNo := ExportDefLineTemp2."Entry No.";

        IF NOT SetRecRefOnEntryNo(RecRefOneFilePerRecord, ExportDefLineTemp2."Entry No.") THEN
          IF ExportDef."Company Name" = '' THEN
            RecRefOneFilePerRecord.OPEN(ExportDefLineTemp2."Table No.")
          ELSE
            RecRefOneFilePerRecord.OPEN(ExportDefLineTemp2."Table No.", FALSE, ExportDef."Company Name");

        SetFiltersOnRecRef(ExportDefLineTemp2, RecRefOneFilePerRecord);
      END;
    END;

    LOCAL PROCEDURE OneFilePerRecordLoop@1000011() ExitValue : Boolean;
    VAR
      lRecRef@1000000 : RecordRef;
      i@1100531000 : Integer;
      RecRefPresent@1100531001 : Boolean;
    BEGIN
      OneFilePerRecordCounter += 1;
      IF NOT ExportDef."One File per Record" THEN
        EXIT(OneFilePerRecordCounter = 1);

      IF OneFilePerRecordCounter = 1 THEN
        ExitValue := RecRefOneFilePerRecord.FINDFIRST
      ELSE
        ExitValue := RecRefOneFilePerRecord.NEXT <> 0;

      lRecRef := RecRefOneFilePerRecord.DUPLICATE;
      lRecRef.FILTERGROUP(2);
      lRecRef.SETRECFILTER;
      lRecRef.FILTERGROUP(0);

      FOR i := 1 TO NoOfRecRefSet DO
        IF RecRefSetEntryNo[i] = FirstTableEntryNo THEN BEGIN
          SettedRecRef[i] := lRecRef;
          RecRefPresent := TRUE;
        END;

      IF NOT RecRefPresent THEN
        SetRecRef(lRecRef, FirstTableEntryNo);
    END;

    LOCAL PROCEDURE FillBuffers@1000010(VAR ExportDefinition@1000002 : Record 11148599);
    VAR
      ExportDefLine@1000004 : Record 11148600;
      ExportDefTableLink@1000003 : Record 11148601;
      ExportDefFunction@1100531000 : Record 11148602;
    BEGIN
      ExportDefLineTemp.RESET;
      ExportDefLineTemp.DELETEALL;

      ExportDefLineTemp2.RESET;
      ExportDefLineTemp2.DELETEALL;

      ExportDefTableLinkTemp.RESET;
      ExportDefTableLinkTemp.DELETEALL;

      ExportDefFunctionTemp.RESET;
      ExportDefFunctionTemp.DELETEALL;

      ExportDefLine.SETRANGE("Export Definition", ExportDefinition.Code);
      ExportDefLine.SETFILTER(Type, '<>%1', ExportDefLine.Type::" ");
      IF ExportDefLine.FINDSET THEN
        REPEAT
          ExportDefLineTemp := ExportDefLine;
          ExportDefLineTemp.Functions := FALSE;
          ExportDefLineTemp.INSERT;

          ExportDefLineTemp2 := ExportDefLine;
          ExportDefLineTemp2.Functions := FALSE;
          ExportDefLineTemp2.INSERT;

        UNTIL ExportDefLine.NEXT = 0;

      ExportDefTableLink.SETRANGE("Export Definition", ExportDefinition.Code);
      IF ExportDefTableLink.FINDSET THEN
        REPEAT
          ExportDefTableLinkTemp := ExportDefTableLink;
          ExportDefTableLinkTemp.INSERT;
        UNTIL ExportDefTableLink.NEXT = 0;

      ExportDefFunction.SETRANGE("Export Definition", ExportDefinition.Code);
      IF ExportDefFunction.FINDSET THEN
        REPEAT

          IF ExportDefLineTemp.GET(ExportDefFunction."Export Definition", ExportDefFunction."Export Def. Entry No.") THEN BEGIN
            ExportDefLineTemp.Functions := TRUE;
            ExportDefLineTemp.MODIFY;
            ExportDefLineTemp2.GET(ExportDefFunction."Export Definition", ExportDefFunction."Export Def. Entry No.");
            ExportDefLineTemp2.Functions := TRUE;
            ExportDefLineTemp2.MODIFY;
          END;

          ExportDefFunctionTemp := ExportDefFunction;
          ExportDefFunctionTemp.INSERT;
        UNTIL ExportDefFunction.NEXT = 0;
    END;

    LOCAL PROCEDURE ProcessLine@1000008(VAR ExportDefLine@1000000 : Record 11148600;VAR ParentNode@1000002 : Codeunit 11148611);
    BEGIN
      WITH ExportDefLine DO
        CASE Type OF

          Type::Tag :
            ProcessTagLine(ExportDefLine, ParentNode);

          Type::Table :
            ProcessTableLine(ExportDefLine, ParentNode);

          Type::Field :
            ProcessFieldLine(ExportDefLine, ParentNode);

          Type::Const :
            ProcessConstLine(ExportDefLine, ParentNode);

          Type::Variable :
            ProcessVariableLine(ExportDefLine, ParentNode);

        END;
    END;

    LOCAL PROCEDURE ProcessTagLine@1000005(VAR ExportDefLine@1000000 : Record 11148600;VAR ParentNode@1000001 : Codeunit 11148611);
    VAR
      TmpExportDefLine@1000003 : TEMPORARY Record 11148600;
      SubNode@1000000000 : Codeunit 11148611;
    BEGIN
      IF ExportDefLine."Tag Name" = '' THEN
        ParentNode.Clone(SubNode)
      ELSE
        AddElement(ParentNode, ExportDefLine."Tag Name", '',
                   ExportDefLine."XML Namespace", ExportDefLine."XML Namespace Prefix", SubNode);

      GetChildLines(ExportDefLine, TmpExportDefLine);
      IF TmpExportDefLine.FINDSET THEN
        REPEAT
          ProcessLine(TmpExportDefLine, SubNode);
        UNTIL TmpExportDefLine.NEXT = 0;
    END;

    LOCAL PROCEDURE ProcessTableLine@1000006(VAR ExportDefLine@1000000 : Record 11148600;VAR ParentNode@1000001 : Codeunit 11148611);
    VAR
      TmpExportDefLine@1000011 : TEMPORARY Record 11148600;
      Object@1100531001 : Record 2000000001;
      SubNode@1000002 : Codeunit 11148611;
      RecRef@1000003 : RecordRef;
      ExportDefMgt@1000004 : Codeunit 11148605;
      Progressbar@1000007 : Codeunit 11148624;
      FirstTableLine@1000006 : Boolean;
    BEGIN
      IF NOT SetRecRefOnEntryNo(RecRef, ExportDefLine."Entry No.") THEN
        IF ExportDef."Company Name" = '' THEN
          RecRef.OPEN(ExportDefLine."Table No.")
        ELSE
          RecRef.OPEN(ExportDefLine."Table No.", FALSE, ExportDef."Company Name");

      IF FirstTableLineNo = 0 THEN
        FirstTableLineNo := ExportDefLine."Line No.";
      FirstTableLine := FirstTableLineNo = ExportDefLine."Line No.";

      GetChildLines(ExportDefLine, TmpExportDefLine);

      SetFiltersOnRecRef(ExportDefLine, RecRef);

      IF FirstTableLine THEN BEGIN
        RecordsProcessed := RecRef.COUNT;
        Progressbar.InitializeBar(1, RecordsProcessed);
      END;

      IF RecRef.FINDSET THEN
        REPEAT

          IF FirstTableLine THEN
            Progressbar.AddRecordCounter(1, 1, FORMAT(RecRef.RECORDID));

          RecRefPerIndent[ExportDefLine.Indent + 1] := RecRef.DUPLICATE;

          IF ExportDefLine."Tag Name" = '' THEN
            ParentNode.Clone(SubNode)
          ELSE
            IF NOT ExportDefLine.Skip THEN // CI-214
              AddElement(ParentNode, ExportDefLine."Tag Name", '',
                         ExportDefLine."XML Namespace", ExportDefLine."XML Namespace Prefix", SubNode);

          IF TmpExportDefLine.FINDSET THEN
            REPEAT
              ProcessLine(TmpExportDefLine, SubNode);
            UNTIL TmpExportDefLine.NEXT = 0;

        UNTIL RecRef.NEXT = 0;

      IF FirstTableLine THEN BEGIN
        IF RecRef.FINDSET THEN
          ;
        IF (ExportDef.Filename <> '') OR (ExportDef."Filename Type" <> ExportDef."Filename Type"::Key) THEN
          ExportDefMgt.CreateFilename(ExportDef, RecRef, Path, Filename2, Trigger, ExportJobEntryNo);
      END;
    END;

    LOCAL PROCEDURE ProcessFieldLine@1000007(VAR ExportDefLine@1000000 : Record 11148600;VAR ParentNode@1000001 : Codeunit 11148611);
    VAR
      VariableMgt@1000004 : Codeunit 11148619;
      SubNode@1000002 : Codeunit 11148611;
      TmpExportDefLine@1000003 : TEMPORARY Record 11148600;
      RecRef@1000005 : RecordRef;
      FldRef@1000006 : FieldRef;
      FieldValue@1000008 : Text[1024];
      ValidxRecRef@1100531000 : Boolean;
      NumberVal@1000000000 : Decimal;
      DateVal@1000000002 : Date;
      TimeVal@1000000003 : Time;
      DateTimeVal@1000000004 : DateTime;
    BEGIN
      ExportDefLineTemp2.RESET;
      ExportDefLineTemp2.SETCURRENTKEY("Export Definition", "Line No.");
      ExportDefLineTemp2.SETRANGE("Export Definition", ExportDefLine."Export Definition");
      ExportDefLineTemp2.SETFILTER("Line No.", '<%1', ExportDefLine."Line No.");
      ExportDefLineTemp2.SETRANGE(Type, ExportDefLineTemp2.Type::Table);
      ExportDefLineTemp2.SETRANGE("Table No.", ExportDefLine."Table No.");
      ExportDefLineTemp2.SETFILTER(Indent, '<=%1', ExportDefLine.Indent);
      ExportDefLineTemp2.FINDLAST;

      IF ExportDefLine."Original Value" AND xRecRefSet THEN
        IF SetxRecRefOnEntryNo(RecRef, ExportDefLineTemp2."Entry No.") THEN
          ValidxRecRef := TRUE;

      IF NOT ValidxRecRef THEN
        RecRef := RecRefPerIndent[ExportDefLineTemp2.Indent + 1].DUPLICATE;

      ExportDefLine.TESTFIELD("Field No.");
      FldRef := RecRef.FIELD(ExportDefLine."Field No.");

      IF NOT (UPPERCASE(FORMAT(FldRef.TYPE)) IN ['BLOB', 'BINARY']) THEN BEGIN
        FieldValue := ConvertFieldValue(RecRef, FldRef, ExportDefLine, FALSE);
        IF ExportDefLine."As Attribute" THEN BEGIN
          IF (FORMAT(FieldValue) <> '') OR NOT ExportDefLine."Skip If Empty" THEN
            IF NOT ExportDefLine.Skip THEN
              AddAttribute(ParentNode, ExportDefLine."Tag Name", FieldValue);
        END ELSE
          IF (FORMAT(FieldValue) <> '') OR NOT ExportDefLine."Skip If Empty" THEN
            IF NOT ExportDefLine.Skip THEN
              AddElement(
                ParentNode, ExportDefLine."Tag Name", FieldValue,
                ExportDefLine."XML Namespace", ExportDefLine."XML Namespace Prefix", SubNode);

        IF ExportDefLine."Dest. Variable" <> '' THEN
          VariableMgt.SetVariable(ExportDefLine."Dest. Variable", FieldValue);
      END;

      GetChildLines(ExportDefLine, TmpExportDefLine);
      IF TmpExportDefLine.FINDSET THEN
        REPEAT
          ProcessLine(TmpExportDefLine, SubNode);
        UNTIL TmpExportDefLine.NEXT = 0;
    END;

    LOCAL PROCEDURE ProcessConstLine@1000009(VAR ExportDefLine@1000000 : Record 11148600;VAR ParentNode@1000001 : Codeunit 11148611);
    VAR
      SubNode@1000002 : Codeunit 11148611;
      VariableMgt@1000004 : Codeunit 11148619;
      TmpExportDefLine@1000003 : TEMPORARY Record 11148600;
      Value@1000000000 : Text[1024];
    BEGIN
      Value := ExportValueProcessing.PostProcessValue(ExportDefLine, ExportDefLine.Code);
      IF NOT ExportDefLine.Skip THEN BEGIN
        IF ExportDefLine."As Attribute" THEN
          AddAttribute(ParentNode, ExportDefLine."Tag Name", Value)
        ELSE
          AddElement(ParentNode, ExportDefLine."Tag Name", Value,
                     ExportDefLine."XML Namespace", ExportDefLine."XML Namespace Prefix", SubNode);
      END;
      IF ExportDefLine."Dest. Variable" <> '' THEN
        VariableMgt.SetVariable(ExportDefLine."Dest. Variable", Value);

      GetChildLines(ExportDefLine, TmpExportDefLine);
      IF TmpExportDefLine.FINDSET THEN
        REPEAT
          ProcessLine(TmpExportDefLine, SubNode);
        UNTIL TmpExportDefLine.NEXT = 0;
    END;

    LOCAL PROCEDURE ProcessVariableLine@1000012(VAR ExportDefLine@1000000 : Record 11148600;VAR ParentNode@1000001 : Codeunit 11148611);
    VAR
      SubNode@1000002 : Codeunit 11148611;
      TmpExportDefLine@1000003 : TEMPORARY Record 11148600;
      VariableMgt@1000004 : Codeunit 11148619;
      Value@1000000000 : Text[1024];
    BEGIN
      Value := ExportValueProcessing.PostProcessValue(ExportDefLine, VariableMgt.GetVariable(ExportDefLine.Code));
      IF NOT ExportDefLine.Skip THEN BEGIN
        IF ExportDefLine."As Attribute" THEN BEGIN
          IF (FORMAT(Value) <> '') OR NOT ExportDefLine."Skip If Empty" THEN
            AddAttribute(ParentNode, ExportDefLine."Tag Name", Value)
        END ELSE BEGIN
          IF (FORMAT(Value) <> '') OR NOT ExportDefLine."Skip If Empty" THEN
            AddElement(ParentNode, ExportDefLine."Tag Name", Value,
                     ExportDefLine."XML Namespace", ExportDefLine."XML Namespace Prefix", SubNode);
        END;
      END;
      IF ExportDefLine."Dest. Variable" <> '' THEN
        VariableMgt.SetVariable(ExportDefLine."Dest. Variable", Value);

      GetChildLines(ExportDefLine, TmpExportDefLine);
      IF TmpExportDefLine.FINDSET THEN
        REPEAT
          ProcessLine(TmpExportDefLine, SubNode);
        UNTIL TmpExportDefLine.NEXT = 0;
    END;

    LOCAL PROCEDURE GetChildLines@1000004(VAR ExportDefLine@1000001 : Record 11148600;VAR ExportDefChildLine@1000000 : Record 11148600);
    VAR
      StopLoop@1000002 : Boolean;
    BEGIN
      ExportDefLineTemp2.RESET;
      ExportDefLineTemp2.SETCURRENTKEY("Export Definition", "Line No.");
      ExportDefLineTemp2.SETRANGE("Export Definition", ExportDefLine."Export Definition");
      ExportDefLineTemp2.SETFILTER("Line No.", '>%1', ExportDefLine."Line No.");
      IF ExportDefLineTemp2.FINDSET THEN
        REPEAT
          IF ExportDefLineTemp2.Indent = ExportDefLine.Indent + 1 THEN BEGIN
            // CI-214
            // If ExportDefLine is skipped, all of its children should also
            // be skipped (otherwise, the corresponding elements would end
            // up under their grandparent element)
            IF ExportDefLine.Skip THEN
              ExportDefLineTemp2.TESTFIELD(Skip, TRUE);
            // CI-214
            ExportDefChildLine := ExportDefLineTemp2;
            ExportDefChildLine.INSERT;
          END;

          IF ExportDefLineTemp2.Indent <= ExportDefLine.Indent THEN
            StopLoop := TRUE;

          IF ExportDefLineTemp2.NEXT = 0 THEN
            StopLoop := TRUE;

          IF ExportDefLineTemp2.Indent <= ExportDefLine.Indent THEN
            StopLoop := TRUE;

        UNTIL StopLoop;

      ExportDefChildLine.SETCURRENTKEY("Export Definition", "Line No.");
    END;

    LOCAL PROCEDURE SetFiltersOnRecRef@1000015(VAR ExportDefLine@1000002 : Record 11148600;VAR RecRef@1000001 : RecordRef);
    VAR
      Mgt@1000000 : Codeunit 11148589;
      MainRecRef@1000003 : RecordRef;
      MainFldRef@1000005 : FieldRef;
      ThisFldRef@1000004 : FieldRef;
      VariableMgt@1000006 : Codeunit 11148619;
    BEGIN
      Mgt.SetFilterOnRecordRef(RecRef, FORMAT(ExportDefLine."Table Filter"));

      IF ExportDefLine."Link to Table (Tag Name)" <> '' THEN BEGIN

        ExportDefLineTemp2.RESET;
        ExportDefLineTemp2.SETCURRENTKEY("Export Definition", "Line No.");
        ExportDefLineTemp2.SETRANGE("Export Definition", ExportDefLine."Export Definition");
        ExportDefLineTemp2.SETFILTER("Line No.", '<%1', ExportDefLine."Line No.");
        ExportDefLineTemp2.SETRANGE("Tag Name", ExportDefLine."Link to Table (Tag Name)");
        ExportDefLineTemp2.SETRANGE(Type, ExportDefLineTemp2.Type::Table);
        ExportDefLineTemp2.FINDLAST;
        MainRecRef := RecRefPerIndent[ExportDefLineTemp2.Indent + 1].DUPLICATE;

        ExportDefTableLinkTemp.SETRANGE("Export Definition", ExportDefLine."Export Definition");
        ExportDefTableLinkTemp.SETRANGE("Export Def. Entry No.", ExportDefLine."Entry No.");
        ExportDefTableLinkTemp.SETFILTER(Variable, '%1', '');
        IF ExportDefTableLinkTemp.FINDSET THEN
          REPEAT
            MainFldRef := MainRecRef.FIELD(ExportDefTableLinkTemp."Main Field No.");
            ThisFldRef := RecRef.FIELD(ExportDefTableLinkTemp."Sub Field No.");
            ThisFldRef.SETRANGE := MainFldRef.VALUE;
          UNTIL ExportDefTableLinkTemp.NEXT = 0;
      END;

      ExportDefTableLinkTemp.SETRANGE("Export Definition", ExportDefLine."Export Definition");
      ExportDefTableLinkTemp.SETRANGE("Export Def. Entry No.", ExportDefLine."Entry No.");
      ExportDefTableLinkTemp.SETFILTER(Variable, '<>%1', '');
      IF ExportDefTableLinkTemp.FINDSET THEN
        REPEAT
          ThisFldRef := RecRef.FIELD(ExportDefTableLinkTemp."Main Field No.");
          ThisFldRef.SETFILTER := VariableMgt.GetVariable(ExportDefTableLinkTemp.Variable);
        UNTIL ExportDefTableLinkTemp.NEXT = 0;
    END;

    LOCAL PROCEDURE AddRootElement@1000001(VAR Doc@1000001 : Codeunit 11148637;Name@1002 : Text[250];XMLNamespace@1000000000 : Text[50];XMLNamespacePrefix@1000000001 : Text[30];VAR CreatedXMLNode@1005 : Codeunit 11148611);
    BEGIN
      IF (XMLNamespacePrefix = '') THEN
        Doc.CreateNode(1, Name, XMLNamespace, CreatedXMLNode)
      ELSE
        Doc.CreateNode(1, XMLNamespacePrefix + ':' + Name, XMLNamespace, CreatedXMLNode);

      Doc.AppendChild(CreatedXMLNode);
    END;

    LOCAL PROCEDURE AddElement@1(VAR ParentNode@1000000 : Codeunit 11148611;Name@1002 : Text[250];Value@1003 : Text[1024];XMLNamespace@1000000000 : Text[50];XMLNamespacePrefix@1000000001 : Text[30];VAR CreatedXMLNode@1005 : Codeunit 11148611);
    BEGIN
      IF (XMLNamespacePrefix = '') THEN
        XmlDoc.CreateNode(1, Name, XMLNamespace, CreatedXMLNode)
      ELSE
        XmlDoc.CreateNode(1, XMLNamespacePrefix + ':' + Name, XMLNamespace, CreatedXMLNode);

      IF Value <> '' THEN
        CreatedXMLNode.SetText(Value);

      ParentNode.AppendChild(CreatedXMLNode);
    END;

    LOCAL PROCEDURE AddAttribute@1000003(VAR Node@1000000 : Codeunit 11148611;Name@1002 : Text[250];Value@1003 : Text[250]);
    VAR
      Attribute@1000002 : Codeunit 11148611;
      Attributes@1000000000 : Codeunit 11148649;
    BEGIN
      XmlDoc.CreateNode(2, Name, '', Attribute);

      IF Value <> '' THEN
        Attribute.SetText(Value);

      Node.Attributes(Attributes);
      Attributes.SetNamedItem(Attribute);
    END;

    LOCAL PROCEDURE ConvertFieldValue@1000000(VAR RecRef@1100531001 : RecordRef;VAR FldRef@1000000 : FieldRef;VAR ExportDefLine@1000001 : Record 11148600;XmlFormat@1000000000 : Boolean) ExitValue : Text[1024];
    VAR
      i@1000000001 : Integer;
      InternalValue@1000000002 : Text[1024];
    BEGIN
      IF FORMAT(FldRef.CLASS) = 'FlowField' THEN
        FldRef.CALCFIELD;

      IF UPPERCASE(FORMAT(FldRef.TYPE)) = 'OPTION' THEN BEGIN
        CASE ExportDefLine."Option Type" OF

          ExportDefLine."Option Type"::Value :
            BEGIN
              i := FldRef.VALUE;
              InternalValue := FORMAT(i);
            END;

          ExportDefLine."Option Type"::Name :
            BEGIN
              i := FldRef.VALUE;
              InternalValue := SELECTSTR(i + 1, FORMAT(FldRef.OPTIONSTRING));
            END;

          ExportDefLine."Option Type"::Caption :
            BEGIN
              i := FldRef.VALUE;
              InternalValue := SELECTSTR(i + 1, FORMAT(FldRef.OPTIONCAPTION));
            END;
        END;
      END ELSE
        InternalValue := FORMAT(FldRef.VALUE);

      ExitValue := ExportValueProcessing.PostProcessValue(ExportDefLine, InternalValue);
    END;

    LOCAL PROCEDURE CreateDoc@1000014(VAR RootNode@1000002 : Codeunit 11148611);
    VAR
      Setup@1000000 : Record 11148589;
      DocNotCreated@1000001 : TextConst 'ENU=The XML Document cannot be created.;NLD=Het XML document kan niet worden aangemaakt.';
      InstructionNode@1000004 : Codeunit 11148611;
      XMLProcessingInstruction@1000003 : Text[1024];
    BEGIN
      IF NOT FromConnector THEN
        IF NOT XmlDoc.Create(TRUE, FALSE) THEN
          ERROR(DocNotCreated);

      AddRootElement(
        XmlDoc,
        ExportDefLineTemp."Tag Name",
        ExportDefLineTemp."XML Namespace",
        ExportDefLineTemp."XML Namespace Prefix",
        RootNode);

      IF ExportDef."XML Declaration" = '' THEN BEGIN
        Setup.GET;
        XMLProcessingInstruction := Setup."XML Declaration";
      END ELSE
        XMLProcessingInstruction := ExportDef."XML Declaration";

      IF XMLProcessingInstruction <> '' THEN BEGIN
        XmlDoc.CreateProcessingInstruction('xml', XMLProcessingInstruction, InstructionNode);
        XmlDoc.InsertBefore(InstructionNode, RootNode);
      END;
    END;

    LOCAL PROCEDURE SaveDoc@1000013();
    VAR
      IndentXMLDocument@1000000002 : Codeunit 11148650;
      ExportDefMgt@1000001 : Codeunit 11148605;
      OutStr@1000003 : OutStream;
      TmpBlob@1000002 : TEMPORARY Record 11148609;
      LogMgt@1000004 : Codeunit 11148623;
      ExportDefinition@1100512000 : Record 11148599;
      RecRef@1100512001 : RecordRef;
    BEGIN
      IF (ExportDef.Filename <> '') OR (ExportDef."Filename Type" <> ExportDef."Filename Type"::YYYYMMDD) THEN BEGIN

        IF Filename2 = '' THEN BEGIN
          RecRef.GETTABLE(ExportDefinition);
          ExportDefMgt.CreateFilename(ExportDef, RecRef, Path, Filename2, Trigger, ExportJobEntryNo);
        END;

        IndentXMLDocument.Indent(XmlDoc);

        IF (Path <> '') AND (Filename2 <> '') THEN
          XmlDoc.SaveToFile(Path + Filename2);
      END;

      IF ExportDef."Save to Messages" THEN BEGIN
        TmpBlob.BLOB.CREATEOUTSTREAM(OutStr);
        XmlDoc.SaveToStream(OutStr);
        LogMgt.SaveMessageToLog(1, ExportDef.Code, Path, Filename2, TmpBlob, FALSE, FALSE);
      END;
    END;

    PROCEDURE SetRecRef@1000002(VAR NewRecRef@1100531000 : RecordRef;EntryNo@1000001 : Integer);
    BEGIN
      NoOfRecRefSet += 1;
      RecRefSetEntryNo[NoOfRecRefSet] := EntryNo;
      SettedRecRef[NoOfRecRefSet] := NewRecRef;

      RecRefSet := TRUE;
    END;

    PROCEDURE SetxRecRef@1000020(VAR NewxRecRef@1000000 : RecordRef;EntryNo@1100531000 : Integer);
    BEGIN
      NoOfxRecRefSet += 1;
      xRecRefSetEntryNo[NoOfxRecRefSet] := EntryNo;
      SettedxRecRef[NoOfxRecRefSet] := NewxRecRef;

      xRecRefSet := TRUE;
    END;

    PROCEDURE FillOutStream@1000016(VAR OutStr@1000000 : OutStream);
    BEGIN
      XmlDoc.SaveToStream(OutStr);
    END;

    PROCEDURE SetKeepDocumentOpen@1000017(NewValue@1000000 : Boolean);
    BEGIN
      KeepDocumentOpen := NewValue;
    END;

    LOCAL PROCEDURE DoSynchronize@1000019(VAR ExportDefinition@1000000 : Record 11148599);
    VAR
      ImportDefinition@1000003 : Record 11148591;
      Company@1000002 : Record 2000000006;
      SynchonizationInbox@1000001 : Record 11148618;
      OutStr@1000004 : OutStream;
      ImportXMLFile@1000005 : Codeunit 11148595;
    BEGIN
      IF ExportDefinition."Destination Company" = '' THEN
        Company.SETFILTER(Name, '<>%1', COMPANYNAME)
      ELSE
        Company.SETRANGE(Name, ExportDefinition."Destination Company");
      IF Company.FINDSET THEN
        REPEAT
          ImportDefinition.CHANGECOMPANY(Company.Name);
          IF ImportDefinition.GET(ExportDefinition."Import Code") THEN
            IF ExportDefinition."Use Inbox" THEN BEGIN
              SynchonizationInbox.CHANGECOMPANY(Company.Name);
              SynchonizationInbox.LOCKTABLE;
              IF SynchonizationInbox.FINDLAST THEN
                ;
              SynchonizationInbox."Entry No." += 1;
              SynchonizationInbox."Import Definition" := ImportDefinition.Code;
              SynchonizationInbox."Date Time Inserted" := CURRENTDATETIME;
              SynchonizationInbox."Source Company" := COMPANYNAME;
              SynchonizationInbox.Status := SynchonizationInbox.Status::New;
              SynchonizationInbox.Document.CREATEOUTSTREAM(OutStr);
              XmlDoc.SaveToStream(OutStr);
              SynchonizationInbox.INSERT;
            END ELSE BEGIN
              ImportXMLFile.SetDoc(XmlDoc);
              ImportXMLFile.SetDestinationCompany(Company.Name);
              ImportXMLFile.RUN(ImportDefinition);
            END;
        UNTIL Company.NEXT = 0;
    END;

    PROCEDURE SetTrigger@1000021(NewValue@1000000 : Text[1024]);
    BEGIN
      Trigger := NewValue;
    END;

    PROCEDURE SetExportJobEntryNo@1000023(NewValue@1000000 : Integer);
    BEGIN
      ExportJobEntryNo := NewValue;
    END;

    PROCEDURE SetDoc@1000024(VAR xmlDocument@1000001 : Codeunit 11148637);
    BEGIN
      XmlDoc := xmlDocument;
      FromConnector := TRUE;
    END;

    PROCEDURE SetIsWebServiceCall@1000000001(IsWebServiceCall@1000000000 : Boolean);
    BEGIN
      FromWebService := IsWebServiceCall;
    END;

    PROCEDURE NoOfRecordsProcessed@1100531000() : Integer;
    BEGIN
      EXIT(RecordsProcessed);
    END;

    PROCEDURE SetRecRefOnEntryNo@1100531001(VAR RecRef@1100531000 : RecordRef;EntryNo@1100531001 : Integer) : Boolean;
    VAR
      i@1100531002 : Integer;
    BEGIN
      FOR i := 1 TO NoOfRecRefSet DO
        IF RecRefSetEntryNo[i] = EntryNo THEN BEGIN
          RecRef := SettedRecRef[i];
          EXIT(TRUE);
        END;
    END;

    PROCEDURE SetxRecRefOnEntryNo@1100531002(VAR RecRef@1100531000 : RecordRef;EntryNo@1100531001 : Integer) : Boolean;
    VAR
      i@1100531002 : Integer;
    BEGIN
      FOR i := 1 TO NoOfxRecRefSet DO
        IF xRecRefSetEntryNo[i] = EntryNo THEN BEGIN
          RecRef := SettedxRecRef[i];
          EXIT(TRUE);
        END;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148615 IN - Export File
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    TableNo=11148599;
    OnRun=VAR
            Task@1000019 : Record 11148614;
            oFile@1000001 : File;
            RecRef@1000000 : RecordRef;
          BEGIN
            ExportDef := Rec;

            CheckDefinition;
            PrepareForExport;
            FillBuffers(ExportDef);

            IF ExportDef."File Format" = ExportDef."File Format"::CSV THEN
              SetupCsvFileWriter
            ELSE IF ExportDef."File Format" = ExportDef."File Format"::"Fixed Width" THEN
              SetupFixedWidthFileWriter
            ELSE IF ExportDef."File Format" = ExportDef."File Format"::Excel THEN
              SetupExcelFileWriter;

            ProcessExport;
            FinishExport;

            IF "Run Task" <> '' THEN BEGIN
              Task.GET("Run Task");
              Task.Process;
            END;
          END;

  }
  CODE
  {
    VAR
      ExportDef@1000000004 : Record 11148599;
      ExportDefLineTemp@1000000003 : TEMPORARY Record 11148600;
      ExportDefLineTemp2@1000000013 : TEMPORARY Record 11148600;
      ExportDefLineTemp3@1000000027 : TEMPORARY Record 11148600;
      ExportDefTableLinkTemp@1000000002 : TEMPORARY Record 11148601;
      ExportDefFunctionTemp@1000000001 : TEMPORARY Record 11148602;
      ExportDefMgt@1000000005 : Codeunit 11148605;
      ExportValueProcessing@1000000023 : Codeunit 11148616;
      VariableMgt@1000000011 : Codeunit 11148619;
      Mgt@1000000018 : Codeunit 11148589;
      Trigger@1000000006 : Text[30];
      PathToSave@1000000009 : Text[1024];
      FileNameToSave@1000000010 : Text[1024];
      ExportFileName@1000000014 : Text[1024];
      ExportJobEntryNo@1000000008 : Integer;
      RecordsProcessed@1000000007 : Integer;
      ConnectITWriter@1000000012 : Codeunit 11148617;
      TableIds@1000000017 : ARRAY [100] OF Integer;
      TableLevel@1000000021 : ARRAY [100] OF Integer;
      TableStatus@1000000020 : ARRAY [100] OF 'Open,Prepared,Active,End';
      MaxTables@1000000019 : Integer;
      LastLevelMoved@1000000022 : Integer;
      LastTableIdMoved@1000000028 : Integer;
      RecRefs@1000000015 : ARRAY [100] OF RecordRef;
      xRecRefs@1000000016 : ARRAY [100] OF RecordRef;
      Written@1000000029 : Boolean;
      "-----"@1000000000 : Integer;
      gRecRef@1000000 : RecordRef;
      gxRecRef@1000006 : RecordRef;
      gRecRefSet@1000001 : Boolean;
      gxRecRefSet@1000005 : Boolean;
      Text001@1000000026 : TextConst 'ENU=You must specify an empty code for all Tables in Export Definition %1;NLD=U dient overal een lege code op te geven in Export Definitie %1';
      Text002@1000000025 : TextConst 'ENU=All table records in Export Definition %1 must have the same indentation when Code is empty.;NLD=All tabel records in Export Definition %1 moeten dezelfde inpsringing hebben als Code leeg is.';
      Text003@1000000024 : TextConst 'ENU=One of the columns in Export Definition %1 must have a identifier field.;NLD=Een van de kolommen in Export Definitie %1 moet identificatie aan staan.';

    LOCAL PROCEDURE CheckDefinition@1000000000();
    VAR
      ExportDefLine@1000000000 : Record 11148600;
      ExportDefLine2@1000000001 : Record 11148600;
    BEGIN
      IF ExportDef.Status = ExportDef.Status::Blocked THEN
        ExportDef.FIELDERROR(Status);

      ExportDefLine.SETCURRENTKEY("Export Definition", "Line No.");
      ExportDefLine.SETRANGE("Export Definition", ExportDef.Code);
      ExportDefLine.SETRANGE(Type, ExportDefLine.Type::Table);
      IF ExportDefLine.FINDSET THEN
        REPEAT
          IF ExportDefLine.Code = '' THEN BEGIN
            ExportDefLine2.COPYFILTERS(ExportDefLine);
            ExportDefLine2.SETFILTER(Code, '<>%1', '');
            IF NOT ExportDefLine2.ISEMPTY THEN
              ERROR(Text001, ExportDef.Code);

            ExportDefLine2.SETFILTER(Indent, '<>%1', ExportDefLine.Indent);
            IF NOT ExportDefLine2.ISEMPTY THEN
              ERROR(Text002, ExportDef.Code);
          END ELSE BEGIN
            ExportDefLine2.SETFILTER(Type, '<>%1', ExportDefLine2.Type::Table);
            ExportDefLine2.SETRANGE(Code, ExportDefLine.Code);
            ExportDefLine2.SETRANGE(Indent, ExportDefLine.Indent + 1);
            IF ExportDefLine2.ISEMPTY THEN
              ERROR(Text003, ExportDef.Code)
          END;
        UNTIL ExportDefLine.NEXT = 0;
    END;

    LOCAL PROCEDURE PrepareForExport@1000000001();
    VAR
      Project@1000000000 : Record 11148620;
      RecRef@1000000001 : RecordRef;
      CommentMgt@1000000002 : Codeunit 11148622;
    BEGIN
      CommentMgt.ResetError;

      IF (STRPOS(LOWERCASE(ExportDef.Location + ExportDef.Filename), '#entryno#') > 0) OR
         (ExportDef."Filename Type" = ExportDef."Filename Type"::"Entry No.")
      THEN BEGIN
        ExportDef."Export Entry No." += 1;
        ExportDef.MODIFY;
      END;

      IF (STRPOS(LOWERCASE(ExportDef.Location + ExportDef.Filename), '#pentryno#') > 0) OR
         (ExportDef."Filename Type" = ExportDef."Filename Type"::"Project Entry No.")
      THEN BEGIN
        ExportDef.TESTFIELD("Project Code");
        Project.GET(ExportDef."Project Code");
        Project."Export Entry No." += 1;
        Project.MODIFY;
      END;

      // TODO: Why is RecRef here? Clean up code
      ExportDefMgt.CreateFilename(ExportDef, RecRef, PathToSave, FileNameToSave, Trigger, ExportJobEntryNo);
      IF PathToSave = '' THEN
        ExportDef.TESTFIELD(Location);
      IF FileNameToSave = '' THEN
        ExportDef.TESTFIELD(Filename);

      ExportFileName := PathToSave + FileNameToSave;
      ExportDefMgt.CheckFileExist(ExportFileName);

      VariableMgt.SetVariable('#FILENAME#', ExportFileName);
      VariableMgt.SetVariable('#PATH#', PathToSave);
      VariableMgt.SetVariable('#DEF_CODE#', ExportDef.Code);
      VariableMgt.SetVariable('#DEF_DESCRIPTION#', ExportDef.Description);
    END;

    LOCAL PROCEDURE SetupCsvFileWriter@1000000003();
    VAR
      ColumnIdentifier@1000000000 : Integer;
      ColumnCount@1000000001 : Integer;
    BEGIN
      ExportDef.TESTFIELD("File Format", ExportDef."File Format"::CSV);

      ConnectITWriter.OpenCSVWriter(ExportFileName);

      ConnectITWriter.SetFieldSeparator(ExportDef."Field Separator");
      ConnectITWriter.SetFieldDelimiter(ExportDef."Field Delimiter");

      ExportDefLineTemp.RESET;
      ExportDefLineTemp.SETCURRENTKEY("Export Definition", "Line No.");
      ExportDefLineTemp.SETRANGE("Export Definition", ExportDef.Code);
      ExportDefLineTemp.SETRANGE(Type, ExportDefLineTemp.Type::Table);
      IF ExportDefLineTemp.FINDSET THEN
        REPEAT
          ColumnIdentifier := -1;
          ColumnCount := 0;

          ExportDefLineTemp3.COPY(ExportDefLineTemp);
          ExportDefLineTemp3.NEXT;

          ExportDefLineTemp2.RESET;
          ExportDefLineTemp2.SETCURRENTKEY("Export Definition", "Line No.");
          ExportDefLineTemp2.SETRANGE("Export Definition", ExportDef.Code);
          ExportDefLineTemp2.SETFILTER(Type, '%1|%2|%3', ExportDefLineTemp2.Type::Field,
              ExportDefLineTemp2.Type::Const, ExportDefLineTemp2.Type::Variable);
          ExportDefLineTemp2.SETRANGE(Indent, ExportDefLineTemp.Indent + 1);
          IF (ExportDefLineTemp."Line No." = ExportDefLineTemp3."Line No.") THEN
            ExportDefLineTemp2.SETFILTER("Line No.", '%1..', ExportDefLineTemp."Line No.")
          ELSE
            ExportDefLineTemp2.SETFILTER("Line No.", '%1..%2', ExportDefLineTemp."Line No.", ExportDefLineTemp3."Line No.");

          IF ExportDefLineTemp2.FINDSET THEN
            REPEAT
              IF (ExportDefLineTemp2.Code = ExportDefLineTemp.Code) AND (ExportDefLineTemp.Code <> '') THEN
                ColumnIdentifier := ColumnCount;
              ColumnCount += 1;
            UNTIL ExportDefLineTemp2.NEXT = 0;

          ConnectITWriter.AddRecordDefinition(ColumnIdentifier, ExportDefLineTemp.Code, ColumnCount);
        UNTIL ExportDefLineTemp.NEXT = 0;
    END;

    LOCAL PROCEDURE SetupFixedWidthFileWriter@1000000010();
    VAR
      ColumnIdentifier@1000000000 : Integer;
      ColumnCount@1000000001 : Integer;
    BEGIN
      ExportDef.TESTFIELD("File Format", ExportDef."File Format"::"Fixed Width");

      ConnectITWriter.OpenFixedWidthWriter(ExportFileName);

      ExportDefLineTemp.RESET;
      ExportDefLineTemp.SETCURRENTKEY("Export Definition", "Line No.");
      ExportDefLineTemp.SETRANGE("Export Definition", ExportDef.Code);
      ExportDefLineTemp.SETRANGE(Type, ExportDefLineTemp.Type::Table);
      IF ExportDefLineTemp.FINDSET THEN
        REPEAT
          ColumnIdentifier := -1;
          ColumnCount := 0;

          ExportDefLineTemp3.COPY(ExportDefLineTemp);
          ExportDefLineTemp3.NEXT;

          ExportDefLineTemp2.RESET;
          ExportDefLineTemp2.SETCURRENTKEY("Export Definition", "Line No.");
          ExportDefLineTemp2.SETRANGE("Export Definition", ExportDef.Code);
          ExportDefLineTemp2.SETFILTER(Type, '%1|%2|%3', ExportDefLineTemp2.Type::Field,
              ExportDefLineTemp2.Type::Const, ExportDefLineTemp2.Type::Variable);
          ExportDefLineTemp2.SETRANGE(Indent, ExportDefLineTemp.Indent + 1);
          IF (ExportDefLineTemp."Line No." = ExportDefLineTemp3."Line No.") THEN
            ExportDefLineTemp2.SETFILTER("Line No.", '%1..', ExportDefLineTemp."Line No.")
          ELSE
            ExportDefLineTemp2.SETFILTER("Line No.", '%1..%2', ExportDefLineTemp."Line No.", ExportDefLineTemp3."Line No.");

          IF ExportDefLineTemp2.FINDSET THEN
            REPEAT
              IF (ExportDefLineTemp2.Code = ExportDefLineTemp.Code) AND (ExportDefLineTemp.Code <> '')THEN
                ColumnIdentifier := ColumnCount;
              ColumnCount += 1;
            UNTIL ExportDefLineTemp2.NEXT = 0;

          IF ConnectITWriter.AddRecordDefinition(ColumnIdentifier, ExportDefLineTemp.Code, ColumnCount) THEN BEGIN

            IF ExportDefLineTemp2.FINDSET THEN
              REPEAT
                ConnectITWriter.AddColumnParameters(ExportDefLineTemp.Code, ExportDefLineTemp2.Width, ExportDefLineTemp2.Alignment);
              UNTIL ExportDefLineTemp2.NEXT = 0;

          END;
        UNTIL ExportDefLineTemp.NEXT = 0;
    END;

    LOCAL PROCEDURE SetupExcelFileWriter@1000000009();
    VAR
      ColumnIdentifier@1000000000 : Integer;
      ColumnCount@1000000001 : Integer;
    BEGIN
      ExportDef.TESTFIELD("File Format", ExportDef."File Format"::Excel);

      ConnectITWriter.OpenExcelWriter(ExportFileName, ExportDef."Worksheet Name");

      ExportDefLineTemp.RESET;
      ExportDefLineTemp.SETCURRENTKEY("Export Definition", "Line No.");
      ExportDefLineTemp.SETRANGE("Export Definition", ExportDef.Code);
      ExportDefLineTemp.SETRANGE(Type, ExportDefLineTemp.Type::Table);
      IF ExportDefLineTemp.FINDSET THEN
        REPEAT
          ColumnIdentifier := -1;
          ColumnCount := 0;

          ExportDefLineTemp3.COPY(ExportDefLineTemp);
          ExportDefLineTemp3.NEXT;

          ExportDefLineTemp2.RESET;
          ExportDefLineTemp2.SETCURRENTKEY("Export Definition", "Line No.");
          ExportDefLineTemp2.SETRANGE("Export Definition", ExportDef.Code);
          ExportDefLineTemp2.SETFILTER(Type, '%1|%2|%3', ExportDefLineTemp2.Type::Field,
              ExportDefLineTemp2.Type::Const, ExportDefLineTemp2.Type::Variable);
          ExportDefLineTemp2.SETRANGE(Indent, ExportDefLineTemp.Indent + 1);
          IF (ExportDefLineTemp."Line No." = ExportDefLineTemp3."Line No.") THEN
            ExportDefLineTemp2.SETFILTER("Line No.", '%1..', ExportDefLineTemp."Line No.")
          ELSE
            ExportDefLineTemp2.SETFILTER("Line No.", '%1..%2', ExportDefLineTemp."Line No.", ExportDefLineTemp3."Line No.");

          IF ExportDefLineTemp2.FINDSET THEN
            REPEAT
              IF (ExportDefLineTemp2.Code = ExportDefLineTemp.Code) AND (ExportDefLineTemp.Code <> '')THEN
                ColumnIdentifier := ColumnCount;
              ColumnCount += 1;
            UNTIL ExportDefLineTemp2.NEXT = 0;

          ConnectITWriter.AddRecordDefinition(ColumnIdentifier, ExportDefLineTemp.Code, ColumnCount);
        UNTIL ExportDefLineTemp.NEXT = 0;
    END;

    LOCAL PROCEDURE ProcessExport@1000000006();
    VAR
      ConnectITRecord@1000000000 : Codeunit 11148635;
    BEGIN
      IF (ExportDef.Headers) THEN
        WriteHeader;

      ConnectITRecord.Create(FALSE, FALSE);

      ExportDefLineTemp.SETCURRENTKEY("Export Definition", "Line No.");
      ExportDefLineTemp.SETRANGE("Export Definition", ExportDef.Code);
      ExportDefLineTemp.SETRANGE(Type, ExportDefLineTemp.Type::Table);
      IF ExportDefLineTemp.FINDSET THEN
        REPEAT
          ProcessExportTableLine(ExportDefLineTemp, ConnectITRecord);
        UNTIL ExportDefLineTemp.NEXT = 0;

      IF IsFlatExport THEN BEGIN
        FlatProcessExport(ConnectITRecord);
      END ELSE BEGIN
        MultiProcessExport(ConnectITRecord);
      END;
    END;

    PROCEDURE FlatProcessExport@1000000011(VAR ConnectITRecord@1000000000 : Codeunit 11148635);
    BEGIN
      ExportDefLineTemp.SETRANGE(Type);
      WHILE MoveRecordPointers DO BEGIN
        ConnectITRecord.ClearValues;
        ExportDefLineTemp.SETRANGE(Indent, LastLevelMoved, LastLevelMoved +1);
        IF ExportDefLineTemp.FINDSET THEN
          REPEAT
            IF NOT ((ExportDefLineTemp.Indent = LastLevelMoved) AND (ExportDefLineTemp.Type <> ExportDefLineTemp.Type::Table)) THEN
              ProcessExportDefLine(ExportDefLineTemp,ConnectITRecord);
          UNTIL ExportDefLineTemp.NEXT = 0;
        ConnectITWriter.WriteLine(ConnectITRecord);
      END;
    END;

    PROCEDURE MultiProcessExport@1000000014(VAR ConnectITRecord@1000000000 : Codeunit 11148635);
    VAR
      ExpDefLineTemp@1000000001 : TEMPORARY Record 11148600;
    BEGIN
      ExportDefLineTemp.SETRANGE(Type);
      IF ExportDefLineTemp.FINDSET THEN
        REPEAT
          ExpDefLineTemp := ExportDefLineTemp;
          ExpDefLineTemp.INSERT;
        UNTIL ExportDefLineTemp.NEXT = 0;

      MultiProcessLine(ExpDefLineTemp, 0, ConnectITRecord);
    END;

    PROCEDURE MultiProcessLine@1000000016(VAR ExportDefLine@1000000000 : Record 11148600;IndentLevel@1000000001 : Integer;VAR ConnectITRecord@1000000002 : Codeunit 11148635);
    BEGIN
      ExportDefLine.SETRANGE(Indent, IndentLevel);
      IF ExportDefLine.FINDSET THEN
        REPEAT
          CASE ExportDefLine.Type OF
            ExportDefLine.Type::Table: MultiProcessTableLine(ExportDefLine, IndentLevel, ConnectITRecord);
            ExportDefLine.Type::Const,
            ExportDefLine.Type::Variable,
            ExportDefLine.Type::Field: MultiProcessOutputLine(ExportDefLine, IndentLevel, ConnectITRecord);
          END;
        UNTIL ExportDefLine.NEXT = 0;
    END;

    PROCEDURE MultiProcessTableLine@1000000018(VAR ExportDefLine@1000000000 : Record 11148600;IndentLevel@1000000001 : Integer;VAR ConnectITRecord@1000000002 : Codeunit 11148635);
    VAR
      ChildExportDefLineTemp@1000000003 : TEMPORARY Record 11148600;
      MainRecRef@1000000011 : RecordRef;
      MainFldRef@1000000010 : FieldRef;
      MainIndex@1000000009 : Integer;
      SubRecRef@1000000008 : RecordRef;
      SubFldRef@1000000007 : FieldRef;
      SubIndex@1000000006 : Integer;
      RecRef@1000000005 : RecordRef;
      CurrentIndex@1000000004 : Integer;
      FoundNext@1000000012 : Boolean;
    BEGIN
      IF IndentLevel <> 0 THEN BEGIN
        IF NOT Written THEN BEGIN
          ConnectITWriter.WriteLine(ConnectITRecord);
          Written := TRUE;
        END;
      END;

      MultiGetChildLines(ExportDefLine, ChildExportDefLineTemp);

      IF ExportDefLine."Link to Table (Tag Name)" <> '' THEN BEGIN

        ExportDefLineTemp2.RESET;
        ExportDefLineTemp2.SETCURRENTKEY("Export Definition", "Line No.");
        ExportDefLineTemp2.SETRANGE("Export Definition", ExportDefLine."Export Definition");
        ExportDefLineTemp2.SETRANGE("Tag Name", ExportDefLine."Link to Table (Tag Name)");
        ExportDefLineTemp2.FINDFIRST;

        MainIndex := FindRecRef(ExportDefLineTemp2."Table No.");
        SubIndex := FindRecRef(ExportDefLine."Table No.");

        MainRecRef := RecRefs[MainIndex];
        SubRecRef := RecRefs[SubIndex];

        ExportDefTableLinkTemp.SETRANGE("Export Definition", ExportDefLine."Export Definition");
        ExportDefTableLinkTemp.SETRANGE("Export Def. Entry No.", ExportDefLine."Entry No.");
        IF ExportDefTableLinkTemp.FINDSET THEN
          REPEAT
            MainFldRef := MainRecRef.FIELD(ExportDefTableLinkTemp."Main Field No.");
            SubFldRef := SubRecRef.FIELD(ExportDefTableLinkTemp."Sub Field No.");
            SubFldRef.SETRANGE(MainFldRef.VALUE);
          UNTIL ExportDefTableLinkTemp.NEXT = 0;

      END;

      CurrentIndex := FindRecRef(ExportDefLine."Table No.");
      RecRef := RecRefs[CurrentIndex];
      Mgt.SetFilterOnRecordRef(RecRef, FORMAT(ExportDefLine."Table Filter"));

      Written := TRUE;
      IF RecRef.FINDSET THEN
        REPEAT
          IF ChildExportDefLineTemp.FINDSET THEN BEGIN
            Written := FALSE;
            ConnectITRecord.ClearValues;
            REPEAT
              MultiProcessLine(ChildExportDefLineTemp, ChildExportDefLineTemp.Indent, ConnectITRecord);
            UNTIL ChildExportDefLineTemp.NEXT = 0;

            IF NOT Written THEN
              ConnectITWriter.WriteLine(ConnectITRecord);
            Written := TRUE;
          END;

        UNTIL RecRef.NEXT = 0;
    END;

    PROCEDURE MultiProcessOutputLine@1000000017(VAR ExportDefLine@1000000000 : Record 11148600;IndentLevel@1000000001 : Integer;VAR ConnectITRecord@1000000002 : Codeunit 11148635);
    VAR
      RecRef@1000000004 : RecordRef;
      FldRef@1000000007 : FieldRef;
      xRecRef@1000000006 : RecordRef;
      ValueToWrite@1000000005 : Text[1024];
      CurrentIndex@1000000003 : Integer;
    BEGIN
      CurrentIndex := FindRecRef(ExportDefLine."Table No.");
      RecRef := RecRefs[CurrentIndex];

      CASE ExportDefLine.Type OF
        ExportDefLine.Type::Field :
          BEGIN
            IF (ExportDefLine."Original Value") AND gxRecRefSet THEN
              FldRef := xRecRef.FIELD(ExportDefLine."Field No.")
            ELSE
              FldRef := RecRef.FIELD(ExportDefLine."Field No.");

            ValueToWrite := ConvertFieldValue(RecRef, FldRef, ExportDefLine);
          END;

        ExportDefLine.Type::Const :
          ValueToWrite := ExportValueProcessing.PostProcessValue(ExportDefLine, ExportDefLine.Code);

        ExportDefLine.Type::Variable :
          ValueToWrite := ExportValueProcessing.PostProcessValue(ExportDefLine, VariableMgt.GetVariable(ExportDefLine.Code));

      END;

      IF ExportDefLine."Dest. Variable" <> '' THEN
        VariableMgt.SetVariable(ExportDefLine."Dest. Variable", ValueToWrite);

      ConnectITRecord.AddValue(ValueToWrite);
    END;

    PROCEDURE MultiGetChildLines@1000000019(VAR ExpDefLine@1000000000 : Record 11148600;VAR ChildExpDefLine@1000000001 : Record 11148600);
    BEGIN
      ExportDefLineTemp2.RESET;
      ExportDefLineTemp2.SETCURRENTKEY("Export Definition", "Line No.");
      ExportDefLineTemp2.SETRANGE("Export Definition", ExpDefLine."Export Definition");
      ExportDefLineTemp2.SETFILTER("Line No.", '>%1', ExpDefLine."Line No.");
      IF ExportDefLineTemp2.FINDSET THEN
        REPEAT
          IF ExportDefLineTemp2.Indent = ExpDefLine.Indent + 1 THEN BEGIN
            ChildExpDefLine := ExportDefLineTemp2;
            ChildExpDefLine.INSERT;
          END;
        UNTIL (ExportDefLineTemp2.Indent <= ExpDefLine.Indent) OR (ExportDefLineTemp2.NEXT = 0);

      ChildExpDefLine.SETCURRENTKEY("Export Definition", "Line No.");
    END;

    LOCAL PROCEDURE FinishExport@1000000004();
    VAR
      TmpBlob@1000000004 : Record 11148609;
      LogMgt@1000000003 : Codeunit 11148623;
      File@1000000002 : File;
      InStr@1000000001 : InStream;
      OutStr@1000000000 : OutStream;
    BEGIN
      ConnectITWriter.Close();

      IF ExportDef."Save to Messages" THEN BEGIN
        File.OPEN(ExportFileName);
        File.CREATEINSTREAM(InStr);
        TmpBlob.BLOB.CREATEOUTSTREAM(OutStr);
        COPYSTREAM(OutStr, InStr);
        LogMgt.SaveMessageToLog(1, ExportDef.Code, PathToSave, FileNameToSave, TmpBlob, FALSE, TRUE);
        File.CLOSE;
      END;
    END;

    LOCAL PROCEDURE ProcessExportTableLine@1000000012(VAR ExportDefLine@1000000000 : Record 11148600;VAR ConnectITRecord@1000000001 : Codeunit 11148635);
    VAR
      i@1000000002 : Integer;
    BEGIN
      IF ExportDefLine.Type = ExportDefLine.Type::Table THEN BEGIN

        IF (ExportDefLine.Code <> '') THEN
          ConnectITRecord.SetIdentifier(ExportDefLine.Code);
        FOR i := 1 TO 100 DO BEGIN
          IF TableIds[i] = 0 THEN BEGIN
            TableIds[i] := ExportDefLine."Table No.";

            IF ExportDef."Company Name" = '' THEN
              RecRefs[i].OPEN(ExportDefLine."Table No.")
            ELSE
              RecRefs[i].OPEN(ExportDefLine."Table No.", FALSE, ExportDef."Company Name");

            IF gRecRefSet AND (RecRefs[i].NUMBER = gRecRef.NUMBER) THEN BEGIN
              RecRefs[i] := gRecRef;
            END;

            TableStatus[i] := TableStatus::Open;
            TableLevel[i] := ExportDefLine.Indent;
            MaxTables := i;

            i := 100;
          END ELSE IF TableIds[i] = ExportDefLine."Table No." THEN
            i := 100;
        END;


        IF (ExportDefLine.Indent = 0) AND (ExportDefLine."Link to Table (Tag Name)" = '') THEN BEGIN
          Mgt.SetFilterOnRecordRef(RecRefs[MaxTables], FORMAT(ExportDefLineTemp."Table Filter"));
          RecRefs[MaxTables].FINDSET;
        END;

      END;
    END;

    LOCAL PROCEDURE ProcessExportDefLine@1000000007(VAR ExportDefLine@1000000000 : Record 11148600;VAR ConnectITRecord@1000000001 : Codeunit 11148635);
    VAR
      MainRecRef@1000000005 : RecordRef;
      MainFldRef@1000000007 : FieldRef;
      MainIndex@1000000003 : Integer;
      SubRecRef@1000000006 : RecordRef;
      SubFldRef@1000000008 : FieldRef;
      SubIndex@1000000004 : Integer;
      RecRef@1000000010 : RecordRef;
      FldRef@1000000011 : FieldRef;
      CurrentIndex@1000000009 : Integer;
      xRecRef@1000000012 : RecordRef;
      ValueToWrite@1000000013 : Text[1024];
    BEGIN
      CurrentIndex := FindRecRef(ExportDefLine."Table No.");
      RecRef := RecRefs[CurrentIndex];

      IF ExportDefLine.Type = ExportDefLine.Type::Table THEN BEGIN

        IF TableStatus[CurrentIndex] <> TableStatus::Active THEN BEGIN
          IF ExportDefLine."Link to Table (Tag Name)" <> '' THEN BEGIN

            ExportDefLineTemp2.RESET;
            ExportDefLineTemp2.SETCURRENTKEY("Export Definition", "Line No.");
            ExportDefLineTemp2.SETRANGE("Export Definition", ExportDefLine."Export Definition");
            ExportDefLineTemp2.SETRANGE("Tag Name", ExportDefLine."Link to Table (Tag Name)");
            ExportDefLineTemp2.FINDFIRST;

            MainIndex := FindRecRef(ExportDefLineTemp2."Table No.");
            SubIndex := FindRecRef(ExportDefLine."Table No.");

            MainRecRef := RecRefs[MainIndex];
            SubRecRef := RecRefs[SubIndex];

            ExportDefTableLinkTemp.SETRANGE("Export Definition", ExportDefLine."Export Definition");
            ExportDefTableLinkTemp.SETRANGE("Export Def. Entry No.", ExportDefLine."Entry No.");
            IF ExportDefTableLinkTemp.FINDSET THEN
              REPEAT
                MainFldRef := MainRecRef.FIELD(ExportDefTableLinkTemp."Main Field No.");
                SubFldRef := SubRecRef.FIELD(ExportDefTableLinkTemp."Sub Field No.");
                SubFldRef.SETRANGE(MainFldRef.VALUE);
              UNTIL ExportDefTableLinkTemp.NEXT = 0;

          END;

          Mgt.SetFilterOnRecordRef(RecRef, FORMAT(ExportDefLineTemp."Table Filter"));
          IF (IsFlatExport) THEN BEGIN
            IF RecRef.FINDSET THEN
              TableStatus[CurrentIndex] := TableStatus::Active
            ELSE
              TableStatus[CurrentIndex] := TableStatus::"End";
          END ELSE BEGIN
            TableStatus[CurrentIndex] := TableStatus::Prepared;
          END;

        END;

        EXIT;

      END;

      CASE ExportDefLineTemp.Type OF
        ExportDefLineTemp.Type::Field :
          BEGIN
            IF (ExportDefLineTemp."Original Value") AND gxRecRefSet THEN
              FldRef := xRecRef.FIELD(ExportDefLineTemp."Field No.")
            ELSE
              FldRef := RecRef.FIELD(ExportDefLineTemp."Field No.");

            ValueToWrite := ConvertFieldValue(RecRef, FldRef, ExportDefLineTemp);
          END;

        ExportDefLineTemp.Type::Const :
          ValueToWrite := ExportValueProcessing.PostProcessValue(ExportDefLineTemp, ExportDefLineTemp.Code);

        ExportDefLineTemp.Type::Variable :
          ValueToWrite := ExportValueProcessing.PostProcessValue(ExportDefLineTemp, VariableMgt.GetVariable(ExportDefLineTemp.Code));

      END;

      IF ExportDefLineTemp."Dest. Variable" <> '' THEN
        VariableMgt.SetVariable(ExportDefLineTemp."Dest. Variable", ValueToWrite);

      ConnectITRecord.AddValue(ValueToWrite);
    END;

    LOCAL PROCEDURE MoveRecordPointers@1000000015() DataFound : Boolean;
    VAR
      Index@1000000000 : Integer;
      Steps@1000000001 : Integer;
    BEGIN
      FOR Index := MaxTables DOWNTO 1 DO
        IF TableStatus[Index] = TableStatus::Active THEN BEGIN

          Steps := RecRefs[Index].NEXT;
          IF Steps = 0 THEN BEGIN
            TableStatus[Index] := TableStatus::"End";
          END ELSE BEGIN
            LastLevelMoved := TableLevel[Index];
            LastTableIdMoved := TableIds[Index];
            EXIT(TRUE);
          END;
        END ELSE IF TableStatus[Index] = TableStatus::Prepared THEN BEGIN
          IF RecRefs[Index].FINDSET THEN BEGIN
            TableStatus[Index] := TableStatus::Active;
            LastLevelMoved := TableLevel[Index];
            LastTableIdMoved := TableIds[Index];
            EXIT(TRUE);
          END;
        END;

      IF TableStatus[1] = TableStatus::Open THEN BEGIN
        DataFound := RecRefs[1].FINDSET;
        TableStatus[1] := TableStatus::Active;
        LastLevelMoved := TableLevel[1];
        LastTableIdMoved := TableIds[1];
        EXIT(TRUE);
      END;

      EXIT(FALSE);
    END;

    LOCAL PROCEDURE WriteHeader@1000000002();
    VAR
      ConnectITRecord@1000000000 : Codeunit 11148635;
    BEGIN
      // Cannot write header when line data is variable.
      IF NOT IsFlatExport THEN
        EXIT;

      ExportDefLineTemp.RESET;
      ExportDefLineTemp.SETCURRENTKEY("Export Definition", "Line No."); // CI-123
      ExportDefLineTemp.SETRANGE("Export Definition", ExportDef.Code);
      ExportDefLineTemp.SETFILTER(Type, '%1|%2|%3', ExportDefLineTemp.Type::Field,
            ExportDefLineTemp.Type::Const, ExportDefLineTemp.Type::Variable);
      IF ExportDefLineTemp.FINDSET THEN BEGIN
        ConnectITRecord.Create(FALSE, FALSE);
        REPEAT
          ConnectITRecord.AddValue(ExportDefLineTemp."Tag Name");
        UNTIL ExportDefLineTemp.NEXT = 0;
        ConnectITWriter.WriteLine(ConnectITRecord);
      END;
    END;

    LOCAL PROCEDURE IsFlatExport@1000000005() : Boolean;
    BEGIN
      ExportDefLineTemp2.RESET;
      ExportDefLineTemp2.SETCURRENTKEY("Export Definition", "Line No."); // CI-123
      ExportDefLineTemp2.SETRANGE("Export Definition", ExportDef.Code);
      ExportDefLineTemp2.SETRANGE(Type, ExportDefLineTemp.Type::Table);
      ExportDefLineTemp2.SETFILTER(Indent, '<>0');
      IF ExportDefLineTemp2.FINDFIRST THEN
        EXIT(FALSE);

      EXIT(TRUE);
    END;

    LOCAL PROCEDURE FindRecRef@1000000008(TableNo@1000000000 : Integer) Result : Integer;
    VAR
      I@1000000001 : Integer;
    BEGIN
      FOR I := 1 TO 100 DO
        IF TableIds[I] = TableNo THEN
          EXIT(I);
    END;

    LOCAL PROCEDURE FillBuffers@1000010(VAR ExportDefinition@1000002 : Record 11148599);
    VAR
      ExportDefLine@1000004 : Record 11148600;
      ExportDefTableLink@1000003 : Record 11148601;
      ExportDefFunction@1100531000 : Record 11148602;
    BEGIN
      ExportDefLineTemp.RESET;
      ExportDefLineTemp.DELETEALL;

      ExportDefTableLinkTemp.RESET;
      ExportDefTableLinkTemp.DELETEALL;

      ExportDefFunctionTemp.RESET;
      ExportDefFunctionTemp.DELETEALL;

      ExportDefLine.SETRANGE("Export Definition", ExportDefinition.Code);
      ExportDefLine.SETFILTER(Type, '<>%1', ExportDefLine.Type::" ");
      IF ExportDefLine.FINDSET THEN
        REPEAT
          ExportDefLineTemp := ExportDefLine;
          ExportDefLineTemp.Functions := FALSE;
          ExportDefLineTemp.INSERT;

          ExportDefLineTemp2 := ExportDefLine;
          ExportDefLineTemp2.Functions := FALSE;
          ExportDefLineTemp2.INSERT;

          ExportDefLineTemp3 := ExportDefLine;
          ExportDefLineTemp3.Functions := FALSE;
          ExportDefLineTemp3.INSERT;
        UNTIL ExportDefLine.NEXT = 0;

      ExportDefTableLink.SETRANGE("Export Definition", ExportDefinition.Code);
      IF ExportDefTableLink.FINDSET THEN
        REPEAT
          ExportDefTableLinkTemp := ExportDefTableLink;
          ExportDefTableLinkTemp.INSERT;
        UNTIL ExportDefTableLink.NEXT = 0;

      ExportDefFunction.SETRANGE("Export Definition", ExportDefinition.Code);
      IF ExportDefFunction.FINDSET THEN
        REPEAT
          ExportDefFunctionTemp := ExportDefFunction;
          ExportDefFunctionTemp.INSERT;

          IF ExportDefLineTemp.GET(ExportDefFunction."Export Definition", ExportDefFunction."Export Def. Entry No.") THEN BEGIN
            ExportDefLineTemp.Functions := TRUE;
            ExportDefLineTemp.MODIFY;
          END;

        UNTIL ExportDefFunction.NEXT = 0;
    END;

    LOCAL PROCEDURE ConvertFieldValue@1000001(VAR RecRef@1100531001 : RecordRef;VAR FldRef@1000000 : FieldRef;VAR ExportDefLine@1000001 : Record 11148600) ExitValue : Text[1024];
    VAR
      InternalValue@1000000000 : Text[1024];
      i@1000003 : Integer;
    BEGIN
      IF UPPERCASE(FORMAT(FldRef.CLASS)) = 'FLOWFIELD' THEN
        FldRef.CALCFIELD;

      IF UPPERCASE(FORMAT(FldRef.TYPE)) = 'OPTION' THEN BEGIN
        CASE ExportDefLine."Option Type" OF

          ExportDefLine."Option Type"::Value :
            BEGIN
              i := FldRef.VALUE;
              InternalValue := FORMAT(i);
            END;

          ExportDefLine."Option Type"::Name :
            BEGIN
              i := FldRef.VALUE;
              InternalValue := SELECTSTR(i + 1, FORMAT(FldRef.OPTIONSTRING));
            END;

          ExportDefLine."Option Type"::Caption :
            BEGIN
              i := FldRef.VALUE;
              InternalValue := SELECTSTR(i + 1, FORMAT(FldRef.OPTIONCAPTION));
            END;
        END;
      END ELSE
        InternalValue := FORMAT(FldRef.VALUE);

      ExitValue := ExportValueProcessing.PostProcessValue(ExportDefLine, InternalValue);
    END;

    PROCEDURE SetRecRef@1000002(VAR NewRecRef@1000000 : RecordRef);
    BEGIN
      gRecRef := NewRecRef;
      gRecRefSet := TRUE;
    END;

    PROCEDURE SetxRecRef@1000020(VAR NewxRecRef@1000000 : RecordRef);
    BEGIN
      gxRecRef := NewxRecRef;
      gxRecRefSet := TRUE;
    END;

    PROCEDURE SetTrigger@1000021(NewValue@1000000 : Text[1024]);
    BEGIN
      Trigger := NewValue;
    END;

    PROCEDURE SetExportJobEntryNo@1000023(NewValue@1000000 : Integer);
    BEGIN
      ExportJobEntryNo := NewValue;
    END;

    PROCEDURE NoOfRecordsProcessed@1100531000() : Integer;
    BEGIN
      EXIT(RecordsProcessed);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148616 IN - Export Value Processing
{
  OBJECT-PROPERTIES
  {
    Date=24-05-13;
    Time=13:00:00;
    Version List=IDYN-CE5.50.0;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE PostProcessValue@1000000000(VAR ExportDefLine@1000000001 : Record 11148600;InValue@1000000000 : Text[1024]) OutValue : Text[1024];
    BEGIN
      IF ExportDefLine.Functions THEN
        PostProcessFunctions(ExportDefLine, InValue);

      IF ExportDefLine."Conversion Code" <> '' THEN
        PostProcessConversion(ExportDefLine, InValue);

      OutValue := PostProcessFormat(ExportDefLine, InValue);
    END;

    LOCAL PROCEDURE PostProcessFunctions@1000000001(VAR ExportDefLine@1000000002 : Record 11148600;VAR InValue@1000000011 : Text[1024]);
    VAR
      ExportDefFunction@1000000003 : Record 11148602;
      FunctionMgt@1000000000 : Codeunit 11148593;
      TextValue@1000000004 : Text[1024];
      IntValue@1000000005 : Integer;
      DecValue@1000000010 : Decimal;
      DateValue@1000000006 : Integer;
      TimeValue@1000000007 : Integer;
      DateTimeValue@1000000008 : Integer;
      BoolValue@1000000009 : Integer;
    BEGIN
      ExportDefFunction.SETRANGE("Export Definition", ExportDefLine."Export Definition");
      ExportDefFunction.SETRANGE("Export Def. Entry No.", ExportDefLine."Entry No.");
      IF ExportDefFunction.FINDSET THEN
        REPEAT
          FunctionMgt.ExportProcessRun(ExportDefLine, ExportDefFunction, InValue);
        UNTIL ExportDefFunction.NEXT = 0;
    END;

    LOCAL PROCEDURE PostProcessConversion@1000000002(VAR ExportDefLine@1000000002 : Record 11148600;VAR InValue@1000000001 : Text[1024]);
    VAR
      ConversionLine@1000000000 : Record 11148606;
    BEGIN
      ConversionLine.SETCURRENTKEY("Conversion Code", "NAV Value");
      ConversionLine.SETFILTER("Conversion Code", '@' + ExportDefLine."Conversion Code");
      ConversionLine.SETFILTER("NAV Value", '@' + InValue);
      IF ConversionLine.FINDFIRST THEN
        InValue := ConversionLine."Extern Value";
    END;

    PROCEDURE PostProcessFormat@1000000003(VAR ExportDefLine@1000000001 : Record 11148600;InValue@1000000000 : Text[1024]) OutValue : Text[1024];
    VAR
      Field@1000000002 : Record 2000000041;
      DateVal@1000000003 : Date;
      TimeVal@1000000004 : Time;
      DateTimeVal@1000000005 : DateTime;
      DateFormulaVal@1000000006 : DateFormula;
      DecVal@1000000007 : Decimal;
      IntVal@1000000008 : Integer;
      BoolVal@1000000009 : Boolean;
    BEGIN
      IF Field.GET(ExportDefLine."Table No.", ExportDefLine."Field No.") THEN BEGIN
        CASE Field.Type OF
          Field.Type::Date :
            BEGIN
              EVALUATE(DateVal, InValue);
              IF ExportDefLine."Skip If Empty" AND (DateVal = 0D) THEN
                OutValue := ''
              ELSE IF ExportDefLine."Data Format" = '' THEN
                OutValue := FORMAT(DateVal, 0, 9)
              ELSE
                OutValue := FORMAT(DateVal, 0, ExportDefLine."Data Format");
            END;
          Field.Type::Time :
            BEGIN
              EVALUATE(TimeVal, InValue);
              IF ExportDefLine."Skip If Empty" AND (TimeVal = 0T) THEN
                OutValue := ''
              ELSE IF ExportDefLine."Data Format" = '' THEN
                OutValue := FORMAT(TimeVal, 0, 9)
              ELSE
                OutValue := FORMAT(TimeVal, 0, ExportDefLine."Data Format");
            END;
          Field.Type::DateTime :
            BEGIN
              EVALUATE(DateTimeVal, InValue);
              IF ExportDefLine."Skip If Empty" AND (DateTimeVal = 0DT) THEN
                OutValue := ''
              ELSE IF ExportDefLine."Data Format" = '' THEN
                OutValue := FORMAT(DateTimeVal, 0, 9)
              ELSE
                OutValue := FORMAT(DateTimeVal, 0, ExportDefLine."Data Format");
            END;
          Field.Type::DateFormula :
            BEGIN
              EVALUATE(DateFormulaVal, InValue);
              IF ExportDefLine."Skip If Empty" AND (InValue = '') THEN
                OutValue := ''
              ELSE IF ExportDefLine."Data Format" = '' THEN
                OutValue := FORMAT(DateFormulaVal, 0, 9)
              ELSE
                OutValue := FORMAT(DateFormulaVal, 0, ExportDefLine."Data Format");
            END;
          Field.Type::Decimal :
            BEGIN
              EVALUATE(DecVal, InValue);
              IF ExportDefLine."Skip If Empty" AND (DecVal = 0) THEN
                OutValue := ''
              ELSE IF ExportDefLine."Data Format" = '' THEN
                OutValue := FORMAT(DecVal, 0, 9)
              ELSE
                OutValue := FORMAT(DecVal, 0, ExportDefLine."Data Format");
            END;
          Field.Type::Integer :
            BEGIN
              EVALUATE(IntVal, InValue);
              IF ExportDefLine."Skip If Empty" AND (IntVal = 0) THEN
                OutValue := ''
              ELSE IF ExportDefLine."Data Format" = '' THEN
                OutValue := FORMAT(IntVal, 0, 9)
              ELSE
                OutValue := FORMAT(IntVal, 0, ExportDefLine."Data Format");
            END;
          Field.Type::Boolean :
            BEGIN
              EVALUATE(BoolVal, InValue);
              IF ExportDefLine."Data Format" = '' THEN
                OutValue := FORMAT(BoolVal, 0, 9)
              ELSE
                OutValue := FORMAT(BoolVal, 0, ExportDefLine."Data Format");
            END;
          ELSE
            OutValue := InValue;
        END;
      END ELSE
        OutValue := InValue;

      OutValue := ExportDefLine."Before Field" + OutValue + ExportDefLine."After Field";
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148617 IN - ConnectIT Writer
{
  OBJECT-PROPERTIES
  {
    Date=14-07-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.1;
  }
  PROPERTIES
  {
    SingleInstance=Yes;
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      ConnectITWriterAutomation@1000000000 : Automation "{75E053EA-4A5A-4210-9188-699CF98212FE} 2.7:{52968EBB-632D-43F2-A348-B51CF4FD4279}:'IDYN.Components'.ConnectITWriter";
      ConnectITWriterDotNetOnRTC@1000000003 : DotNet "'IDYN.Components, Version=2.7.1.712, Culture=neutral, PublicKeyToken=0f5532c6f6903616'.IDYN.Components.FileManagement.ConnectITWriter" RUNONCLIENT;
      ConnectITWriterDotNetOnNST@1000000004 : DotNet "'IDYN.Components, Version=2.7.1.712, Culture=neutral, PublicKeyToken=0f5532c6f6903616'.IDYN.Components.FileManagement.ConnectITWriter";
      Mode@1000000001 : 'Automation,DotNet on RTC,DotNet on NST';
      ClientSide@1000000002 : Boolean;

    PROCEDURE OpenCSVWriter@1000000000(FileName@1000000000 : Text[1024]) : Boolean;
    BEGIN
      Instantiate;

      CASE Mode OF
        Mode::Automation: EXIT(ConnectITWriterAutomation.OpenCsvWriter(FileName));
        Mode::"DotNet on RTC": EXIT(ConnectITWriterDotNetOnRTC.OpenCsvWriter(FileName));
        Mode::"DotNet on NST": EXIT(ConnectITWriterDotNetOnNST.OpenCsvWriter(FileName));
      END;
    END;

    PROCEDURE OpenFixedWidthWriter@1000000001(FileName@1000000000 : Text[1024]) : Boolean;
    BEGIN
      Instantiate;

      CASE Mode OF
        Mode::Automation: EXIT(ConnectITWriterAutomation.OpenFixedWidthWriter(FileName));
        Mode::"DotNet on RTC": EXIT(ConnectITWriterDotNetOnRTC.OpenFixedWidthWriter(FileName));
        Mode::"DotNet on NST": EXIT(ConnectITWriterDotNetOnNST.OpenFixedWidthWriter(FileName));
      END;
    END;

    PROCEDURE OpenExcelWriter@1000000002(FileName@1000000000 : Text[1024];SheetName@1000000001 : Text[1024]) : Boolean;
    BEGIN
      Instantiate;

      CASE Mode OF
        Mode::Automation: EXIT(ConnectITWriterAutomation.OpenExcelWriter(FileName, SheetName));
        Mode::"DotNet on RTC": EXIT(ConnectITWriterDotNetOnRTC.OpenExcelWriter(FileName, SheetName));
        Mode::"DotNet on NST": EXIT(ConnectITWriterDotNetOnNST.OpenExcelWriter(FileName, SheetName));
      END;
    END;

    PROCEDURE AddRecordDefinition@1000000003(IdentifierTag@1000000000 : Integer;IdentifierValue@1000000001 : Text[1024];ColumnCount@1000000002 : Integer) : Boolean;
    BEGIN
      IF IsInstantiated THEN BEGIN
        CASE Mode OF
          Mode::Automation: EXIT(ConnectITWriterAutomation.AddRecordDefinition(IdentifierTag, IdentifierValue, ColumnCount));
          Mode::"DotNet on RTC": EXIT(ConnectITWriterDotNetOnRTC.AddRecordDefinition(IdentifierTag, IdentifierValue, ColumnCount));
          Mode::"DotNet on NST": EXIT(ConnectITWriterDotNetOnNST.AddRecordDefinition(IdentifierTag, IdentifierValue, ColumnCount));
        END;
      END;
    END;

    PROCEDURE AddColumnParameters@1000000004(IdentifierValue@1000000000 : Text[1024];ColumnWidth@1000000001 : Integer;Alignment@1000000002 : Integer);
    BEGIN
      IF IsInstantiated THEN BEGIN
        CASE Mode OF
          Mode::Automation: ConnectITWriterAutomation.AddColumnParameters(IdentifierValue, ColumnWidth, Alignment);
          Mode::"DotNet on RTC": ConnectITWriterDotNetOnRTC.AddColumnParameters(IdentifierValue, ColumnWidth, Alignment);
          Mode::"DotNet on NST": ConnectITWriterDotNetOnNST.AddColumnParameters(IdentifierValue, ColumnWidth, Alignment);
        END;
      END;
    END;

    PROCEDURE WriteLine@1000000005(VAR ConnectITRecord@1000000000 : Codeunit 11148635);
    VAR
      ConnectITRecordAutomation@1000000001 : Automation "{75E053EA-4A5A-4210-9188-699CF98212FE} 2.7:{9C9B16DA-9FCE-4E46-83AE-AB9824219F2E}:'IDYN.Components'.ConnectITRecord";
      ConnectITRecordDotNetOnRTC@1000000002 : DotNet "'IDYN.Components, Version=2.7.1.712, Culture=neutral, PublicKeyToken=0f5532c6f6903616'.IDYN.Components.FileManagement.ConnectITRecord" RUNONCLIENT;
      ConnectITRecordDotNetOnNST@1000000003 : DotNet "'IDYN.Components, Version=2.7.1.712, Culture=neutral, PublicKeyToken=0f5532c6f6903616'.IDYN.Components.FileManagement.ConnectITRecord";
    BEGIN
      IF IsInstantiated THEN BEGIN
        CASE Mode OF
          Mode::Automation:
            BEGIN
              ConnectITRecord.GetAutomation(ConnectITRecordAutomation);
              ConnectITWriterAutomation.WriteLine(ConnectITRecordAutomation);
            END;
          Mode::"DotNet on RTC":
            BEGIN
              ConnectITRecord.GetDotNetOnRTC(ConnectITRecordDotNetOnRTC);
              ConnectITWriterDotNetOnRTC.WriteLine(ConnectITRecordDotNetOnRTC);
            END;
          Mode::"DotNet on NST":
            BEGIN
              ConnectITRecord.GetDotNetOnNST(ConnectITRecordDotNetOnNST);
              ConnectITWriterDotNetOnNST.WriteLine(ConnectITRecordDotNetOnNST);
            END;
        END;
      END;
    END;

    PROCEDURE Close@1000000006();
    BEGIN
      Instantiate;

      CASE Mode OF
        Mode::Automation: ConnectITWriterAutomation.Close;
        Mode::"DotNet on RTC": ConnectITWriterDotNetOnRTC.Close;
        Mode::"DotNet on NST": ConnectITWriterDotNetOnNST.Close;
      END;
    END;

    PROCEDURE SetFieldSeparator@1000000007(Separator@1000000000 : Text[1]);
    BEGIN
      IF IsInstantiated THEN BEGIN
        CASE Mode OF
          Mode::Automation: ConnectITWriterAutomation.FieldSeparator := Separator;
          Mode::"DotNet on RTC": ConnectITWriterDotNetOnRTC.FieldSeparator := Separator;
          Mode::"DotNet on NST": ConnectITWriterDotNetOnNST.FieldSeparator := Separator;
        END;
      END;
    END;

    PROCEDURE SetFieldDelimiter@1000000008(Delimiter@1000000000 : Text[1]);
    BEGIN
      IF IsInstantiated THEN BEGIN
        CASE Mode OF
          Mode::Automation: ConnectITWriterAutomation.FieldDelimiter := Delimiter;
          Mode::"DotNet on RTC": ConnectITWriterDotNetOnRTC.FieldDelimiter := Delimiter;
          Mode::"DotNet on NST": ConnectITWriterDotNetOnNST.FieldDelimiter := Delimiter;
        END;
      END;
    END;

    LOCAL PROCEDURE Instantiate@1000000012() : Boolean;
    BEGIN
      SetMode;

      IF IsInstantiated THEN
        EXIT(TRUE);

      CASE Mode OF
        Mode::Automation: EXIT(InstantiateAutomation);
        Mode::"DotNet on RTC": EXIT(InstantiateDotNetOnRTC);
        Mode::"DotNet on NST": EXIT(InstantiateDotNetOnNST);
      END;
    END;

    LOCAL PROCEDURE InstantiateAutomation@1000000011() : Boolean;
    BEGIN
      EXIT(CREATE(ConnectITWriterAutomation, TRUE, ClientSide));
    END;

    LOCAL PROCEDURE InstantiateDotNetOnRTC@1000000015() : Boolean;
    BEGIN
      ConnectITWriterDotNetOnRTC := ConnectITWriterDotNetOnRTC.ConnectITWriter;
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE InstantiateDotNetOnNST@1000000016() : Boolean;
    BEGIN
      ConnectITWriterDotNetOnNST := ConnectITWriterDotNetOnNST.ConnectITWriter;
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE IsInstantiated@1000000013() : Boolean;
    BEGIN
      CASE Mode OF
        Mode::Automation: EXIT(NOT ISCLEAR(ConnectITWriterAutomation));
        Mode::"DotNet on RTC": EXIT(NOT ISNULL(ConnectITWriterDotNetOnRTC));
        Mode::"DotNet on NST": EXIT(NOT ISNULL(ConnectITWriterDotNetOnNST));
      END;
    END;

    PROCEDURE SetClientSide@1000000019(ClientSide2@1000000000 : Boolean);
    BEGIN
      ClientSide := ClientSide2;
    END;

    PROCEDURE GetMode@1000000014() : Integer;
    BEGIN
      EXIT(Mode);
    END;

    LOCAL PROCEDURE SetMode@1000000009();
    BEGIN
      IF NOT ISSERVICETIER THEN BEGIN
        Mode := Mode::Automation;
        EXIT;
      END;

      IF ClientSide THEN BEGIN
        Mode := Mode::"DotNet on RTC";
        EXIT;
      END;

      Mode := Mode::"DotNet on NST";
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148618 IN - Export ADO
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    TableNo=11148599;
    OnRun=VAR
            Task@1000023 : Record 11148614;
            Connection@1000001 : Automation "{2A75196C-D9EB-4129-B803-931327F72D5C} 2.8:{00000514-0000-0010-8000-00AA006D2EA4}:'Microsoft ActiveX Data Objects 2.8 Library'.Connection";
          BEGIN
            gRec := Rec;

            TESTFIELD("File Format", "File Format"::ADO);
            IF Status = Status::Blocked THEN
              FIELDERROR(Status);

            FillBuffers(Rec);

            CREATE(Connection,FALSE,TRUE);
            Connection.Open("Connection String");

            WriteTable(Connection);

            IF "Run Task" <> '' THEN BEGIN
              Task.GET("Run Task");
              Task.Process;
            END;

            IF "Execute in ADO Database" <> '' THEN
              Connection.Execute("Execute in ADO Database");
          END;

  }
  CODE
  {
    VAR
      gRec@1000002 : Record 11148599;
      gTmpExportDefLine@1000004 : TEMPORARY Record 11148600;
      gTmpExportDefTableLink@1000003 : TEMPORARY Record 11148601;
      gTmpExportDefFunction@1100531001 : TEMPORARY Record 11148602;
      gRecRef@1000000 : RecordRef;
      gxRecRef@1000008 : RecordRef;
      gFieldnameArray@1000010 : ARRAY [100] OF Text[1024];
      gTrigger@1000009 : Text[30];
      gNoOfFields@1000014 : Integer;
      gNoOfRecordsProcessed@1100531000 : Integer;
      gRecRefSet@1000001 : Boolean;
      gxRecRefSet@1000007 : Boolean;

    LOCAL PROCEDURE WriteTable@1000005(VAR Connection@1000029 : Automation "{2A75196C-D9EB-4129-B803-931327F72D5C} 2.8:{00000514-0000-0010-8000-00AA006D2EA4}:'Microsoft ActiveX Data Objects 2.8 Library'.Connection");
    VAR
      Mgt@1000014 : Codeunit 11148589;
      VariableMgt@1000020 : Codeunit 11148619;
      Progressbar@1000013 : Codeunit 11148624;
      Recordset@1000000 : Automation "{2A75196C-D9EB-4129-B803-931327F72D5C} 2.8:{00000535-0000-0010-8000-00AA006D2EA4}:'Microsoft ActiveX Data Objects 2.8 Library'.Recordset";
      RecRef@1000017 : RecordRef;
      xRecRef@1000016 : RecordRef;
      FldRef@1000015 : FieldRef;
      ThisFldRef@1000008 : FieldRef;
      ValueToWrite@1000004 : Text[1024];
      i@1000019 : Integer;
    BEGIN
      gTmpExportDefLine.SETCURRENTKEY("Export Definition", "Line No.");
      gTmpExportDefLine.SETFILTER("Table No.", '<>%1', 0);
      gTmpExportDefLine.FINDFIRST;

      IF gRecRefSet THEN
        RecRef := gRecRef
      ELSE
        IF gRec."Company Name" = '' THEN
          RecRef.OPEN(gTmpExportDefLine."Table No.")
        ELSE
          RecRef.OPEN(gTmpExportDefLine."Table No.", FALSE, gRec."Company Name");

      IF gxRecRefSet THEN
        xRecRef := gxRecRef;

      Mgt.SetFilterOnRecordRef(RecRef, FORMAT(gTmpExportDefLine."Table Filter"));

      gTmpExportDefTableLink.SETRANGE("Export Definition", gRec.Code);
      gTmpExportDefTableLink.SETRANGE("Export Def. Entry No.", gTmpExportDefLine."Entry No.");
      gTmpExportDefTableLink.SETFILTER(Variable, '<>%1', '');
      IF gTmpExportDefTableLink.FINDSET THEN
        REPEAT
          ThisFldRef := RecRef.FIELD(gTmpExportDefTableLink."Main Field No.");
          ThisFldRef.SETRANGE := VariableMgt.GetVariable(gTmpExportDefTableLink.Variable);
        UNTIL gTmpExportDefTableLink.NEXT = 0;

      gTmpExportDefLine.SETRANGE("Table No.");

      gNoOfRecordsProcessed := RecRef.COUNT;
      Progressbar.InitializeBar(1, gNoOfRecordsProcessed);

      CREATE(Recordset,FALSE,TRUE);
      Recordset.Open(gRec."SQL String", Connection, 1, 3, 1);

      gNoOfFields := Recordset.Fields.Count;
      FOR i := 1 TO gNoOfFields DO
        gFieldnameArray[i] := Recordset.Fields.Item(i - 1).Name;

      IF RecRef.FINDSET THEN
        REPEAT

          Recordset.AddNew;

          Progressbar.AddRecordCounter(1, 1, FORMAT(RecRef.RECORDID));

          gTmpExportDefLine.SETCURRENTKEY("Export Definition", "Line No.");
          gTmpExportDefLine.FINDFIRST;

          IF gTmpExportDefLine.FINDSET THEN
            REPEAT

              ValueToWrite := '';

              CASE gTmpExportDefLine.Type OF
                gTmpExportDefLine.Type::Table, gTmpExportDefLine.Type::Field :
                  BEGIN
                    IF (gTmpExportDefLine."Original Value") AND gxRecRefSet THEN
                      FldRef := xRecRef.FIELD(gTmpExportDefLine."Field No.")
                    ELSE
                      FldRef := RecRef.FIELD(gTmpExportDefLine."Field No.");

                    ValueToWrite := ConvertFieldValue(RecRef, FldRef, gTmpExportDefLine);
                  END;

                gTmpExportDefLine.Type::Const :
                  ValueToWrite := gTmpExportDefLine.Code;

                gTmpExportDefLine.Type::Variable :
                  ValueToWrite := VariableMgt.GetVariable(gTmpExportDefLine.Code);

              END;

              IF FieldExist(gTmpExportDefLine."Tag Name") THEN
                Recordset.Fields.Item(gTmpExportDefLine."Tag Name").Value := ValueToWrite;

              IF gTmpExportDefLine."Dest. Variable" <> '' THEN
                VariableMgt.SetVariable(gTmpExportDefLine."Dest. Variable", ValueToWrite);

            UNTIL gTmpExportDefLine.NEXT = 0;

          Recordset.Update;
        UNTIL RecRef.NEXT = 0;
    END;

    LOCAL PROCEDURE FillBuffers@1100531001(VAR ExportDefinition@1000002 : Record 11148599);
    VAR
      ExportDefLine@1000004 : Record 11148600;
      ExportDefTableLink@1000003 : Record 11148601;
      ExportDefFunction@1100531000 : Record 11148602;
    BEGIN
      gTmpExportDefLine.RESET;
      gTmpExportDefLine.DELETEALL;

      gTmpExportDefTableLink.RESET;
      gTmpExportDefTableLink.DELETEALL;

      gTmpExportDefFunction.RESET;
      gTmpExportDefFunction.DELETEALL;

      ExportDefLine.SETRANGE("Export Definition", ExportDefinition.Code);
      ExportDefLine.SETFILTER(Type, '<>%1', ExportDefLine.Type::" ");
      IF ExportDefLine.FINDSET THEN
        REPEAT
          gTmpExportDefLine := ExportDefLine;
          gTmpExportDefLine.Functions := FALSE;
          gTmpExportDefLine.INSERT;
        UNTIL ExportDefLine.NEXT = 0;

      ExportDefTableLink.SETRANGE("Export Definition", ExportDefinition.Code);
      IF ExportDefTableLink.FINDSET THEN
        REPEAT
          gTmpExportDefTableLink := ExportDefTableLink;
          gTmpExportDefTableLink.INSERT;
        UNTIL ExportDefTableLink.NEXT = 0;

      ExportDefFunction.SETRANGE("Export Definition", ExportDefinition.Code);
      IF ExportDefFunction.FINDSET THEN
        REPEAT
          gTmpExportDefFunction := ExportDefFunction;
          gTmpExportDefFunction.INSERT;

          IF gTmpExportDefLine.GET(ExportDefFunction."Export Definition", ExportDefFunction."Export Def. Entry No.") THEN BEGIN
            gTmpExportDefLine.Functions := TRUE;
            gTmpExportDefLine.MODIFY;
          END;

        UNTIL ExportDefFunction.NEXT = 0;
    END;

    LOCAL PROCEDURE ConvertFieldValue@1000001(VAR RecRef@1100531000 : RecordRef;VAR FldRef@1000000 : FieldRef;VAR ExportDefLine@1000001 : Record 11148600) ExitValue : Text[1024];
    VAR
      ConversionLine@1000002 : Record 11148606;
      FunctionMgt@1100531001 : Codeunit 11148593;
      i@1000003 : Integer;
    BEGIN
      IF FORMAT(FldRef.CLASS) = 'FlowField' THEN
        FldRef.CALCFIELD;

      IF FORMAT(FldRef.TYPE) = 'Option' THEN
        CASE ExportDefLine."Option Type" OF

          ExportDefLine."Option Type"::Value :
            ExitValue := FORMAT(FldRef.VALUE);

          ExportDefLine."Option Type"::Name :
            BEGIN
              EVALUATE(i, FORMAT(FldRef.VALUE));
              ExitValue := SELECTSTR(i + 1, FORMAT(FldRef.OPTIONSTRING));
            END;

          ExportDefLine."Option Type"::Caption :
            BEGIN
              EVALUATE(i, FORMAT(FldRef.VALUE));
              ExitValue := SELECTSTR(i + 1, FORMAT(FldRef.OPTIONCAPTION));
            END;
        END

      ELSE
        IF ExportDefLine."Data Format" = '' THEN
          ExitValue := FORMAT(FldRef.VALUE, 0, 9)
        ELSE
          ExitValue := FORMAT(FldRef.VALUE, 0, ExportDefLine."Data Format");

      IF ExportDefLine.Functions THEN BEGIN
        gTmpExportDefFunction.SETRANGE("Export Definition", ExportDefLine."Export Definition");
        gTmpExportDefFunction.SETRANGE("Export Def. Entry No.", ExportDefLine."Entry No.");
        IF gTmpExportDefFunction.FINDSET THEN
          REPEAT
            FunctionMgt.ExportProcessRun(ExportDefLine, gTmpExportDefFunction, ExitValue);
          UNTIL gTmpExportDefFunction.NEXT = 0;
      END;

      IF ExportDefLine."Conversion Code" <> '' THEN BEGIN
        ConversionLine.SETCURRENTKEY("Conversion Code", "NAV Value");
        ConversionLine.SETFILTER("Conversion Code", '@' + ExportDefLine."Conversion Code");
        ConversionLine.SETFILTER("NAV Value", '@' + ExitValue);
        IF ConversionLine.FINDFIRST THEN
          ExitValue := ConversionLine."Extern Value";
      END;

      ExitValue := ExportDefLine."Before Field" + ExitValue + ExportDefLine."After Field";
    END;

    PROCEDURE SetRecRef@1000002(VAR NewRecRef@1000000 : RecordRef);
    BEGIN
      gRecRef := NewRecRef;
      gRecRefSet := TRUE;
    END;

    PROCEDURE SetxRecRef@1000020(VAR NewxRecRef@1000000 : RecordRef);
    BEGIN
      gxRecRef := NewxRecRef;
      gxRecRefSet := TRUE;
    END;

    PROCEDURE SetTrigger@1000021(NewValue@1000000 : Text[1024]);
    BEGIN
      gTrigger := NewValue;
    END;

    PROCEDURE GetFieldsFromConnection@1000007(VAR ExportDefinition@1000000 : Record 11148599;VAR NoOfFields@1000003 : Integer;VAR FieldnameArray@1000004 : ARRAY [100] OF Text[1024]);
    VAR
      Connection@1000002 : Automation "{2A75196C-D9EB-4129-B803-931327F72D5C} 2.8:{00000514-0000-0010-8000-00AA006D2EA4}:'Microsoft ActiveX Data Objects 2.8 Library'.Connection";
      Recordset@1000001 : Automation "{2A75196C-D9EB-4129-B803-931327F72D5C} 2.8:{00000535-0000-0010-8000-00AA006D2EA4}:'Microsoft ActiveX Data Objects 2.8 Library'.Recordset";
      i@1000005 : Integer;
    BEGIN
      WITH ExportDefinition DO BEGIN
        TESTFIELD("Connection String");
        TESTFIELD("SQL String");

        CREATE(Connection,FALSE,TRUE);
        Connection.Open("Connection String");

        CREATE(Recordset,FALSE,TRUE);
        Recordset.Open("SQL String", Connection);

        NoOfFields := Recordset.Fields.Count;
        FOR i := 1 TO NoOfFields DO
          FieldnameArray[i] := Recordset.Fields.Item(i - 1).Name;

      END;

      Connection.Close;
    END;

    LOCAL PROCEDURE FieldExist@1000006(FieldnameToCheck@1000000 : Text[1024]) : Boolean;
    VAR
      i@1000001 : Integer;
    BEGIN
      FOR i := 1 TO gNoOfFields DO
        IF FieldnameToCheck = gFieldnameArray[i] THEN
          EXIT(TRUE);
    END;

    PROCEDURE NoOfRecordsProcessed@1100531000() : Integer;
    BEGIN
      EXIT(gNoOfRecordsProcessed);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148619 IN - Variable Management
{
  OBJECT-PROPERTIES
  {
    Date=05-06-13;
    Time=13:00:00;
    Version List=IDYN-CE5.50.1;
  }
  PROPERTIES
  {
    SingleInstance=Yes;
    OnRun=BEGIN
            CreateVariables;
          END;

  }
  CODE
  {
    VAR
      TextValue@1000003 : ARRAY [100] OF Text[1024];
      TextCode@1000004 : ARRAY [100] OF Code[20];
      NoOfVariables@1000005 : Integer;

    PROCEDURE SetVariable@1000001(Code@1100493001 : Code[20];NewValue@1100493002 : Text[1024]);
    VAR
      i@1100493000 : Integer;
      NameFound@1100493003 : Boolean;
    BEGIN
      FOR i := 1 TO NoOfVariables DO
        IF TextCode[i] = Code THEN BEGIN
          NameFound := TRUE;
          TextValue[i] := NewValue;
        END;

      IF NOT NameFound THEN BEGIN
        NoOfVariables += 1;
        TextCode[NoOfVariables] := Code;
        TextValue[NoOfVariables] := NewValue;
      END;
    END;

    PROCEDURE SetVariableIfExists@1000003(Code@1100493001 : Code[20];NewValue@1100493002 : Text[1024]);
    VAR
      Variable@1000000 : Record 11148604;
      i@1100493000 : Integer;
      NameFound@1100493003 : Boolean;
    BEGIN
      IF Variable.GET(Code) THEN BEGIN
        FOR i := 1 TO NoOfVariables DO
          IF TextCode[i] = Code THEN BEGIN
            NameFound := TRUE;
            TextValue[i] := NewValue;
          END;

        IF NOT NameFound THEN BEGIN
          NoOfVariables += 1;
          TextCode[NoOfVariables] := Code;
          TextValue[NoOfVariables] := NewValue;
        END;
      END;
    END;

    PROCEDURE GetVariable@1000000(Code@1100493002 : Code[20]) : Text[1024];
    VAR
      i@1100493001 : Integer;
    BEGIN
      FOR i := 1 TO NoOfVariables DO
        IF TextCode[i] = Code THEN
          EXIT(TextValue[i]);

      EXIT('');
    END;

    PROCEDURE CreateVariables@1000000000();
    VAR
      Variable@1000000000 : Record 11148604;
    BEGIN
      Variable.Code := '#FILENAME#';
      Variable.Description := 'Filename';
      IF Variable.INSERT THEN;

      Variable.Code := '#PATH#';
      Variable.Description := 'Path';
      IF Variable.INSERT THEN;

      Variable.Code := '#DEF_CODE#';
      Variable.Description := 'Definition Code';
      IF Variable.INSERT THEN;

      Variable.Code := '#DEF_DESCRIPTION#';
      Variable.Description := 'Definition Description';
      IF Variable.INSERT THEN;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148620 IN - Monitoring
{
  OBJECT-PROPERTIES
  {
    Date=24-05-13;
    Time=13:00:00;
    Version List=IDYN-CE5.50.0;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE GlobalModifyRecord@1000000(VAR RecRef@1000000 : RecordRef;VAR xRecRef@1000001 : RecordRef);
    BEGIN
      AddJobRecords(RecRef, xRecRef, 1, TRUE);
    END;

    PROCEDURE GlobalDeleteRecord@1000001(VAR RecRef@1000000 : RecordRef);
    BEGIN
      AddJobRecords(RecRef, RecRef, 2, TRUE);
    END;

    PROCEDURE GlobalInsertRecord@1000003(VAR RecRef@1000000 : RecordRef);
    BEGIN
      AddJobRecords(RecRef, RecRef, 0, TRUE);
    END;

    PROCEDURE GlobalRenameRecord@1000006(VAR RecRef@1000000 : RecordRef;VAR xRecRef@1000001 : RecordRef);
    BEGIN
      AddJobRecords(RecRef, xRecRef, 3, TRUE);
    END;

    PROCEDURE ModifyRecord@1000005(VAR RecRef@1000000 : RecordRef;VAR xRecRef@1000001 : RecordRef);
    BEGIN
      AddJobRecords(RecRef, xRecRef, 1, FALSE);
    END;

    PROCEDURE DeleteRecord@1000004(VAR RecRef@1000000 : RecordRef);
    BEGIN
      AddJobRecords(RecRef, RecRef, 2, FALSE);
    END;

    PROCEDURE InsertRecord@1000002(VAR RecRef@1000000 : RecordRef);
    BEGIN
      AddJobRecords(RecRef, RecRef, 0, FALSE);
    END;

    PROCEDURE RenameRecord@1000007(VAR RecRef@1000000 : RecordRef;VAR xRecRef@1000001 : RecordRef);
    BEGIN
      AddJobRecords(RecRef, xRecRef, 3, FALSE);
    END;

    LOCAL PROCEDURE AddJobRecords@1000008(VAR RecRef@1000001 : RecordRef;VAR xRecRef@1000012 : RecordRef;Trigger@1000003 : 'Insert,Modify,Delete,Rename';FromChangeLog@1000007 : Boolean);
    VAR
      MonitoringSetup@1000002 : Record 11148607;
      ExportJob@1000000 : Record 11148608;
      Company@1000009 : Record 2000000006;
      Fld@1000014 : Record 2000000041;
      ExportDefinitionLine@1000015 : Record 11148600;
      RecordValue@1000016 : Record 11148619;
      MonitoringExcludedTable@1000017 : Record 11148622;
      RecRef2@1000004 : RecordRef;
      FldRef@1000010 : FieldRef;
      FldRef2@1000011 : FieldRef;
      RecordInFilter@1000005 : Boolean;
      Mgt@1000006 : Codeunit 11148589;
      ProcessExportJob@1000008 : Codeunit 11148621;
      i@1000013 : Integer;
    BEGIN
      IF FromChangeLog THEN BEGIN
        MonitoringExcludedTable.SETCURRENTKEY("Table No.");
        MonitoringExcludedTable.SETRANGE("Table No.", RecRef.NUMBER);
        IF NOT MonitoringExcludedTable.ISEMPTY THEN
          EXIT;
      END;

      MonitoringSetup.SETCURRENTKEY("Table No.");
      MonitoringSetup.SETRANGE("Table No.", RecRef.NUMBER);
      MonitoringSetup.SETFILTER("Export Definition", '<>%1', '');

      CASE Trigger OF
        Trigger::Insert :
          MonitoringSetup.SETRANGE("Export Insert", TRUE);
        Trigger::Modify :
          MonitoringSetup.SETRANGE("Export Modify", TRUE);
        Trigger::Delete :
          MonitoringSetup.SETRANGE("Export Delete", TRUE);
        Trigger::Rename :
          MonitoringSetup.SETRANGE("Export Rename", TRUE);
      END;

      IF MonitoringSetup.FINDSET THEN
        REPEAT

          IF FORMAT(MonitoringSetup."Table Filter") IN ['', Mgt.EmptyTableFilter(MonitoringSetup."Table No.")] THEN
            RecordInFilter := TRUE
          ELSE BEGIN
            IF Trigger IN [Trigger::Insert, Trigger::Rename] THEN BEGIN
              RecRef2.CLOSE;
              RecRef2.OPEN(RecRef.NUMBER, TRUE);

              Fld.SETRANGE(TableNo, RecRef.NUMBER);
              Mgt.SetFieldTypeFilter(Fld, FALSE);
              IF Fld.FINDSET THEN
                REPEAT
                  FldRef := RecRef.FIELD(Fld."No.");
                  FldRef2 := RecRef2.FIELD(Fld."No.");
                  FldRef2.VALUE := FldRef.VALUE;
                UNTIL Fld.NEXT = 0;
              RecRef2.INSERT;
            END ELSE BEGIN
              RecRef2.CLOSE;
              RecRef2.OPEN(RecRef.NUMBER, TRUE);
              FOR i := 1 TO RecRef2.FIELDCOUNT DO BEGIN
                FldRef2 := RecRef2.FIELDINDEX(i);
                FldRef := RecRef.FIELDINDEX(i);
                FldRef2.VALUE := FldRef.VALUE;
              END;
              RecRef2.INSERT;
            END;
            Mgt.SetFilterOnRecordRef(RecRef2, FORMAT(MonitoringSetup."Table Filter"));
            RecordInFilter := RecRef2.FIND('=');
          END;

          IF RecordInFilter THEN BEGIN
            ExportJob.INIT;
            CLEAR(ExportJob."Entry No.");
            ExportJob."Setup Entry No." := MonitoringSetup."Entry No.";
            ExportJob."Table No." := MonitoringSetup."Table No.";
            ExportJob."Table Filter" := MonitoringSetup."Table Filter";
            ExportJob."Export Definition" := MonitoringSetup."Export Definition";
            ExportJob."Export Moment" := MonitoringSetup."Export Moment";
            EVALUATE(ExportJob."Record Filter", BuildTableFilter(RecRef));

            IF Trigger IN [Trigger::Delete, Trigger::Rename] THEN
              EVALUATE(ExportJob."Original Record Filter", BuildTableFilter(xRecRef));

            ExportJob.Trigger := Trigger;
            ExportJob."Group per" := MonitoringSetup."Group per";
            ExportJob."Export in all Companies" := MonitoringSetup."Export from all Companies";
            ExportJob."DateTime Inserted" := CURRENTDATETIME;
            ExportJob."Trigger Dest. Variable" := MonitoringSetup."Trigger Dest. Variable";
            ExportJob."Job Entry No. Dest. Variable" := MonitoringSetup."Job Entry No. Dest. Variable";
            ExportJob."Processing Codeunit" := MonitoringSetup."Processing Codeunit";
            ExportJob.INSERT(TRUE);

            ExportDefinitionLine.SETRANGE("Export Definition", MonitoringSetup."Export Definition");
            ExportDefinitionLine.SETRANGE("Table No.", MonitoringSetup."Table No.");
            IF Trigger <> Trigger::Delete THEN
              ExportDefinitionLine.SETRANGE("Original Value", TRUE);
            ExportDefinitionLine.SETFILTER("Field No.", '<>0');
            IF ExportDefinitionLine.FINDSET THEN BEGIN
              RecordValue.Type := RecordValue.Type::"Export Job";
              RecordValue."Entry No." := ExportJob."Entry No.";
              RecordValue."Table No." := MonitoringSetup."Table No.";
              REPEAT
                IF Trigger = Trigger::Delete THEN
                  FldRef := RecRef.FIELD(ExportDefinitionLine."Field No.")
                ELSE
                  FldRef := xRecRef.FIELD(ExportDefinitionLine."Field No.");
                RecordValue."Field No." := FldRef.NUMBER;
                RecordValue."Original Value" := FORMAT(FldRef.VALUE);
                IF RecordValue.INSERT THEN
                  ;

              UNTIL ExportDefinitionLine.NEXT = 0;
            END;

            IF MonitoringSetup."Export from all Companies" THEN BEGIN
              Company.SETFILTER(Name, '<>%1', COMPANYNAME);
              IF Company.FINDSET THEN
                REPEAT
                  CLEAR(ExportJob."Entry No.");
                  ExportJob.CHANGECOMPANY(Company.Name);
                  ExportJob.INSERT(TRUE);
                UNTIL Company.NEXT = 0;
            END;

            IF ExportJob."Export Moment" = ExportJob."Export Moment"::Live THEN BEGIN
              RecRef2.CLOSE;
              RecRef2.OPEN(RecRef.NUMBER, TRUE);
              FOR i := 1 TO RecRef.FIELDCOUNT DO BEGIN
                FldRef := RecRef.FIELDINDEX(i);
                IF FORMAT(FldRef.TYPE) <> 'BLOB' THEN BEGIN
                  FldRef2 := RecRef2.FIELDINDEX(i);
                  FldRef2.VALUE := FldRef.VALUE;
                END;
              END;
              RecRef2.INSERT;

              ProcessExportJob.LiveRecRef(RecRef2);
              ProcessExportJob.RUN(ExportJob);
              RecRef2.CLOSE;

            END;

          END;

        UNTIL MonitoringSetup.NEXT = 0;
    END;

    LOCAL PROCEDURE BuildTableFilter@1000009(VAR RecRef@1000000 : RecordRef) ExitValue : Text[1024];
    VAR
      Mgt@1000008 : Codeunit 11148589;
      Fld@1000002 : Record 2000000041;
      RecRef2@1000001 : RecordRef;
      FldRef@1000003 : FieldRef;
      FirstField@1000004 : Boolean;
      FldFilter@1000005 : Text[1024];
    BEGIN
      RecRef2 := RecRef.DUPLICATE;
      RecRef2.RESET;

      Fld.SETRANGE(TableNo, RecRef2.NUMBER);
      Mgt.SetFieldTypeFilter(Fld, FALSE);
      RecRef2.SETRECFILTER;

      FirstField := TRUE;

      ExitValue := MakeFilterValue(RecRef2.NAME) + ': ';

      IF Fld.FINDSET THEN
        REPEAT
          FldRef := RecRef2.FIELD(Fld."No.");

          IF FldRef.GETFILTER <> '' THEN BEGIN
            FldFilter :=
              MakeFilterValue(Fld."Field Caption") + '=' +
              MakeFilterValue(FldRef.GETFILTER);
            IF FirstField THEN BEGIN
              ExitValue := ExitValue + FldFilter;
              FirstField := FALSE;
            END ELSE
              IF STRLEN(ExitValue + ',' + FldFilter) < 252 THEN
                ExitValue := ExitValue + ',' + FldFilter;
          END;

        UNTIL Fld.NEXT = 0;
    END;

    LOCAL PROCEDURE MakeFilterValue@1100495000(String@1100495000 : Text[1024]) RetValue : Text[1024];
    VAR
      i@1100495003 : Integer;
    BEGIN
      RetValue := String;

      i := STRLEN(RetValue);

      WHILE i > 0 DO BEGIN
        IF RetValue[i] = '"' THEN
          RetValue := COPYSTR(RetValue, 1, i) + COPYSTR(RetValue, i);
        i -= 1;
      END;

      RetValue := '"' + RetValue + '"';
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148621 IN - Process Export Job
{
  OBJECT-PROPERTIES
  {
    Date=24-05-13;
    Time=13:00:00;
    Version List=IDYN-CE5.50.0;
  }
  PROPERTIES
  {
    TableNo=11148608;
    OnRun=VAR
            TmpExportJob@1000001 : TEMPORARY Record 11148608;
            CommentMgt@1000005 : Codeunit 11148622;
            RecRef@1000002 : RecordRef;
            xRecRef@1000003 : RecordRef;
            Succeeded@1000006 : Boolean;
          BEGIN
            CommentMgt.Reset;

            IF "Processing Codeunit" = 0 THEN BEGIN
              GetAllJobsToExport(Rec, TmpExportJob);
              FillRecRef(TmpExportJob, RecRef);
              FillxRecRef(TmpExportJob, xRecRef);

              Succeeded := RunExport(Rec, RecRef, xRecRef);
              SetStatusToExportJobs(TmpExportJob, Succeeded);
            END ELSE BEGIN
              CODEUNIT.RUN("Processing Codeunit", Rec);
            END;
          END;

  }
  CODE
  {
    VAR
      gRecRef@1000000 : RecordRef;
      RecRefSet@1000001 : Boolean;
      xRecRefSet@1000002 : Boolean;

    LOCAL PROCEDURE GetAllJobsToExport@1000003(VAR ExportJob@1000001 : Record 11148608;VAR TmpExportJob@1000000 : Record 11148608);
    VAR
      ExportJob2@1000002 : Record 11148608;
    BEGIN
      TmpExportJob := ExportJob;
      TmpExportJob.INSERT;

      CASE ExportJob."Group per" OF

        ExportJob."Group per"::" " :
          BEGIN
            TmpExportJob := ExportJob2;
            IF TmpExportJob.INSERT THEN
              ;
          END;

        ExportJob."Group per"::Record :
          BEGIN
            ExportJob2.SETCURRENTKEY(Status, "Export Definition");
            ExportJob2.SETRANGE(Status, ExportJob2.Status::New);
            ExportJob2.SETRANGE("Export Definition", ExportJob."Export Definition");
            ExportJob2.SETRANGE("Table No.", ExportJob."Table No.");
            ExportJob2.SETRANGE(Trigger, ExportJob.Trigger);
            IF ExportJob2.FINDSET THEN
              REPEAT
                IF FORMAT(ExportJob2."Record Filter") = FORMAT(ExportJob."Record Filter") THEN BEGIN
                  TmpExportJob := ExportJob2;
                  IF TmpExportJob.INSERT THEN
                    ;
                END;
              UNTIL ExportJob2.NEXT = 0;
          END;

        ExportJob."Group per"::Table :
          BEGIN
            ExportJob2.SETCURRENTKEY(Status, "Export Definition");
            ExportJob2.SETRANGE(Status, ExportJob2.Status::New);
            ExportJob2.SETRANGE("Export Definition", ExportJob."Export Definition");
            ExportJob2.SETRANGE("Table No.", ExportJob."Table No.");
            ExportJob2.SETRANGE(Trigger, ExportJob.Trigger);
            IF ExportJob2.FINDSET THEN
              REPEAT
                TmpExportJob := ExportJob2;
                IF TmpExportJob.INSERT THEN
                  ;
              UNTIL ExportJob2.NEXT = 0;
          END;

      END;
    END;

    LOCAL PROCEDURE FillRecRef@1000006(VAR TmpExportJob@1000000 : Record 11148608;VAR RecRef@1000001 : RecordRef);
    VAR
      Fld@1000004 : Record 2000000041;
      Mgt@1000003 : Codeunit 11148589;
      ImportDefMgt@1000007 : Codeunit 11148591;
      RecRef2@1000002 : RecordRef;
      FldRef@1000005 : FieldRef;
      FldRef2@1000006 : FieldRef;
    BEGIN
      IF RecRefSet THEN BEGIN
        RecRef := gRecRef;
        EXIT;
      END;

      WITH TmpExportJob DO BEGIN
        FINDFIRST;
        RecRef.OPEN("Table No.", TRUE);

        CASE Trigger OF

          Trigger::Delete :
            REPEAT

              RecRef2.OPEN("Table No.");
              Mgt.SetFilterOnRecordRef(RecRef2, FORMAT("Original Record Filter"));

              Fld.SETRANGE(TableNo, "Table No.");
              Mgt.SetFieldTypeFilter(Fld, FALSE);
              IF Fld.FINDSET THEN
                REPEAT
                  FldRef := RecRef2.FIELD(Fld."No.");
                  IF FldRef.GETFILTER <> '' THEN BEGIN
                    ImportDefMgt.EvaluateFieldRefValue(FldRef, Fld.Type, FldRef.GETFILTER, FALSE);
                    FldRef2 := RecRef.FIELD(Fld."No.");
                    FldRef2.VALUE := FldRef.VALUE;
                  END;
                UNTIL Fld.NEXT = 0;
              RecRef2.CLOSE;
              IF RecRef.INSERT THEN
                ;

            UNTIL NEXT = 0;

          ELSE BEGIN

            RecRef2.OPEN("Table No.");
            REPEAT
              RecRef2.RESET;
              Mgt.SetFilterOnRecordRef(RecRef2, FORMAT("Record Filter"));
              IF RecRef2.FINDFIRST THEN BEGIN

                Fld.SETRANGE(TableNo, "Table No.");
                Mgt.SetFieldTypeFilter(Fld, FALSE);
                IF Fld.FINDSET THEN
                  REPEAT
                    FldRef2 := RecRef2.FIELD(Fld."No.");
                    FldRef := RecRef.FIELD(Fld."No.");
                    FldRef.VALUE := FldRef2.VALUE;
                  UNTIL Fld.NEXT = 0;
                IF RecRef.INSERT THEN
                  ;
              END;

            UNTIL NEXT = 0;
            RecRef2.CLOSE;
          END;
        END;
      END;
    END;

    LOCAL PROCEDURE FillxRecRef@1000005(VAR TmpExportJob@1000001 : Record 11148608;VAR xRecRef@1000000 : RecordRef);
    VAR
      ExportDefinitionLine@1000003 : Record 11148600;
      RecordValue@1000009 : Record 11148619;
      Fld@1000007 : Record 2000000041;
      Mgt@1000006 : Codeunit 11148589;
      ImportDefMgt@1000008 : Codeunit 11148591;
      RecRef2@1000005 : RecordRef;
      FldRef@1000011 : FieldRef;
      FldRef2@1000010 : FieldRef;
    BEGIN
      WITH TmpExportJob DO BEGIN

        xRecRef.OPEN("Table No.", TRUE);
        FINDFIRST;

        CASE Trigger OF

          Trigger::Modify :
            BEGIN
              ExportDefinitionLine.SETRANGE("Export Definition", "Export Definition");
              ExportDefinitionLine.SETRANGE("Original Value", TRUE);
              IF NOT ExportDefinitionLine.ISEMPTY THEN

                REPEAT
                  RecordValue.SETRANGE(Type, RecordValue.Type::"Export Job");
                  RecordValue.SETRANGE("Entry No.", "Entry No.");
                  IF RecordValue.FINDSET THEN
                    REPEAT
                      IF Fld.GET(RecordValue."Table No.", RecordValue."Field No.") THEN BEGIN
                        FldRef := xRecRef.FIELD(RecordValue."Field No.");
                        IF FORMAT(FldRef.TYPE) <> 'BLOB' THEN
                          ImportDefMgt.EvaluateFieldRefValue(FldRef, Fld.Type, RecordValue."Original Value", FALSE);
                      END;
                    UNTIL RecordValue.NEXT = 0;

                  RecRef2.OPEN("Table No.", TRUE);
                  Mgt.SetFilterOnRecordRef(RecRef2, FORMAT("Original Record Filter"));
                  Fld.SETRANGE(TableNo, "Table No.");
                  Mgt.SetFieldTypeFilter(Fld, FALSE);
                  IF Fld.FINDSET THEN
                    REPEAT
                      FldRef := RecRef2.FIELD(Fld."No.");
                      IF FldRef.GETFILTER <> '' THEN BEGIN
                        ImportDefMgt.EvaluateFieldRefValue(FldRef, Fld.Type, FldRef.GETFILTER, FALSE);
                        FldRef2 := xRecRef.FIELD(Fld."No.");
                        FldRef2.VALUE := FldRef.VALUE;
                      END;
                    UNTIL Fld.NEXT = 0;
                  RecRef2.CLOSE;

                  IF xRecRef.INSERT THEN
                    xRecRefSet := TRUE;

                UNTIL NEXT = 0;
            END;

          Trigger::Rename :
            BEGIN
              RecRef2.OPEN("Table No.");
              ExportDefinitionLine.SETRANGE("Export Definition", "Export Definition");
              ExportDefinitionLine.SETRANGE("Original Value", TRUE);
              REPEAT
                RecRef2.RESET;
                Mgt.SetFilterOnRecordRef(RecRef2, FORMAT("Original Record Filter"));

                Fld.SETRANGE(TableNo, "Table No.");
                Mgt.SetFieldTypeFilter(Fld, FALSE);
                IF Fld.FINDSET THEN
                  REPEAT
                    FldRef := RecRef2.FIELD(Fld."No.");
                    IF FldRef.GETFILTER <> '' THEN BEGIN
                      ImportDefMgt.EvaluateFieldRefValue(FldRef, Fld.Type, FldRef.GETFILTER, FALSE);
                      FldRef2 := xRecRef.FIELD(Fld."No.");
                      FldRef2.VALUE := FldRef.VALUE;
                    END;
                  UNTIL Fld.NEXT = 0;

                IF ExportDefinitionLine.FINDSET THEN
                  REPEAT
                    FldRef2 := xRecRef.FIELD(Fld."No.");
                    FldRef2.VALUE := FldRef.VALUE;

                  UNTIL NEXT = 0;

                IF xRecRef.INSERT THEN
                  xRecRefSet := TRUE;

              UNTIL NEXT = 0;
              RecRef2.CLOSE;
            END;

        END;

      END;
    END;

    LOCAL PROCEDURE RunExport@1000004(VAR ExportJob@1000000 : Record 11148608;VAR RecRef@1000001 : RecordRef;VAR xRecRef@1000002 : RecordRef) ExitValue : Boolean;
    VAR
      ExportDefinition@1000007 : Record 11148599;
      ExportDefinitionLine@1100531000 : Record 11148600;
      ExportXMLFile@1000003 : Codeunit 11148609;
      ExportFile@1000004 : Codeunit 11148610;
      StartExportADO@1000009 : Codeunit 11148613;
      VariableMgt@1000008 : Codeunit 11148619;
    BEGIN
      ExportDefinition.GET(ExportJob."Export Definition");

      IF ExportDefinition.Status = ExportDefinition.Status::Manual THEN
        EXIT(FALSE);

      COMMIT;
      IF ExportJob."Trigger Dest. Variable" <> '' THEN
        VariableMgt.SetVariable(ExportJob."Trigger Dest. Variable", FORMAT(ExportJob.Trigger));

      IF ExportJob."Job Entry No. Dest. Variable" <> '' THEN
        VariableMgt.SetVariable(ExportJob."Job Entry No. Dest. Variable", FORMAT(ExportJob."Entry No."));

      CASE ExportDefinition."File Format" OF
        ExportDefinition."File Format"::XML :
          BEGIN

            ExportDefinitionLine.SETRANGE("Export Definition", ExportDefinition.Code);
            ExportDefinitionLine.SETRANGE(Type, ExportDefinitionLine.Type::Table);
            ExportDefinitionLine.SETRANGE("Table No.", ExportJob."Table No.");
            IF ExportDefinitionLine.FINDSET THEN
              REPEAT
                ExportXMLFile.SetRecRef(RecRef, ExportDefinitionLine."Entry No.");
                IF ExportDefinitionLine."Link to Table (Tag Name)" <> '' THEN
                  SetParentRecRef(ExportXMLFile, ExportDefinitionLine, RecRef, 1);
              UNTIL ExportDefinitionLine.NEXT = 0;

            IF xRecRefSet THEN BEGIN
              ExportDefinitionLine.SETRANGE("Export Definition", ExportDefinition.Code);
              ExportDefinitionLine.SETRANGE(Type, ExportDefinitionLine.Type::Table);
              ExportDefinitionLine.SETRANGE("Table No.", ExportJob."Table No.");
              IF ExportDefinitionLine.FINDSET THEN
                REPEAT
                  ExportXMLFile.SetxRecRef(xRecRef, ExportDefinitionLine."Entry No.");
                UNTIL ExportDefinitionLine.NEXT = 0;
            END;

            ExportXMLFile.SetTrigger(FORMAT(ExportJob.Trigger));
            ExportXMLFile.SetExportJobEntryNo(ExportJob."Entry No.");

            ExitValue := ExportXMLFile.RUN(ExportDefinition);
          END;

        ExportDefinition."File Format"::CSV,
        ExportDefinition."File Format"::"Fixed Width",
        ExportDefinition."File Format"::Excel :
          BEGIN
            ExportFile.SetRecRef(RecRef);
            IF xRecRefSet THEN
              ExportFile.SetxRecRef(xRecRef);
            ExportFile.SetTrigger(FORMAT(ExportJob.Trigger));
            ExportFile.SetExportJobEntryNo(ExportJob."Entry No.");
            ExitValue := ExportFile.RUN(ExportDefinition);
          END;

        ExportDefinition."File Format"::ADO :
          BEGIN
            StartExportADO.SetRecRef(RecRef);
            IF xRecRefSet THEN
              StartExportADO.SetxRecRef(xRecRef);
            ExitValue := StartExportADO.RUN(ExportDefinition);
          END;

      END;

      IF ExportJob."Trigger Dest. Variable" <> '' THEN
        VariableMgt.SetVariable(ExportJob."Trigger Dest. Variable", '');

      IF ExportJob."Job Entry No. Dest. Variable" <> '' THEN
        VariableMgt.SetVariable(ExportJob."Job Entry No. Dest. Variable", '');
    END;

    LOCAL PROCEDURE SetStatusToExportJobs@1000008(VAR TmpExportJob@1000001 : Record 11148608;Succeeded@1000000 : Boolean);
    VAR
      ExportJob@1000002 : Record 11148608;
    BEGIN
      IF TmpExportJob.FINDSET THEN
        REPEAT
          ExportJob := TmpExportJob;
          IF Succeeded THEN BEGIN
            ExportJob.Status := ExportJob.Status::Exported;
            ExportJob."DateTime Exported" := CURRENTDATETIME;
          END ELSE
            ExportJob.Status := ExportJob.Status::Error;
          ExportJob.MODIFY;
        UNTIL TmpExportJob.NEXT = 0;
    END;

    PROCEDURE LiveRecRef@1000000(VAR NewRecRef@1000000 : RecordRef);
    BEGIN
      gRecRef := NewRecRef;
      RecRefSet := TRUE;
    END;

    PROCEDURE SetParentRecRef@1100531001(VAR ExportXMLFile@1100531000 : Codeunit 11148609;VAR ExportDefinitionLine@1100531002 : Record 11148600;VAR RecRef@1100531001 : RecordRef;LoopCounter@1100531008 : Integer);
    VAR
      ParentExportDefinitionLine@1100531003 : Record 11148600;
      ExportDefTableLink@1100531005 : Record 11148601;
      ParentRecRef@1100531004 : RecordRef;
      FldRef@1100531006 : FieldRef;
      ParentFldRef@1100531007 : FieldRef;
    BEGIN
      IF LoopCounter = 80 THEN
        ERROR('Stack overflow.');

      ParentExportDefinitionLine.SETCURRENTKEY("Export Definition", "Line No.");
      ParentExportDefinitionLine.SETRANGE("Export Definition", ExportDefinitionLine."Export Definition");
      ParentExportDefinitionLine.SETFILTER("Line No.", '<%1', ExportDefinitionLine."Line No.");
      ParentExportDefinitionLine.SETRANGE("Tag Name", ExportDefinitionLine."Link to Table (Tag Name)");
      IF ParentExportDefinitionLine.FINDLAST THEN BEGIN
        ParentExportDefinitionLine.TESTFIELD(Type, ParentExportDefinitionLine.Type::Table);

        ParentRecRef.OPEN(ParentExportDefinitionLine."Table No.");

        ExportDefTableLink.SETRANGE("Export Definition", ExportDefinitionLine."Export Definition");
        ExportDefTableLink.SETRANGE("Export Def. Entry No.", ExportDefinitionLine."Entry No.");
        ExportDefTableLink.SETFILTER(Variable, '%1', '');
        IF ExportDefTableLink.FINDSET THEN
          REPEAT
            ParentFldRef := ParentRecRef.FIELD(ExportDefTableLink."Main Field No.");
            FldRef := RecRef.FIELD(ExportDefTableLink."Sub Field No.");
            ParentFldRef.SETRANGE := FldRef.VALUE;
            //ParentFldRef.VALUE := FldRef.VALUE;

          UNTIL ExportDefTableLink.NEXT = 0;

        ExportXMLFile.SetRecRef(ParentRecRef, ParentExportDefinitionLine."Entry No.");
        IF ParentExportDefinitionLine."Link to Table (Tag Name)" <> '' THEN
          SetParentRecRef(ExportXMLFile, ParentExportDefinitionLine, ParentRecRef, LoopCounter + 1);
      END;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148622 IN - Comment Management
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    SingleInstance=Yes;
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      gTmpMessageHistComment@1000001 : TEMPORARY Record 11148612;
      gFilename@1000004 : Text[1024];
      gKey@1000003 : Text[1024];
      gNoOfComments@1000000 : Integer;
      gErrorOccured@1000002 : Boolean;
      Text001@1000000001 : TextConst 'ENU=--------------------------------------------------------------------------------;NLD=--------------------------------------------------------------------------------';
      Text002@1000000000 : TextConst 'ENU=Import Definition %1;NLD=Import Definitie %1';

    PROCEDURE Reset@1000000();
    BEGIN
      gTmpMessageHistComment.RESET;
      gTmpMessageHistComment.DELETEALL;

      gNoOfComments := 0;
      gErrorOccured := FALSE;
    END;

    PROCEDURE ResetError@1000006();
    BEGIN
      gErrorOccured := FALSE;
    END;

    PROCEDURE SetFilename@1000002(NewValue@1000000 : Text[1024]);
    BEGIN
      gFilename := NewValue;
    END;

    PROCEDURE SetKey@1000005(NewValue@1000000 : Text[1024]);
    BEGIN
      gKey := NewValue;
    END;

    PROCEDURE AddComment@1000001(Comment@1000000 : Text[1024]);
    BEGIN
      gNoOfComments += 1;

      gTmpMessageHistComment."Line No." := gNoOfComments;
      gTmpMessageHistComment.File := gFilename;
      gTmpMessageHistComment.Key := gKey;
      gTmpMessageHistComment.Comment := COPYSTR(Comment, 1, MAXSTRLEN(gTmpMessageHistComment.Comment));
      gTmpMessageHistComment.Error := FALSE;
      gTmpMessageHistComment."Error No." := 0;
      gTmpMessageHistComment.INSERT;
    END;

    PROCEDURE AddError@1000004(ErrorNo@1000000000 : Integer;ErrorType@1000001 : Integer;Error@1000000 : Text[1024]);
    BEGIN
      gNoOfComments += 1;

      gTmpMessageHistComment."Line No." := gNoOfComments;
      gTmpMessageHistComment.File := gFilename;
      gTmpMessageHistComment.Key := gKey;
      gTmpMessageHistComment.Comment := COPYSTR(Error, 1, MAXSTRLEN(gTmpMessageHistComment.Comment));
      gTmpMessageHistComment.Error := TRUE;
      gTmpMessageHistComment."Error No." := ErrorNo;
      gTmpMessageHistComment."Error Type" := ErrorType;
      gTmpMessageHistComment.INSERT;

      gErrorOccured := TRUE;
    END;

    PROCEDURE ErrorOccured@1000003() : Boolean;
    BEGIN
      EXIT(gErrorOccured)
    END;

    PROCEDURE WriteLogFile@1100495001(VAR ImportDefinition@1100496000 : Record 11148591);
    VAR
      Mgt@1100495005 : Codeunit 11148589;
      LogDirectory@1100495006 : Text[1024];
      LogFileName@1000000000 : Text[1024];
      LogFile@1100495000 : File;
      tXMLLogFile@1100495002 : TextConst 'ENU=XML Log File;NLD=XML Logbestand';
      tComment@1100495003 : TextConst 'ENU=Comment on import values:;NLD=Opmerkingen over importdefinities:';
      tErrorLine@1100496001 : TextConst 'ENU=" %1 - %2: %3";NLD=" %1 - %2: %3"';
      tCommentLine@1000000 : TextConst 'ENU=" %1: %2";NLD=" %1: %2"';
    BEGIN
      IF ImportDefinition."Log Location" = '' THEN
        EXIT;

      LogDirectory := FORMAT(TODAY, 0, ImportDefinition."Log Location");

      Mgt.CheckCreateDirectory(LogDirectory);
      LogFileName := LogDirectory + '\' + FORMAT(CURRENTDATETIME, 0, '<Year4><Month,2><Day,2>') + '.log';

      LogFile.TEXTMODE(TRUE);
      IF Mgt.FileExists(LogFileName) THEN BEGIN
        LogFile.WRITEMODE(TRUE);
        LogFile.OPEN(LogFileName);
        LogFile.SEEK(LogFile.LEN);
      END ELSE BEGIN
        LogFile.CREATE(LogFileName);
      END;

      LogFile.WRITE(Text001);
      LogFile.WRITE('');
      LogFile.WRITE(STRSUBSTNO(Text002, ImportDefinition.Code));
      LogFile.WRITE('');
      LogFile.WRITE(tXMLLogFile + ' ' + FORMAT(CURRENTDATETIME, 0, '<Day,2>-<Month,2>-<Year> <Hours,2>:<Minutes,2>:<Seconds,2>'));
      LogFile.WRITE('');
      LogFile.WRITE(' ' + tComment);
      LogFile.WRITE('');

      IF gTmpMessageHistComment.FINDSET THEN
        REPEAT
          IF gTmpMessageHistComment.Error THEN
            LogFile.WRITE(
              STRSUBSTNO(tErrorLine, gTmpMessageHistComment.File, gTmpMessageHistComment.Key, gTmpMessageHistComment.Comment))
          ELSE
            LogFile.WRITE(STRSUBSTNO(tCommentLine, gTmpMessageHistComment.File, gTmpMessageHistComment.Comment));
        UNTIL gTmpMessageHistComment.NEXT = 0;

      LogFile.CLOSE;
    END;

    PROCEDURE MessageText@1000007() ExitValue : Text[400];
    VAR
      tMessageLine@1000000 : TextConst 'ENU=%1 %2: %3\;NLD=%1 %2: %3\';
      Comment@1000001 : Text[1024];
      i@1000002 : Integer;
    BEGIN
      IF gTmpMessageHistComment.FINDSET THEN
        REPEAT
          Comment := gTmpMessageHistComment.Comment;
          i := STRLEN(gTmpMessageHistComment.Comment);
          WHILE i <> 0 DO BEGIN
            IF Comment[i] = '\' THEN
              Comment := COPYSTR(Comment, 1, i - 1) + '%1' + COPYSTR(Comment, i + 1);
            i -= 1;
          END;
          IF STRLEN(Comment) > 45 THEN
            Comment := COPYSTR(Comment, 1, 43) + '...';

          ExitValue := COPYSTR(STRSUBSTNO(tMessageLine, ExitValue, gTmpMessageHistComment.File, Comment), 1, MAXSTRLEN(ExitValue));
        UNTIL (gTmpMessageHistComment.NEXT = 0) OR (STRLEN(ExitValue) = MAXSTRLEN(ExitValue));
    END;

    PROCEDURE BodyText@1000010() ExitValue : Text[1024];
    VAR
      Ch13@1000000 : Char;
    BEGIN
      IF gTmpMessageHistComment.FINDSET THEN
        REPEAT
          ExitValue :=
            COPYSTR(
              ExitValue +
              gTmpMessageHistComment.File + ': ' +
              gTmpMessageHistComment.Comment +
              FORMAT(Ch13), 1, MAXSTRLEN(ExitValue));
        UNTIL (gTmpMessageHistComment.NEXT = 0) OR (STRLEN(ExitValue) = MAXSTRLEN(ExitValue));
    END;

    PROCEDURE FillHistoryRecords@1000008(VAR MessageHistory@1000000 : Record 11148611;VAR MessageHistComment@1000001 : Record 11148612);
    BEGIN
      MessageHistory.INSERT;

      IF gTmpMessageHistComment.FINDSET THEN
        REPEAT
          MessageHistComment := gTmpMessageHistComment;
          MessageHistComment.INSERT;
        UNTIL gTmpMessageHistComment.NEXT = 0;
    END;

    PROCEDURE GetComments@1000009(VAR MessageHistComment@1000000 : Record 11148612);
    BEGIN
      IF gTmpMessageHistComment.FINDSET THEN
        REPEAT
          MessageHistComment := gTmpMessageHistComment;
          MessageHistComment.INSERT;
        UNTIL gTmpMessageHistComment.NEXT = 0;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148623 IN - Log Management
{
  OBJECT-PROPERTIES
  {
    Date=24-05-13;
    Time=13:00:00;
    Version List=IDYN-CE5.50.0;
  }
  PROPERTIES
  {
    OnRun=VAR
            CommonDialogControl@1100543000 : OCX "{F9043C85-F6F2-101A-A3C9-08002B2F49FB}:'Microsoft Common Dialog Control, version 6.0'";
          BEGIN
            CommonDialogControl.MaxFileSize := 2048;
            CommonDialogControl.CancelError := TRUE;
            CommonDialogControl.DialogTitle := gDialogTitle;
            CommonDialogControl.Filter := gDialogFilter;
            CommonDialogControl.FileName := gDialogFilename;
            CommonDialogControl.Action(gDialogAction);

            gDialogFilename := CommonDialogControl.FileName;
          END;

  }
  CODE
  {
    VAR
      gDialogFilename@1000002 : Text[250];
      gDialogFilter@1000001 : Text[250];
      gDialogTitle@1000000 : Text[30];
      gDialogAction@1000003 : Integer;

    PROCEDURE SetDialogProperties@1100496002(Title@1100496000 : Text[30];Filter@1100496001 : Text[250];Filename@1100496002 : Text[250];Action@1100496003 : Integer);
    BEGIN
      gDialogTitle := Title;
      gDialogFilter := Filter;
      gDialogFilename := Filename;
      gDialogAction := Action;
    END;

    PROCEDURE GetDialogFilename@1100496003() : Text[250];
    BEGIN
      EXIT(gDialogFilename);
    END;

    PROCEDURE SaveMessageToLog@1000002(Type@1000001 : 'Import,Export';Code@1000002 : Code[20];Path@1100496000 : Text[250];Filename@1000007 : Text[205];VAR TmpBlob@1000000 : TEMPORARY Record 11148609;BinaryFile@1000010 : Boolean;Ansi@1000012 : Boolean);
    VAR
      Message@1000008 : Record 11148609;
      MessageLine@1000009 : Record 11148610;
      MessageHistory@1000006 : Record 11148611;
      MessageHistComment@1000005 : Record 11148612;
      TmpMessageHistComment@1000004 : TEMPORARY Record 11148612;
      CommentMgt@1000003 : Codeunit 11148622;
      ctProcessed@1000011 : TextConst 'ENU=Processed;NLD=Verwerkt';
    BEGIN
      Message.Type := Type;
      Message.Code := Code;
      Message.Path := Path;
      Message.File := Filename;
      Message.BLOB := TmpBlob.BLOB;
      IF CommentMgt.ErrorOccured THEN
        Message.Status := Message.Status::Error
      ELSE
        Message.Status := Message.Status::Processed;
      Message.INSERT(TRUE);

      IF BinaryFile THEN BEGIN
        MessageLine."Message Entry No." := Message."Entry No.";
        MessageLine."Line No." := 1;
        MessageLine."Sub Line No." := 1;
        MessageLine.Text := '*';
        MessageLine.INSERT;
      END ELSE
        BlobToMessageLines(TmpBlob, MessageLine, Message."Entry No.", Ansi);

      MessageHistory."Message Entry No." := Message."Entry No.";
      MessageHistory.Type := Message.Type;
      MessageHistory.Code := Message.Code;
      MessageHistory.Error := CommentMgt.ErrorOccured;
      MessageHistory.INSERT(TRUE);

      CommentMgt.GetComments(TmpMessageHistComment);

      IF TmpMessageHistComment.FINDSET THEN
        REPEAT
          MessageHistComment := TmpMessageHistComment;
          MessageHistComment."History Entry No." := MessageHistory."Entry No.";
          MessageHistComment."Message Entry No." := Message."Entry No.";
          MessageHistComment.Type := Message.Type;
          MessageHistComment.Code := Message.Code;
          MessageHistComment.INSERT;
        UNTIL TmpMessageHistComment.NEXT = 0
      ELSE BEGIN
        MessageHistComment."History Entry No." := MessageHistory."Entry No.";
        MessageHistComment."Line No." := 1;
        MessageHistComment."Message Entry No." := Message."Entry No.";
        MessageHistComment.File := Message.File;
        MessageHistComment.Comment := ctProcessed;
        MessageHistComment.Type := Message.Type;
        MessageHistComment.Code := Message.Code;
        MessageHistComment.INSERT;
      END;
    END;

    PROCEDURE BlobToMessageLines@1000001(VAR TmpBlob@1000000 : TEMPORARY Record 11148609;VAR MessageLine@1000002 : Record 11148610;MessageEntryNo@1000001 : Integer;Ansi@1000003 : Boolean);
    VAR
      CharacterCounter@1000014 : Integer;
      CodeLineCounter@1000013 : Integer;
      LineCharacterCounter@1000012 : Integer;
      SubLineCounter@1000011 : Integer;
      ReadChar@1000009 : Char;
      Line@1000008 : Text[250];
      OpenTagChar@1000007 : Char;
      CloseTagChar@1000006 : Char;
      InsertCR@1000005 : Boolean;
      InStr@1000004 : InStream;
    BEGIN
      CodeLineCounter := 1;
      SubLineCounter := 1;

      OpenTagChar := '<';
      CloseTagChar := '>';

      MessageLine.SETRANGE("Message Entry No.", MessageEntryNo);
      MessageLine.DELETEALL;

      TmpBlob.BLOB.CREATEINSTREAM(InStr);

      WHILE InStr.READ(ReadChar) > 0 DO BEGIN

        CharacterCounter += 1;

        CASE ReadChar OF
          9 :
            BEGIN
              LineCharacterCounter += 1;
              IF LineCharacterCounter MOD 249 = 0 THEN BEGIN
                InsertMessageLine(
                  MessageLine, MessageEntryNo, CodeLineCounter, SubLineCounter, Line, Ansi);
                SubLineCounter += 1;
                Line := '';
              END;
              Line += ' ';
              InsertCR := FALSE;
            END;

          13 :
            BEGIN
              InsertMessageLine(
                MessageLine, MessageEntryNo, CodeLineCounter, SubLineCounter, Line, Ansi);

              CodeLineCounter += 1;
              SubLineCounter := 1;
              Line := '';

              InStr.READ(ReadChar);
              CharacterCounter += 1;
              LineCharacterCounter := 0;
              InsertCR := FALSE;
            END;

          {
          OpenTagChar :
            BEGIN
              IF InsertCR THEN BEGIN
                CodeLineCounter += 1;
                FOR i := 1 TO SubLineCounter DO
                  InsertMessageLine(
                    MessageLine, MessageEntryNo, CodeLineCounter, i, Line[i], ansi);

                CLEAR(Line);
                CharacterCounter += 1;
                LineCharacterCounter := 0;
                SubLineCounter := 1;
              END;
              Line[SubLineCounter] += FORMAT(ReadChar);

            END;

          CloseTagChar :
            BEGIN
              Line[SubLineCounter] += FORMAT(ReadChar);
              InsertCR := TRUE;
            END;
          }

          ELSE BEGIN
            LineCharacterCounter += 1;

            IF LineCharacterCounter MOD 249 = 0 THEN BEGIN
              InsertMessageLine(
                MessageLine, MessageEntryNo, CodeLineCounter, SubLineCounter, Line, Ansi);
              Line := '';
              SubLineCounter += 1;
            END;

            Line += FORMAT(ReadChar);
            InsertCR := FALSE;
          END;
        END;
      END;

      InsertMessageLine(
        MessageLine, MessageEntryNo, CodeLineCounter, SubLineCounter, Line, Ansi);
    END;

    LOCAL PROCEDURE InsertMessageLine@1000005(VAR MessageLine@1000000 : Record 11148610;MessageEntryNo@1000001 : Integer;LineNo@1000002 : Integer;SubLineNo@1000003 : Integer;Line@1000004 : Text[1024];Ansi@1000005 : Boolean);
    BEGIN
      MessageLine."Message Entry No." := MessageEntryNo;
      MessageLine."Line No." := LineNo;
      MessageLine."Sub Line No." := SubLineNo;
      MessageLine.Text := ConvertLine(Line, Ansi);
      MessageLine.INSERT;
    END;

    PROCEDURE UpdateMessage@1000000(MessageEntryNo@1000000 : Integer);
    VAR
      Message@1000001 : Record 11148609;
      MessageHistory@1000006 : Record 11148611;
      MessageHistComment@1000005 : Record 11148612;
      TmpMessageHistComment@1000004 : TEMPORARY Record 11148612;
      CommentMgt@1000003 : Codeunit 11148622;
    BEGIN
      Message.GET(MessageEntryNo);
      IF CommentMgt.ErrorOccured THEN
        Message.Status := Message.Status::Error
      ELSE
        Message.Status := Message.Status::Processed;
      Message.MODIFY(TRUE);

      MessageHistory."Message Entry No." := Message."Entry No.";
      MessageHistory.Type := Message.Type;
      MessageHistory.Code := Message.Code;
      MessageHistory.Error := CommentMgt.ErrorOccured;
      MessageHistory.INSERT(TRUE);

      CommentMgt.GetComments(TmpMessageHistComment);

      IF TmpMessageHistComment.FINDSET THEN
        REPEAT
          MessageHistComment := TmpMessageHistComment;
          MessageHistComment."History Entry No." := MessageHistory."Entry No.";
          MessageHistComment."Message Entry No." := Message."Entry No.";
          MessageHistComment.Type := Message.Type;
          MessageHistComment.Code := Message.Code;
          MessageHistComment.INSERT;
        UNTIL TmpMessageHistComment.NEXT = 0;
    END;

    LOCAL PROCEDURE ConvertLine@1000003(TextToConvert@1000001 : Text[1024];Ansi@1000000 : Boolean) : Text[1024];
    VAR
      Mgt@1000002 : Codeunit 11148589;
    BEGIN
      IF Ansi THEN
        EXIT(Mgt.Ansi2Ascii(TextToConvert))
      ELSE
        EXIT(TextToConvert);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148624 IN - Progressbar
{
  OBJECT-PROPERTIES
  {
    Date=14-07-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.1;
  }
  PROPERTIES
  {
    SingleInstance=Yes;
    OnRun=BEGIN
            Open(3);
          END;

  }
  CODE
  {
    VAR
      Window@1100496000 : Dialog;
      PrevTime@1100496004 : ARRAY [4] OF Time;
      StartTime@1100496003 : ARRAY [4] OF Time;
      NoOfBars@1100496002 : Integer;
      NoOfRecords@1100496006 : ARRAY [4] OF Integer;
      RecordCounter@1100496008 : ARRAY [4] OF Integer;
      WindowOpen@1100496001 : Boolean;
      SuppressBar@1000000000 : Boolean;

    PROCEDURE Open@1100496014(NewNoOfBars@1100496000 : Integer);
    VAR
      DialogText@1100496001 : Text[1024];
      i@1100496002 : Integer;
    BEGIN
      IF (NOT GUIALLOWED) OR (SuppressBar) THEN
        EXIT;

      NoOfBars := NewNoOfBars;
      IF WindowOpen THEN
        Close;

      DialogText := '';

      FOR i := 1 TO NoOfBars DO
        DialogText := DialogText + '#' + FORMAT(i) + '###################### @' + FORMAT(15 - i) + '@@@@@@@@@@@@@\';

      DialogText := DialogText + '                 #4##### #5##### #6######';
      Window.OPEN(DialogText);
      WindowOpen := TRUE;

      FOR i := 1 TO ARRAYLEN(StartTime) DO BEGIN
        StartTime[i] := TIME;
        PrevTime[i] := TIME;
        RecordCounter[i] := 0;
        NoOfRecords[i] := 0;
      END;
    END;

    PROCEDURE Close@1100496005();
    BEGIN
      IF WindowOpen THEN BEGIN
        Window.CLOSE;
        WindowOpen := FALSE;
      END;
    END;

    PROCEDURE IsOpen@1100496011() : Boolean;
    BEGIN
      EXIT(WindowOpen);
    END;

    PROCEDURE SetText@1100496002(BarNo@1000000 : Integer;NewText@1100496000 : Text[1024]);
    VAR
      TextNo@1000001 : Integer;
    BEGIN
      IF WindowOpen THEN BEGIN
        TextNo := NoOfBars - BarNo + 1;
        Window.UPDATE(TextNo, NewText);
      END;
    END;

    PROCEDURE InitializeBar@1100496004(BarNo@1000000 : Integer;NewNoOfRecords@1000001 : Integer);
    BEGIN
      IF WindowOpen THEN BEGIN

        StartTime[BarNo] := TIME;
        PrevTime[BarNo] := TIME - 1000;
        NoOfRecords[BarNo] := NewNoOfRecords;
        RecordCounter[BarNo] := 0;

        IF BarNo > 1 THEN
          InitializeBar(BarNo - 1, 0);
      END;
    END;

    PROCEDURE SetRecordCounter@1100496007(BarNo@1000000 : Integer;NewRecordCounter@1100496000 : Integer);
    BEGIN
      IF WindowOpen THEN BEGIN
        RecordCounter[BarNo] := NewRecordCounter;
        UpdateBar(BarNo, '');
      END;
    END;

    PROCEDURE AddRecordCounter@1000001(BarNo@1000000 : Integer;NoToAdd@1100496000 : Integer;NewText@1000001 : Text[1024]);
    BEGIN
      IF WindowOpen THEN BEGIN

        RecordCounter[BarNo] += NoToAdd;

        IF BarNo > 1 THEN
          InitializeBar(BarNo - 1, 0);

        UpdateBar(BarNo, NewText);
      END;
    END;

    LOCAL PROCEDURE UpdateBar@1000000004(BarNo@1000000 : Integer;NewText@1000002 : Text[1024]);
    VAR
      MsToGo@1100496001 : Decimal;
      i@1100496000 : Integer;
      TextNo@1000003 : Integer;
    BEGIN
      IF BarNo > NoOfBars THEN
        EXIT;

      IF StartTime[BarNo] = 0T THEN BEGIN
        StartTime[BarNo] := TIME;
        PrevTime[BarNo] := TIME;
      END;

      IF TIME - PrevTime[BarNo] > 250 THEN BEGIN

        IF NoOfRecords[BarNo] <> 0 THEN BEGIN

          Window.UPDATE(BarNo - NoOfBars + 14, ROUND(RecordCounter[BarNo] / NoOfRecords[BarNo] * 10000, 1));
          Window.UPDATE(4, 000000T + (TIME - StartTime[BarNo]));

          MsToGo := (TIME - StartTime[BarNo]) / RecordCounter[BarNo] * (NoOfRecords[BarNo] - RecordCounter[BarNo]);

          IF MsToGo < 86400000 THEN BEGIN
            Window.UPDATE(5, 000000T + ROUND(MsToGo, 1));
            Window.UPDATE(6, TIME + ROUND(MsToGo, 1));
          END;

          IF NewText <> '' THEN BEGIN
            TextNo := NoOfBars - BarNo + 1;
            Window.UPDATE(TextNo, NewText);
          END;

          i := BarNo - 1;
          WHILE i >= 1 DO BEGIN
            IF NoOfRecords[i] = 0 THEN
              Window.UPDATE(i - NoOfBars + 14, 0)
            ELSE
              Window.UPDATE(i - NoOfBars + 14, ROUND(RecordCounter[i] / NoOfRecords[i] * 10000, 1));
            i -= 1;
          END;

        END;

        PrevTime[BarNo] := TIME;

      END;
    END;

    PROCEDURE SuppressBarDialog@1000000000(Suppress@1000000000 : Boolean);
    BEGIN
      SuppressBar := Suppress;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148625 IN - Initialize
{
  OBJECT-PROPERTIES
  {
    Date=16-11-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.4;
  }
  PROPERTIES
  {
    SingleInstance=Yes;
    OnRun=VAR
            DemoFob@1000000 : Boolean;
          BEGIN
            DemoFob := FALSE;

            CreateSetup;
            CreateFunctions;
            CreateVariables;
            IF DemoFob THEN BEGIN
              CreateTransport;
              CreateImport;
              CreateExport;
              CreateRoles;
            END;
          END;

  }
  CODE
  {
    VAR
      Initialized@1000000 : Boolean;
      Text001@1000000000 : TextConst 'ENU=Success;NLD=Succes';
      Text002@1000000001 : TextConst 'ENU=Error;NLD=Fout';
      Text003@1000000002 : TextConst 'ENU=Log;NLD=Log';

    PROCEDURE CheckInitialize@1000007();
    VAR
      Setup@1000000 : Record 11148589;
      Initialize@1000001 : Codeunit 11148625;
    BEGIN
      IF NOT Initialized THEN BEGIN
        IF NOT Setup.GET THEN
          Initialize.RUN;
        Initialized := TRUE;
      END;
    END;

    LOCAL PROCEDURE CreateSetup@1000013();
    VAR
      Setup@1000001 : Record 11148589;
    BEGIN
      WITH Setup DO BEGIN
        "Confirm Overwrite" := TRUE;
        "XML Declaration" := 'version="1.0" encoding="UTF-8"';
        "FTP Executable" := 'C:\Windows\System32\ftp.exe';
        "Captions of Fields and Tables" := TRUE;
        "Seconds Between Execute Task" := 1;
        "Seconds Between Inbox Exec." := 1;
        "Use Error Handling" := TRUE;
        Setup."Default Processed Path" := Text001;
        Setup."Default Error Path" := Text002;
        Setup."Default Log Path" := Text003;
        IF NOT INSERT THEN
          MODIFY;
      END;
    END;

    LOCAL PROCEDURE CreateTransport@1000002();
    VAR
      Transport@1000000 : Record 11148590;
    BEGIN
      WITH Transport DO BEGIN
        Code := 'FTP_GET';
        Description := 'FTP Get from Juicypear';
        Status := Status::Edit;
        Type := Type::"FTP Download";
        Address := 'veritest.juicypear.nl';
        Account := 'veritest';
        Password := 'juicypear';
        "To Location" := 'C:\';
        "Transfer Mode" := "Transfer Mode"::Bin;
        IF NOT INSERT THEN
          MODIFY;
      END;
    END;

    LOCAL PROCEDURE CreateImport@1000000();
    VAR
      ImportDefinition@1000000 : Record 11148591;
    BEGIN
      WITH ImportDefinition DO BEGIN
        Code := 'IMPORT_SALESPERSON';
        Description := 'Item Salesperson ConnectIT';
        Location := 'C:\ConnectIT\Demo\';
        Filename := 'Salesperson.xml';
        "Processed Location" := 'C:\ConnectIT\Demo\Processed\';
        "Log Location" := 'C:\ConnectIT\Demo\Log\';
        Status := Status::Edit;
        "File Format" := "File Format"::XML;
        Headers := FALSE;
        "Field Delimiter" := '"';
        "Field Separator" := ',';
        "Save to Messages" := FALSE;
        "Main Table No." := 13;
        IF NOT INSERT THEN
          MODIFY;
      END;

      CreateImportField('IMPORT_SALESPERSON', 1, 1, 13, TRUE, 'Code', 10);
      CreateImportField('IMPORT_SALESPERSON', 1, 2, 13, TRUE, 'Name', 50);
      CreateImportField('IMPORT_SALESPERSON', 1, 3, 13, TRUE, 'Commission', 12);
      CreateImportField('IMPORT_SALESPERSON', 1, 5050, 13, FALSE, '', 0);
      CreateImportField('IMPORT_SALESPERSON', 1, 5051, 13, FALSE, '', 0);
      CreateImportField('IMPORT_SALESPERSON', 1, 5052, 13, TRUE, 'EMail', 80);
      CreateImportField('IMPORT_SALESPERSON', 1, 5053, 13, TRUE, 'PhoneNo', 30);
      CreateImportField('IMPORT_SALESPERSON', 1, 5062, 13, FALSE, '', 0);
      CreateImportField('IMPORT_SALESPERSON', 1, 5085, 13, FALSE, '', 0);
      CreateImportField('IMPORT_SALESPERSON', 1, 5086, 13, FALSE, '', 0);
    END;

    LOCAL PROCEDURE CreateImportField@1000003(ImportDefinition@1000000 : Code[20];DataitemNo@1000008 : Integer;FieldNo@1000003 : Integer;TableNo@1000004 : Integer;Import@1000005 : Boolean;TagName@1000006 : Text[30];Width@1000007 : Integer);
    BEGIN
      // ImportDefinitionField."Import Definition" := ImportDefinition;
      // ImportDefinitionField."Dataitem No." := DataitemNo;
      // ImportDefinitionField."Field No." := FieldNo;
      // ImportDefinitionField."Table No." := TableNo;
      // ImportDefinitionField.Import := Import;
      // ImportDefinitionField."Tag Name" := TagName;
      // ImportDefinitionField.Width := Width;
      // IF NOT ImportDefinitionField.INSERT THEN
      //   ImportDefinitionField.MODIFY;
    END;

    LOCAL PROCEDURE CreateExport@1000001();
    VAR
      ExportDefinition@1000000 : Record 11148599;
      ExportDefTableLink@1000001 : Record 11148601;
    BEGIN
      WITH ExportDefinition DO BEGIN
        Code := 'ITEM_EXPORT';
        Description := 'Item Export ConnectIT';
        Location := 'C:\ConnectIT\Demo\';
        Filename := 'Items.xml';
        "XML Declaration" := 'version="1.0" encoding="UTF-8"';
        Status := Status::Edit;
        "File Format" := "File Format"::XML;
        Headers := FALSE;
        "One File per Record" := FALSE;
        "Field Delimiter" := '"';
        "Field Separator" := ',';
        "Save to Messages" := TRUE;
        "Main Table No." := 27;
        EVALUATE("Main Table Filter", 'Table27:');
        "Sub Table No." := 7002;
        EVALUATE("Sub Table Filter", 'Table7002:');
        IF NOT INSERT THEN
          MODIFY;
      END;

      CreateExportLine('ITEM_EXPORT', 1, 10000, 0, 'Items', 1, 0, 0, 0, 0, '', '');
      CreateExportLine('ITEM_EXPORT', 2, 20000, 1, 'Item', 2, 27, 0, 0, 0, 'Table27: ', '');
      CreateExportLine('ITEM_EXPORT', 3, 30000, 2, 'No', 3, 27, 1, 20, 0, ' ', '');
      CreateExportLine('ITEM_EXPORT', 4, 40000, 2, 'Description', 3, 27, 3, 30, 0, '', '');
      CreateExportLine('ITEM_EXPORT', 5, 50000, 2, 'BaseUnitOfMeasure', 3, 27, 8, 10, 0, '', '');
      CreateExportLine('ITEM_EXPORT', 6, 60000, 2, 'UnitPrice', 3, 27, 18, 12, 1, '', '');
      CreateExportLine('ITEM_EXPORT', 7, 70000, 2, 'SalesPrices', 1, 0, 0, 12, 1, '', '');
      CreateExportLine('ITEM_EXPORT', 8, 80000, 3, 'SalesPrice', 2, 7002, 0, 12, 1, 'Table7002: ', 'Item');
      CreateExportLine('ITEM_EXPORT', 9, 90000, 4, 'StartingDate', 3, 7002, 4, 10, 1, ' ', '');
      CreateExportLine('ITEM_EXPORT', 10, 100000, 4, 'UnitPrice', 3, 7002, 5, 12, 1, ' ', '');
      CreateExportLine('ITEM_EXPORT', 11, 110000, 4, 'MinimumQuantity', 3, 7002, 14, 12, 1, '', '');
      CreateExportLine('ITEM_EXPORT', 12, 120000, 4, 'EndingDate', 3, 7002, 15, 10, 1, '', '');
      CreateExportLine('ITEM_EXPORT', 13, 130000, 4, 'UnitOfMeasureCode', 3, 7002, 5400, 10, 0, '', '');

      WITH ExportDefTableLink DO BEGIN
        "Export Definition" := 'ITEM_EXPORT';
        "Export Def. Entry No." := 8;
        "Main Field No." := 1;
        "Main Table No." := 27;
        "Sub Table No." := 7002;
        "Sub Field No." := 1;
        IF NOT INSERT THEN
          MODIFY;
      END;

      CreateExportField('ITEM_EXPORT', 1, 1, 27, TRUE, 'No', 20, 0);
      CreateExportField('ITEM_EXPORT', 1, 2, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 3, 27, TRUE, 'Description', 30, 0);
      CreateExportField('ITEM_EXPORT', 1, 4, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 6, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 8, 27, TRUE, 'BaseUnitOfMeasure', 10, 0);
      CreateExportField('ITEM_EXPORT', 1, 9, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 11, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 12, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 14, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 15, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 16, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 17, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 18, 27, TRUE, 'UnitPrice', 12, 1);
      CreateExportField('ITEM_EXPORT', 1, 19, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 20, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 21, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 22, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 24, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 25, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 28, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 29, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 30, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 31, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 32, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 33, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 34, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 35, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 36, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 37, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 38, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 39, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 40, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 41, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 42, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 43, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 44, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 45, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 46, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 47, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 48, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 49, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 50, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 51, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 52, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 53, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 54, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 55, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 62, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 68, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 69, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 70, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 71, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 72, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 73, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 74, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 77, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 78, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 79, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 80, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 83, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 84, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 85, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 87, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 90, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 91, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 93, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 94, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 95, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 96, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 97, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 98, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 99, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 100, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 101, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 102, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 103, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 105, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 106, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 107, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 108, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5400, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5401, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5402, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5403, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5404, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5405, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5407, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5409, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5410, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5411, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5412, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5413, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5414, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5415, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5417, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5419, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5420, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5421, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5422, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5425, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5426, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5428, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5429, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5430, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5431, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5440, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5441, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5442, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5700, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5701, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5702, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5703, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5704, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5706, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5707, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5708, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5709, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5776, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5777, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5900, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5901, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 5902, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 6500, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 6501, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 6502, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 7171, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 7301, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 7302, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 7307, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 7380, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 7381, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 7382, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 7383, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 7384, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 7700, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 30000, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 99000750, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 99000751, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 99000752, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 99000753, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 99000754, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 99000755, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 99000756, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 99000757, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 99000758, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 99000759, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 99000760, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 99000761, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 99000762, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 99000765, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 99000766, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 99000767, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 99000768, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 99000769, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 99000770, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 99000771, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 99000773, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 99000774, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 99000777, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 99000778, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 99000875, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 1, 99008500, 27, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 2, 1, 7002, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 2, 2, 7002, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 2, 3, 7002, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 2, 4, 7002, TRUE, 'StartingDate', 10, 1);
      CreateExportField('ITEM_EXPORT', 2, 5, 7002, TRUE, 'UnitPrice', 12, 1);
      CreateExportField('ITEM_EXPORT', 2, 7, 7002, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 2, 10, 7002, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 2, 11, 7002, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 2, 13, 7002, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 2, 14, 7002, TRUE, 'MinimumQuantity', 12, 1);
      CreateExportField('ITEM_EXPORT', 2, 15, 7002, TRUE, 'EndingDate', 10, 1);
      CreateExportField('ITEM_EXPORT', 2, 5400, 7002, TRUE, 'UnitOfMeasureCode', 10, 0);
      CreateExportField('ITEM_EXPORT', 2, 5700, 7002, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 2, 7001, 7002, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 2, 30000, 7002, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 2, 30001, 7002, FALSE, '', 0, 0);
      CreateExportField('ITEM_EXPORT', 2, 30002, 7002, FALSE, '', 0, 0);
    END;

    LOCAL PROCEDURE CreateExportLine@1000004(ExportDefinition@1000001 : Code[20];EntryNo@1000002 : Integer;LineNo@1000003 : Integer;Indent@1000004 : Integer;TagName@1000005 : Text[30];Type@1000012 : Integer;TableNo@1000006 : Integer;FieldNo@1000007 : Integer;Width@1000008 : Integer;Alignment@1000009 : Integer;TableFilter@1000010 : Text[30];LinkToTable@1000011 : Text[30]);
    VAR
      ExportDefLine@1000000 : Record 11148600;
    BEGIN
      ExportDefLine."Export Definition" := ExportDefinition;
      ExportDefLine."Entry No." := EntryNo;
      ExportDefLine."Line No." := LineNo;
      ExportDefLine.Indent := Indent;
      ExportDefLine."Tag Name" := TagName;
      ExportDefLine.Type := Type;
      ExportDefLine."Table No." := TableNo;
      ExportDefLine."Field No." := FieldNo;
      ExportDefLine.Width := Width;
      ExportDefLine.Alignment := Alignment;
      EVALUATE(ExportDefLine."Table Filter", TableFilter);
      ExportDefLine."Link to Table (Tag Name)" := LinkToTable;
      IF NOT ExportDefLine.INSERT THEN
        ExportDefLine.MODIFY;
    END;

    LOCAL PROCEDURE CreateExportField@1000005(ExportDefinition@1000000 : Code[20];DataitemNo@1000008 : Integer;FieldNo@1000003 : Integer;TableNo@1000004 : Integer;Export@1000005 : Boolean;TagName@1000006 : Text[30];Width@1000007 : Integer;Alignment@1000001 : Integer);
    BEGIN
      // ExportDefinitionField."Export Definition" := ExportDefinition;
      // ExportDefinitionField."Dataitem No." := DataitemNo;
      // ExportDefinitionField."Field No." := FieldNo;
      // ExportDefinitionField."Table No." := TableNo;
      // ExportDefinitionField.Export := Export;
      // ExportDefinitionField."Tag Name" := TagName;
      // ExportDefinitionField.Width := Width;
      // ExportDefinitionField.Alignment := Alignment;
      // IF NOT ExportDefinitionField.INSERT THEN
      //   ExportDefinitionField.MODIFY;
    END;

    PROCEDURE CreateRoles@1000006();
    VAR
      UserRole@1000000 : Record 2000000004;
    BEGIN
      WITH UserRole DO BEGIN

        "Role ID" := 'CONNECTIT_ADMIN';
        Name := 'ConnectIT Admin';
        IF NOT INSERT THEN
          MODIFY;

        "Role ID" := 'CONNECTIT_MONITORING';
        Name := 'ConnectIT Monitoring';
        IF NOT INSERT THEN
          MODIFY;

        "Role ID" := 'CONNECTIT_USER';
        Name := 'ConnectIT User';
        IF NOT INSERT THEN
          MODIFY;

      END;

      //Admin Role
      CreatePermission('CONNECTIT_ADMIN', 0, 0, 1, 2, 2, 2, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, 402, 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, 403, 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, 404, 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - ConnectIT Setup", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Transport", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Import Definition", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Import Definition Line", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Import Def. Table Link", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Import Def. Function", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Function", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Import Restriction", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Import Restriction Value", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Import Restr. Var. Filter", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Export Definition", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Export Definition Line", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Export Def. Table Link", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Export Def. Function", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Function Temp. Table", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Variable", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Conversion", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Conversion Line", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Monitoring Setup", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Export Job", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Message", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Message Line", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Message History", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Message Hist. Comment", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Comment Line", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Task", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Task Object", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Task Planning", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Task Log", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Synchonization Inbox", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Record Value", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Project", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Project Line", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Monitoring Excluded Table", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Connector", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Connector Line", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Relation", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Relation Condition", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Relation Filter", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Trace Rule", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Trace Message", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Trace Entry", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Import Definition Version", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Import Def. Version Line", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Import Def. Vers. T. Link", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Export Definition Version", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Export Def. Version Line", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Export Def. Vers. T. Link", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Relation Error Message", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Data Change Setup", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Data Change Setup (Table)", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Data Change Setup (Field)", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - RTC Table Filter", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Task Group", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Definition Copy Rules", 1, 1, 1, 1, 1);

      // Monitoring Role
      CreatePermission('CONNECTIT_ADMIN', 0, DATABASE::"IN - Data Change Temp", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_MONITORING', 0, DATABASE::"IN - Export Definition", 1, 0, 0, 0, 1);
      CreatePermission('CONNECTIT_MONITORING', 0, DATABASE::"IN - Monitoring Setup", 1, 1, 0, 0, 1);
      CreatePermission('CONNECTIT_MONITORING', 0, DATABASE::"IN - Export Job", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_MONITORING', 0, DATABASE::"IN - Monitoring Excluded Table", 1, 1, 0, 0, 0);

      // User Role
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - ConnectIT Setup", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Transport", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Import Definition", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Import Definition Line", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Import Def. Table Link", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Import Def. Function", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Function", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Import Restriction", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Import Restriction Value", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Import Restr. Var. Filter", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Export Definition", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Export Definition Line", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Export Def. Table Link", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Export Def. Function", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Function Temp. Table", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Variable", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Conversion", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Conversion Line", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Monitoring Setup", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Export Job", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Message", 1, 1, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Message Line", 1, 1, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Message History", 1, 1, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Message Hist. Comment", 1, 1, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Comment Line", 1, 1, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Task", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Task Object", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Task Planning", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Task Log", 1, 1, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Synchonization Inbox", 1, 1, 1, 1, 1);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Record Value", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Project", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Project Line", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Monitoring Excluded Table", 1, 1, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Connector", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Connector Line", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Relation", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Relation Condition", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Relation Filter", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Trace Rule", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Trace Message", 1, 1, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Trace Entry", 1, 1, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Import Definition Version", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Import Def. Version Line", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Import Def. Vers. T. Link", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Export Definition Version", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Export Def. Version Line", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Export Def. Vers. T. Link", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Relation Error Message", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Data Change Setup", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Data Change Setup (Table)", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Data Change Setup (Field)", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - RTC Table Filter", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Task Group", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Definition Copy Rules", 1, 0, 0, 0, 0);
      CreatePermission('CONNECTIT_USER', 0, DATABASE::"IN - Data Change Temp", 1, 1, 1, 1, 1);
    END;

    LOCAL PROCEDURE CreatePermission@1000008(RoleId@1000000 : Code[20];ObjectType@1000001 : Integer;ObjectId@1000002 : Integer;ReadPermission2@1000003 : Integer;InsertPermission@1000004 : Integer;ModifyPermission@1000005 : Integer;DeletePermission@1000006 : Integer;ExecutePermission@1000007 : Integer);
    VAR
      Permission@1000008 : Record 2000000005;
    BEGIN
      WITH Permission DO BEGIN
        "Role ID" := RoleId;
        "Object Type" := ObjectType;
        "Object ID" := ObjectId;
        "Read Permission" := ReadPermission2;
        "Insert Permission" := InsertPermission;
        "Modify Permission" := ModifyPermission;
        "Delete Permission" := DeletePermission;
        "Execute Permission" := ExecutePermission;
        IF NOT INSERT THEN
          MODIFY;
      END;
    END;

    LOCAL PROCEDURE CreateFunctions@1100531000();
    VAR
      FunctionMgt@1100531000 : Codeunit 11148593;
    BEGIN
      FunctionMgt.Initialize;
    END;

    PROCEDURE CreateVariables@1000000000();
    VAR
      VariableMgt@1000000000 : Codeunit 11148619;
    BEGIN
      VariableMgt.CreateVariables;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148626 IN - Task Management
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    TableNo=11148616;
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      LoopCounter@1000000 : Integer;

    PROCEDURE GetNextDateTime@1000000(VAR TaskPlanning@1000000 : Record 11148616;Recursive@1000003 : Boolean) ExitValue : DateTime;
    VAR
      TaskPlanning2@1000002 : Record 11148616;
      MomentInteger@1000001 : Integer;
      ctError@1000004 : TextConst 'ENU="Error in %1 %2=''%3'', %4=''%5''.\\Stack overflow: Codeunit %6: %7";NLD="Error in %1 %2=''%3'', %4=''%5''.\\Stack overflow: Codeunit %6: %7"';
    BEGIN
      WITH TaskPlanning DO BEGIN

        LoopCounter += 1;
        IF LoopCounter > 10 THEN BEGIN
          MESSAGE(
            ctError,
            TABLECAPTION,
            FIELDCAPTION("Task Code"), "Task Code",
            FIELDCAPTION("Line No."), "Line No.",
            CODEUNIT::"IN - Task Management", 'Task Managment');
          EXIT(0DT);
        END;

        IF "Last Time Started" = 0DT THEN
          ExitValue := CURRENTDATETIME
        ELSE
          ExitValue := "Last Time Started";

        CASE Cycle OF

          Cycle::Second :
            ExitValue += Interval * 1000;

          Cycle::Minute :
            ExitValue += Interval * 1000 * 60;

          Cycle::Hour :
            BEGIN
              IF Moment = '' THEN
                ExitValue := ROUNDDATETIME(ExitValue + (1000 * 60 * 60), 1000 * 60, '<')
              ELSE BEGIN
                IF EVALUATE(MomentInteger, Moment) THEN
                  ;
                ExitValue := ROUNDDATETIME(ExitValue, 1000 * 60 * 60, '<') + (1000 * 60 * MomentInteger);
              END;

              WHILE ExitValue <= CURRENTDATETIME DO
                ExitValue += 1000 * 60 * 60;
              ExitValue += (Interval - 1) * 1000 * 60 * 60;
            END;

          Cycle::Day :
            BEGIN
              IF "Moment Time" = 0T THEN
                ExitValue := ROUNDDATETIME(ExitValue + 1000 * 60 * 60 * 24, 1000 * 60, '<')
              ELSE
                ExitValue := CREATEDATETIME(DT2DATE(ExitValue), "Moment Time");

              WHILE ExitValue <= CURRENTDATETIME DO
                ExitValue += 1000 * 60 * 60 * 24;
              ExitValue += (Interval - 1) * 1000 * 60 * 60 * 24;
            END;

          Cycle::Week :
            BEGIN
              IF EVALUATE(MomentInteger, Moment) THEN
                ;

              CASE TRUE OF

                (Moment = '') AND ("Moment Time" = 0T) :
                  ExitValue := ROUNDDATETIME(ExitValue + 1000 * 60 * 60 * 24 * 7, 1000 * 60, '<');

                (Moment = '') AND ("Moment Time" <> 0T) :
                  ExitValue := CREATEDATETIME(CALCDATE('<7D>', DT2DATE(ExitValue)), "Moment Time");

                (Moment <> '') AND ("Moment Time" = 0T) :
                  ExitValue :=
                    ROUNDDATETIME(
                      ExitValue - ((-DATE2DWY(DT2DATE(ExitValue) + MomentInteger, 1)) * 1000 * 60 * 60 * 24), 1000 * 60, '<');

                (Moment <> '') AND ("Moment Time" <> 0T) :
                  ExitValue :=
                    CREATEDATETIME(
                      CALCDATE('<' + FORMAT(-DATE2DWY(DT2DATE(ExitValue), 1) + MomentInteger) + 'D>', DT2DATE(ExitValue)),
                      "Moment Time");
              END;

              WHILE ExitValue <= CURRENTDATETIME DO
                ExitValue += 1000 * 60 * 60 * 24 * 7;
              ExitValue += (Interval - 1) * 1000 * 60 * 60 * 24 * 7;
            END;

          Cycle::Month :
            BEGIN

              IF EVALUATE(MomentInteger, Moment) THEN
                ;

              CASE TRUE OF

                (Moment = '') AND ("Moment Time" = 0T) :
                  ExitValue := ROUNDDATETIME(CREATEDATETIME(CALCDATE('<1M>', DT2DATE(ExitValue)), DT2TIME(ExitValue)), 1000 * 60, '<');

                (Moment = '') AND ("Moment Time" <> 0T) :
                  ExitValue := CREATEDATETIME(CALCDATE('<1M>', DT2DATE(ExitValue)), "Moment Time");

                (Moment <> '') AND ("Moment Time" = 0T) :
                  ExitValue :=
                    ROUNDDATETIME(
                      CREATEDATETIME(
                        CALCDATE(
                          '<' + FORMAT(MomentInteger - 1) + 'D>',
                          DMY2DATE(1, DATE2DMY(DT2DATE(ExitValue), 2), DATE2DMY(DT2DATE(ExitValue), 3))),
                        DT2TIME(ExitValue)),
                      1000 * 60,
                      '<');

                (Moment <> '') AND ("Moment Time" <> 0T) :
                  ExitValue :=
                    CREATEDATETIME(
                      CALCDATE(
                        '<' + FORMAT(MomentInteger - 1) + 'D>',
                        DMY2DATE(1, DATE2DMY(DT2DATE(ExitValue), 2), DATE2DMY(DT2DATE(ExitValue), 3))),
                      "Moment Time");
              END;

              WHILE ExitValue <= CURRENTDATETIME DO
                ExitValue := CREATEDATETIME(CALCDATE('<1M>', DT2DATE(ExitValue)), DT2TIME(ExitValue));
              IF Interval > 1 THEN
                ExitValue := CREATEDATETIME(CALCDATE('<' + FORMAT(Interval - 1) + 'M>', DT2DATE(ExitValue)), DT2TIME(ExitValue));
            END;

          Cycle::Year :
            BEGIN

              IF EVALUATE(MomentInteger, Moment) THEN
                ;

              CASE TRUE OF

                (Moment = '') AND ("Moment Time" = 0T) :
                  ExitValue := ROUNDDATETIME(CREATEDATETIME(CALCDATE('<1Y>', DT2DATE(ExitValue)), DT2TIME(ExitValue)), 1000 * 60, '<');

                (Moment = '') AND ("Moment Time" <> 0T) :
                  ExitValue := CREATEDATETIME(CALCDATE('<1Y>', DT2DATE(ExitValue)), "Moment Time");

                (Moment <> '') AND ("Moment Time" = 0T) :
                  ExitValue :=
                    ROUNDDATETIME(
                      CREATEDATETIME(
                        CALCDATE(
                          '<' + FORMAT(MomentInteger - 1) + 'D>',
                          DMY2DATE(1, 1, DATE2DMY(DT2DATE(ExitValue), 3))),
                        DT2TIME(ExitValue)),
                      1000 * 60,
                      '<');

                (Moment <> '') AND ("Moment Time" <> 0T) :
                  ExitValue :=
                    CREATEDATETIME(
                      CALCDATE(
                        '<' + FORMAT(MomentInteger - 1) + 'D>',
                        DMY2DATE(1, 1, DATE2DMY(DT2DATE(ExitValue), 3))),
                      "Moment Time");
              END;

              WHILE ExitValue <= CURRENTDATETIME DO
                ExitValue := CREATEDATETIME(CALCDATE('<1Y>', DT2DATE(ExitValue)), DT2TIME(ExitValue));
              IF Interval > 1 THEN
                ExitValue := CREATEDATETIME(CALCDATE('<' + FORMAT(Interval - 1) + 'Y>', DT2DATE(ExitValue)), DT2TIME(ExitValue));
            END;

        END;

        IF Cycle IN [Cycle::Second, Cycle::Minute, Cycle::Hour] THEN BEGIN
          IF "Active From" <> 0T THEN
            IF DT2TIME(ExitValue) < "Active From" THEN BEGIN
              TaskPlanning2 := TaskPlanning;
              TaskPlanning2."Last Time Started" := CREATEDATETIME(DT2DATE(ExitValue), "Active From");
              TaskPlanning2.Interval := 1;
              ExitValue := GetNextDateTime(TaskPlanning2, TRUE);
            END;

          IF "Active Till" <> 0T THEN
            IF DT2TIME(ExitValue) > "Active Till" THEN BEGIN
              TaskPlanning2 := TaskPlanning;
              TaskPlanning2."Last Time Started" := CREATEDATETIME(DT2DATE(ExitValue + (1000 * 60 * 60 * 24)), "Active From");
              TaskPlanning2.Interval := 1;
              ExitValue := GetNextDateTime(TaskPlanning2, TRUE);
            END;
        END;

        IF ExitValue <> 0DT THEN
          IF Cycle IN [Cycle::Second, Cycle::Minute, Cycle::Hour, Cycle::Day] THEN BEGIN

            IF (DATE2DWY(DT2DATE(ExitValue), 1) = 1) AND NOT Monday THEN
              ExitValue += 1000 * 60 * 60 * 24;
            IF (DATE2DWY(DT2DATE(ExitValue), 1) = 2) AND NOT Tuesday THEN
              ExitValue += 1000 * 60 * 60 * 24;
            IF (DATE2DWY(DT2DATE(ExitValue), 1) = 3) AND NOT Wednesday THEN
              ExitValue += 1000 * 60 * 60 * 24;
            IF (DATE2DWY(DT2DATE(ExitValue), 1) = 4) AND NOT Thursday THEN
              ExitValue += 1000 * 60 * 60 * 24;
            IF (DATE2DWY(DT2DATE(ExitValue), 1) = 5) AND NOT Friday THEN
              ExitValue += 1000 * 60 * 60 * 24;
            IF (DATE2DWY(DT2DATE(ExitValue), 1) = 6) AND NOT Saturday THEN
              ExitValue += 1000 * 60 * 60 * 24;
            IF (DATE2DWY(DT2DATE(ExitValue), 1) = 7) AND NOT Sunday THEN
              ExitValue += 1000 * 60 * 60 * 24;
          END;

      END;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148627 IN - Execute Task
{
  OBJECT-PROPERTIES
  {
    Date=05-11-13;
    Time=13:00:00;
    Version List=IDYN-CE5.50.8;
  }
  PROPERTIES
  {
    TableNo=11148614;
    OnRun=VAR
            Task@1100512000 : Record 11148614;
            TaskObject@1000000 : Record 11148615;
            TmpTaskObject@1000001 : TEMPORARY Record 11148615;
            TaskPlanning@1000004 : Record 11148616;
            Progressbar@1000002 : Codeunit 11148624;
            ExecuteTaskObject@1000006 : Codeunit 11148628;
            ErrorMgt@1000005 : Codeunit 11148630;
            ErrorText@1000007 : Text[1024];
            Failed@1000003 : Boolean;
            ctUnknownError@1000008 : TextConst 'ENU=Unkown error.;NLD=Onbekende fout.';
            Continue@1000000000 : Boolean;
          BEGIN
            IF Status = Status::Blocked THEN
              FIELDERROR(Status);

            Task.LOCKTABLE;
            Task.FINDSET;
            "Last Time Started" := CURRENTDATETIME;
            "Last Time Ended" := 0DT;
            Result := Result::Started;
            "Error Text" := '';
            MODIFY;

            COMMIT;

            IF "Single Object" THEN BEGIN
              TmpTaskObject."Task Code" := Code;
              TmpTaskObject.Type := "Object Type";
              TmpTaskObject.Field4 := Field5;
              TmpTaskObject."Object No." := "Object No.";
              TmpTaskObject."Table No." := "Table No.";
              TmpTaskObject."Table Filter" := "Table Filter";
              TmpTaskObject."Continue on Failure" := "Continue on Failure"; // CI-136
              TmpTaskObject.INSERT;
            END ELSE BEGIN
              TaskObject.SETRANGE("Task Code", Code);
              IF TaskObject.FINDSET THEN
                REPEAT
                  TmpTaskObject := TaskObject;
                  TmpTaskObject.INSERT;
                UNTIL TaskObject.NEXT = 0;
            END;

            ErrorMgt.ClearError;

            IF TmpTaskObject.FINDSET THEN
              REPEAT
                IF NOT ExecuteTaskObject.RUN(TmpTaskObject) THEN
                  // CI-136.begin
                  // Failed := TRUE;
                  Failed := NOT TmpTaskObject."Continue on Failure";
                  // CI-136.end
                IF "Wait After Run Object (s.)" <> 0 THEN
                  SLEEP("Wait After Run Object (s.)" * 1000);
              UNTIL (TmpTaskObject.NEXT = 0) OR Failed;

            IF Failed THEN BEGIN
              Result := Result::Failed;
              ErrorText := ErrorMgt.GetError;
              IF ErrorText = '' THEN
                ErrorText := ctUnknownError;
              "Error Text" := COPYSTR(ErrorText, 1, MAXSTRLEN("Error Text"));
              ExecuteTaskObject.SetErrorText(ErrorText);
              AddTraceEntry(TRUE, COPYSTR(ErrorText, 1, 250), ExecuteTaskObject.NoOfRecordsProcessed);
            END ELSE BEGIN
              "Last Time Ended" := CURRENTDATETIME;
              Result := Result::Ready;
              AddTraceEntry(FALSE, '', ExecuteTaskObject.NoOfRecordsProcessed);
            END;

            MODIFY;
            COMMIT;

            TaskPlanning.SETRANGE("Task Code", Code);
            IF TaskPlanning.FINDSET THEN
              REPEAT
                TaskPlanning.CalcStartNextTime;
                TaskPlanning.MODIFY;
              UNTIL TaskPlanning.NEXT = 0;

            Progressbar.Close;
          END;

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148628 IN - Execute Task Object
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    TableNo=11148615;
    OnRun=BEGIN
            CLEAR(TaskLog);
            TaskLog."Task Code" := "Task Code";
            TaskLog."Executed By" := USERID;
            TaskLog.Started := CURRENTDATETIME;
            TaskLog.Type := Type;
            TaskLog."Object Type" := Field4;
            TaskLog."Object No." := "Object No.";
            TaskLog."Table No." := "Table No.";
            TaskLog."Table Filter" := "Table Filter";
            TaskLog.INSERT(TRUE);

            COMMIT;

            ExecuteTaskObject(Rec);

            TaskLog.Ended := CURRENTDATETIME;
            TaskLog.MODIFY;
          END;

  }
  CODE
  {
    VAR
      TaskLog@1000000 : Record 11148617;
      gNoOfRecordsProcessed@1100531000 : Integer;
      Text000@1000 : TextConst 'ENU=%1 %2 no longer supported.;NLD=%1 %2 wordt niet langer ondersteund.';

    LOCAL PROCEDURE ExecuteTaskObject@1000000(VAR TaskObject@1000000 : Record 11148615);
    VAR
      Transport@1000001 : Record 11148590;
      ImportDefinition@1000005 : Record 11148591;
      ExportDefinition@1000006 : Record 11148599;
      ExportJob@1000007 : Record 11148608;
      Task@1000002 : Record 11148614;
      TraceRule@1100531000 : Record 11148628;
      Mgt@1000004 : Codeunit 11148589;
      TraceMgt@1100531001 : Codeunit 11148642;
      RecRef@1000003 : RecordRef;
    BEGIN
      WITH TaskObject DO

        CASE Type OF
          Type::Transport :
            BEGIN
              RecRef.OPEN(DATABASE::"IN - Transport");
              Mgt.SetFilterOnRecordRef(RecRef, FORMAT("Table Filter"));
              Transport.SETVIEW(RecRef.GETVIEW(FALSE));
              Transport.SETRANGE(Status, Transport.Status::Automated);
              Transport.FINDSET;
              REPEAT
                Transport.Process(FALSE);
                gNoOfRecordsProcessed += 1;
              UNTIL Transport.NEXT = 0;
            END;

          Type::Import :
            BEGIN
              RecRef.OPEN(DATABASE::"IN - Import Definition");
              Mgt.SetFilterOnRecordRef(RecRef, FORMAT("Table Filter"));
              ImportDefinition.SETVIEW(RecRef.GETVIEW(FALSE));
              ImportDefinition.SETRANGE(Status, ImportDefinition.Status::Automated);
              ImportDefinition.FINDSET;
              REPEAT
                ImportDefinition.SetHideMessage(TRUE);
                ImportDefinition.Process;
                gNoOfRecordsProcessed += 1;
              UNTIL ImportDefinition.NEXT = 0;
            END;

          Type::Export :
            BEGIN
              RecRef.OPEN(DATABASE::"IN - Export Definition");
              Mgt.SetFilterOnRecordRef(RecRef, FORMAT("Table Filter"));
              ExportDefinition.SETVIEW(RecRef.GETVIEW(FALSE));
              ExportDefinition.SETRANGE(Status, ExportDefinition.Status::Automated);
              ExportDefinition.FINDSET;
              REPEAT
                ExportDefinition.Process;
                gNoOfRecordsProcessed += 1;
              UNTIL ExportDefinition.NEXT = 0;
            END;

          Type::"Export Job" :
            BEGIN
              RecRef.OPEN(DATABASE::"IN - Export Job");
              Mgt.SetFilterOnRecordRef(RecRef, FORMAT("Table Filter"));
              ExportJob.SETVIEW(RecRef.GETVIEW(FALSE));
              ExportJob.SETRANGE(Status, ExportJob.Status::New);
              IF ExportJob.FINDSET THEN
                REPEAT
                  ExportJob.Process;
                  gNoOfRecordsProcessed += 1;
                UNTIL ExportJob.NEXT = 0;
            END;

          Type::Task :
            BEGIN
              RecRef.OPEN(DATABASE::"IN - Task");
              Mgt.SetFilterOnRecordRef(RecRef, FORMAT("Table Filter"));
              Task.SETVIEW(RecRef.GETVIEW(FALSE));
              Task.SETRANGE(Status, Task.Status::Automated);
              Task.FINDSET;
              REPEAT
                Task.Process;
                gNoOfRecordsProcessed += 1;
              UNTIL Task.NEXT = 0;
            END;

          Type::"Apply Trace Rules" :
            IF FORMAT("Table Filter") = '' THEN BEGIN
              TraceMgt.RUN;
              gNoOfRecordsProcessed += TraceRule.COUNT;
            END ELSE BEGIN
              RecRef.OPEN(DATABASE::"IN - Trace Rule");
              Mgt.SetFilterOnRecordRef(RecRef, FORMAT("Table Filter"));
              TraceRule.SETVIEW(TraceRule.GETVIEW(FALSE));
              TraceRule.FINDSET;
              REPEAT
                TraceRule.ApplyRules;
                gNoOfRecordsProcessed += 1;
              UNTIL Task.NEXT = 0;
            END;

          Type::"Send Trace Messages" :
            BEGIN
              RecRef.OPEN(DATABASE::"IN - Trace Rule");
              Mgt.SetFilterOnRecordRef(RecRef, FORMAT("Table Filter"));
              TraceRule.SETVIEW(TraceRule.GETVIEW(FALSE));
              TraceRule.FINDSET;
              REPEAT
                TraceRule.SendEmails;
                gNoOfRecordsProcessed += 1;
              UNTIL Task.NEXT = 0;
            END;

          Type::Report :
            BEGIN
              REPORT.RUN("Object No.", FALSE);
              gNoOfRecordsProcessed += 1;
            END;

          Type::Dataport :
            BEGIN
              ERROR(Text000, FIELDCAPTION(Type), Type);
            END;

          Type::Codeunit :
            BEGIN
              CODEUNIT.RUN("Object No.");
              gNoOfRecordsProcessed += 1;
            END;

        END;
    END;

    PROCEDURE SetErrorText@1000001(ErrorText@1000000 : Text[1024]);
    BEGIN
      TaskLog."Error Text" := COPYSTR(ErrorText, 1, MAXSTRLEN(TaskLog."Error Text"));
      TaskLog.MODIFY;
    END;

    PROCEDURE NoOfRecordsProcessed@1100531000() : Integer;
    BEGIN
      EXIT(gNoOfRecordsProcessed);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148630 IN - Error Management
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE ClearError@1000001();
    BEGIN
      CLEARLASTERROR;
    END;

    PROCEDURE GetError@1000000() : Text[1024];
    VAR
      ctCreateFolder@1000000 : TextConst 'ENU=Cannot create folder.;NLD=Kan de map niet aanmaken.';
    BEGIN
      IF STRPOS(GETLASTERRORTEXT, 'CreateFolder') > 0 THEN
        EXIT(ctCreateFolder)
      ELSE
        EXIT(GETLASTERRORTEXT);
      //EXIT('Error');
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148634 IN - Export Definition to XML
{
  OBJECT-PROPERTIES
  {
    Date=14-07-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.1;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      Text000@1000000000 : TextConst 'ENU=Exporting project...;NLD=Project aan het exporteren...';
      Text001@1000000001 : TextConst 'ENU=Exporting definition...;NLD=Definitie aan het exporteren...';

    PROCEDURE ExportProjectDefinition@1100531002(VAR Project@1100531003 : Record 11148620);
    VAR
      Mgt@1100531018 : Codeunit 11148589;
      LogMgt@1100531002 : Codeunit 11148623;
      ExportDefinition@1100531007 : Record 11148599;
      ImportDefinition@1100531008 : Record 11148591;
      Task@1100531012 : Record 11148614;
      Transport@1100531013 : Record 11148590;
      MonitoringSetup@1100531014 : Record 11148607;
      Connector@1100531016 : Record 11148623;
      ConnectorLine@1100531017 : Record 11148624;
      ConversionBuffer@1000000001 : TEMPORARY Record 11148605;
      RecRef@1100531015 : RecordRef;
      gDoc@1100531001 : Codeunit 11148637;
      Filename2@1100531000 : Text[1024];
      ctExtensions@1100531006 : TextConst 'ENU=XML Definition Files (*.xml)|*.xml|All Files (*.*)|*.*;NLD=XML Definition Files (*.xml)|*.xml|All Files (*.*)|*.*';
      ctTitleText@1100531005 : TextConst 'ENU=Export Project Definition File;NLD=Projectdefinitie exporteren';
      DocNotCreated@1100531004 : TextConst 'ENU=The XML Document cannot be created.;NLD=Het XML document kan niet worden aangemaakt.';
      Node2@1100531010 : Codeunit 11148611;
      Node3@1100531011 : Codeunit 11148611;
      RootNode@1100531009 : Codeunit 11148611;
      Window@1000000000 : Dialog;
    BEGIN
      LogMgt.SetDialogProperties(FORMAT(ctTitleText), FORMAT(ctExtensions), 'ProjectDef-' + Project.Code + '.xml', 2);

      IF NOT LogMgt.RUN THEN
        EXIT;

      Filename2 := LogMgt.GetDialogFilename;

      IF Filename2 = '' THEN
        EXIT;

      // CI-144.begin
      IF GUIALLOWED THEN
        Window.OPEN(Text000);
      // CI-144.end

      Mgt.QueryReplace(Filename2);

      IF NOT gDoc.Create(FALSE,TRUE) THEN
        ERROR(DocNotCreated);

      AddRootElement(gDoc, 'ProjectDefinition', RootNode);
      RecRef.GETTABLE(Project);
      ExportRecRef(gDoc, RootNode, RecRef);

      AddElement(gDoc, RootNode, 'ExportDefinitions', '', Node2);
      ExportDefinition.SETCURRENTKEY("Project Code");
      ExportDefinition.SETRANGE("Project Code", Project.Code);
      IF ExportDefinition.FINDSET THEN
        REPEAT
          AddElement(gDoc, Node2, 'ExportDefinition', '', Node3);
          AddExportDefinition(gDoc, ExportDefinition, Node3);
          BufferExportDefConversions(ExportDefinition, ConversionBuffer); // CI-90
        UNTIL ExportDefinition.NEXT = 0;

      AddElement(gDoc, RootNode, 'ImportDefinitions', '', Node2);
      ImportDefinition.SETCURRENTKEY("Project Code");
      ImportDefinition.SETRANGE("Project Code", Project.Code);
      IF ImportDefinition.FINDSET THEN
        REPEAT
          AddElement(gDoc, Node2, 'ImportDefinition', '', Node3);
          AddImportDefinition(gDoc, ImportDefinition, Node3);
          BufferImportDefConversions(ImportDefinition, ConversionBuffer); // CI-90
        UNTIL ImportDefinition.NEXT = 0;

      AddElement(gDoc, RootNode, 'Tasks', '', Node2);
      Task.SETCURRENTKEY("Project Code");
      Task.SETRANGE("Project Code", Project.Code);
      IF Task.FINDSET THEN
        REPEAT
          AddElement(gDoc, Node2, 'Task', '', Node3);
          RecRef.GETTABLE(Task);
          ExportRecRef(gDoc, Node3, RecRef);
        UNTIL Task.NEXT = 0;

      AddElement(gDoc, RootNode, 'Transports', '', Node2);
      Transport.SETCURRENTKEY("Project Code");
      Transport.SETRANGE("Project Code", Project.Code);
      IF Transport.FINDSET THEN
        REPEAT
          AddElement(gDoc, Node2, 'Transport', '', Node3);
          RecRef.GETTABLE(Transport);
          ExportRecRef(gDoc, Node3, RecRef);
        UNTIL Transport.NEXT = 0;

      AddElement(gDoc, RootNode, 'MonitoringSetups', '', Node2);
      ExportDefinition.SETCURRENTKEY("Project Code");
      ExportDefinition.SETRANGE("Project Code", Project.Code);
      IF ExportDefinition.FINDSET THEN
        REPEAT
          MonitoringSetup.SETCURRENTKEY("Export Definition");
          MonitoringSetup.SETRANGE("Export Definition", ExportDefinition.Code);
          IF MonitoringSetup.FINDSET THEN
            REPEAT
              AddElement(gDoc, Node2, 'MonitoringSetup', '', Node3);
              RecRef.GETTABLE(MonitoringSetup);
              ExportRecRef(gDoc, Node3, RecRef);
            UNTIL MonitoringSetup.NEXT = 0;
        UNTIL ExportDefinition.NEXT = 0;

      AddElement(gDoc, RootNode, 'Connectors', '', Node2);
      Connector.SETCURRENTKEY("Project Code");
      Connector.SETRANGE("Project Code", Project.Code);
      IF Connector.FINDSET THEN
        REPEAT
          AddElement(gDoc, Node2, 'Connector', '', Node3);
          RecRef.GETTABLE(Connector);
          ExportRecRef(gDoc, Node3, RecRef);
        UNTIL Connector.NEXT = 0;

      AddElement(gDoc, RootNode, 'ConnectorLines', '', Node2);
      ConnectorLine.SETRANGE("Connector Code", Connector.Code);
      IF ConnectorLine.FINDSET THEN
        REPEAT
          AddElement(gDoc, Node2, 'ConnectorLine', '', Node3);
          RecRef.GETTABLE(ConnectorLine);
          ExportRecRef(gDoc, Node3, RecRef);
        UNTIL ConnectorLine.NEXT = 0;

      AddConversions(gDoc, ConversionBuffer, RootNode); // CI-90

      gDoc.SaveToFile(Filename2);

      // CI-144.begin
      IF GUIALLOWED THEN
        Window.CLOSE;
      // CI-144.end
    END;

    PROCEDURE ExportExportDefinition@1100531001(VAR ExportDefinition@1100531003 : Record 11148599);
    VAR
      ConversionBuffer@1000000001 : TEMPORARY Record 11148605;
      Mgt@1100531008 : Codeunit 11148589;
      LogMgt@1100531002 : Codeunit 11148623;
      gDoc@1100531001 : Codeunit 11148637;
      Filename2@1100531000 : Text[1024];
      ctExtensions@1100531006 : TextConst 'ENU=XML Definition Files (*.xml)|*.xml|All Files (*.*)|*.*;NLD=XML Definition Files (*.xml)|*.xml|All Files (*.*)|*.*';
      ctTitleText@1100531005 : TextConst 'ENU=Export XML Definition File;NLD=XML definitie exporteren';
      DocNotCreated@1100531004 : TextConst 'ENU=The XML Document cannot be created.;NLD=Het XML document kan niet worden aangemaakt.';
      RootNode@1100531007 : Codeunit 11148611;
      Window@1000000000 : Dialog;
    BEGIN
      LogMgt.SetDialogProperties(FORMAT(ctTitleText), FORMAT(ctExtensions), 'ExportDef-' + ExportDefinition.Code + '.xml', 2);
      IF NOT LogMgt.RUN THEN
        EXIT;

      Filename2 := LogMgt.GetDialogFilename;

      IF Filename2 = '' THEN
        EXIT;

      // CI-144.begin
      IF GUIALLOWED THEN
        Window.OPEN(Text001);
      // CI-144.end

      Mgt.QueryReplace(Filename2);
      IF NOT gDoc.Create(FALSE,TRUE) THEN
        ERROR(DocNotCreated);

      AddRootElement(gDoc, 'ExportDefinition', RootNode);
      AddExportDefinition(gDoc, ExportDefinition, RootNode);

      BufferExportDefConversions(ExportDefinition, ConversionBuffer); // CI-90
      AddConversions(gDoc, ConversionBuffer, RootNode); // CI-90

      gDoc.SaveToFile(Filename2);

      // CI-144.begin
      IF GUIALLOWED THEN
        Window.CLOSE;
      // CI-144.end
    END;

    LOCAL PROCEDURE AddExportDefinition@1100531000(VAR Doc@1000000000 : Codeunit 11148637;VAR ExportDefinition@1100531000 : Record 11148599;VAR RootNode@1100531005 : Codeunit 11148611);
    VAR
      ExportDefinitionLine@1100531003 : Record 11148600;
      ExportDefTableLink@1100531002 : Record 11148601;
      ExportDefFunction@1100531001 : Record 11148602;
      Node2@1100531007 : Codeunit 11148611;
      Node3@1100531006 : Codeunit 11148611;
      RecRef@1100531004 : RecordRef;
    BEGIN
      RecRef.GETTABLE(ExportDefinition);
      ExportRecRef(Doc, RootNode, RecRef);

      AddElement(Doc, RootNode, 'ExportDefinitionLines', '', Node2);
      ExportDefinitionLine.SETRANGE("Export Definition", ExportDefinition.Code);
      IF ExportDefinitionLine.FINDSET THEN
        REPEAT
          AddElement(Doc, Node2, 'ExportDefinitionLine', '', Node3);
          RecRef.GETTABLE(ExportDefinitionLine);
          ExportRecRef(Doc, Node3, RecRef);
        UNTIL ExportDefinitionLine.NEXT = 0;

      AddElement(Doc, RootNode, 'ExportDefTableLinks', '', Node2);
      ExportDefTableLink.SETRANGE("Export Definition", ExportDefinition.Code);
      IF ExportDefTableLink.FINDSET THEN
        REPEAT
          AddElement(Doc, Node2, 'ExportDefTableLink', '', Node3);
          RecRef.GETTABLE(ExportDefTableLink);
          ExportRecRef(Doc, Node3, RecRef);
        UNTIL ExportDefTableLink.NEXT = 0;

      AddElement(Doc, RootNode, 'ExportDefFunctions', '', Node2);
      ExportDefFunction.SETRANGE("Export Definition", ExportDefinition.Code);
      IF ExportDefFunction.FINDSET THEN
        REPEAT
          AddElement(Doc, Node2, 'ExportDefFunction', '', Node3);
          RecRef.GETTABLE(ExportDefFunction);
          ExportRecRef(Doc, Node3, RecRef);
        UNTIL ExportDefFunction.NEXT = 0;
    END;

    PROCEDURE ExportImportDefinition@1100531006(VAR ImportDefinition@1100531006 : Record 11148591);
    VAR
      ConversionBuffer@1000000001 : TEMPORARY Record 11148605;
      Mgt@1100531007 : Codeunit 11148589;
      LogMgt@1100531001 : Codeunit 11148623;
      Filename2@1100531000 : Text[1024];
      ctExtensions@1100531004 : TextConst 'ENU=XML Definition Files (*.xml)|*.xml|All Files (*.*)|*.*;NLD=XML Definition Files (*.xml)|*.xml|All Files (*.*)|*.*';
      ctTitleText@1100531003 : TextConst 'ENU=Export XML Definition File;NLD=XML definitie exporteren';
      DocNotCreated@1100531002 : TextConst 'ENU=The XML Document cannot be created.;NLD=Het XML document kan niet worden aangemaakt.';
      RootNode@1100531005 : Codeunit 11148611;
      gDoc@1100531008 : Codeunit 11148637;
      Window@1000000000 : Dialog;
    BEGIN
      LogMgt.SetDialogProperties(FORMAT(ctTitleText), FORMAT(ctExtensions), 'ImportDef-' + ImportDefinition.Code + '.xml', 2);
      IF NOT LogMgt.RUN THEN
        EXIT;

      Filename2 := LogMgt.GetDialogFilename;

      IF Filename2 = '' THEN
        EXIT;

      // CI-144.begin
      IF GUIALLOWED THEN
        Window.OPEN(Text001);
      // CI-144.end

      Mgt.QueryReplace(Filename2);

      ImportDefinition.TESTFIELD(Location);

      IF NOT gDoc.Create(FALSE,TRUE) THEN
        ERROR(DocNotCreated);

      AddRootElement(gDoc, 'ImportDefinition', RootNode);
      AddImportDefinition(gDoc, ImportDefinition, RootNode);

      BufferImportDefConversions(ImportDefinition, ConversionBuffer); // CI-90
      AddConversions(gDoc, ConversionBuffer, RootNode); // CI-90

      gDoc.SaveToFile(Filename2);

      // CI-144.begin
      IF GUIALLOWED THEN
        Window.CLOSE;
      // CI-144.end
    END;

    LOCAL PROCEDURE AddImportDefinition@1100531005(VAR Doc@1000000000 : Codeunit 11148637;VAR ImportDefinition@1100531011 : Record 11148591;VAR RootNode@1100531008 : Codeunit 11148611);
    VAR
      ImportDefinitionLine@1100531006 : Record 11148592;
      ImportDefTableLink@1100531005 : Record 11148593;
      ImportDefFunction@1100531004 : Record 11148594;
      ImportRestriction@1100531003 : Record 11148596;
      ImportRestrictionValue@1100531002 : Record 11148597;
      ImportRestrVarFilter@1100531001 : Record 11148598;
      Node2@1100531010 : Codeunit 11148611;
      Node3@1100531009 : Codeunit 11148611;
      RecRef@1100531007 : RecordRef;
    BEGIN
      RecRef.GETTABLE(ImportDefinition);
      ExportRecRef(Doc, RootNode, RecRef);

      AddElement(Doc, RootNode, 'ImportDefinitionLines', '', Node2);
      ImportDefinitionLine.SETRANGE("Import Definition", ImportDefinition.Code);
      IF ImportDefinitionLine.FINDSET THEN
        REPEAT
          AddElement(Doc, Node2, 'ImportDefinitionLine', '', Node3);
          RecRef.GETTABLE(ImportDefinitionLine);
          ExportRecRef(Doc, Node3, RecRef);
        UNTIL ImportDefinitionLine.NEXT = 0;

      AddElement(Doc, RootNode, 'ImportDefTableLinks', '', Node2);
      ImportDefTableLink.SETRANGE("Import Definition", ImportDefinition.Code);
      IF ImportDefTableLink.FINDSET THEN
        REPEAT
          AddElement(Doc, Node2, 'ImportDefTableLink', '', Node3);
          RecRef.GETTABLE(ImportDefTableLink);
          ExportRecRef(Doc, Node3, RecRef);
        UNTIL ImportDefTableLink.NEXT = 0;

      AddElement(Doc, RootNode, 'ImportRestrictions', '', Node2);
      ImportRestriction.SETRANGE("Import Definition", ImportDefinition.Code);
      IF ImportRestriction.FINDSET THEN
        REPEAT
          AddElement(Doc, Node2, 'ImportRestriction', '', Node3);
          RecRef.GETTABLE(ImportRestriction);
          ExportRecRef(Doc, Node3, RecRef);
        UNTIL ImportRestriction.NEXT = 0;

      AddElement(Doc, RootNode, 'ImportRestrictionValues', '', Node2);
      ImportRestrictionValue.SETRANGE("Import Definition", ImportDefinition.Code);
      IF ImportRestrictionValue.FINDSET THEN
        REPEAT
          AddElement(Doc, Node2, 'ImportRestrictionValue', '', Node3);
          RecRef.GETTABLE(ImportRestrictionValue);
          ExportRecRef(Doc, Node3, RecRef);
        UNTIL ImportRestrictionValue.NEXT = 0;

      AddElement(Doc, RootNode, 'ImportRestrVarFilters', '', Node2);
      ImportRestrVarFilter.SETRANGE("Import Definition", ImportDefinition.Code);
      IF ImportRestrVarFilter.FINDSET THEN
        REPEAT
          AddElement(Doc, Node2, 'ImportRestrVarFilter', '', Node3);
          RecRef.GETTABLE(ImportRestrVarFilter);
          ExportRecRef(Doc, Node3, RecRef);
        UNTIL ImportRestrVarFilter.NEXT = 0;

      AddElement(Doc, RootNode, 'ImportDefFunctions', '', Node2);
      ImportDefFunction.SETRANGE("Import Definition", ImportDefinition.Code);
      IF ImportDefFunction.FINDSET THEN
        REPEAT
          AddElement(Doc, Node2, 'ImportDefFunction', '', Node3);
          RecRef.GETTABLE(ImportDefFunction);
          ExportRecRef(Doc, Node3, RecRef);
        UNTIL ImportDefFunction.NEXT = 0;
    END;

    LOCAL PROCEDURE ExportRecRef@1000002(VAR Doc@1000000000 : Codeunit 11148637;VAR Node@1000000 : Codeunit 11148611;VAR RecRef@1000001 : RecordRef);
    VAR
      Fld@1000002 : Record 2000000041;
      Mgt@1000005 : Codeunit 11148589;
      NewNode@1000006 : Codeunit 11148611;
      FldRef@1000003 : FieldRef;
    BEGIN
      Mgt.SetFieldTypeFilter(Fld, TRUE);
      Fld.SETRANGE(TableNo, RecRef.NUMBER);
      IF Fld.FINDSET THEN
        REPEAT
          FldRef := RecRef.FIELD(Fld."No.");
          // CI-121.begin
          // AddElement(Node, Mgt.Capitalize(Fld.FieldName), FORMAT(FldRef.VALUE), NewNode);
          AddElement(Doc, Node, Mgt.Capitalize(Fld.FieldName), FORMAT(FldRef.VALUE, 0, 9), NewNode);
          // CI-121.end
        UNTIL Fld.NEXT = 0;
    END;

    LOCAL PROCEDURE AddRootElement@1000001(VAR Doc@1000001 : Codeunit 11148637;Name@1002 : Text[250];VAR CreatedXMLNode@1005 : Codeunit 11148611);
    BEGIN
      Doc.CreateNode(1, Name, '', CreatedXMLNode);
      Doc.AppendChild(CreatedXMLNode);
    END;

    LOCAL PROCEDURE AddElement@1(VAR Doc@1000000000 : Codeunit 11148637;VAR Node@1000000 : Codeunit 11148611;Name@1002 : Text[250];Value@1003 : Text[1024];VAR CreatedXMLNode@1005 : Codeunit 11148611);
    BEGIN
      Doc.CreateNode(1, Name, '', CreatedXMLNode);

      IF Value <> '' THEN
        CreatedXMLNode.SetText(Value);

      Node.AppendChild(CreatedXMLNode);
    END;

    LOCAL PROCEDURE BufferExportDefConversions@1000000000(ExportDefinition@1000000000 : Record 11148599;VAR ConversionBuffer@1000000001 : TEMPORARY Record 11148605);
    VAR
      ExportDefinitionLine@1000000002 : Record 11148600;
    BEGIN
      // CI-90
      ExportDefinitionLine.SETRANGE("Export Definition", ExportDefinition.Code);
      ExportDefinitionLine.SETFILTER("Conversion Code", '<>%1', '');

      IF ExportDefinitionLine.FINDSET THEN
        REPEAT
          ConversionBuffer.Code := ExportDefinitionLine."Conversion Code";
          IF NOT ConversionBuffer.INSERT THEN;
        UNTIL ExportDefinitionLine.NEXT = 0;
    END;

    LOCAL PROCEDURE BufferImportDefConversions@1000000001(ImportDefinition@1000000000 : Record 11148591;VAR ConversionBuffer@1000000001 : TEMPORARY Record 11148605);
    VAR
      ImportDefinitionLine@1000000002 : Record 11148592;
    BEGIN
      // CI-90
      ImportDefinitionLine.SETRANGE("Import Definition", ImportDefinition.Code);
      ImportDefinitionLine.SETFILTER("Conversion Code", '<>%1', '');

      IF ImportDefinitionLine.FINDSET THEN
        REPEAT
          ConversionBuffer.Code := ImportDefinitionLine."Conversion Code";
          IF NOT ConversionBuffer.INSERT THEN;
        UNTIL ImportDefinitionLine.NEXT = 0;
    END;

    LOCAL PROCEDURE AddConversions@1000000002(VAR Doc@1000000004 : Codeunit 11148637;VAR ConversionBuffer@1000000000 : TEMPORARY Record 11148605;VAR ParentNode@1000000001 : Codeunit 11148611);
    VAR
      Conversion@1000000003 : Record 11148605;
      NewNode@1000000002 : Codeunit 11148611;
    BEGIN
      // CI-90
      AddElement(Doc, ParentNode, 'Conversions', '', NewNode);

      IF ConversionBuffer.FINDSET THEN
        REPEAT
          Conversion.GET(ConversionBuffer.Code);
          AddConversion(Doc, Conversion, NewNode);
        UNTIL ConversionBuffer.NEXT = 0;
    END;

    LOCAL PROCEDURE AddConversion@1000000007(VAR Doc@1000000004 : Codeunit 11148637;Conversion@1000000001 : Record 11148605;VAR ParentNode@1000000000 : Codeunit 11148611);
    VAR
      RecRef@1000000003 : RecordRef;
      NewNode@1000000002 : Codeunit 11148611;
    BEGIN
      // CI-90
      AddElement(Doc, ParentNode, 'Conversion', '', NewNode);
      RecRef.GETTABLE(Conversion);
      ExportRecRef(Doc, NewNode, RecRef);

      AddConversionLines(Doc, Conversion, NewNode);
    END;

    LOCAL PROCEDURE AddConversionLines@1000000003(VAR Doc@1000000004 : Codeunit 11148637;Conversion@1000000000 : Record 11148605;VAR ParentNode@1000000001 : Codeunit 11148611);
    VAR
      ConversionLine@1000000002 : Record 11148606;
      NewNode@1000000003 : Codeunit 11148611;
    BEGIN
      // CI-90
      AddElement(Doc, ParentNode, 'Lines', '', NewNode);

      ConversionLine.SETRANGE("Conversion Code", Conversion.Code);

      IF ConversionLine.FINDSET THEN
        REPEAT
          AddConversionLine(Doc, ConversionLine, NewNode);
        UNTIL ConversionLine.NEXT = 0;
    END;

    LOCAL PROCEDURE AddConversionLine@1000000004(VAR Doc@1000000004 : Codeunit 11148637;ConversionLine@1000000002 : Record 11148606;VAR ParentNode@1000000001 : Codeunit 11148611);
    VAR
      RecRef@1000000003 : RecordRef;
      NewNode@1000000000 : Codeunit 11148611;
    BEGIN
      // CI-90
      AddElement(Doc, ParentNode, 'Line', '', NewNode);
      RecRef.GETTABLE(ConversionLine);
      ExportRecRef(Doc, NewNode, RecRef);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.

      16.01.2014 jhoek: At the time of this writing, the non-local functions in the codeunit were called
                        exclusively from OnAction triggers in Page objects. As a consequence, it is safe
                        to call gDoc.Create with ClientSide = true. See also CI-156 in JIRA.
    }
    END.
  }
}

OBJECT Codeunit 11148635 IN - ConnectIT Record
{
  OBJECT-PROPERTIES
  {
    Date=14-07-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.1;
  }
  PROPERTIES
  {
    OnRun=VAR
            Text001@1000000005 : TextConst 'ENU=Deleting data...\Current table #1############################;NLD=Verwijderen van data...\Huidige tabel #1############################';
          BEGIN
          END;

  }
  CODE
  {
    VAR
      ConnectITRecordAutomation@1000000000 : Automation "{75E053EA-4A5A-4210-9188-699CF98212FE} 2.7:{9C9B16DA-9FCE-4E46-83AE-AB9824219F2E}:'IDYN.Components'.ConnectITRecord";
      ConnectITRecordDotNetOnRTC@1000000001 : DotNet "'IDYN.Components, Version=2.7.1.712, Culture=neutral, PublicKeyToken=0f5532c6f6903616'.IDYN.Components.FileManagement.ConnectITRecord" RUNONCLIENT;
      ConnectITRecordDotNetOnNST@1000000002 : DotNet "'IDYN.Components, Version=2.7.1.712, Culture=neutral, PublicKeyToken=0f5532c6f6903616'.IDYN.Components.FileManagement.ConnectITRecord";
      Mode@1000000003 : 'Automation,DotNet on RTC,DotNet on NST';

    PROCEDURE GetAutomation@1000000003(VAR ConnectITRecord2@1000000000 : Automation "{75E053EA-4A5A-4210-9188-699CF98212FE} 2.7:{9C9B16DA-9FCE-4E46-83AE-AB9824219F2E}:'IDYN.Components'.ConnectITRecord");
    BEGIN
      ConnectITRecord2 := ConnectITRecordAutomation;
    END;

    PROCEDURE SetAutomation@1000000000(ConnectITRecord2@1000000000 : Automation "{75E053EA-4A5A-4210-9188-699CF98212FE} 2.7:{9C9B16DA-9FCE-4E46-83AE-AB9824219F2E}:'IDYN.Components'.ConnectITRecord");
    BEGIN
      ConnectITRecordAutomation := ConnectITRecord2;
      Mode := Mode::Automation;
    END;

    PROCEDURE GetDotNetOnRTC@1000000013(VAR ConnectITRecord2@1000000000 : DotNet "'IDYN.Components, Version=2.7.1.712, Culture=neutral, PublicKeyToken=0f5532c6f6903616'.IDYN.Components.FileManagement.ConnectITRecord" RUNONCLIENT);
    BEGIN
      ConnectITRecord2 := ConnectITRecordDotNetOnRTC;
    END;

    PROCEDURE SetDotNetOnRTC@1000000014(ConnectITRecord2@1000000000 : DotNet "'IDYN.Components, Version=2.7.1.712, Culture=neutral, PublicKeyToken=0f5532c6f6903616'.IDYN.Components.FileManagement.ConnectITRecord" RUNONCLIENT);
    BEGIN
      ConnectITRecordDotNetOnRTC := ConnectITRecord2;
      Mode := Mode::"DotNet on RTC";
    END;

    PROCEDURE GetDotNetOnNST@1000000015(VAR ConnectITRecord2@1000000000 : DotNet "'IDYN.Components, Version=2.7.1.712, Culture=neutral, PublicKeyToken=0f5532c6f6903616'.IDYN.Components.FileManagement.ConnectITRecord");
    BEGIN
      ConnectITRecord2 := ConnectITRecordDotNetOnNST;
    END;

    PROCEDURE SetDotNetOnNST@1000000016(ConnectITRecord2@1000000000 : DotNet "'IDYN.Components, Version=2.7.1.712, Culture=neutral, PublicKeyToken=0f5532c6f6903616'.IDYN.Components.FileManagement.ConnectITRecord");
    BEGIN
      ConnectITRecordDotNetOnNST := ConnectITRecord2;
      Mode := Mode::"DotNet on NST";
    END;

    PROCEDURE Create@1000000004(NewServer@1000000000 : Boolean;ClientSide@1000000001 : Boolean) : Boolean;
    BEGIN
      SetMode(ClientSide);

      CASE Mode OF
        Mode::Automation: EXIT(CreateAutomation(NewServer, ClientSide));
        Mode::"DotNet on RTC": EXIT(CreateDotNetOnRTC(NewServer, ClientSide));
        Mode::"DotNet on NST": EXIT(CreateDotNetOnNST(NewServer, ClientSide));
      END;
    END;

    LOCAL PROCEDURE CreateAutomation@1000000010(NewServer@1000000001 : Boolean;ClientSide@1000000000 : Boolean) : Boolean;
    BEGIN
      IF NOT ISCLEAR(ConnectITRecordAutomation) THEN
        CLEAR(ConnectITRecordAutomation);

      EXIT(CREATE(ConnectITRecordAutomation, NewServer, ClientSide));
    END;

    LOCAL PROCEDURE CreateDotNetOnRTC@1000000011(NewServer@1000000001 : Boolean;ClientSide@1000000000 : Boolean) : Boolean;
    BEGIN
      ConnectITRecordDotNetOnRTC := ConnectITRecordDotNetOnRTC.ConnectITRecord;
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE CreateDotNetOnNST@1000000012(NewServer@1000000001 : Boolean;ClientSide@1000000000 : Boolean) : Boolean;
    BEGIN
      ConnectITRecordDotNetOnNST := ConnectITRecordDotNetOnNST.ConnectITRecord;
      EXIT(TRUE);
    END;

    PROCEDURE ClearValues@1000000005();
    BEGIN
      CASE Mode OF
        Mode::Automation: ConnectITRecordAutomation.ClearValues;
        Mode::"DotNet on RTC": ConnectITRecordDotNetOnRTC.ClearValues;
        Mode::"DotNet on NST": ConnectITRecordDotNetOnNST.ClearValues;
      END;
    END;

    PROCEDURE AddValue@1000000006(Value@1000000000 : Text[1024]);
    BEGIN
      CASE Mode OF
        Mode::Automation: ConnectITRecordAutomation.AddValue(Value);
        Mode::"DotNet on RTC": ConnectITRecordDotNetOnRTC.AddValue(Value);
        Mode::"DotNet on NST": ConnectITRecordDotNetOnNST.AddValue(Value);
      END;
    END;

    PROCEDURE GetValue@1000000002(Index@1000000000 : Integer) : Text[1024];
    BEGIN
      CASE Mode OF
        Mode::Automation: EXIT(ConnectITRecordAutomation.GetValue(Index));
        Mode::"DotNet on RTC": EXIT(ConnectITRecordDotNetOnRTC.GetValue(Index));
        Mode::"DotNet on NST": EXIT(ConnectITRecordDotNetOnNST.GetValue(Index));
      END;
    END;

    PROCEDURE TryGetValue@1000000017(Index@1000000000 : Integer;VAR Value@1000000001 : Text[1024]) : Boolean;
    BEGIN
      // CI-167
      CASE Mode OF
        Mode::Automation: EXIT(ConnectITRecordAutomation.TryGetValue(Index, Value));
        Mode::"DotNet on RTC": EXIT(ConnectITRecordDotNetOnRTC.TryGetValue(Index, Value));
        Mode::"DotNet on NST": EXIT(ConnectITRecordDotNetOnNST.TryGetValue(Index, Value));
      END;
    END;

    PROCEDURE LastError@1000000018() Result : Text[1024];
    BEGIN
      // CI-167
      CASE Mode OF
        Mode::Automation: EXIT(COPYSTR(ConnectITRecordAutomation.LastError, 1, MAXSTRLEN(Result)));
        Mode::"DotNet on RTC": EXIT(COPYSTR(ConnectITRecordDotNetOnRTC.LastError, 1, MAXSTRLEN(Result)));
        Mode::"DotNet on NST": EXIT(COPYSTR(ConnectITRecordDotNetOnNST.LastError, 1, MAXSTRLEN(Result)));
      END;
    END;

    PROCEDURE GetIdentifier@1000000001() : Text[1024];
    BEGIN
      CASE Mode OF
        Mode::Automation: EXIT(ConnectITRecordAutomation.Identifier);
        Mode::"DotNet on RTC": EXIT(ConnectITRecordDotNetOnRTC.Identifier);
        Mode::"DotNet on NST": EXIT(ConnectITRecordDotNetOnNST.Identifier);
      END;
    END;

    PROCEDURE SetIdentifier@1000000007(Identifier@1000000000 : Text[1024]);
    BEGIN
      CASE Mode OF
        Mode::Automation: ConnectITRecordAutomation.Identifier := Identifier;
        Mode::"DotNet on RTC": ConnectITRecordDotNetOnRTC.Identifier := Identifier;
        Mode::"DotNet on NST": ConnectITRecordDotNetOnNST.Identifier := Identifier;
      END;
    END;

    PROCEDURE GetMode@1000000008() : Integer;
    BEGIN
      EXIT(Mode);
    END;

    LOCAL PROCEDURE SetMode@1000000009(ClientSide@1000000000 : Boolean);
    BEGIN
      IF NOT ISSERVICETIER THEN BEGIN
        Mode := Mode::Automation;
        EXIT;
      END;

      IF ClientSide THEN BEGIN
        Mode := Mode::"DotNet on RTC";
        EXIT;
      END;

      Mode := Mode::"DotNet on NST";
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148636 IN - Imp. Definition from XML
{
  OBJECT-PROPERTIES
  {
    Date=14-07-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.1;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      Text000@1000000001 : TextConst 'ENU=Importing project...;NLD=Project aan het importeren...';
      Text001@1000000000 : TextConst 'ENU=Importing definition...;NLD=Definitie aan het importeren...';

    PROCEDURE ImportProjectDefinition@1100531003(VAR Project@1100531000 : Record 11148620);
    VAR
      LogMgt@1100531002 : Codeunit 11148623;
      gDoc@1000000001 : Codeunit 11148637;
      gDocAsNode@1000000002 : Codeunit 11148611;
      RootNode@1100531003 : Codeunit 11148611;
      FileName2@1100531001 : Text[1024];
      ctExtensions@1100531007 : TextConst 'ENU=XML Definition Files (*.xml)|*.xml|All Files (*.*)|*.*;NLD=XML Definition Files (*.xml)|*.xml|All Files (*.*)|*.*';
      ctNotValidFile@1100531006 : TextConst 'ENU=This is not a valid export definition.;NLD=Dit is geen geldige exportdefinitie.';
      ctTitleText@1100531005 : TextConst 'ENU=Import Project File;NLD=Project importeren';
      DocNotCreated@1100531004 : TextConst 'ENU=The XML Document cannot be created.;NLD=Het XML document kan niet worden aangemaakt.';
      Node2@1100531009 : Codeunit 11148611;
      Node3@1100531008 : Codeunit 11148611;
      NodeList@1100531010 : Codeunit 11148612;
      ExportDefinition@1100531011 : Record 11148599;
      ImportDefinition@1100531012 : Record 11148591;
      Task@1100531013 : Record 11148614;
      MonitoringSetup@1100531015 : Record 11148607;
      Connector@1100531016 : Record 11148623;
      ConnectorLine@1100531017 : Record 11148624;
      RecRef@1100531014 : RecordRef;
      ctDeleteData@1100531018 : TextConst 'ENU=The existing projectdata will be deleted. Imported conversions (if any) will overwrite existing conversions with the same Code.\Are you sure?;NLD=De bestaande projectdata zal worden verwijderd. Bestaande conversies worden overschreven met evt. geimporteerde conversies met dezelfde Code. \Weet u het zeker?';
      Window@1000000000 : Dialog;
    BEGIN
      LogMgt.SetDialogProperties(FORMAT(ctTitleText), ctExtensions, '', 1);
      IF NOT LogMgt.RUN THEN
        EXIT;

      FileName2 := LogMgt.GetDialogFilename;
      IF FileName2 = '' THEN
        EXIT;

      // CI-144.begin
      IF GUIALLOWED THEN
        Window.OPEN(Text000);
      // CI-144.end

      IF NOT gDoc.Create(FALSE, TRUE) THEN
        ERROR(DocNotCreated);

      gDoc.SetPreserveWhitespace(TRUE); // CI-139
      gDoc.SetAsync(FALSE); // CI-146
      gDoc.LoadFromFile(FileName2);

      IF NOT CONFIRM(ctDeleteData, TRUE) THEN
        ERROR('');

      gDoc.AsNode(gDocAsNode);
      FindNode(gDocAsNode, 'ProjectDefinition', RootNode);

      IF RootNode.IsClear THEN
        ERROR(ctNotValidFile);

      RecRef.GETTABLE(Project);
      ImportRecRef(RootNode, RecRef, TRUE);
      RecRef.SETTABLE(Project);

      ExportDefinition.SETCURRENTKEY("Project Code");
      ExportDefinition.SETRANGE("Project Code", Project.Code);
      IF ExportDefinition.FINDSET THEN
        REPEAT
          MonitoringSetup.SETCURRENTKEY("Export Definition");
          MonitoringSetup.SETRANGE("Export Definition", ExportDefinition.Code);
          MonitoringSetup.DELETEALL(TRUE);
          ExportDefinition.DELETE(TRUE);
        UNTIL ExportDefinition.NEXT = 0;

      ImportDefinition.SETCURRENTKEY("Project Code");
      ImportDefinition.SETRANGE("Project Code", Project.Code);
      ImportDefinition.DELETEALL(TRUE);

      Task.SETCURRENTKEY("Project Code");
      Task.SETRANGE("Project Code", Project.Code);
      Task.DELETEALL(TRUE);

      Connector.SETCURRENTKEY("Project Code");
      Connector.SETRANGE("Project Code", Project.Code);
      Connector.DELETEALL(TRUE);

      FindNode(RootNode, 'ExportDefinitions', Node2);
      IF FindNodes(Node2, 'ExportDefinition', NodeList) THEN BEGIN
        NodeList.Reset;
        NodeList.NextNode(Node3);
        WHILE NOT Node3.IsClear DO BEGIN
          ImportExportDef(ExportDefinition, Node3);
          NodeList.NextNode(Node3);
        END;
      END;

      FindNode(RootNode, 'ImportDefinitions', Node2);
      IF FindNodes(Node2, 'ImportDefinition', NodeList) THEN BEGIN
        NodeList.Reset;
        NodeList.NextNode(Node3);
        WHILE NOT Node3.IsClear DO BEGIN
          ImportImportDef(ImportDefinition, Node3);
          NodeList.NextNode(Node3);
        END;
      END;

      FindNode(RootNode, 'Tasks', Node2);
      IF FindNodes(Node2, 'Task', NodeList) THEN BEGIN
        NodeList.Reset;
        NodeList.NextNode(Node3);
        WHILE NOT Node3.IsClear DO BEGIN
          RecRef.GETTABLE(Task);
          ImportRecRef(Node3, RecRef, TRUE);
          NodeList.NextNode(Node3);
        END;
      END;

      FindNode(RootNode, 'MonitoringSetups', Node2);
      IF FindNodes(Node2, 'MonitoringSetup', NodeList) THEN BEGIN
        NodeList.Reset;
        NodeList.NextNode(Node3);
        WHILE NOT Node3.IsClear DO BEGIN
          RecRef.GETTABLE(MonitoringSetup);
          ImportRecRef(Node3, RecRef, TRUE);
          NodeList.NextNode(Node3);
        END;
      END;

      FindNode(RootNode, 'Connectors', Node2);
      IF FindNodes(Node2, 'Connector', NodeList) THEN BEGIN
        NodeList.Reset;
        NodeList.NextNode(Node3);
        WHILE NOT Node3.IsClear DO BEGIN
          RecRef.GETTABLE(Connector);
          ImportRecRef(Node3, RecRef, TRUE);
          NodeList.NextNode(Node3);
        END;
      END;

      FindNode(RootNode, 'ConnectorLines', Node2);
      IF FindNodes(Node2, 'ConnectorLine', NodeList) THEN BEGIN
        NodeList.Reset;
        NodeList.NextNode(Node3);
        WHILE NOT Node3.IsClear DO BEGIN
          RecRef.GETTABLE(ConnectorLine);
          ImportRecRef(Node3, RecRef, TRUE);
          NodeList.NextNode(Node3);
        END;
      END;

      // CI-90.begin
      IF FindNode(RootNode, 'Conversions', Node2) THEN
        ImportConversions(Node2);
      // CI-90.end

      CLEAR(gDoc);

      // CI-144.begin
      IF GUIALLOWED THEN
        Window.CLOSE;
      // CI-144.end
    END;

    PROCEDURE ImportExportDefinition@1100531002(VAR ExportDefinition@1100531000 : Record 11148599);
    VAR
      LogMgt@1100531002 : Codeunit 11148623;
      gDoc@1000000001 : Codeunit 11148637;
      gDocAsNode@1000000003 : Codeunit 11148611;
      RootNode@1100531003 : Codeunit 11148611;
      Node2@1000000002 : Codeunit 11148611;
      FileName2@1100531001 : Text[1024];
      ctExtensions@1100531007 : TextConst 'ENU=XML Definition Files (*.xml)|*.xml|All Files (*.*)|*.*;NLD=XML Definition Files (*.xml)|*.xml|All Files (*.*)|*.*';
      ctNotValidFile@1100531006 : TextConst 'ENU=This is not a valid export definition.;NLD=Dit is geen geldige exportdefinitie.';
      ctTitleText@1100531005 : TextConst 'ENU=Import XML Definition File;NLD=XML definitie importeren';
      DocNotCreated@1100531004 : TextConst 'ENU=The XML Document cannot be created.;NLD=Het XML document kan niet worden aangemaakt.';
      Window@1000000000 : Dialog;
    BEGIN
      LogMgt.SetDialogProperties(FORMAT(ctTitleText), ctExtensions, '', 1);
      IF NOT LogMgt.RUN THEN
        EXIT;

      FileName2 := LogMgt.GetDialogFilename;
      IF FileName2 = '' THEN
        EXIT;

      // CI-144.begin
      IF GUIALLOWED THEN
        Window.OPEN(Text001);
      // CI-144.end

      IF NOT gDoc.Create(FALSE,TRUE) THEN
        ERROR(DocNotCreated);

      gDoc.SetPreserveWhitespace(TRUE); // CI-139
      gDoc.SetAsync(FALSE); // CI-146
      gDoc.LoadFromFile(FileName2);

      gDoc.AsNode(gDocAsNode);
      FindNode(gDocAsNode, 'ExportDefinition', RootNode);

      IF RootNode.IsClear THEN
        ERROR(ctNotValidFile);

      ImportExportDef(ExportDefinition, RootNode);

      // CI-90.begin
      IF FindNode(RootNode, 'Conversions', Node2) THEN
        ImportConversions(Node2);
      // CI-90.end

      CLEAR(gDoc);

      // CI-144.begin
      IF GUIALLOWED THEN
        Window.CLOSE;
      // CI-144.end
    END;

    LOCAL PROCEDURE ImportExportDef@1100531000(VAR ExportDefinition@1100531000 : Record 11148599;VAR RootNode@1100531009 : Codeunit 11148611);
    VAR
      ExportDefinitionLine@1100531008 : Record 11148600;
      ExportDefTableLink@1100531007 : Record 11148601;
      ExportDefFunction@1100531006 : Record 11148602;
      NodeList@1100531005 : Codeunit 11148612;
      Node2@1100531004 : Codeunit 11148611;
      Node3@1100531003 : Codeunit 11148611;
      RecRef@1100531001 : RecordRef;
    BEGIN
      RecRef.GETTABLE(ExportDefinition);
      ImportRecRef(RootNode, RecRef, TRUE);
      RecRef.SETTABLE(ExportDefinition);

      ExportDefinitionLine.SETRANGE("Export Definition", ExportDefinition.Code);
      ExportDefinitionLine.DELETEALL;
      ExportDefTableLink.SETRANGE("Export Definition", ExportDefinition.Code);
      ExportDefTableLink.DELETEALL;

      FindNode(RootNode, 'ExportDefinitionLines', Node2);
      IF FindNodes(Node2, 'ExportDefinitionLine', NodeList) THEN BEGIN
        NodeList.Reset;
        NodeList.NextNode(Node3);
        WHILE NOT Node3.IsClear DO BEGIN
          RecRef.GETTABLE(ExportDefinitionLine);
          ImportRecRef(Node3, RecRef, TRUE);
          NodeList.NextNode(Node3);
        END;
      END;

      FindNode(RootNode, 'ExportDefTableLinks', Node2);
      IF FindNodes(Node2, 'ExportDefTableLink', NodeList) THEN BEGIN
        NodeList.Reset;
        NodeList.NextNode(Node3);
        WHILE NOT Node3.IsClear DO BEGIN
          RecRef.GETTABLE(ExportDefTableLink);
          ImportRecRef(Node3, RecRef, TRUE);
          NodeList.NextNode(Node3);
        END;
      END;

      FindNode(RootNode, 'ExportDefFunctions', Node2);
      IF FindNodes(Node2, 'ExportDefFunction', NodeList) THEN BEGIN
        NodeList.Reset;
        NodeList.NextNode(Node3);
        WHILE NOT Node3.IsClear DO BEGIN
          RecRef.GETTABLE(ExportDefFunction);
          ImportRecRef(Node3, RecRef, TRUE);
          NodeList.NextNode(Node3);
        END;
      END;
    END;

    PROCEDURE ImportImportDefinition@1100531006(VAR ImportDefinition@1100531000 : Record 11148591);
    VAR
      LogMgt@1100531003 : Codeunit 11148623;
      gDoc@1000000001 : Codeunit 11148637;
      gDocAsNode@1000000003 : Codeunit 11148611;
      RootNode@1100531001 : Codeunit 11148611;
      Node2@1000000002 : Codeunit 11148611;
      FileName2@1100531002 : Text[1024];
      ctExtensions@1100531007 : TextConst 'ENU=XML Definition Files (*.xml)|*.xml|All Files (*.*)|*.*;NLD=XML Definition Files (*.xml)|*.xml|All Files (*.*)|*.*';
      ctNotValidFile@1100531006 : TextConst 'ENU=This is not a valid import definition.;NLD=Dit is geen geldige importdefinitie.';
      ctTitleText@1100531005 : TextConst 'ENU=Import XML Definition File;NLD=XML definitie importeren';
      DocNotCreated@1100531004 : TextConst 'ENU=The XML Document cannot be created.;NLD=Het XML document kan niet worden aangemaakt.';
      Window@1000000000 : Dialog;
    BEGIN
      LogMgt.SetDialogProperties(FORMAT(ctTitleText), ctExtensions, '', 1);
      IF NOT LogMgt.RUN THEN
        EXIT;

      FileName2 := LogMgt.GetDialogFilename;
      IF FileName2 = '' THEN
        EXIT;

      // CI-144.begin
      IF GUIALLOWED THEN
        Window.OPEN(Text001);
      // CI-144.end

      IF NOT gDoc.Create(FALSE,TRUE) THEN
        ERROR(DocNotCreated);

      gDoc.SetPreserveWhitespace(TRUE); // CI-139
      gDoc.SetAsync(FALSE); // CI-146
      gDoc.LoadFromFile(FileName2);

      gDoc.AsNode(gDocAsNode);
      FindNode(gDocAsNode, 'ImportDefinition', RootNode);

      IF RootNode.IsClear THEN
        ERROR(ctNotValidFile);

      ImportImportDef(ImportDefinition, RootNode);

      // CI-90.begin
      IF FindNode(RootNode, 'Conversions', Node2) THEN
        ImportConversions(Node2);
      // CI-90.end

      CLEAR(gDoc);

      // CI-144.begin
      IF GUIALLOWED THEN
        Window.CLOSE;
      // CI-144.end
    END;

    LOCAL PROCEDURE ImportImportDef@1100531005(VAR ImportDefinition@1100531000 : Record 11148591;VAR RootNode@1100531009 : Codeunit 11148611);
    VAR
      ImportDefinitionLine@1100531014 : Record 11148592;
      ImportDefTableLink@1100531013 : Record 11148593;
      ImportDefFunction@1100531012 : Record 11148594;
      ImportRestriction@1100531011 : Record 11148596;
      ImportRestrictionValue@1100531010 : Record 11148597;
      ImportRestrVarFilter@1100531002 : Record 11148598;
      NodeList@1100531006 : Codeunit 11148612;
      Node2@1100531005 : Codeunit 11148611;
      Node3@1100531004 : Codeunit 11148611;
      RecRef@1100531001 : RecordRef;
    BEGIN
      RecRef.GETTABLE(ImportDefinition);
      ImportRecRef(RootNode, RecRef, TRUE);

      RecRef.SETTABLE(ImportDefinition);

      ImportDefinitionLine.SETRANGE("Import Definition", ImportDefinition.Code);
      ImportDefinitionLine.DELETEALL;
      ImportDefTableLink.SETRANGE("Import Definition", ImportDefinition.Code);
      ImportDefTableLink.DELETEALL;
      ImportRestriction.SETRANGE("Import Definition", ImportDefinition.Code);
      ImportRestriction.DELETEALL;
      ImportRestrictionValue.SETRANGE("Import Definition", ImportDefinition.Code);
      ImportRestrictionValue.DELETEALL;
      ImportRestrVarFilter.SETRANGE("Import Definition", ImportDefinition.Code);
      ImportRestrVarFilter.DELETEALL;

      FindNode(RootNode, 'ImportDefinitionLines', Node2);
      IF FindNodes(Node2, 'ImportDefinitionLine', NodeList) THEN BEGIN
        NodeList.Reset;
        NodeList.NextNode(Node3);
        WHILE NOT Node3.IsClear DO BEGIN
          RecRef.GETTABLE(ImportDefinitionLine);
          ImportRecRef(Node3, RecRef, TRUE);
          NodeList.NextNode(Node3);
        END;
      END;

      FindNode(RootNode, 'ImportDefTableLinks', Node2);
      IF FindNodes(Node2, 'ImportDefTableLink', NodeList) THEN BEGIN
        NodeList.Reset;
        NodeList.NextNode(Node3);
        WHILE NOT Node3.IsClear DO BEGIN
          RecRef.GETTABLE(ImportDefTableLink);
          ImportRecRef(Node3, RecRef, TRUE);
          NodeList.NextNode(Node3);
        END;
      END;

      FindNode(RootNode, 'ImportRestrictions', Node2);
      IF FindNodes(Node2, 'ImportRestriction', NodeList) THEN BEGIN
        NodeList.Reset;
        NodeList.NextNode(Node3);
        WHILE NOT Node3.IsClear DO BEGIN
          RecRef.GETTABLE(ImportRestriction);
          ImportRecRef(Node3, RecRef, TRUE);
          NodeList.NextNode(Node3);
        END;
      END;

      FindNode(RootNode, 'ImportRestrictionValues', Node2);
      IF FindNodes(Node2, 'ImportRestrictionValue', NodeList) THEN BEGIN
        NodeList.Reset;
        NodeList.NextNode(Node3);
        WHILE NOT Node3.IsClear DO BEGIN
          RecRef.GETTABLE(ImportRestrictionValue);
          ImportRecRef(Node3, RecRef, TRUE);
          NodeList.NextNode(Node3);
        END;
      END;

      FindNode(RootNode, 'ImportRestrVarFilters', Node2);
      IF FindNodes(Node2, 'ImportRestrVarFilter', NodeList) THEN BEGIN
        NodeList.Reset;
        NodeList.NextNode(Node3);
        WHILE NOT Node3.IsClear DO BEGIN
          RecRef.GETTABLE(ImportRestrVarFilter);
          ImportRecRef(Node3, RecRef, TRUE);
          NodeList.NextNode(Node3);
        END;
      END;

      FindNode(RootNode, 'ImportDefFunctions', Node2);
      IF FindNodes(Node2, 'ImportDefFunction', NodeList) THEN BEGIN
        NodeList.Reset;
        NodeList.NextNode(Node3);
        WHILE NOT Node3.IsClear DO BEGIN
          RecRef.GETTABLE(ImportDefFunction);
          ImportRecRef(Node3, RecRef, TRUE);
          NodeList.NextNode(Node3);
        END;
      END;
    END;

    LOCAL PROCEDURE ImportRecRef@1000002(VAR Node@1000000 : Codeunit 11148611;VAR RecRef@1000001 : RecordRef;Write@1000000002 : Boolean);
    VAR
      Fld@1000002 : Record 2000000041;
      Mgt@1000005 : Codeunit 11148589;
      ImportDefMgt@1000004 : Codeunit 11148591;
      NewNode@1000006 : Codeunit 11148611;
      FldRef@1000003 : FieldRef;
      Decimal@1000007 : Decimal;
      TempTxt@1000000001 : Text[250];
      TempTxt2@1000000000 : Text[250];
    BEGIN
      Mgt.SetFieldTypeFilter(Fld, TRUE);
      Fld.SETRANGE(TableNo, RecRef.NUMBER);
      IF Fld.FINDSET THEN
        REPEAT
          FldRef := RecRef.FIELD(Fld."No.");

          IF FindNode(Node, Mgt.Capitalize(Fld.FieldName), NewNode) THEN BEGIN
            IF Fld.Type = Fld.Type::Option THEN BEGIN
              IF EVALUATE(Decimal, FORMAT(NewNode.GetText)) THEN
                FldRef.VALUE := Decimal
              // CI-121.begin
              ELSE IF EVALUATE(Decimal, FORMAT(NewNode.GetText), 9) THEN
                FldRef.VALUE := Decimal
              // CI-121.end
              ELSE
                IF STRPOS(FldRef.OPTIONSTRING,FORMAT(NewNode.GetText)) <> 0 THEN BEGIN
                  Decimal := 0;
                  TempTxt := FldRef.OPTIONSTRING;
                  WHILE STRPOS(TempTxt,FORMAT(NewNode.GetText)) <> 1 DO BEGIN
                    TempTxt := COPYSTR(TempTxt,STRPOS(TempTxt,',') + 1,STRLEN(TempTxt));
                    Decimal += 1;
                  END;
                  FldRef.VALUE := Decimal;
                END ELSE
                  FldRef.VALUE := 0;
            END ELSE BEGIN
              ImportDefMgt.EvaluateFieldRefValue(FldRef, Fld.Type, FORMAT(NewNode.GetText), Fld.FieldName = 'Temp. Table Filter');
            END;
          END;

        UNTIL Fld.NEXT = 0;

      IF Write THEN // CI-90
        IF NOT RecRef.INSERT THEN
          RecRef.MODIFY;
    END;

    LOCAL PROCEDURE FindNode@3(VAR XMLRootNode@1000 : Codeunit 11148611;NodePath@1001 : Text[250];VAR FoundXMLNode@1002 : Codeunit 11148611) : Boolean;
    BEGIN
      IF NodePath = '' THEN
        EXIT(FALSE);

      XMLRootNode.SelectSingleNode(NodePath, FoundXMLNode);

      EXIT(NOT FoundXMLNode.IsClear);
    END;

    LOCAL PROCEDURE FindNodes@4(VAR XMLRootNode@1000 : Codeunit 11148611;NodePath@1001 : Text[250];VAR ReturnedXMLNodeList@1002 : Codeunit 11148612) : Boolean;
    BEGIN
      IF NodePath = '' THEN
        EXIT(FALSE);

      XMLRootNode.SelectNodes(NodePath, ReturnedXMLNodeList);
      EXIT(NOT ReturnedXMLNodeList.IsClear);
    END;

    LOCAL PROCEDURE ImportConversions@1000000005(VAR Node@1000000000 : Codeunit 11148611);
    VAR
      Node2@1000000001 : Codeunit 11148611;
      NodeList@1000000002 : Codeunit 11148612;
    BEGIN
      // CI-90
      IF FindNodes(Node, 'Conversion', NodeList) THEN BEGIN
        NodeList.Reset;
        NodeList.NextNode(Node2);

        WHILE NOT Node2.IsClear DO BEGIN
          ImportConversion(Node2);
          NodeList.NextNode(Node2);
        END;
      END;
    END;

    LOCAL PROCEDURE ImportConversion@1000000014(VAR Node@1000000000 : Codeunit 11148611);
    VAR
      Conversion@1000000001 : Record 11148605;
      ConversionLine@1000000004 : Record 11148606;
      RecRef@1000000002 : RecordRef;
      Node2@1000000003 : Codeunit 11148611;
    BEGIN
      // CI-90
      RecRef.GETTABLE(Conversion);
      ImportRecRef(Node, RecRef, FALSE);
      RecRef.SETTABLE(Conversion);

      // Delete existing conversion
      IF NOT Conversion.DELETE(TRUE) THEN;

      // Write new conversion
      ImportRecRef(Node, RecRef, TRUE);

      IF FindNode(Node, 'Lines', Node2) THEN
        ImportConversionLines(Node2);
    END;

    LOCAL PROCEDURE ImportConversionLines@1000000015(VAR Node@1000000000 : Codeunit 11148611);
    VAR
      Node2@1000000001 : Codeunit 11148611;
      NodeList@1000000002 : Codeunit 11148612;
    BEGIN
      // CI-90
      IF FindNodes(Node, 'Line', NodeList) THEN BEGIN
        NodeList.Reset;
        NodeList.NextNode(Node2);

        WHILE NOT Node2.IsClear DO BEGIN
          ImportConversionLine(Node2);
          NodeList.NextNode(Node2);
        END;
      END;
    END;

    LOCAL PROCEDURE ImportConversionLine@1000000016(Node@1000000000 : Codeunit 11148611);
    VAR
      ConversionLine@1000000002 : Record 11148606;
      RecRef@1000000001 : RecordRef;
    BEGIN
      // CI-90
      RecRef.GETTABLE(ConversionLine);
      ImportRecRef(Node, RecRef, TRUE);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.

      16.01.2014 jhoek: At the time of this writing, the non-local functions in the codeunit were called
                        exclusively from OnAction triggers in Page objects. As a consequence, it is safe
                        to call gDoc.Create with ClientSide = true. See also CI-156 in JIRA.
    }
    END.
  }
}

OBJECT Codeunit 11148637 IN - XML Document
{
  OBJECT-PROPERTIES
  {
    Date=14-07-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.1;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      DOMDocument@1000000 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{88D96A05-F192-11D4-A65F-0040963251E5}:'Microsoft XML, v6.0'.DOMDocument60";
      XmlDocumentOnRTC@1000000001 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlDocument" RUNONCLIENT;
      XmlDocumentOnNST@1000000002 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlDocument";
      Mode@1000000000 : 'Automation,DotNet on NST,DotNet on RTC';
      Text000@1000000003 : TextConst 'ENU=Asynchronous operation not supported.;NLD=Asynchrone uitvoering wordt niet ondersteund.';

    PROCEDURE Create@1000000003(NewServer@1000000000 : Boolean;ClientSide@1000000001 : Boolean) : Boolean;
    BEGIN
      SetMode(ClientSide);

      CASE Mode OF
        Mode::Automation: EXIT(CreateAutomation(NewServer, ClientSide));
        Mode::"DotNet on RTC": EXIT(CreateDotNetOnRTC(NewServer, ClientSide));
        Mode::"DotNet on NST": EXIT(CreateDotNetOnNST(NewServer, ClientSide));
      END;
    END;

    LOCAL PROCEDURE CreateAutomation@1000000023(NewServer@1000000000 : Boolean;ClientSide@1000000001 : Boolean) : Boolean;
    BEGIN
      IF NOT ISCLEAR(DOMDocument) THEN
        CLEAR(DOMDocument);

      EXIT(CREATE(DOMDocument, NewServer, ClientSide));
    END;

    LOCAL PROCEDURE CreateDotNetOnRTC@1000000024(NewServer@1000000001 : Boolean;ClientSide@1000000000 : Boolean) : Boolean;
    BEGIN
      XmlDocumentOnRTC := XmlDocumentOnRTC.XmlDocument();
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE CreateDotNetOnNST@1000000025(NewServer@1000000001 : Boolean;ClientSide@1000000000 : Boolean) : Boolean;
    BEGIN
      XmlDocumentOnNST := XmlDocumentOnNST.XmlDocument();
      EXIT(TRUE);
    END;

    PROCEDURE IsClear@1000000020() : Boolean;
    BEGIN
      CASE Mode OF
        Mode::Automation: EXIT(ISCLEAR(DOMDocument));
        Mode::"DotNet on RTC": EXIT(ISNULL(XmlDocumentOnRTC));
        Mode::"DotNet on NST": EXIT(ISNULL(XmlDocumentOnNST));
      END;
    END;

    PROCEDURE GetAutomation@1000000000(VAR DOMDocument2@1000000000 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{88D96A05-F192-11D4-A65F-0040963251E5}:'Microsoft XML, v6.0'.DOMDocument60");
    BEGIN
      DOMDocument2 := DOMDocument;
    END;

    PROCEDURE SetAutomation@1000000001(DOMDocument2@1000000000 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{88D96A05-F192-11D4-A65F-0040963251E5}:'Microsoft XML, v6.0'.DOMDocument60");
    BEGIN
      DOMDocument := DOMDocument2;
    END;

    PROCEDURE GetDotNetOnRTC@1000000034(VAR XmlDocument@1000000000 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlDocument" RUNONCLIENT);
    BEGIN
      XmlDocument := XmlDocumentOnRTC;
    END;

    PROCEDURE SetDotNetOnRTC@1000000035(VAR XmlDocument@1000000000 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlDocument" RUNONCLIENT);
    BEGIN
      XmlDocumentOnRTC := XmlDocument;
    END;

    PROCEDURE GetDotNetOnNST@1000000036(VAR XmlDocument@1000000000 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlDocument");
    BEGIN
      XmlDocument := XmlDocumentOnNST;
    END;

    PROCEDURE SetDotnetOnNST@1000000037(VAR XmlDocument@1000000000 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlDocument");
    BEGIN
      XmlDocument := XmlDocumentOnRTC;
    END;

    PROCEDURE GetAsync@1000000004() : Boolean;
    BEGIN
      CASE Mode OF
        Mode::Automation: EXIT(DOMDocument.async);
        Mode::"DotNet on RTC": EXIT(FALSE);
        Mode::"DotNet on NST": EXIT(FALSE);
      END;
    END;

    PROCEDURE SetAsync@1000000005(Async2@1000000000 : Boolean);
    BEGIN
      CASE Mode OF
        Mode::Automation:
          DOMDocument.async := Async2;
        Mode::"DotNet on RTC",
        Mode::"DotNet on NST":
          IF Async2 = TRUE THEN
            ERROR(Text000);
      END;
    END;

    PROCEDURE GetPreserveWhitespace@1000000018() : Boolean;
    BEGIN
      CASE Mode OF
        Mode::Automation: EXIT(DOMDocument.preserveWhiteSpace);
        Mode::"DotNet on RTC": EXIT(XmlDocumentOnRTC.PreserveWhitespace);
        Mode::"DotNet on NST": EXIT(XmlDocumentOnNST.PreserveWhitespace);
      END;
    END;

    PROCEDURE SetPreserveWhitespace@1000000019(PreserveWhitespace2@1000000000 : Boolean);
    BEGIN
      CASE Mode OF
        Mode::Automation: DOMDocument.preserveWhiteSpace := PreserveWhitespace2;
        Mode::"DotNet on RTC": XmlDocumentOnRTC.PreserveWhitespace := PreserveWhitespace2;
        Mode::"DotNet on NST": XmlDocumentOnNST.PreserveWhitespace := PreserveWhitespace2;
      END;
    END;

    PROCEDURE GetProhibitDTD@1000000026() : Boolean;
    BEGIN
      // CI-210
      CASE Mode OF
        Mode::Automation: EXIT(DOMDocument.getProperty('ProhibitDTD'));
      END;
    END;

    PROCEDURE SetProhibitDTD@1000000027(ProhibitDTD2@1000000000 : Boolean);
    BEGIN
      // CI-210
      CASE Mode OF
        Mode::Automation: DOMDocument.setProperty('ProhibitDTD', ProhibitDTD2);
      END;
    END;

    PROCEDURE GetResolveExternals@1000000029() : Boolean;
    BEGIN
      // CI-210
      CASE Mode OF
        Mode::Automation: EXIT(DOMDocument.resolveExternals);
      END;
    END;

    PROCEDURE SetResolveExternals@1000000030(ResolveExternals2@1000000000 : Boolean);
    BEGIN
      CASE Mode OF
        Mode::Automation: DOMDocument.resolveExternals := ResolveExternals2;
      END;
    END;

    PROCEDURE GetValidateOnParse@1000000031() : Boolean;
    BEGIN
      // CI-210
      CASE Mode OF
        Mode::Automation: EXIT(DOMDocument.getProperty('ValidateOnParse'));
      END;
    END;

    PROCEDURE SetValidateOnParse@1000000032(ValidateOnParse2@1000000000 : Boolean);
    BEGIN
      // CI-210
      CASE Mode OF
        Mode::Automation: DOMDocument.setProperty('ValidateOnParse', ValidateOnParse2);
      END;
    END;

    PROCEDURE LoadFromText@1000000014(Text@1000000000 : Text[1024]);
    BEGIN
      CASE Mode OF
        Mode::Automation:
          BEGIN
            DOMDocument.loadXML(Text);
            TestParseErrorAutomation; // CI-210
          END;
        Mode::"DotNet on RTC": XmlDocumentOnRTC.LoadXml(Text);
        Mode::"DotNet on NST": XmlDocumentOnNST.LoadXml(Text);
      END;
    END;

    PROCEDURE LoadFromBigText@1000000016(BigText@1000000000 : BigText);
    BEGIN
      CASE Mode OF
        Mode::Automation:
          BEGIN
            DOMDocument.loadXML(FORMAT(BigText));
            TestParseErrorAutomation; // CI-210
          END;
        Mode::"DotNet on RTC": XmlDocumentOnRTC.LoadXml(FORMAT(BigText));
        Mode::"DotNet on NST": XmlDocumentOnNST.LoadXml(FORMAT(BigText));
      END;
    END;

    PROCEDURE LoadFromFile@1000000006(FileName@1000000000 : Text[260]);
    BEGIN
      CASE Mode OF
        Mode::Automation:
          BEGIN
            DOMDocument.load(FileName);
            TestParseErrorAutomation; // CI-210
          END;
        Mode::"DotNet on RTC": XmlDocumentOnRTC.Load(FileName);
        Mode::"DotNet on NST": XmlDocumentOnNST.Load(FileName);
      END;
    END;

    PROCEDURE LoadFromStream@1000000009(VAR Stream@1000000000 : InStream);
    VAR
      DotNetStream@1000000001 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";
    BEGIN
      IF Mode <> Mode::Automation THEN
        DotNetStream := Stream;

      CASE Mode OF
        Mode::Automation:
          BEGIN
            DOMDocument.load(Stream);
            TestParseErrorAutomation; // CI-210
          END;
        Mode::"DotNet on RTC": XmlDocumentOnRTC.Load(DotNetStream);
        Mode::"DotNet on NST": XmlDocumentOnNST.Load(DotNetStream);
      END;
    END;

    PROCEDURE SaveToFile@1000000015(FileName@1000000000 : Text[260]);
    BEGIN
      CASE Mode OF
        Mode::Automation: DOMDocument.save(FileName);
        Mode::"DotNet on RTC": XmlDocumentOnRTC.Save(FileName);
        Mode::"DotNet on NST": XmlDocumentOnNST.Save(FileName);
      END;
    END;

    PROCEDURE SaveToStream@1000000008(VAR Stream@1000000000 : OutStream);
    VAR
      DotNetStream@1000000001 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";
    BEGIN
      IF Mode <> Mode::Automation THEN
        DotNetStream := Stream;

      CASE Mode OF
        Mode::Automation: DOMDocument.save(Stream);
        Mode::"DotNet on RTC": XmlDocumentOnRTC.Save(DotNetStream);
        Mode::"DotNet on NST": XmlDocumentOnNST.Save(DotNetStream);
      END;
    END;

    PROCEDURE AddToBigText@1000000017(VAR BigText@1000000000 : BigText);
    BEGIN
      CASE Mode OF
        Mode::Automation: BigText.ADDTEXT(DOMDocument.xml);
        Mode::"DotNet on RTC": BigText.ADDTEXT(XmlDocumentOnRTC.OuterXml);
        Mode::"DotNet on NST": BigText.ADDTEXT(XmlDocumentOnNST.OuterXml);
      END;
    END;

    PROCEDURE ChildNodes@1000000002(VAR XMLNodeList@1000000000 : Codeunit 11148612);
    BEGIN
      CASE Mode OF
        Mode::Automation: XMLNodeList.SetAutomation(DOMDocument.childNodes);
        Mode::"DotNet on RTC": XMLNodeList.SetDotNetOnRTC(XmlDocumentOnRTC.ChildNodes);
        Mode::"DotNet on NST": XMLNodeList.SetDotNetOnNST(XmlDocumentOnNST.ChildNodes);
      END;
    END;

    PROCEDURE CreateNode@1000000010(NodeType@1000000000 : Integer;NodeName@1000000001 : Text[1024];Namespace@1000000002 : Text[1024];VAR Node@1000000003 : Codeunit 11148611);
    VAR
      NodeTypeOnRTC@1000000004 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNodeType" RUNONCLIENT;
      NodeTypeOnNST@1000000005 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNodeType";
    BEGIN
      CASE Mode OF
        Mode::Automation:
          Node.SetAutomation(DOMDocument.createNode(NodeType, NodeName, Namespace));
        Mode::"DotNet on RTC":
          BEGIN
            NodeTypeOnRTC := NodeType;
            Node.SetDotNetOnRTC(XmlDocumentOnRTC.CreateNode(NodeTypeOnRTC, NodeName, Namespace));
          END;
        Mode::"DotNet on NST":
          BEGIN
            NodeTypeOnNST := NodeType;
            Node.SetDotNetOnNST(XmlDocumentOnNST.CreateNode(NodeTypeOnNST, NodeName, Namespace));
          END;
      END;
    END;

    PROCEDURE CreateProcessingInstruction@1000000012(Target@1000000000 : Text[1024];Data@1000000001 : Text[1024];VAR Node@1000000002 : Codeunit 11148611);
    BEGIN
      CASE Mode OF
        Mode::Automation: Node.SetAutomation(DOMDocument.createProcessingInstruction(Target, Data));
        Mode::"DotNet on RTC": Node.SetDotNetOnRTC(XmlDocumentOnRTC.CreateProcessingInstruction(Target, Data));
        Mode::"DotNet on NST": Node.SetDotNetOnNST(XmlDocumentOnNST.CreateProcessingInstruction(Target, Data));
      END;
    END;

    PROCEDURE AsNode@1000000007(VAR XMLNode@1000000000 : Codeunit 11148611);
    BEGIN
      CASE Mode OF
        Mode::Automation: XMLNode.SetAutomation(DOMDocument);
        Mode::"DotNet on RTC": XMLNode.SetDotNetOnRTC(XmlDocumentOnRTC);
        Mode::"DotNet on NST": XMLNode.SetDotNetOnNST(XmlDocumentOnNST);
      END;
    END;

    PROCEDURE AppendChild@1000000011(VAR XMLNode@1000000000 : Codeunit 11148611);
    VAR
      XMLDOMNode@1000000001 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{2933BF80-7B36-11D2-B20E-00C04F983E60}:'Microsoft XML, v6.0'.IXMLDOMNode";
      XmlNodeOnRTC@1000000002 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode" RUNONCLIENT;
      XmlNodeOnNST@1000000003 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode";
    BEGIN
      CASE Mode OF
        Mode::Automation:
          BEGIN
            XMLNode.GetAutomation(XMLDOMNode);
            DOMDocument.appendChild(XMLDOMNode);
          END;
        Mode::"DotNet on RTC":
          BEGIN
            XMLNode.GetDotNetOnRTC(XmlNodeOnRTC);
            XmlDocumentOnRTC.AppendChild(XmlNodeOnRTC);
          END;
        Mode::"DotNet on NST":
          BEGIN
            XMLNode.GetDotNetOnNST(XmlNodeOnNST);
            XmlDocumentOnNST.AppendChild(XmlNodeOnNST);
          END;
      END;
    END;

    PROCEDURE InsertBefore@1000000013(VAR NewXMLNode@1000000000 : Codeunit 11148611;VAR RefXMLNode@1000000001 : Codeunit 11148611);
    VAR
      NewXMLDOMNode@1000000003 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{2933BF80-7B36-11D2-B20E-00C04F983E60}:'Microsoft XML, v6.0'.IXMLDOMNode";
      RefXMLDOMNode@1000000002 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{2933BF80-7B36-11D2-B20E-00C04F983E60}:'Microsoft XML, v6.0'.IXMLDOMNode";
      NewXmlNodeOnRTC@1000000004 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode" RUNONCLIENT;
      RefXmlNodeOnRTC@1000000005 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode" RUNONCLIENT;
      NewXmlNodeOnNST@1000000006 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode";
      RefXmlNodeOnNST@1000000007 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode";
    BEGIN
      CASE Mode OF
        Mode::Automation:
          BEGIN
            NewXMLNode.GetAutomation(NewXMLDOMNode);
            RefXMLNode.GetAutomation(RefXMLDOMNode);

            DOMDocument.insertBefore(NewXMLDOMNode, RefXMLDOMNode);
          END;
        Mode::"DotNet on RTC":
          BEGIN
            NewXMLNode.GetDotNetOnRTC(NewXmlNodeOnRTC);
            RefXMLNode.GetDotNetOnRTC(RefXmlNodeOnRTC);

            XmlDocumentOnRTC.InsertBefore(NewXmlNodeOnRTC, RefXmlNodeOnRTC);
          END;
        Mode::"DotNet on NST":
          BEGIN
            NewXMLNode.GetDotNetOnNST(NewXmlNodeOnNST);
            RefXMLNode.GetDotNetOnNST(RefXmlNodeOnNST);

            XmlDocumentOnNST.InsertBefore(NewXmlNodeOnNST, RefXmlNodeOnNST);
          END;
      END;
    END;

    PROCEDURE GetMode@1000000022() : Integer;
    BEGIN
      EXIT(Mode);
    END;

    LOCAL PROCEDURE SetMode@1000000021(ClientSide@1000000000 : Boolean);
    BEGIN
      IF NOT ISSERVICETIER THEN BEGIN
        Mode := Mode::Automation;
        EXIT;
      END;

      IF ClientSide THEN BEGIN
        Mode := Mode::"DotNet on RTC";
        EXIT;
      END;

      Mode := Mode::"DotNet on NST";
    END;

    LOCAL PROCEDURE TestParseErrorAutomation@1000000028();
    VAR
      ParseError@1000000000 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{3EFAA426-272F-11D2-836F-0000F87A7782}:'Microsoft XML, v6.0'.IXMLDOMParseError";
    BEGIN
      // CI-210
      ParseError := DOMDocument.parseError;

      IF ParseError.errorCode <> 0 THEN
        ERROR(ParseError.reason);
    END;

    EVENT DOMDocument@1000000::ondataavailable@198();
    BEGIN
    END;

    EVENT DOMDocument@1000000::onreadystatechange@-609();
    BEGIN
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148638 IN - Connector Management
{
  OBJECT-PROPERTIES
  {
    Date=14-07-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.1;
  }
  PROPERTIES
  {
    SingleInstance=Yes;
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      FolderMonDotNetOnNst1@1002 : DotNet "'IDYN.Components, Version=2.7.1.712, Culture=neutral, PublicKeyToken=0f5532c6f6903616'.IDYN.Components.FolderMonitor" WITHEVENTS;
      FolderMonDotNetOnNst2@1003 : DotNet "'IDYN.Components, Version=2.7.1.712, Culture=neutral, PublicKeyToken=0f5532c6f6903616'.IDYN.Components.FolderMonitor" WITHEVENTS;
      FolderMonDotNetOnNst3@1004 : DotNet "'IDYN.Components, Version=2.7.1.712, Culture=neutral, PublicKeyToken=0f5532c6f6903616'.IDYN.Components.FolderMonitor" WITHEVENTS;
      FolderMonAutomation1@1000009 : Automation "{75E053EA-4A5A-4210-9188-699CF98212FE} 2.7:{1AD456AC-A719-456F-A691-94B7C0C9959A}:'IDYN.Components'.FolderMonitor" WITHEVENTS;
      FolderMonAutomation2@1000001 : Automation "{75E053EA-4A5A-4210-9188-699CF98212FE} 2.7:{1AD456AC-A719-456F-A691-94B7C0C9959A}:'IDYN.Components'.FolderMonitor" WITHEVENTS;
      FolderMonAutomation3@1000000 : Automation "{75E053EA-4A5A-4210-9188-699CF98212FE} 2.7:{1AD456AC-A719-456F-A691-94B7C0C9959A}:'IDYN.Components'.FolderMonitor" WITHEVENTS;
      FileSystemArray@1000002 : ARRAY [10] OF Code[20];
      Text000@1000 : TextConst 'ENU=Connectors of type %1 are no longer supported.;NLD=Connectors van het soort %1 worden niet langer ondersteund.';
      Mode@1001 : 'Automation,,DotNet on NST';

    PROCEDURE Start@1000000(VAR Connector@1000000 : Record 11148623);
    BEGIN
      SetMode;

      IF Connector.Status = Connector.Status::Blocked THEN
        Connector.FIELDERROR(Status);

      CASE Connector.Type OF

        Connector.Type::"File System" :
          CASE Mode OF
            Mode::Automation: StartFileSystemAutomation(Connector);
            Mode::"DotNet on NST": StartFileSystemDotNetOnNST(Connector);
          END;

        Connector.Type::"Message Queue" :
          ERROR(Text000, Connector.Type);

        Connector.Type::"Web Service" :
          ERROR(Text000, Connector.Type);

        Connector.Type::"Port Connector" :
          ERROR(Text000, Connector.Type);

      END;
    END;

    PROCEDURE Stop@1000001(VAR Connector@1000000 : Record 11148623);
    BEGIN
      SetMode;

      CASE Connector.Type OF

        Connector.Type::"File System" :
          CASE Mode OF
            Mode::Automation: StopFileSystemAutomation(Connector);
            Mode::"DotNet on NST": StopFileSystemDotNetOnNST(Connector);
          END;

        Connector.Type::"Message Queue" :
          ERROR(Text000, Connector.Type);

        Connector.Type::"Web Service" :
          ERROR(Text000, Connector.Type);

        Connector.Type::"Port Connector" :
          ERROR(Text000, Connector.Type);

      END;
    END;

    PROCEDURE ConnectorActive@1000007(VAR Connector@1000000 : Record 11148623) : Boolean;
    VAR
      i@1000001 : Integer;
    BEGIN
      CASE Connector.Type OF

        Connector.Type::"File System" :
          FOR i := 1 TO 3 DO
            IF FileSystemArray[i] = Connector.Code THEN
              EXIT(TRUE);

        Connector.Type::"Message Queue" :
          ERROR(Text000, Connector.Type);

        Connector.Type::"Web Service" :
          ERROR(Text000, Connector.Type);

        Connector.Type::"Port Connector" :
          ERROR(Text000, Connector.Type);

      END;
    END;

    LOCAL PROCEDURE StartFileSystemAutomation@1000002(VAR Connector@1000000 : Record 11148623);
    VAR
      i@1000001 : Integer;
      Started@1000002 : Boolean;
    BEGIN
      FOR i := 1 TO 3 DO
        IF FileSystemArray[i] = Connector.Code THEN
          StopFileSystemAutomation(Connector);

      IF FileSystemArray[1] = '' THEN BEGIN
        IF NOT ISCLEAR(FolderMonAutomation1) THEN
          FolderMonAutomation1.Close;
        CLEAR(FolderMonAutomation1);
        CREATE(FolderMonAutomation1, TRUE, TRUE);
        FolderMonAutomation1.Folder := Connector.Folder;
        FolderMonAutomation1.Active := TRUE;
        FileSystemArray[1] := Connector.Code;
        Started := TRUE;
      END;

      IF (FileSystemArray[2] = '') AND NOT Started THEN BEGIN
        IF NOT ISCLEAR(FolderMonAutomation2) THEN
          FolderMonAutomation2.Close;
        CLEAR(FolderMonAutomation2);
        CREATE(FolderMonAutomation2, TRUE, TRUE);
        FolderMonAutomation2.Folder := Connector.Folder;
        FolderMonAutomation2.Active := TRUE;
        Started := TRUE;
        FileSystemArray[2] := Connector.Code;
      END;

      IF (FileSystemArray[3] = '') AND NOT Started THEN BEGIN
        IF NOT ISCLEAR(FolderMonAutomation3) THEN
          FolderMonAutomation3.Close;
        CLEAR(FolderMonAutomation3);
        CREATE(FolderMonAutomation3, TRUE, TRUE);
        FolderMonAutomation3.Folder := Connector.Folder;
        FolderMonAutomation3.Active := TRUE;
        Started := TRUE;
        FileSystemArray[3] := Connector.Code;
      END;

      IF NOT Started THEN
        MESSAGE('No empty slot');
    END;

    LOCAL PROCEDURE StopFileSystemAutomation@1000005(VAR Connector@1000000 : Record 11148623);
    BEGIN
      IF FileSystemArray[1] = Connector.Code THEN BEGIN
        FolderMonAutomation1.Active := FALSE;
        FileSystemArray[1] := '';
        FolderMonAutomation1.Close;
        CLEAR(FolderMonAutomation1);
      END;

      IF FileSystemArray[2] = Connector.Code THEN BEGIN
        FolderMonAutomation2.Active := FALSE;
        FileSystemArray[2] := '';
        FolderMonAutomation2.Close;
        CLEAR(FolderMonAutomation2);
      END;

      IF FileSystemArray[3] = Connector.Code THEN BEGIN
        FolderMonAutomation3.Active := FALSE;
        FileSystemArray[3] := '';
        FolderMonAutomation3.Close;
        CLEAR(FolderMonAutomation3);
      END;
    END;

    LOCAL PROCEDURE StartFileSystemDotNetOnNST@4(VAR Connector@1000 : Record 11148623);
    VAR
      i@1001 : Integer;
      Started@1002 : Boolean;
    BEGIN
      WriteDebugEntryToEventLog(STRSUBSTNO('Starting connector %1 (.NET on NST)', Connector.Code));

      FOR i := 1 TO 3 DO
        IF FileSystemArray[i] = Connector.Code THEN
          StopFileSystemDotNetOnNST(Connector);

      IF FileSystemArray[1] = '' THEN BEGIN
        IF NOT ISNULL(FolderMonDotNetOnNst1) THEN
          FolderMonDotNetOnNst1.Close;
        CLEAR(FolderMonDotNetOnNst1);
        FolderMonDotNetOnNst1 := FolderMonDotNetOnNst1.FolderMonitor;
        FolderMonDotNetOnNst1.Folder := Connector.Folder;
        FolderMonDotNetOnNst1.Active := TRUE;
        FileSystemArray[1] := Connector.Code;
        Started := TRUE;
      END;

      IF (FileSystemArray[2] = '') AND NOT Started THEN BEGIN
        IF NOT ISNULL(FolderMonDotNetOnNst2) THEN
          FolderMonDotNetOnNst2.Close;
        CLEAR(FolderMonDotNetOnNst2);
        FolderMonDotNetOnNst2 := FolderMonDotNetOnNst2.FolderMonitor;
        FolderMonDotNetOnNst2.Folder := Connector.Folder;
        FolderMonDotNetOnNst2.Active := TRUE;
        Started := TRUE;
        FileSystemArray[2] := Connector.Code;
      END;

      IF (FileSystemArray[3] = '') AND NOT Started THEN BEGIN
        IF NOT ISNULL(FolderMonDotNetOnNst3) THEN
          FolderMonDotNetOnNst3.Close;
        CLEAR(FolderMonDotNetOnNst3);
        FolderMonDotNetOnNst3 := FolderMonDotNetOnNst3.FolderMonitor;
        FolderMonDotNetOnNst3.Folder := Connector.Folder;
        FolderMonDotNetOnNst3.Active := TRUE;
        Started := TRUE;
        FileSystemArray[3] := Connector.Code;
      END;

      IF NOT Started THEN
        MESSAGE('No empty slot');
    END;

    LOCAL PROCEDURE StopFileSystemDotNetOnNST@5(VAR Connector@1000 : Record 11148623);
    BEGIN
      WriteDebugEntryToEventLog(STRSUBSTNO('Stopping connector %1 (.NET on NST)', Connector.Code));

      IF FileSystemArray[1] = Connector.Code THEN BEGIN
        FolderMonDotNetOnNst1.Active := FALSE;
        FileSystemArray[1] := '';
        FolderMonDotNetOnNst1.Close;
        CLEAR(FolderMonDotNetOnNst1);
      END;

      IF FileSystemArray[2] = Connector.Code THEN BEGIN
        FolderMonDotNetOnNst2.Active := FALSE;
        FileSystemArray[2] := '';
        FolderMonDotNetOnNst2.Close;
        CLEAR(FolderMonDotNetOnNst2);
      END;

      IF FileSystemArray[3] = Connector.Code THEN BEGIN
        FolderMonDotNetOnNst3.Active := FALSE;
        FileSystemArray[3] := '';
        FolderMonDotNetOnNst3.Close;
        CLEAR(FolderMonDotNetOnNst3);
      END;
    END;

    LOCAL PROCEDURE FileOnChanged@1000006(PathFilename@1000000 : Text[1024];ConnectorCode@1000001 : Code[20]);
    VAR
      ImportDefinition@1000004 : Record 11148591;
      Task@1000005 : Record 11148614;
      Connector@1000002 : Record 11148623;
      ConnectorLine@1000003 : Record 11148624;
      Mgt@1000008 : Codeunit 11148589;
      Filename@1000007 : Text[1024];
      Path@1000006 : Text[1024];
    BEGIN
      WriteDebugEntryToEventLog(STRSUBSTNO('FileOnChanged was fired for file %1, connector %2.', PathFilename, ConnectorCode));

      Mgt.SplitFilenamePath(PathFilename, Path, Filename);

      Connector.GET(ConnectorCode);
      ConnectorLine.SETRANGE("Connector Code", Connector.Code);
      IF ConnectorLine.FINDSET THEN
        REPEAT
          CASE ConnectorLine.Type OF

            ConnectorLine.Type::Filename :
              IF ConnectorLine.Value = Filename THEN
                ConnectorLine.MARK(TRUE);

            ConnectorLine.Type::"Filename Contains" :
              IF STRPOS(Filename, ConnectorLine.Value) > 0 THEN
                ConnectorLine.MARK(TRUE);

          END;

        UNTIL ConnectorLine.NEXT = 0;

      ConnectorLine.MARKEDONLY(TRUE);

      ConnectorLine.SETFILTER("Run Import Def.", '<>%1', '');
      IF ConnectorLine.FINDFIRST THEN BEGIN
        ImportDefinition.GET(ConnectorLine."Run Import Def.");
        ImportDefinition.Location := Path;
        ImportDefinition.Filename := Filename;
        ImportDefinition.Process;
      END ELSE
        IF Connector."Run Import Def." <> '' THEN BEGIN
          ImportDefinition.GET(Connector."Run Import Def.");
          ImportDefinition.Location := Path;
          ImportDefinition.Filename := Filename;
          ImportDefinition.Process;
        END;

      ConnectorLine.SETRANGE("Run Import Def.");

      ConnectorLine.SETFILTER("Run Task", '<>%1', '');
      IF ConnectorLine.FINDSET THEN
        REPEAT
          Task.GET(ConnectorLine."Run Task");
          Task.Process;
        UNTIL ConnectorLine.NEXT = 0;

      IF Connector."Run Task" <> '' THEN BEGIN
        Task.GET(Connector."Run Task");
        Task.Process;
      END;
    END;

    PROCEDURE GetMode@1() : Integer;
    BEGIN
      EXIT(Mode);
    END;

    LOCAL PROCEDURE SetMode@2();
    BEGIN
      CASE ISSERVICETIER OF
        FALSE: Mode := Mode::Automation;
        TRUE: Mode := Mode::"DotNet on NST";
      END;
    END;

    LOCAL PROCEDURE WriteDebugEntryToEventLog@3(Message@1002 : Text[1024]);
    VAR
      ConnectITSetup@1001 : Record 11148589;
      EventLog@1000 : Codeunit 11148654;
    BEGIN
      ConnectITSetup.GET;

      IF ConnectITSetup."Debugging Entries in Event Log" THEN
        EventLog.WriteInfo(Message);
    END;

    EVENT FolderMonAutomation1@1000009::OnChanged@1(FolderMonitor@1001 : Automation "{75E053EA-4A5A-4210-9188-699CF98212FE} 2.7:{7478A075-9BFB-4CB0-8B57-F0B9E4ECC416}:'IDYN.Components'.IFolderMonitor";filePath@1000 : Text);
    BEGIN
      FileOnChanged(filePath, FileSystemArray[1]);
    END;

    EVENT FolderMonAutomation2@1000001::OnChanged@1(FolderMonitor@1001 : Automation "{75E053EA-4A5A-4210-9188-699CF98212FE} 2.7:{7478A075-9BFB-4CB0-8B57-F0B9E4ECC416}:'IDYN.Components'.IFolderMonitor";filePath@1000 : Text);
    BEGIN
      FileOnChanged(filePath, FileSystemArray[2]);
    END;

    EVENT FolderMonAutomation3@1000000::OnChanged@1(FolderMonitor@1001 : Automation "{75E053EA-4A5A-4210-9188-699CF98212FE} 2.7:{7478A075-9BFB-4CB0-8B57-F0B9E4ECC416}:'IDYN.Components'.IFolderMonitor";filePath@1000 : Text);
    BEGIN
      FileOnChanged(filePath, FileSystemArray[3]);
    END;

    EVENT FolderMonDotNetOnNst1@1002::OnChanged@12(folderMonitor@1001 : DotNet "'IDYN.Components, Version=2.7.1.712, Culture=neutral, PublicKeyToken=0f5532c6f6903616'.IDYN.Components.IFolderMonitor";filePath@1000 : Text);
    BEGIN
      FileOnChanged(filePath, FileSystemArray[1]);
    END;

    EVENT FolderMonDotNetOnNst2@1003::OnChanged@12(folderMonitor@1001 : DotNet "'IDYN.Components, Version=2.7.1.712, Culture=neutral, PublicKeyToken=0f5532c6f6903616'.IDYN.Components.IFolderMonitor";filePath@1000 : Text);
    BEGIN
      FileOnChanged(filePath, FileSystemArray[2]);
    END;

    EVENT FolderMonDotNetOnNst3@1004::OnChanged@12(folderMonitor@1001 : DotNet "'IDYN.Components, Version=2.7.1.712, Culture=neutral, PublicKeyToken=0f5532c6f6903616'.IDYN.Components.IFolderMonitor";filePath@1000 : Text);
    BEGIN
      FileOnChanged(filePath, FileSystemArray[3]);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148641 IN - Relation Management
{
  OBJECT-PROPERTIES
  {
    Date=14-07-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.1;
  }
  PROPERTIES
  {
    OnRun=BEGIN
            IF NOT ISSERVICETIER THEN BEGIN
              ReadObjects;
            END ELSE BEGIN
              ERROR(Text003);
            END;
          END;

  }
  CODE
  {
    VAR
      CSideManager@1100543000 : Codeunit 11148651;
      Text001@1000000000 : TextConst 'ENU=Errors have occurred while extracting table relations.\\Would you like to see the errors?;NLD=Er zijn fouten opgetreden tijdens er uitlezen van tabelrelaties.\\Wilt u deze bekijken?';
      Text002@1000000001 : TextConst 'ENU=You''re license does not give you rights to access this table.;NLD=Uw licentie staat niet toe om deze tabel te bewerken.';
      Text003@1000000002 : TextConst 'ENU=Please refresh the relations using the Classic Client.\The Role Tailored Client does not support the refresh feature.;NLD=Het is niet mogelijk om de de Role Tailored Client de tabel relaties te verversen. Gebruik hiervoor de Classic Client.';

    LOCAL PROCEDURE ReadObjects@1100531000();
    VAR
      Relation@1100531018 : Record 11148625;
      Object@1100531005 : Record 2000000001;
      Fld@1100531015 : Record 2000000041;
      Mgt@1100531004 : Codeunit 11148589;
      Window@1100531006 : Dialog;
      oFile@1100531001 : File;
      FieldNoText@1100531012 : Text[30];
      Filename@1100531002 : Text[1024];
      TableRelation@1100531014 : Text[1024];
      TextLine@1100531000 : Text[1024];
      FieldNo@1100531013 : Integer;
      NoOfRecords@1100531007 : Integer;
      Position@1100531011 : Integer;
      RecordCounter@1100531008 : Integer;
      FieldsOpen@1100531010 : Boolean;
      ErrorLog@1000000000 : TEMPORARY Record 11148637;
    BEGIN
      Filename := Mgt.TmpDir + '\exportobject.txt';

      Object.SETRANGE(Type, Object.Type::Table);
      Object.SETFILTER(
        ID, '<>%1&<>%2&<>%3',
        DATABASE::"IN - Relation",
        DATABASE::"IN - Relation Condition",
        DATABASE::"IN - Relation Filter");
      NoOfRecords := Object.COUNT;

      Window.OPEN('#1#########################\@2@@@@@@@@@@@@@@@@@@@@@@@@@');

      IF Object.FINDSET THEN
        REPEAT

          RecordCounter += 1;

          Window.UPDATE(1, FORMAT(Object.ID) + ' - ' + Object.Name);
          Window.UPDATE(2, ROUND(RecordCounter / NoOfRecords * 10000, 1));

          IF IsLicensed(Object) THEN BEGIN
            IF ExportFile(Object, Filename) THEN BEGIN

              Relation.SETCURRENTKEY("Table No.");
              Relation.SETRANGE("Table No.", Object.ID);
              Relation.DELETEALL(TRUE);

              oFile.OPEN(Filename);
              oFile.TEXTMODE(TRUE);

              WHILE oFile.POS < oFile.LEN DO BEGIN

                oFile.READ(TextLine);

                CASE TRUE OF

                  TextLine = '  FIELDS' :
                    FieldsOpen := TRUE;

                  TextLine = '  }' :
                    FieldsOpen := FALSE;

                END;

                IF FieldsOpen THEN BEGIN

                  IF COPYSTR(TextLine, 5, 1) = '{' THEN BEGIN
                    Position := 7;
                    NextValue(TextLine, Position, ';', '[', ']', FieldNoText);
                    EVALUATE(FieldNo, FieldNoText);
                    Fld.GET(Object.ID, FieldNo);
                  END;

                  IF COPYSTR(TextLine, 52, 13) = 'TableRelation' THEN BEGIN
                    TableRelation := COPYSTR(TextLine, 66);
                    AnalyseTableRelation(TableRelation, Fld);
                    WHILE NOT (TextLine[STRLEN(TextLine)] IN [';', '}']) DO BEGIN
                      oFile.READ(TextLine);
                      TextLine := DELCHR(TextLine, '<>', ' ');
                      IF STRPOS(TextLine, 'ELSE IF (') > 0 THEN
                        AnalyseTableRelation(TextLine, Fld);
                    END;

                  END;

                END;

              END;

              oFile.CLOSE;

            END ELSE
              ErrorLog.LogError(Object.ID, CSideManager.GetLastError);
          END ELSE
            ErrorLog.LogError(Object.ID, Text002);

          COMMIT;

        UNTIL Object.NEXT = 0;

      Window.CLOSE;

      IF NOT ErrorLog.ISEMPTY THEN
        IF CONFIRM(Text001, TRUE) THEN
          PAGE.RUNMODAL(0, ErrorLog);
    END;

    LOCAL PROCEDURE AnalyseTableRelation@1000019(VAR Expression@1000005 : Text[1024];VAR Fld@1000003 : Record 2000000041);
    VAR
      Relation@1100531001 : Record 11148625;
      RelationCondition@1100531008 : Record 11148626;
      RelationFilter@1100531009 : Record 11148627;
      AllObj@1000013 : Record 2000000038;
      Fld2@1100531002 : Record 2000000041;
      RecRef@1100531005 : RecordRef;
      FldRef@1100531004 : FieldRef;
      KeyRef@1100531003 : KeyRef;
      FieldString@1100531007 : Text[30];
      Filter1@1000018 : Text[1024];
      Filter2@1000017 : Text[1024];
      Filter3@1000016 : Text[1024];
      NextString@1000010 : Text[1024];
      TableString@1100531006 : Text[1024];
      Position@1000012 : Integer;
      GetNext@1000019 : Boolean;
      GetNextFilter2@1100531000 : Boolean;
      GetNext2@1000020 : Boolean;
    BEGIN
      Position := 1;

      GetNext := TRUE;
      WHILE GetNext DO BEGIN

        CLEAR(Relation."Entry No.");
        Relation."Table No." := Fld.TableNo;
        Relation."Field No." := Fld."No.";
        Relation.INSERT;

        NextString := '';
        NextValueTill(Expression, Position, '"', ' .;}', TableString);

        IF TableString = 'ELSE' THEN
          NextValueTill(Expression, Position, '"', ' .;}', TableString);

        IF TableString = 'IF' THEN BEGIN

          GetNextFilter2 := TRUE;
          WHILE GetNextFilter2 DO BEGIN

            Position += 1;
            GetNextFilter(Expression, Position, Filter1, Filter2, Filter3);

            CLEAR(RelationCondition."Entry No.");
            RelationCondition."Relation Entry No." := Relation."Entry No.";
            Fld2.SETRANGE(TableNo, Fld.TableNo);
            Fld2.SETFILTER(FieldName, CreateFilter(Filter1, TRUE));
            IF Fld2.FINDFIRST THEN
              RelationCondition."Field No." := Fld."No.";

            CASE Filter2 OF
              'CONST' :
                RelationCondition.Type := RelationCondition.Type::Const;

              'FILTER' :
                RelationCondition.Type := RelationCondition.Type::Filter;

            END;
            RelationCondition.Value := Filter3;
            RelationCondition.INSERT;

            NextString := '';
            GetNextFilter2 := Expression[Position] = ',';
            Position += 1;
          END;
          Position += 1;
          NextValueTill(Expression, Position, '"', ' .;}', TableString);
        END;

        FieldString := '';
        IF Expression[Position - 1] = '.' THEN
          NextValueTill(Expression, Position, '"', ' ;}', FieldString);

        AllObj.SETRANGE("Object Type", AllObj."Object Type"::Table);
        AllObj.SETFILTER("Object Name", CreateFilter(TableString, TRUE));
        IF AllObj.FINDFIRST THEN BEGIN

          Relation."Relation Table No." := AllObj."Object ID";

          IF FieldString = '' THEN BEGIN
            RecRef.OPEN(Relation."Relation Table No.");
            KeyRef := RecRef.KEYINDEX(1);
            FldRef := KeyRef.FIELDINDEX(1);
            Relation."Relation Field No." := FldRef.NUMBER;
            RecRef.CLOSE;
          END ELSE BEGIN
            Fld2.SETRANGE(TableNo, AllObj."Object ID");
            Fld2.SETFILTER(FieldName, CreateFilter(FieldString, TRUE));
            IF Fld2.FINDFIRST THEN
              Relation."Relation Field No." := Fld2."No.";
          END;

          Relation.MODIFY;

        END;

        GetNext2 := COPYSTR(Expression, Position, 5) = 'WHERE';
        IF GetNext2 THEN BEGIN
          Position += 1;
          NextValueTill(Expression, Position, '"', ' ', FieldString);

          WHILE GetNext2 DO BEGIN

            Position += 1;
            GetNextFilter(Expression, Position, Filter1, Filter2, Filter3);

            CLEAR(RelationFilter."Entry No.");
            RelationFilter."Relation Entry No." := Relation."Entry No.";
            Fld2.SETRANGE(TableNo, Relation."Relation Table No.");
            Fld2.SETFILTER(FieldName, CreateFilter(Filter1, TRUE));
            IF Fld2.FINDFIRST THEN
              RelationFilter."Field No." := Fld2."No."
            ELSE
              RelationFilter."Field No." := 0;
            RelationFilter.Value := Filter3;

            CASE Filter2 OF
              'CONST' :
                RelationFilter.Type := RelationFilter.Type::Const;

              'FILTER' :
                RelationFilter.Type := RelationFilter.Type::Filter;

              'FIELD' :
                BEGIN
                  RelationFilter.Type := RelationFilter.Type::Field;
                  Fld2.SETRANGE(TableNo, Relation."Table No.");
                  Fld2.SETFILTER(FieldName, CreateFilter(Filter3, TRUE));
                  IF Fld2.FINDFIRST THEN
                    RelationFilter.Value := FORMAT(Fld2."No.");
                END;

            END;
            RelationFilter.INSERT;

            GetNext2 := Expression[Position] = ',';
            Position += 1;
          END;
        END;

        GetNext := Position < STRLEN(Expression);

      END;
    END;

    LOCAL PROCEDURE NextValue@1000031(VAR TextLine@1000 : Text[1024];VAR Position@1000007 : Integer;Seperator@1000001 : Char;OpenChar@1000008 : Char;CloseChar@1000010 : Char;VAR ExitValue@1000009 : Text[1024]) : Boolean;
    VAR
      Char@1000000 : Char;
      Advanced@1000003 : Boolean;
      FirstCharacter@1000004 : Boolean;
      Stop@1000002 : Boolean;
    BEGIN
      ExitValue := '';
      FirstCharacter := TRUE;

      IF Position > STRLEN(TextLine) THEN
        EXIT(FALSE);

      WHILE NOT Stop DO

        IF NextChar(TextLine, Position, Char) THEN BEGIN

          CASE Char OF

            Seperator :
              IF Advanced THEN
                ExitValue += FORMAT(Char)
              ELSE
                Stop := TRUE;

            OpenChar :
              IF FirstCharacter THEN
                Advanced := TRUE
              ELSE
                IF OpenChar = CloseChar THEN BEGIN
                  IF Advanced THEN
                    IF NextChar(TextLine, Position, Char) THEN
                      IF Char = CloseChar THEN
                        ExitValue += FORMAT(Char)
                      ELSE BEGIN
                        Advanced := FALSE;
                        Position -= 1;
                      END;
                END ELSE
                  ExitValue += FORMAT(Char);

            CloseChar :
              IF Advanced THEN
                IF NextChar(TextLine, Position, Char) THEN
                  IF Char = CloseChar THEN
                    ExitValue += FORMAT(Char)
                  ELSE BEGIN
                    Advanced := FALSE;
                    Position -= 1;
                  END;

            ELSE
              ExitValue += FORMAT(Char);
          END;

          FirstCharacter := FALSE;

        END ELSE
          Stop := TRUE;

      ExitValue := DELCHR(ExitValue, '<>', ' ');
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE NextValueTill@1100531001(VAR TextLine@1000 : Text[1024];VAR Position@1000007 : Integer;OpenChar@1000008 : Char;StopChars@1100531000 : Text[30];VAR ExitValue@1000009 : Text[1024]) : Boolean;
    VAR
      Char@1000000 : Char;
      Advanced@1000003 : Boolean;
      FirstCharacter@1000004 : Boolean;
      Stop@1000002 : Boolean;
    BEGIN
      ExitValue := '';
      FirstCharacter := TRUE;

      IF Position > STRLEN(TextLine) THEN
        EXIT(FALSE);

      WHILE NOT Stop DO

        IF NextChar(TextLine, Position, Char) THEN BEGIN

          CASE TRUE OF

            Char = OpenChar :
              IF FirstCharacter THEN
                Advanced := TRUE
              ELSE
                IF Advanced THEN BEGIN
                  IF NextChar(TextLine, Position, Char) THEN
                    IF Char = OpenChar THEN
                      ExitValue += FORMAT(Char)
                    ELSE BEGIN
                      Advanced := FALSE;
                      Position -= 1;
                    END;
                END ELSE
                  ExitValue += FORMAT(Char);

            STRPOS(StopChars, FORMAT(Char)) > 0 :

              IF Advanced THEN
                ExitValue += FORMAT(Char)
              ELSE
                Stop := TRUE;

            ELSE
              ExitValue += FORMAT(Char);

          END;

          FirstCharacter := FALSE;

        END ELSE
          Stop := TRUE;

      ExitValue := DELCHR(ExitValue, '<>', ' ');
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE NextChar@1000032(VAR TextLine@1000001 : Text[1024];VAR Position@1000000 : Integer;VAR Char@1000002 : Char) : Boolean;
    BEGIN
      IF Position <= STRLEN(TextLine) THEN BEGIN
        Char := TextLine[Position];
        Position += 1;
        EXIT(TRUE);
      END;
    END;

    LOCAL PROCEDURE GetNextStatementInExpr@1000021(VAR Expression@1000000 : Text[1024];VAR Position@1000001 : Integer;VAR Statement@1000003 : Text[100];VAR NextStatement@1000006 : Text[100];VAR First@1000007 : Text[100];VAR CoupleString@1000008 : Text[100];VAR Last@1000010 : Text[100];VAR AccoladeExpr@1000011 : Text[1024]) ExitValue : Boolean;
    VAR
      NextExp@1000009 : Text[100];
      Stat1@1000002 : Text[100];
      Stat2@1000004 : Text[100];
      Stat3@1000005 : Text[100];
    BEGIN
      AccoladeExpr := '';

      GetNextStatementInExprSub(Expression, Position, NextExp, AccoladeExpr);

      IF NextStatement = '' THEN BEGIN
        IF NextExp = '' THEN
          EXIT(FALSE);
        Statement := NextExp;
        GetNextStatementInExprSub(Expression, Position, NextStatement, AccoladeExpr);
      END ELSE BEGIN
        Statement := NextStatement;
        NextStatement := NextExp;
      END;

      IF NextStatement IN ['.', '::'] THEN BEGIN
        Stat1 := Statement;
        Stat2 := NextStatement;
        GetNextStatementInExprSub(Expression, Position, Statement, AccoladeExpr);
        Stat3 := Statement;

        Statement := Stat1 + Stat2 + Stat3;

        First := Stat1;
        CoupleString := Stat2;
        Last := Stat3;

        GetNextStatementInExprSub(Expression, Position, NextStatement, AccoladeExpr);

      END ELSE BEGIN
        First := Statement;
        CoupleString := '';
        Last := Statement;
      END;

      EXIT(TRUE);
    END;

    LOCAL PROCEDURE GetNextStatementInExprSub@1000022(VAR Expression@1000011 : Text[1024];VAR Position@1000001 : Integer;VAR Statement@1000003 : Text[100];VAR AccoladeExpr@1000000 : Text[1024]);
    VAR
      Char@1000007 : Char;
      AccoladeExprLength@1100531000 : Integer;
      AccoladeOpen@1000009 : Integer;
      Length@1000012 : Integer;
      AddChar@1000005 : Boolean;
      AddingStarted@1000008 : Boolean;
      StopLoop@1000006 : Boolean;
      TextOpen@1000004 : Boolean;
      VariableOpen@1000002 : Boolean;
    BEGIN
      Statement := '';

      WHILE NOT StopLoop DO

        IF NextCharInExpr(Expression, Position, Char) THEN BEGIN
          AddChar := FALSE;

          CASE TRUE OF

            TextOpen :
              IF Char = '''' THEN
                TextOpen := FALSE;

            AccoladeOpen > 0 :
              BEGIN
                IF Char = '[' THEN
                  AccoladeOpen += 1;
                IF Char = ']' THEN
                  AccoladeOpen -= 1;
                IF AccoladeOpen > 0 THEN BEGIN
                  AccoladeExprLength += 1;
                  IF AccoladeExprLength <= 1024 THEN
                    AccoladeExpr += FORMAT(Char);
                END;
              END;

            VariableOpen :
              BEGIN
                IF Char = '"' THEN
                  VariableOpen := FALSE;
                AddChar := TRUE;
              END;

            Char = '''' :
              TextOpen := TRUE;

            Char = '"' :
              BEGIN
                VariableOpen := TRUE;
                AddChar := TRUE;
              END;

            Char = '[' :
              AccoladeOpen += 1;

            Char = ':' :
              IF Expression[Position] = ':' THEN
                IF AddingStarted THEN BEGIN
                  Position -= 1;
                  StopLoop := TRUE;
                END ELSE BEGIN
                  Position += 1;
                  Statement := '::';
                  StopLoop := TRUE;
                END;

            Char IN [';', '.', '(', ')'] :
              IF AddingStarted THEN BEGIN
                Position -= 1;
                StopLoop := TRUE;
              END ELSE BEGIN
                Statement := FORMAT(Char);
                StopLoop := TRUE;
              END;

            ((Char >= 'a') AND (Char <= 'z')) OR
            ((Char >= 'A') AND (Char <= 'Z')) OR
            ((Char >= '0') AND (Char <= '9')) OR
            ((Char >= '') AND (Char <= '')) OR
            (Char = '_') :
              AddChar := TRUE;

            ELSE
              IF AddingStarted THEN
                StopLoop := TRUE;

          END;

          IF AddChar THEN BEGIN
            Length += 1;
            IF Length < 100 THEN
              Statement += FORMAT(Char);
            AddingStarted := TRUE;
          END;

        END ELSE
          StopLoop := TRUE;
    END;

    LOCAL PROCEDURE NextCharInExpr@1000023(VAR Expression@1000004 : Text[1024];VAR Position@1000003 : Integer;VAR Char@1000002 : Char) : Boolean;
    BEGIN
      IF Position <= STRLEN(Expression) THEN BEGIN
        Char := Expression[Position];
        Position += 1;
        EXIT(TRUE);
      END ELSE
        EXIT(FALSE)
    END;

    LOCAL PROCEDURE GetNextTable@1100531002(VAR TextLine@1000 : Text[1024];VAR Position@1000007 : Integer;VAR ExitValue@1000009 : Text[1024]) : Boolean;
    VAR
      Char@1000000 : Char;
      Advanced@1000003 : Boolean;
      FirstCharacter@1000004 : Boolean;
      Stop@1000002 : Boolean;
    BEGIN
      ExitValue := '';
      FirstCharacter := TRUE;

      IF Position > STRLEN(TextLine) THEN
        EXIT(FALSE);

      WHILE NOT Stop DO

        IF NextChar(TextLine, Position, Char) THEN BEGIN

          CASE Char OF

            ' ', ';', '}' :
              IF Advanced THEN
                ExitValue += FORMAT(Char)
              ELSE
                Stop := TRUE;

            '"' :
              IF FirstCharacter THEN
                Advanced := TRUE
              ELSE
                IF Advanced THEN BEGIN
                  IF NextChar(TextLine, Position, Char) THEN
                    IF Char = '"' THEN
                      ExitValue += FORMAT(Char)
                    ELSE BEGIN
                      Advanced := FALSE;
                      Position -= 1;
                    END;
                END ELSE
                  ExitValue += FORMAT(Char);

            ELSE
              ExitValue += FORMAT(Char);
          END;

          FirstCharacter := FALSE;

        END ELSE
          Stop := TRUE;

      ExitValue := DELCHR(ExitValue, '<>', ' ');
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE GetNextFilter@1000017(VAR Expression@1000000 : Text[1024];VAR Position@1000003 : Integer;VAR First@1000001 : Text[1024];VAR Compare@1000002 : Text[1024];VAR Next@1000004 : Text[1024]);
    BEGIN
      NextValue(Expression, Position, '=', '"', '"', First);
      NextValue(Expression, Position, '(', ')', ')', Compare);
      NextValue(Expression, Position, ')', '"', '"', Next);

      IF COPYSTR(Next, 1, 7) = 'FILTER(' THEN BEGIN
        Next := COPYSTR(Next, 8);
        Position += 1;
      END;

      IF COPYSTR(Next, 1, 11) = 'UPPERLIMIT(' THEN BEGIN
        Next := COPYSTR(Next, 12);
        Position += 1;
      END;
    END;

    LOCAL PROCEDURE CreateFilter@1100512000(sFilter@1100512000 : Text[1024];RemoveQuotes@1100512001 : Boolean) : Text[1024];
    VAR
      i@1100512002 : Integer;
    BEGIN
      IF STRPOS(sFilter, '''') > 0 THEN BEGIN
        i := 1;
        WHILE i <= STRLEN(sFilter) DO
          IF sFilter[i] = '''' THEN BEGIN
            sFilter := COPYSTR(sFilter, 1, i) + COPYSTR(sFilter, i);
            i += 2;
          END ELSE
            i += 1;
      END;

      IF RemoveQuotes THEN
        EXIT('''@' + DELCHR(sFilter, '<>', '"') + '''')
      ELSE
        EXIT('''@' + sFilter + '''');
    END;

    PROCEDURE ExportFile@1100543000(Object@1100543000 : Record 2000000001;Filename@1100543001 : Text[1024]) : Boolean;
    BEGIN
      CSideManager.Create(FALSE, FALSE);

      IF NOT ISSERVICETIER THEN BEGIN
        IF CSideManager.GetClient(GetDatabaseName) THEN
          EXIT(CSideManager.ExportObjectToFile(Filename, Object.Type, Object.ID));
      END ELSE BEGIN
        ERROR(Text003);
      END;

      EXIT(FALSE);
    END;

    LOCAL PROCEDURE GetDatabaseName@1100512001() Result : Text[250];
    BEGIN
      // CI-221
      IF NOT GetSQLDatabaseName(Result) THEN
        GetNativeDatabaseName(Result);
    END;

    LOCAL PROCEDURE GetNativeDatabaseName@1(VAR DatabaseName@1000 : Text[250]) Success : Boolean;
    VAR
      AllObj@1001 : Record 2000000038;
      RecRef@1002 : RecordRef;
      FldRef@1003 : FieldRef;
    BEGIN
      // jhoek.20140404
      IF AllObj.GET(AllObj."Object Type"::Table, NativeDatabaseTableID) THEN BEGIN
        RecRef.OPEN(NativeDatabaseTableID);
        RecRef.FINDFIRST;
        FldRef := RecRef.FIELD(NativeFileNameFieldNo);
        DatabaseName := FORMAT(FldRef.VALUE);
        RecRef.CLOSE;
        EXIT(TRUE);
      END;
    END;

    LOCAL PROCEDURE NativeDatabaseTableID@4() : Integer;
    BEGIN
      // jhoek.20140404
      EXIT(2000000010);
    END;

    LOCAL PROCEDURE NativeFileNameFieldNo@6() : Integer;
    BEGIN
      // jhoek.20140404
      EXIT(2);
    END;

    LOCAL PROCEDURE GetSQLDatabaseName@2(VAR DatabaseName@1000 : Text[250]) : Boolean;
    VAR
      AllObj@1001 : Record 2000000038;
      RecRef@1002 : RecordRef;
      FldRef@1003 : FieldRef;
    BEGIN
      // jhoek.20140404
      IF AllObj.GET(AllObj."Object Type"::Table, SQLDatabaseTableID) THEN BEGIN
        RecRef.OPEN(SQLDatabaseTableID);
        FldRef := RecRef.FIELD(SQLMyDatabaseFieldNo);
        FldRef.SETRANGE(TRUE);
        RecRef.FINDFIRST;
        FldRef := RecRef.FIELD(SQLDatabaseNameFieldNo);
        DatabaseName := FORMAT(FldRef.VALUE);
        RecRef.CLOSE;
        EXIT(TRUE);
      END;
    END;

    LOCAL PROCEDURE SQLDatabaseTableID@5() : Integer;
    BEGIN
      // jhoek.20140404
      EXIT(2000000048);
    END;

    LOCAL PROCEDURE SQLMyDatabaseFieldNo@9() : Integer;
    BEGIN
      // jhoek.20140404
      EXIT(5);
    END;

    LOCAL PROCEDURE SQLDatabaseNameFieldNo@10() : Integer;
    BEGIN
      // jhoek.2014040
      EXIT(1);
    END;

    PROCEDURE IsLicensed@1000000000(VAR Object@1000000000 : Record 2000000001) Result : Boolean;
    VAR
      LicPermission@1000000001 : Record 2000000043;
    BEGIN
      LicPermission.SETRANGE("Object Type", Object.Type);
      LicPermission.SETRANGE("Object Number", Object.ID);
      LicPermission.SETRANGE("Read Permission", LicPermission."Read Permission"::Yes, LicPermission."Read Permission"::Indirect);
      LicPermission.SETRANGE("Modify Permission", LicPermission."Read Permission"::Yes, LicPermission."Read Permission"::Indirect);
      Result := NOT LicPermission.ISEMPTY;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148642 IN - Trace Management
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    OnRun=BEGIN
            ApplyTaskHandlerRules;
          END;

  }
  CODE
  {

    PROCEDURE AddTrace@1100531000(Type@1100531000 : Option;Code@1100531001 : Code[20];Error@1100531002 : Boolean;ErrorMessage@1100531003 : Text[250];NoOfRecordsProcessed@1100531004 : Integer);
    VAR
      ConnectITSetup@1100531006 : Record 11148589;
      TraceEntry@1100531005 : Record 11148630;
    BEGIN
      ConnectITSetup.GET;
      IF ConnectITSetup."Save Trace Entries" THEN BEGIN
        TraceEntry.Date := TODAY;
        TraceEntry.Time := SYSTEM.TIME;
        TraceEntry.DateTime := CURRENTDATETIME;
        TraceEntry."User Id" := USERID;
        TraceEntry.Type := Type;
        TraceEntry.Code := Code;
        TraceEntry.Error := Error;
        TraceEntry."Error Message" := ErrorMessage;
        TraceEntry."No. of Records Processed" := NoOfRecordsProcessed;
        TraceEntry.INSERT(TRUE);

        ApplyRulesToTraceEntry(TraceEntry);
      END;
    END;

    PROCEDURE ApplyRulesToTraceEntry@1100531001(VAR TraceEntry@1100531000 : Record 11148630);
    VAR
      TraceRule@1100531001 : Record 11148628;
      Mgt@1100531002 : Codeunit 11148589;
      RecRef@1100531003 : RecordRef;
    BEGIN
      RecRef.GETTABLE(TraceEntry);

      TraceRule.SETCURRENTKEY("Apply Method");
      TraceRule.SETRANGE("Apply Method", TraceRule."Apply Method"::"In proces");
      TraceRule.SETRANGE("Rule Type", TraceRule."Rule Type"::"Existing Trace");
      IF TraceRule.FINDSET THEN
        REPEAT

          IF FORMAT(TraceRule."Table Filter") <> '' THEN BEGIN

            RecRef.RESET;
            Mgt.SetFilterOnRecordRef(RecRef, FORMAT(TraceRule."Table Filter"));
            IF RecRef.FIND('=') THEN
              AddTraceMessage(TraceRule, TraceEntry."Entry No.");
            RecRef.RESET;

          END;
        UNTIL TraceRule.NEXT = 0;

      RecRef.CLOSE;
    END;

    LOCAL PROCEDURE AddTraceMessage@1100531008(VAR TraceRule@1100531000 : Record 11148628;TraceEntryNo@1100531001 : Integer);
    VAR
      TraceMessage@1100531002 : Record 11148629;
    BEGIN
      TraceMessage."Trace Rule" := TraceRule.Code;
      TraceMessage.Date := TODAY;
      TraceMessage.Time := TIME;
      TraceMessage.DateTime := CURRENTDATETIME;
      TraceMessage."User Id" := USERID;
      TraceMessage."Trace Entry No." := TraceEntryNo;
      IF TraceRule."Send E-Mail" THEN
        TraceMessage."E-Mail Status" := TraceMessage."E-Mail Status"::Pending;
      TraceMessage.INSERT;
    END;

    LOCAL PROCEDURE ApplyTaskHandlerRules@1100531004();
    VAR
      TraceRule@1100531000 : Record 11148628;
      TraceEntry@1100531001 : Record 11148630;
    BEGIN
      TraceEntry.LOCKTABLE;
      TraceEntry.FINDSET;

      TraceRule.SETCURRENTKEY("Apply Method");
      TraceRule.SETRANGE("Apply Method", TraceRule."Apply Method"::"By Task Handler");
      IF TraceRule.FINDSET THEN
        REPEAT
          ApplyTaskHandlerRule(TraceRule);
        UNTIL TraceRule.NEXT = 0;

      TraceEntry.SETCURRENTKEY(Status);
      TraceEntry.SETRANGE(Status, TraceEntry.Status::" ");
      TraceEntry.MODIFYALL(Status, TraceEntry.Status::"Rules Applied");
    END;

    PROCEDURE ApplyTaskHandlerRule@1100531003(VAR TraceRule@1100531000 : Record 11148628);
    VAR
      TraceMessage@1100531005 : Record 11148629;
      TraceEntry@1100531001 : Record 11148630;
      Mgt@1100531003 : Codeunit 11148589;
      RecRef@1100531002 : RecordRef;
      CheckForMissingEntry@1100531004 : Boolean;
    BEGIN
      IF FORMAT(TraceRule."Table Filter") <> '' THEN BEGIN
        RecRef.OPEN(DATABASE::"IN - Trace Entry");
        Mgt.SetFilterOnRecordRef(RecRef, FORMAT(TraceRule."Table Filter"));
        TraceEntry.SETVIEW(RecRef.GETVIEW);
        RecRef.CLOSE;
      END;
      TraceEntry.SETCURRENTKEY(Status, DateTime, Type, Code);

      CASE TraceRule."Rule Type" OF
        TraceRule."Rule Type"::"Existing Trace" :
          BEGIN
            TraceEntry.SETRANGE(Status, TraceEntry.Status::" ");
            IF TraceEntry.FINDSET THEN
              REPEAT
                AddTraceMessage(TraceRule, TraceEntry."Entry No.");
              UNTIL TraceEntry.NEXT = 0;
          END;

        TraceRule."Rule Type"::"Missing Trace" :
          BEGIN
            IF TraceRule."Message Interval (minutes)" = 0 THEN
              CheckForMissingEntry := TRUE
            ELSE BEGIN
              TraceMessage.SETCURRENTKEY("Trace Rule", DateTime);
              TraceMessage.SETRANGE("Trace Rule", TraceRule.Code);
              TraceMessage.SETFILTER(DateTime, '>%1', CURRENTDATETIME - (1000 * 60 * TraceRule."Message Interval (minutes)"));
              CheckForMissingEntry := TraceMessage.ISEMPTY;
            END;
            IF CheckForMissingEntry THEN BEGIN
              TraceEntry.SETFILTER(DateTime, '>%1', CURRENTDATETIME - (1000 * 60 * TraceRule."Measure Period (minutes)"));
              IF TraceEntry.ISEMPTY THEN
                AddTraceMessage(TraceRule, 0);
            END;
          END;

      END;
    END;

    PROCEDURE SendMails@1100531002(VAR TraceRule@1100531000 : Record 11148628);
    VAR
      Mgt@1100531005 : Codeunit 11148589;
      TraceMessage@1100531001 : Record 11148629;
      TraceMessage2@1100531002 : Record 11148629;
      NoOfMessages@1100531003 : Integer;
      ctSubject@1100531004 : TextConst 'ENU=ConnectIT - Trace Message - %1: %2 new messages;NLD=ConnectIT - Import Definition Error - %1: %2';
    BEGIN
      TraceMessage.SETCURRENTKEY("Trace Rule", "E-Mail Status");
      TraceMessage.SETRANGE("Trace Rule", TraceRule.Code);
      TraceMessage.SETRANGE("E-Mail Status", TraceMessage."E-Mail Status"::Pending);
      IF TraceMessage.FINDSET THEN BEGIN
        TraceRule.TESTFIELD("E-Mail Address");
        REPEAT
          TraceMessage2 := TraceMessage;
          TraceMessage2."E-Mail Status" := TraceMessage2."E-Mail Status"::Send;
          TraceMessage2.MODIFY;
          NoOfMessages += 1;
        UNTIL TraceMessage.NEXT = 0;

        Mgt.SendEmail(
          TraceRule."E-Mail Address",
          STRSUBSTNO(ctSubject, TraceRule.Code, NoOfMessages), STRSUBSTNO(ctSubject, TraceRule.Code, NoOfMessages), '');

      END;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148644 IN - Version Management
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE ImportAddNewVersion@1100531000(VAR ImportDefinition@1100531000 : Record 11148591);
    VAR
      ImportDefinitionVersion@1100531004 : Record 11148631;
      NewVersionNo@1100531001 : Integer;
    BEGIN
      WITH ImportDefinition DO BEGIN

        ImportDefinitionVersion.SETRANGE(Code, Code);
        IF ImportDefinitionVersion.FINDLAST THEN
          NewVersionNo := ImportDefinitionVersion."Version No." + 1
        ELSE
          NewVersionNo := 1;

        ImportDefinitionVersion.TRANSFERFIELDS(ImportDefinition);
        ImportDefinitionVersion."Version No." := NewVersionNo;
        ImportDefinitionVersion."Version Date" := TODAY;
        ImportDefinitionVersion."Version Time" := TIME;
        ImportDefinitionVersion.INSERT;

        ImportCopyToVersionNo(ImportDefinition, NewVersionNo);

      END;
    END;

    LOCAL PROCEDURE ImportCopyToVersionNo@1100531004(VAR ImportDefinition@1100531000 : Record 11148591;NewVersionNo@1100531007 : Integer);
    VAR
      ImportDefinitionLine@1100531001 : Record 11148592;
      ImportDefTableLink@1100531002 : Record 11148593;
      ImportDefinitionVersion@1100531004 : Record 11148631;
      ImportDefVersionLine@1100531003 : Record 11148632;
      ImportDefVersTLink@1100531005 : Record 11148633;
    BEGIN
      WITH ImportDefinition DO BEGIN

        ImportDefinitionLine.SETRANGE("Import Definition", Code);
        IF ImportDefinitionLine.FINDSET THEN
          REPEAT
            ImportDefVersionLine.TRANSFERFIELDS(ImportDefinitionLine);
            ImportDefVersionLine."Version No." := NewVersionNo;
            ImportDefVersionLine.INSERT;
          UNTIL ImportDefinitionLine.NEXT = 0;

        ImportDefTableLink.SETRANGE("Import Definition", Code);
        IF ImportDefTableLink.FINDSET THEN
          REPEAT
            ImportDefVersTLink.TRANSFERFIELDS(ImportDefTableLink);
            ImportDefVersTLink."Version No." := NewVersionNo;
            ImportDefVersTLink.INSERT;
          UNTIL ImportDefTableLink.NEXT = 0;

      END;
    END;

    PROCEDURE ImportUpdateExistingVersion@1100531001(VAR ImportDefinition@1100531000 : Record 11148591;VersionNo@1100531001 : Integer);
    VAR
      ImportDefVersionLine@1100531003 : Record 11148632;
      ImportDefVersTLink@1100531002 : Record 11148633;
    BEGIN
      WITH ImportDefinition DO BEGIN
        ImportDefVersionLine.SETRANGE("Import Definition", Code);
        ImportDefVersionLine.SETRANGE("Version No.", VersionNo);
        ImportDefVersionLine.DELETEALL;

        ImportDefVersTLink.SETRANGE("Import Definition", Code);
        ImportDefVersTLink.SETRANGE("Version No.", VersionNo);
        ImportDefVersTLink.DELETEALL;

        ImportCopyToVersionNo(ImportDefinition, VersionNo);

      END;
    END;

    PROCEDURE ImportRestoreVersion@1100531002(VAR ImportDefinitionVersion@1100531000 : Record 11148631);
    VAR
      ImportDefinition@1100531001 : Record 11148591;
      ImportDefinitionLine@1100531006 : Record 11148592;
      ImportDefTableLink@1100531005 : Record 11148593;
      ImportDefVersionLine@1100531003 : Record 11148632;
      ImportDefVersTLink@1100531002 : Record 11148633;
    BEGIN
      WITH ImportDefinitionVersion DO BEGIN
        ImportDefinition.TRANSFERFIELDS(ImportDefinitionVersion);
        ImportDefinition.MODIFY;

        ImportDefinitionLine.SETRANGE("Import Definition", Code);
        ImportDefinitionLine.DELETEALL;

        ImportDefTableLink.SETRANGE("Import Definition", Code);
        ImportDefTableLink.DELETEALL;

        ImportDefVersionLine.SETRANGE("Import Definition", Code);
        ImportDefVersionLine.SETRANGE("Version No.", "Version No.");
        IF ImportDefVersionLine.FINDSET THEN
          REPEAT
            ImportDefinitionLine.TRANSFERFIELDS(ImportDefVersionLine);
            ImportDefinitionLine.INSERT;
          UNTIL ImportDefVersionLine.NEXT = 0;

        ImportDefVersTLink.SETRANGE("Import Definition", Code);
        ImportDefVersTLink.SETRANGE("Version No.", "Version No.");
        IF ImportDefVersTLink.FINDSET THEN
          REPEAT
            ImportDefTableLink.TRANSFERFIELDS(ImportDefVersTLink);
            ImportDefTableLink.INSERT;
          UNTIL ImportDefVersTLink.NEXT = 0;

      END;
    END;

    PROCEDURE ExportAddNewVersion@1100531007(VAR ExportDefinition@1100531000 : Record 11148599);
    VAR
      ExportDefinitionVersion@1100531004 : Record 11148634;
      NewVersionNo@1100531001 : Integer;
    BEGIN
      WITH ExportDefinition DO BEGIN

        ExportDefinitionVersion.SETRANGE(Code, Code);
        IF ExportDefinitionVersion.FINDLAST THEN
          NewVersionNo := ExportDefinitionVersion."Version No." + 1
        ELSE
          NewVersionNo := 1;

        ExportDefinitionVersion.TRANSFERFIELDS(ExportDefinition);
        ExportDefinitionVersion."Version No." := NewVersionNo;
        ExportDefinitionVersion."Version Date" := TODAY;
        ExportDefinitionVersion."Version Time" := TIME;
        ExportDefinitionVersion.INSERT;

        ExportCopyToVersionNo(ExportDefinition, NewVersionNo);

      END;
    END;

    LOCAL PROCEDURE ExportCopyToVersionNo@1100531006(VAR ExportDefinition@1100531000 : Record 11148599;NewVersionNo@1100531007 : Integer);
    VAR
      ExportDefinitionLine@1100531001 : Record 11148600;
      ExportDefTableLink@1100531002 : Record 11148601;
      ExportDefinitionVersion@1100531004 : Record 11148634;
      ExportDefVersionLine@1100531003 : Record 11148635;
      ExportDefVersTLink@1100531005 : Record 11148636;
    BEGIN
      WITH ExportDefinition DO BEGIN

        ExportDefinitionLine.SETRANGE("Export Definition", Code);
        IF ExportDefinitionLine.FINDSET THEN
          REPEAT
            ExportDefVersionLine.TRANSFERFIELDS(ExportDefinitionLine);
            ExportDefVersionLine."Version No." := NewVersionNo;
            ExportDefVersionLine.INSERT;
          UNTIL ExportDefinitionLine.NEXT = 0;

        ExportDefTableLink.SETRANGE("Export Definition", Code);
        IF ExportDefTableLink.FINDSET THEN
          REPEAT
            ExportDefVersTLink.TRANSFERFIELDS(ExportDefTableLink);
            ExportDefVersTLink."Version No." := NewVersionNo;
            ExportDefVersTLink.INSERT;
          UNTIL ExportDefTableLink.NEXT = 0;

      END;
    END;

    PROCEDURE ExportUpdateExistingVersion@1100531005(VAR ExportDefinition@1100531000 : Record 11148599;VersionNo@1100531001 : Integer);
    VAR
      ExportDefVersionLine@1100531003 : Record 11148635;
      ExportDefVersTLink@1100531002 : Record 11148636;
    BEGIN
      WITH ExportDefinition DO BEGIN
        ExportDefVersionLine.SETRANGE("Export Definition", Code);
        ExportDefVersionLine.SETRANGE("Version No.", VersionNo);
        ExportDefVersionLine.DELETEALL;

        ExportDefVersTLink.SETRANGE("Export Definition", Code);
        ExportDefVersTLink.SETRANGE("Version No.", VersionNo);
        ExportDefVersTLink.DELETEALL;

        ExportCopyToVersionNo(ExportDefinition, VersionNo);

      END;
    END;

    PROCEDURE ExportRestoreVersion@1100531003(VAR ExportDefinitionVersion@1100531000 : Record 11148634);
    VAR
      ExportDefinition@1100531001 : Record 11148599;
      ExportDefinitionLine@1100531006 : Record 11148600;
      ExportDefTableLink@1100531005 : Record 11148601;
      ExportDefVersionLine@1100531003 : Record 11148635;
      ExportDefVersTLink@1100531002 : Record 11148636;
    BEGIN
      WITH ExportDefinitionVersion DO BEGIN
        ExportDefinition.TRANSFERFIELDS(ExportDefinitionVersion);
        ExportDefinition.MODIFY;

        ExportDefinitionLine.SETRANGE("Export Definition", Code);
        ExportDefinitionLine.DELETEALL;

        ExportDefTableLink.SETRANGE("Export Definition", Code);
        ExportDefTableLink.DELETEALL;

        ExportDefVersionLine.SETRANGE("Export Definition", Code);
        ExportDefVersionLine.SETRANGE("Version No.", "Version No.");
        IF ExportDefVersionLine.FINDSET THEN
          REPEAT
            ExportDefinitionLine.TRANSFERFIELDS(ExportDefVersionLine);
            ExportDefinitionLine.INSERT;
          UNTIL ExportDefVersionLine.NEXT = 0;

        ExportDefVersTLink.SETRANGE("Export Definition", Code);
        ExportDefVersTLink.SETRANGE("Version No.", "Version No.");
        IF ExportDefVersTLink.FINDSET THEN
          REPEAT
            ExportDefTableLink.TRANSFERFIELDS(ExportDefVersTLink);
            ExportDefTableLink.INSERT;
          UNTIL ExportDefVersTLink.NEXT = 0;

      END;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148645 IN - Data Change Management
{
  OBJECT-PROPERTIES
  {
    Date=24-05-13;
    Time=13:00:00;
    Version List=IDYN-CE5.50.0;
  }
  PROPERTIES
  {
    SingleInstance=Yes;
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      Monitoring@1000000004 : Codeunit 11148620;
      TempDataChangeSetupTable@1000000003 : TEMPORARY Record 11148639;
      DataChangeSetupTable@1000000002 : Record 11148639;
      DataChangeSetup@1000000000 : Record 11148638;
      DataChangeSetupRead@1000000001 : Boolean;
      DataChangeTemp@1000000005 : TEMPORARY Record 11148644;
      UsesIntegrationManagement@1000000006 : ' ,No,Yes';

    PROCEDURE GetDatabaseTableTriggerSetup@1000000000(TableId@1000000004 : Integer;VAR Insert@1000000003 : Boolean;VAR Modify@1000000002 : Boolean;VAR Delete@1000000001 : Boolean;VAR Rename@1000000000 : Boolean);
    BEGIN
      IF COMPANYNAME = '' THEN
        EXIT;

      IF TableId IN
         [DATABASE::"Change Log Setup",
          DATABASE::"Change Log Setup (Table)",
          DATABASE::"Change Log Setup (Field)",
          DATABASE::"Change Log Entry",
          DATABASE::"IN - Data Change Setup",
          DATABASE::"IN - Data Change Setup (Table)",
          DATABASE::"IN - Data Change Setup (Field)",
          DATABASE::Object..DATABASE::Table2100000000]
      THEN
        EXIT;

      IF NOT DataChangeSetupRead THEN BEGIN
        IF DataChangeSetup.GET THEN;
        DataChangeSetupRead := TRUE;
      END;

      IF NOT DataChangeSetup."Data Change Activated" THEN
        EXIT;

      IF NOT TempDataChangeSetupTable.GET(TableId) THEN BEGIN
        IF NOT DataChangeSetupTable.GET(TableId) THEN BEGIN
          TempDataChangeSetupTable.INIT;
          TempDataChangeSetupTable."Table No." := TableId;
        END ELSE
          TempDataChangeSetupTable := DataChangeSetupTable;
        TempDataChangeSetupTable.INSERT;
      END;

      Insert := Insert OR (TempDataChangeSetupTable."Log Insertion" <> TempDataChangeSetupTable."Log Insertion"::" ");
      Modify := Modify OR (TempDataChangeSetupTable."Log Modification" <> TempDataChangeSetupTable."Log Modification"::" ");
      Rename := Rename OR (TempDataChangeSetupTable."Log Modification" <> TempDataChangeSetupTable."Log Modification"::" ");
      Delete := Delete OR (TempDataChangeSetupTable."Log Deletion" <> TempDataChangeSetupTable."Log Deletion"::" ");
    END;

    PROCEDURE OnInsertRecord@1000000001(VAR RecRef@1000000000 : RecordRef);
    BEGIN
      IF ShouldTriggerInsert(RecRef) THEN
        Monitoring.InsertRecord(RecRef);
    END;

    PROCEDURE OnModifyRecord@1000000002(VAR RecRef@1000000000 : RecordRef;VAR xRecRef@1000000001 : RecordRef);
    BEGIN
      IF ShouldTriggerModify(RecRef, xRecRef) THEN
        Monitoring.ModifyRecord(RecRef, xRecRef);
    END;

    PROCEDURE OnDeleteRecord@1000000003(VAR RecRef@1000000000 : RecordRef);
    BEGIN
      IF ShouldTriggerDelete(RecRef) THEN
        Monitoring.DeleteRecord(RecRef);
    END;

    PROCEDURE OnRenameRecord@1000000004(VAR RecRef@1000000001 : RecordRef;VAR xRecRef@1000000000 : RecordRef);
    BEGIN
      IF ShouldTriggerModify(RecRef, xRecRef) THEN
        Monitoring.RenameRecord(RecRef, xRecRef);
    END;

    LOCAL PROCEDURE ShouldTriggerInsert@1000000005(VAR RecRef@1000000000 : RecordRef) Result : Boolean;
    VAR
      xRecRef@1000000002 : RecordRef;
    BEGIN
      IF NOT TempDataChangeSetupTable.GET(RecRef.NUMBER) THEN
        EXIT(FALSE);

      xRecRef.OPEN(RecRef.NUMBER);
      Result := ShouldTrigger(RecRef, xRecRef, TempDataChangeSetupTable."Log Insertion", 0);
    END;

    LOCAL PROCEDURE ShouldTriggerDelete@1000000006(VAR RecRef@1000000000 : RecordRef) Result : Boolean;
    VAR
      xRecRef@1000000001 : RecordRef;
    BEGIN
      IF NOT TempDataChangeSetupTable.GET(RecRef.NUMBER) THEN
        EXIT(FALSE);

      xRecRef.OPEN(RecRef.NUMBER);
      Result := ShouldTrigger(RecRef, xRecRef, TempDataChangeSetupTable."Log Deletion", 2);
    END;

    LOCAL PROCEDURE ShouldTriggerModify@1000000007(VAR RecRef@1000000000 : RecordRef;VAR xRecRef@1000000001 : RecordRef) Result : Boolean;
    BEGIN
      IF NOT TempDataChangeSetupTable.GET(RecRef.NUMBER) THEN
        EXIT(FALSE);

      Result := ShouldTrigger(RecRef, xRecRef, TempDataChangeSetupTable."Log Modification", 1);
    END;

    LOCAL PROCEDURE ShouldTrigger@1000000008(VAR RecRef@1000000000 : RecordRef;VAR xRecRef@1000000001 : RecordRef;FieldSelection@1000000003 : ' ,Some Fields,All Fields';Trigger@1000000004 : 'Insert,Modify,Delete') Result : Boolean;
    VAR
      DataChangeSetupField@1000000002 : Record 11148640;
      FldRef@1000000005 : FieldRef;
      xFldRef@1000000006 : FieldRef;
    BEGIN
      CASE FieldSelection OF
        FieldSelection::" " : EXIT(FALSE);
        FieldSelection::"All Fields" : EXIT(TRUE);
        FieldSelection::"Some Fields" :
            BEGIN
              DataChangeSetupField.SETRANGE("Table No.", RecRef.NUMBER);
              CASE Trigger OF
                Trigger::Insert : DataChangeSetupField.SETRANGE("Log Insertion", TRUE);
                Trigger::Modify : DataChangeSetupField.SETRANGE("Log Modification", TRUE);
                Trigger::Delete : DataChangeSetupField.SETRANGE("Log Deletion", TRUE);
              END;
              IF DataChangeSetupField.FINDSET THEN
                REPEAT
                  FldRef := RecRef.FIELD(DataChangeSetupField."Field No.");
                  xFldRef := xRecRef.FIELD(DataChangeSetupField."Field No.");
                  IF (FORMAT(FldRef.VALUE) <> FORMAT(xFldRef.VALUE)) THEN
                    EXIT(TRUE);
                UNTIL DataChangeSetupField.NEXT = 0;
            END;
      END;
      EXIT(FALSE);
    END;

    PROCEDURE SetRecRefInChange@1000000009(VAR RecRef@1000000000 : RecordRef) : Boolean;
    BEGIN
      DataChangeTemp.RecId := RecRef.RECORDID;
      EXIT(DataChangeTemp.INSERT);
    END;

    PROCEDURE DeleteRecRefInChange@1000000010(VAR RecRef@1000000000 : RecordRef);
    BEGIN
      DataChangeTemp.SETRANGE(RecId, RecRef.RECORDID);
      IF DataChangeTemp.FINDFIRST THEN
        DataChangeTemp.DELETE;
    END;

    PROCEDURE SupportsIntegrationManagement@1000000011() : Boolean;
    VAR
      Object@1000000000 : Record 2000000001;
    BEGIN
      IF UsesIntegrationManagement = UsesIntegrationManagement::" " THEN BEGIN
        IF Object.GET(Object.Type::Codeunit, '', CODEUNIT::"Integration Management") THEN
          UsesIntegrationManagement := UsesIntegrationManagement::Yes
        ELSE
          UsesIntegrationManagement := UsesIntegrationManagement::No;
      END;

      EXIT(UsesIntegrationManagement = UsesIntegrationManagement::Yes);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148646 IN - Def. Copy Management
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    TableNo=11148643;
    OnRun=VAR
            Rules@1000000000 : Record 11148643;
          BEGIN
            Rules.COPY(Rec);
            IF Rules.FINDSET THEN
              REPEAT
                IF Rules."Copy Definition" THEN
                  CopyDefinition(Rules);
              UNTIL Rules.NEXT = 0;

            MESSAGE(Text003, "Definition Code", CopyCount);
          END;

  }
  CODE
  {
    VAR
      Text001@1000000000 : TextConst 'ENU=Are you sure you want to overwrite import definition %1 in company %2?;NLD=Weet u zeker dat u import definitie %1 in bedrijf %2 wilt overschrijven?';
      Text002@1000000001 : TextConst 'ENU=Are you sure you want to overwrite export definition %1 in company %2?;NLD=Weet u zeker dat u export definitie %1 in bedrijf %2 wilt overschrijven?';
      CopyCount@1000000002 : Integer;
      Text003@1000000003 : TextConst 'ENU=The definition %1 was copied to %2 companies.;NLD=De definitie %1 is naar %2 bedrijven gekopieerd.';
      Text004@1000000005 : TextConst 'ENU=Are you sure you want to overwrite task %1 in company %2?;NLD=Weet u zeker dat u taak %1 in bedrijf %2 wilt overschrijven?';
      Text005@1000000004 : TextConst 'ENU=Currently, the copy projects feature is not implemented.;NLD=Het kopieren van projects is op dit moment niet geimplementeerd.';

    LOCAL PROCEDURE CopyDefinition@1000000000(VAR Rules@1000000000 : Record 11148643);
    BEGIN
      CASE Rules."Definition Type" OF
        Rules."Definition Type"::Import : CopyImport(Rules);
        Rules."Definition Type"::Export : CopyExport(Rules);
        Rules."Definition Type"::Task   : CopyTask(Rules);
        Rules."Definition Type"::Project: CopyProject(Rules);
      END;
    END;

    LOCAL PROCEDURE CopyImport@1000000002(VAR Rules@1000000000 : Record 11148643);
    VAR
      ImportDef@1000000001 : Record 11148591;
      ImportDefLine@1000000002 : Record 11148592;
      ImportDefTableLink@1000000003 : Record 11148593;
      ImportDefFunction@1000000004 : Record 11148594;
      ImportRestriction@1000000005 : Record 11148596;
      ImportRestrictionValue@1000000006 : Record 11148597;
      ImportRestrictionVarFilter@1000000007 : Record 11148598;
      ImportDef2@1000000014 : Record 11148591;
      ImportDefLine2@1000000013 : Record 11148592;
      ImportDefTableLink2@1000000012 : Record 11148593;
      ImportDefFunction2@1000000011 : Record 11148594;
      ImportRestriction2@1000000010 : Record 11148596;
      ImportRestrictionValue2@1000000009 : Record 11148597;
      ImportRestrictionVarFilter2@1000000008 : Record 11148598;
    BEGIN
      ImportDef2.CHANGECOMPANY(Rules."Company Name");
      ImportDef2.SETRANGE(Code, Rules."Definition Code");
      IF NOT Rules."Overwrite Definition" THEN
        IF ImportDef2.FINDFIRST THEN
          IF NOT CONFIRM(Text001, FALSE, Rules."Definition Code", Rules."Company Name") THEN
            EXIT;

      ImportDef2.CHANGECOMPANY(Rules."Company Name");
      ImportDef2.SETRANGE(Code, Rules."Definition Code");
      ImportDef2.DELETEALL;

      ImportDefLine2.CHANGECOMPANY(Rules."Company Name");
      ImportDefLine2.SETRANGE("Import Definition", Rules."Definition Code");
      ImportDefLine2.DELETEALL;

      ImportDefTableLink2.CHANGECOMPANY(Rules."Company Name");
      ImportDefTableLink2.SETRANGE("Import Definition", Rules."Definition Code");
      ImportDefTableLink2.DELETEALL;

      ImportDefFunction2.CHANGECOMPANY(Rules."Company Name");
      ImportDefFunction2.SETRANGE("Import Definition", Rules."Definition Code");
      ImportDefFunction2.DELETEALL;

      ImportRestriction2.CHANGECOMPANY(Rules."Company Name");
      ImportRestriction2.SETRANGE("Import Definition", Rules."Definition Code");
      ImportRestriction2.DELETEALL;

      ImportRestrictionValue2.CHANGECOMPANY(Rules."Company Name");
      ImportRestrictionValue2.SETRANGE("Import Definition", Rules."Definition Code");
      ImportRestrictionValue2.DELETEALL;

      ImportRestrictionVarFilter2.CHANGECOMPANY(Rules."Company Name");
      ImportRestrictionVarFilter2.SETRANGE("Import Definition", Rules."Definition Code");
      ImportRestrictionVarFilter2.DELETEALL;

      ImportDef.SETRANGE(Code, Rules."Definition Code");
      IF ImportDef.FINDSET THEN
        REPEAT
          ImportDef2 := ImportDef;
          ImportDef2.INSERT;
        UNTIL ImportDef.NEXT = 0;

      ImportDefLine.SETRANGE("Import Definition", Rules."Definition Code");
      IF ImportDefLine.FINDSET THEN
        REPEAT
          ImportDefLine2 := ImportDefLine;
          ImportDefLine2.INSERT;

          CopyConversion(ImportDefLine."Conversion Code", Rules."Company Name");
          CopyVariable(ImportDefLine."Dest. Variable", Rules."Company Name");
          IF ImportDefLine.Type = ImportDefLine.Type::Variable THEN
            CopyVariable(ImportDefLine.Code, Rules."Company Name");

        UNTIL ImportDefLine.NEXT = 0;

      ImportDefTableLink.SETRANGE("Import Definition", Rules."Definition Code");
      IF ImportDefTableLink.FINDSET THEN
        REPEAT
          ImportDefTableLink2 := ImportDefTableLink;
          ImportDefTableLink2.INSERT;
        UNTIL ImportDefTableLink.NEXT = 0;

      ImportDefFunction.SETRANGE("Import Definition", Rules."Definition Code");
      IF ImportDefFunction.FINDSET THEN
        REPEAT
          ImportDefFunction2 := ImportDefFunction;
          ImportDefFunction2.INSERT;
          CopyFunction(ImportDefFunction.Code, Rules."Company Name");
        UNTIL ImportDefFunction.NEXT = 0;

      ImportRestriction.SETRANGE("Import Definition", Rules."Definition Code");
      IF ImportRestriction.FINDSET THEN
        REPEAT
          ImportRestriction2 := ImportRestriction;
          ImportRestriction2.INSERT;
        UNTIL ImportRestriction.NEXT = 0;

      ImportRestrictionValue.SETRANGE("Import Definition", Rules."Definition Code");
      IF ImportRestrictionValue.FINDSET THEN
        REPEAT
          ImportRestrictionValue2 := ImportRestrictionValue;
          ImportRestrictionValue2.INSERT;
        UNTIL ImportRestrictionValue.NEXT = 0;

      ImportRestrictionVarFilter.SETRANGE("Import Definition", Rules."Definition Code");
      IF ImportRestrictionVarFilter.FINDSET THEN
        REPEAT
          ImportRestrictionVarFilter2 := ImportRestrictionVarFilter;
          ImportRestrictionVarFilter2.INSERT;
        UNTIL ImportRestrictionVarFilter.NEXT = 0;

      CopyCount += 1;
    END;

    LOCAL PROCEDURE CopyExport@1000000001(VAR Rules@1000000000 : Record 11148643);
    VAR
      ExportDef@1000000008 : Record 11148599;
      ExportDefLine@1000000007 : Record 11148600;
      ExportDefTableLink@1000000006 : Record 11148601;
      ExportDefFunction@1000000005 : Record 11148602;
      ExportDef2@1000000004 : Record 11148599;
      ExportDefLine2@1000000003 : Record 11148600;
      ExportDefTableLink2@1000000002 : Record 11148601;
      ExportDefFunction2@1000000001 : Record 11148602;
    BEGIN
      ExportDef2.CHANGECOMPANY(Rules."Company Name");
      ExportDef2.SETRANGE(Code, Rules."Definition Code");
      IF NOT Rules."Overwrite Definition" THEN
        IF ExportDef2.FINDFIRST THEN
          IF NOT CONFIRM(Text001, FALSE, Rules."Definition Code", Rules."Company Name") THEN
            EXIT;

      ExportDef2.CHANGECOMPANY(Rules."Company Name");
      ExportDef2.SETRANGE(Code, Rules."Definition Code");
      ExportDef2.DELETEALL;

      ExportDefLine2.CHANGECOMPANY(Rules."Company Name");
      ExportDefLine2.SETRANGE("Export Definition", Rules."Definition Code");
      ExportDefLine2.DELETEALL;

      ExportDefTableLink2.CHANGECOMPANY(Rules."Company Name");
      ExportDefTableLink2.SETRANGE("Export Definition", Rules."Definition Code");
      ExportDefTableLink2.DELETEALL;

      ExportDefFunction2.CHANGECOMPANY(Rules."Company Name");
      ExportDefFunction2.SETRANGE("Export Definition", Rules."Definition Code");
      ExportDefFunction2.DELETEALL;

      ExportDef.SETRANGE(Code, Rules."Definition Code");
      IF ExportDef.FINDSET THEN
        REPEAT
          ExportDef2 := ExportDef;
          ExportDef2.INSERT;
        UNTIL ExportDef.NEXT = 0;

      ExportDefLine.SETRANGE("Export Definition", Rules."Definition Code");
      IF ExportDefLine.FINDSET THEN
        REPEAT
          ExportDefLine2 := ExportDefLine;
          ExportDefLine2.INSERT;

          CopyConversion(ExportDefLine."Conversion Code", Rules."Company Name");
          CopyVariable(ExportDefLine."Dest. Variable", Rules."Company Name");
          IF ExportDefLine.Type = ExportDefLine.Type::Variable THEN
            CopyVariable(ExportDefLine.Code, Rules."Company Name");

        UNTIL ExportDefLine.NEXT = 0;

      ExportDefTableLink.SETRANGE("Export Definition", Rules."Definition Code");
      IF ExportDefTableLink.FINDSET THEN
        REPEAT
          ExportDefTableLink2 := ExportDefTableLink;
          ExportDefTableLink2.INSERT;
        UNTIL ExportDefTableLink.NEXT = 0;

      ExportDefFunction.SETRANGE("Export Definition", Rules."Definition Code");
      IF ExportDefFunction.FINDSET THEN
        REPEAT
          ExportDefFunction2 := ExportDefFunction;
          ExportDefFunction2.INSERT;
          CopyFunction(ExportDefFunction.Code, Rules."Company Name");
        UNTIL ExportDefFunction.NEXT = 0;

      CopyCount += 1;
    END;

    LOCAL PROCEDURE CopyVariable@1000000003(VariableCode@1000000000 : Code[20];CompanyName@1000000001 : Text[30]);
    VAR
      Variable@1000000002 : Record 11148604;
      Variable2@1000000003 : Record 11148604;
    BEGIN
      IF Variable.GET(VariableCode) THEN BEGIN
        Variable2.CHANGECOMPANY(CompanyName);
        Variable2.SETRANGE(Code, VariableCode);
        IF Variable2.ISEMPTY THEN BEGIN
          Variable2 := Variable;
          Variable2.INSERT;
        END;
      END;
    END;

    LOCAL PROCEDURE CopyConversion@1000000004(ConversionCode@1000000000 : Code[20];CompanyName@1000000001 : Text[30]);
    VAR
      Conversion@1000000002 : Record 11148605;
      ConversionLine@1000000003 : Record 11148606;
      Conversion2@1000000005 : Record 11148605;
      ConversionLine2@1000000004 : Record 11148606;
    BEGIN
      IF Conversion.GET(ConversionCode) THEN BEGIN
        Conversion2.CHANGECOMPANY(CompanyName);
        Conversion2.SETRANGE(Code, ConversionCode);
        IF Conversion2.ISEMPTY THEN BEGIN
          Conversion2 := Conversion;
          Conversion2.INSERT;
        END;

        ConversionLine2.CHANGECOMPANY(CompanyName);
        ConversionLine2.SETRANGE("Conversion Code", ConversionCode);
        ConversionLine2.DELETEALL;

        ConversionLine.SETRANGE("Conversion Code", ConversionCode);
        IF ConversionLine.FINDSET THEN
          REPEAT
            ConversionLine2 := ConversionLine;
            ConversionLine2.INSERT;
          UNTIL ConversionLine.NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE CopyFunction@1000000006(FunctionCode@1000000000 : Code[20];CompanyName@1000000003 : Text[30]);
    VAR
      Func@1000000001 : Record 11148595;
      Func2@1000000002 : Record 11148595;
    BEGIN
      IF Func.GET(FunctionCode) THEN BEGIN
        Func2.CHANGECOMPANY(CompanyName);
        Func2.SETRANGE(Code, FunctionCode);
        IF Func2.ISEMPTY THEN BEGIN
          Func2 := Func;
          Func2.INSERT;
        END;
      END;
    END;

    PROCEDURE CopyTask@1000000005(VAR Rules@1000000000 : Record 11148643);
    VAR
      Task@1000000001 : Record 11148614;
      TaskObject@1000000002 : Record 11148615;
      TaskPlanning@1000000003 : Record 11148616;
      Task2@1000000006 : Record 11148614;
      TaskObject2@1000000005 : Record 11148615;
      TaskPlanning2@1000000004 : Record 11148616;
    BEGIN
      Task2.CHANGECOMPANY(Rules."Company Name");
      Task2.SETRANGE(Code, Rules."Definition Code");
      IF NOT Rules."Overwrite Definition" THEN
        IF Task2.FINDFIRST THEN
          IF NOT CONFIRM(Text001, FALSE, Rules."Definition Code", Rules."Company Name") THEN
            EXIT;

      Task2.CHANGECOMPANY(Rules."Company Name");
      Task2.SETRANGE(Code, Rules."Definition Code");
      Task2.DELETEALL;

      TaskObject2.CHANGECOMPANY(Rules."Company Name");
      TaskObject2.SETRANGE("Task Code", Rules."Definition Code");
      TaskObject2.DELETEALL;

      TaskPlanning2.CHANGECOMPANY(Rules."Company Name");
      TaskPlanning2.SETRANGE("Task Code", Rules."Definition Code");
      TaskPlanning2.DELETEALL;

      Task.SETRANGE(Code, Rules."Definition Code");
      IF Task.FINDSET THEN
        REPEAT
          Task2 := Task;
          Task2.INSERT;
        UNTIL Task.NEXT = 0;

      TaskObject.SETRANGE("Task Code", Rules."Definition Code");
      IF TaskObject.FINDSET THEN
        REPEAT
          TaskObject2 := TaskObject;
          TaskObject2.INSERT;
        UNTIL TaskObject.NEXT = 0;

      TaskPlanning.SETRANGE("Task Code", Rules."Definition Code");
      IF TaskPlanning.FINDSET THEN
        REPEAT
          TaskPlanning2 := TaskPlanning;
          TaskPlanning2.INSERT;

          CopyTaskGroup(TaskPlanning."Task Group Code", Rules."Company Name");
        UNTIL TaskPlanning.NEXT = 0;

      CopyCount += 1;
    END;

    LOCAL PROCEDURE CopyTaskGroup@1000000008(TaskGroupCode@1000000000 : Code[20];CompanyName@1000000003 : Text[30]);
    VAR
      TaskGroup@1000000001 : Record 11148642;
      TaskGroup2@1000000002 : Record 11148642;
    BEGIN
      IF TaskGroup.GET(TaskGroupCode) THEN BEGIN
        TaskGroup2.CHANGECOMPANY(CompanyName);
        TaskGroup2.SETRANGE(Code, TaskGroupCode);
        IF TaskGroup2.ISEMPTY THEN BEGIN
          TaskGroup2 := TaskGroup;
          TaskGroup2.INSERT;
        END;
      END;
    END;

    PROCEDURE CopyProject@1000000007(VAR Rules@1000000000 : Record 11148643);
    BEGIN
      ERROR(Text005);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148647 IN - ConnectIT Web Services
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    OnRun=VAR
            WebService@1000000000 : Record 2000000076;
          BEGIN
            WebService.SETRANGE("Object Type", WebService."Object Type"::Codeunit);
            WebService.SETRANGE("Service Name", 'ConnectIT');
            IF WebService.ISEMPTY THEN BEGIN
              WebService."Object Type" := WebService."Object Type"::Codeunit;
              WebService."Service Name" := 'ConnectIT';
              WebService."Object ID" := CODEUNIT::"IN - ConnectIT Web Services";
              WebService.INSERT(TRUE);
              WebService.VALIDATE(Published, TRUE);
              WebService.MODIFY(TRUE);
            END;
          END;

  }
  CODE
  {
    VAR
      Text001@1000000000 : TextConst 'ENU=No import definition code was supplied. Import cancelled.;NLD=No import definition code was supplied. Import cancelled.';
      Text002@1000000001 : TextConst 'ENU=No export definition code was support. Export cancelled.;NLD=No export definition code was support. Export cancelled.';
      Text003@1000000002 : TextConst 'ENU=Import cancelled.;NLD=Import cancelled.';
      Text004@1000000003 : TextConst 'ENU=Export cancelled.;NLD=Export cancelled.';

    PROCEDURE RunImport@150002003(ImportDef@150002003 : Code[20];VAR ImportXml@150002004 : BigText;VAR ErrorMessage@150002005 : BigText) Result : Boolean;
    VAR
      XmlDoc@150002006 : Codeunit 11148637;
      ImportDefinition@1000000000 : Record 11148591;
      ImportMgt@1000000003 : Codeunit 11148595;
      ErrorMgt@1000000001 : Codeunit 11148630;
      CommentMgt@1000000002 : Codeunit 11148622;
      Progressbar@1000000004 : Codeunit 11148624;
      ErrorText@1000000005 : Text[1024];
    BEGIN
      Progressbar.SuppressBarDialog(TRUE);

      XmlDoc.Create(FALSE, FALSE);
      XmlDoc.LoadFromBigText(ImportXml);

      IF ImportDef = '' THEN BEGIN
        ErrorMessage.ADDTEXT := '<Error>'+Text001+'</Error>';
        EXIT(FALSE);
      END;

      ImportDefinition.GET(ImportDef);

      ErrorMgt.ClearError;
      CommentMgt.Reset;
      CLEAR(ImportMgt);
      ImportMgt.SetDoc(XmlDoc);
      ImportMgt.SetWebServiceCall(TRUE);

      IF NOT ImportMgt.RUN(ImportDefinition) THEN BEGIN
        ErrorText := ErrorMgt.GetError;

        IF ErrorText = '' THEN
          ErrorText := Text003;

        CommentMgt.AddError(0, 0, ErrorText);
        ErrorMessage.ADDTEXT('<Error>'+ErrorText+'</Error>');
        Progressbar.SuppressBarDialog(FALSE);
        EXIT(FALSE);
      END;

      ErrorMessage.ADDTEXT := '<Error>No error.</Error>';

      CLEAR(XmlDoc);
      Progressbar.SuppressBarDialog(FALSE);
      EXIT(TRUE);
    END;

    PROCEDURE RunExport@150002004(ExportDef@150002003 : Code[20];ExportFilter@150002004 : Text[250];VAR ExportXml@150002005 : BigText;VAR ErrorMessage@150002006 : BigText) Result : Boolean;
    VAR
      XmlDoc@150002007 : Codeunit 11148637;
      XmlDocFilter@1000000009 : Codeunit 11148637;
      XmlDocFilterAsNode@1000000010 : Codeunit 11148611;
      ExportDefinition@1000000004 : Record 11148599;
      ExportMgt@1000000003 : Codeunit 11148614;
      VariableMgt@1000000002 : Codeunit 11148619;
      CommentMgt@1000000001 : Codeunit 11148622;
      ErrorMgt@1000000000 : Codeunit 11148630;
      FilterNode@1000000008 : Codeunit 11148611;
      FiltersNodeList@1000000007 : Codeunit 11148612;
      Name@1000000006 : Text[250];
      Value@1000000005 : Text[250];
      ErrorText@1000000013 : Text[1024];
      ProgressBar@1000000014 : Codeunit 11148624;
    BEGIN
      ProgressBar.SuppressBarDialog(TRUE);

      IF ExportDef = '' THEN BEGIN
        ErrorMessage.ADDTEXT('<Error>'+Text002+'</Error>');
        EXIT(FALSE);
      END;

      IF (ExportFilter <> '') THEN BEGIN
        XmlDocFilter.Create(FALSE, FALSE);
        XmlDocFilter.LoadFromText(ExportFilter);

        XmlDocFilter.AsNode(XmlDocFilterAsNode);

        IF FindNodes(XmlDocFilterAsNode, 'Filters/Filter', FiltersNodeList) THEN BEGIN
          FiltersNodeList.NextNode(FilterNode);
          WHILE NOT FilterNode.IsClear DO BEGIN
            Name := UPPERCASE(FindAttribute(FilterNode, 'Name'));
            Value := FindAttribute(FilterNode, 'Value');
            IF Name <> '' THEN BEGIN
              VariableMgt.SetVariable(Name, Value);
            END;
            FiltersNodeList.NextNode(FilterNode);
          END;
        END;
        CLEAR(XmlDocFilter);
      END;

      XmlDoc.Create(FALSE, FALSE);
      ExportDefinition.GET(ExportDef);
      ErrorMgt.ClearError;
      CommentMgt.Reset;
      CLEAR(ExportMgt);
      ExportMgt.SetKeepDocumentOpen(TRUE);
      ExportMgt.SetDoc(XmlDoc);
      ExportMgt.SetIsWebServiceCall(TRUE);

      IF NOT ExportMgt.RUN(ExportDefinition) THEN BEGIN
        ErrorText := ErrorMgt.GetError;

        IF ErrorText = '' THEN
          ErrorText := Text004;

        CommentMgt.AddError(0, 0, ErrorText);
        ErrorMessage.ADDTEXT('<Error>'+ErrorText+'</Error>');
        ProgressBar.SuppressBarDialog(FALSE);
        EXIT(FALSE)
      END;

      XmlDoc.AddToBigText(ExportXml);
      ProgressBar.SuppressBarDialog(FALSE);
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE FindNodes@4(XMLRootNode@1000 : Codeunit 11148611;NodePath@1001 : Text[250];VAR ReturnedXMLNodeList@1002 : Codeunit 11148612) : Boolean;
    BEGIN
      XMLRootNode.SelectNodes(NodePath, ReturnedXMLNodeList);

      IF ReturnedXMLNodeList.IsClear THEN
        EXIT(FALSE)
      ELSE
        EXIT(TRUE);
    END;

    LOCAL PROCEDURE FindAttribute@1000018(XMLRootNode@1000 : Codeunit 11148611;NodePath@1001 : Text[250]) : Text[1024];
    VAR
      XMLNode@1000000001 : Codeunit 11148611;
      XMLNamedNodeMap@1000000000 : Codeunit 11148649;
    BEGIN
      XMLRootNode.Attributes(XMLNamedNodeMap);
      XMLNamedNodeMap.GetNamedItem(NodePath, XMLNode);
      EXIT(XMLNode.GetText);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148648 IN - XML Text Node
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      XMLDOMText@1000000000 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{2933BF87-7B36-11D2-B20E-00C04F983E60}:'Microsoft XML, v6.0'.IXMLDOMText";
      XmlTextOnRTC@1000000001 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlText" RUNONCLIENT;
      XmlTextOnNST@1000000002 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlText";
      Mode@1000000003 : 'Automation,DotNet on RTC,DotNet on NST';

    PROCEDURE GetAutomation@1000000001(VAR XMLDOMText2@1000000000 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{2933BF87-7B36-11D2-B20E-00C04F983E60}:'Microsoft XML, v6.0'.IXMLDOMText");
    BEGIN
      XMLDOMText2 := XMLDOMText;
    END;

    PROCEDURE SetAutomation@1000000002(XMLDOMText2@1000000000 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{2933BF87-7B36-11D2-B20E-00C04F983E60}:'Microsoft XML, v6.0'.IXMLDOMText");
    BEGIN
      XMLDOMText := XMLDOMText2;
      Mode := Mode::Automation;
    END;

    PROCEDURE GetDotNetOnRTC@1000000008(VAR XmlText2@1000000000 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlText" RUNONCLIENT);
    BEGIN
      XmlText2 := XmlTextOnRTC;
    END;

    PROCEDURE SetDotNetOnRTC@1000000009(XmlText2@1000000000 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlText" RUNONCLIENT);
    BEGIN
      XmlTextOnRTC := XmlText2;
      Mode := Mode::"DotNet on RTC";
    END;

    PROCEDURE GetDotNetOnNST@1000000010(VAR XmlText2@1000000000 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlText");
    BEGIN
      XmlText2 := XmlTextOnNST;
    END;

    PROCEDURE SetDotNetOnNST@1000000011(XmlText2@1000000000 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlText");
    BEGIN
      XmlTextOnNST := XmlText2;
      Mode := Mode::"DotNet on NST";
    END;

    PROCEDURE IsClear@1000000004() : Boolean;
    BEGIN
      CASE Mode OF
        Mode::Automation: EXIT(ISCLEAR(XMLDOMText));
        Mode::"DotNet on RTC": EXIT(ISNULL(XmlTextOnRTC));
        Mode::"DotNet on NST": EXIT(ISNULL(XmlTextOnNST));
      END;
    END;

    PROCEDURE FromNode@1000000000(VAR XMLNode@1000000000 : Codeunit 11148611);
    VAR
      XMLDOMNode@1000000001 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{2933BF80-7B36-11D2-B20E-00C04F983E60}:'Microsoft XML, v6.0'.IXMLDOMNode";
      XMLDOMText@1000000004 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{2933BF87-7B36-11D2-B20E-00C04F983E60}:'Microsoft XML, v6.0'.IXMLDOMText";
      XmlNodeOnRTC@1000000002 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode" RUNONCLIENT;
      XmlTextOnRTC2@1000000005 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode" RUNONCLIENT;
      XmlNodeOnNST@1000000003 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode";
      XmlTextOnNST2@1000000006 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode";
    BEGIN
      Mode := XMLNode.GetMode;

      CASE Mode OF
        Mode::Automation:
          BEGIN
            XMLNode.GetAutomation(XMLDOMNode);
            XMLDOMText := XMLDOMNode;
            SetAutomation(XMLDOMText);
          END;
        Mode::"DotNet on RTC":
          BEGIN
            XMLNode.GetDotNetOnRTC(XmlNodeOnRTC);
            XmlTextOnRTC2 := XmlNodeOnRTC;
            SetDotNetOnRTC(XmlTextOnRTC2);
          END;
        Mode::"DotNet on NST":
          BEGIN
            XMLNode.GetDotNetOnNST(XmlNodeOnNST);
            XmlTextOnNST2 := XmlNodeOnNST;
            SetDotNetOnNST(XmlTextOnNST2);
          END;
      END;
    END;

    PROCEDURE SubStringData@1000000003(Offset@1000000000 : Integer;Count@1000000001 : Integer) : Text[1024];
    BEGIN
      CASE Mode OF
        Mode::Automation: EXIT(XMLDOMText.substringData(Offset, Count));
        Mode::"DotNet on RTC": EXIT(XmlTextOnRTC.Substring(Offset, Count));
        Mode::"DotNet on NST": EXIT(XmlTextOnNST.Substring(Offset, Count));
      END;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148649 IN - XML Named Node Map
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      XMLDOMNamedNodeMap@1000000000 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{2933BF83-7B36-11D2-B20E-00C04F983E60}:'Microsoft XML, v6.0'.IXMLDOMNamedNodeMap";
      XmlNamedNodeMapOnRTC@1000000002 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNamedNodeMap" RUNONCLIENT;
      XmlNamedNodeMapOnNST@1000000003 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNamedNodeMap";
      Mode@1000000001 : 'Automation,DotNet on RTC,DotNet on NST';

    PROCEDURE GetAutomation@1000000001(VAR XMLDOMNamedNodeMap2@1000000000 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{2933BF83-7B36-11D2-B20E-00C04F983E60}:'Microsoft XML, v6.0'.IXMLDOMNamedNodeMap");
    BEGIN
      XMLDOMNamedNodeMap2 := XMLDOMNamedNodeMap;
    END;

    PROCEDURE SetAutomation@1000000002(XMLDOMNamedNodeMap2@1000000000 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{2933BF83-7B36-11D2-B20E-00C04F983E60}:'Microsoft XML, v6.0'.IXMLDOMNamedNodeMap");
    BEGIN
      XMLDOMNamedNodeMap := XMLDOMNamedNodeMap2;
      Mode := Mode::Automation;
    END;

    PROCEDURE GetDotNetOnRTC@1000000007(VAR XmlNamedNodeMap2@1000000000 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNamedNodeMap" RUNONCLIENT);
    BEGIN
      XmlNamedNodeMap2 := XmlNamedNodeMapOnRTC;
    END;

    PROCEDURE SetDotNetOnRTC@1000000008(XmlNamedNodeMap2@1000000000 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNamedNodeMap" RUNONCLIENT);
    BEGIN
      XmlNamedNodeMapOnRTC := XmlNamedNodeMap2;
      Mode := Mode::"DotNet on RTC";
    END;

    PROCEDURE GetDotNetOnNST@1000000009(VAR XmlNamedNodeMap2@1000000000 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNamedNodeMap");
    BEGIN
      XmlNamedNodeMap2 := XmlNamedNodeMapOnNST;
    END;

    PROCEDURE SetDotNetOnNST@1000000010(XmlNamedNodeMap2@1000000000 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNamedNodeMap");
    BEGIN
      XmlNamedNodeMapOnNST := XmlNamedNodeMap2;
      Mode := Mode::"DotNet on NST";
    END;

    PROCEDURE GetItem@1000000000(Index@1000000000 : Integer;VAR Node@1000000001 : Codeunit 11148611);
    BEGIN
      CASE Mode OF
        Mode::Automation: Node.SetAutomation(XMLDOMNamedNodeMap.item(Index));
        Mode::"DotNet on RTC": Node.SetDotNetOnRTC(XmlNamedNodeMapOnRTC.Item(Index));
        Mode::"DotNet on NST": Node.SetDotNetOnNST(XmlNamedNodeMapOnNST.Item(Index));
      END;
    END;

    PROCEDURE GetLength@1000000003() : Integer;
    BEGIN
      CASE Mode OF
        Mode::Automation: EXIT(XMLDOMNamedNodeMap.length);
        Mode::"DotNet on RTC": EXIT(XmlNamedNodeMapOnRTC.Count);
        Mode::"DotNet on NST": EXIT(XmlNamedNodeMapOnNST.Count);
      END;
    END;

    PROCEDURE GetNamedItem@1000000005(Name@1000000000 : Text[1024];VAR XMLNode@1000000001 : Codeunit 11148611);
    BEGIN
      CASE Mode OF
        Mode::Automation: XMLNode.SetAutomation(XMLDOMNamedNodeMap.getNamedItem(Name));
        Mode::"DotNet on RTC": XMLNode.SetDotNetOnRTC(XmlNamedNodeMapOnRTC.GetNamedItem(Name));
        Mode::"DotNet on NST": XMLNode.SetDotNetOnNST(XmlNamedNodeMapOnNST.GetNamedItem(Name));
      END;
    END;

    PROCEDURE SetNamedItem@1000000004(VAR XMLNode@1000000000 : Codeunit 11148611);
    VAR
      XMLDOMNode@1000000001 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{2933BF80-7B36-11D2-B20E-00C04F983E60}:'Microsoft XML, v6.0'.IXMLDOMNode";
      XmlDomNodeOnRTC@1000000002 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode" RUNONCLIENT;
      XmlDomNodeOnNST@1000000003 : DotNet "'System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Xml.XmlNode";
    BEGIN
      CASE Mode OF
        Mode::Automation:
          BEGIN
            XMLNode.GetAutomation(XMLDOMNode);
            XMLDOMNamedNodeMap.setNamedItem(XMLDOMNode);
          END;
        Mode::"DotNet on RTC":
          BEGIN
            XMLNode.GetDotNetOnRTC(XmlDomNodeOnRTC);
            XmlNamedNodeMapOnRTC.SetNamedItem(XmlDomNodeOnRTC);
          END;
        Mode::"DotNet on NST":
          BEGIN
            XMLNode.GetDotNetOnNST(XmlDomNodeOnNST);
            XmlNamedNodeMapOnNST.SetNamedItem(XmlDomNodeOnNST);
          END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148650 IN - Indent XML Document
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE Indent@1000000000(VAR XMLDocument@1000000000 : Codeunit 11148637);
    BEGIN
      CASE ISSERVICETIER OF
        FALSE: IndentAutomation(XMLDocument);
        TRUE: IndentDotNet(XMLDocument);
      END;
    END;

    PROCEDURE IndentAutomation@1000000001(VAR XMLDocument@1000000007 : Codeunit 11148637);
    VAR
      Stream@1000000006 : OutStream;
      TempBlob@1000000005 : TEMPORARY Record 11148609;
      RecRef@1000000004 : RecordRef;
      XMLDOMDocument@1000000003 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{88D96A05-F192-11D4-A65F-0040963251E5}:'Microsoft XML, v6.0'.DOMDocument60";
      Reader@1000000002 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{88D96A0C-F192-11D4-A65F-0040963251E5}:'Microsoft XML, v6.0'.SAXXMLReader60";
      Writer@1000000001 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 6.0:{88D96A0F-F192-11D4-A65F-0040963251E5}:'Microsoft XML, v6.0'.MXXMLWriter60";
      NewOutput@1000000000 : BigText;
    BEGIN
      CREATE(Writer, TRUE, TRUE);
      Writer.omitXMLDeclaration := FALSE;
      Writer.indent := TRUE;
      Writer.byteOrderMark := TRUE;
      Writer.standalone := TRUE;
      Writer.version := '1.0';
      Writer.encoding := 'UTF-8';

      CREATE(Reader, TRUE, TRUE);
      Reader.contentHandler := Writer;
      Reader.dtdHandler := Writer;
      Reader.errorHandler := Writer;
      Reader.putProperty('http://xml.org/sax/properties/declaration-handler', Writer);
      Reader.putProperty('http://xml.org/sax/properties/lexical-handler', Writer);

      XMLDocument.GetAutomation(XMLDOMDocument);
      Reader.parse(XMLDOMDocument);

      IF (NOT ISSERVICETIER) THEN
        XMLDOMDocument.loadXML(Writer.output)
      ELSE BEGIN
        NewOutput.ADDTEXT(FORMAT(Writer.output));
        XMLDOMDocument.loadXML(FORMAT(NewOutput));
      END;
    END;

    PROCEDURE IndentDotNet@1000000005(VAR XMLDocument@1000000000 : Codeunit 11148637);
    BEGIN
      // FIXME: Do we need to do something at all?
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148651 IN - C/SIDE Manager
{
  OBJECT-PROPERTIES
  {
    Date=14-07-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.1;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      CSideManagerAutomation@1000000000 : Automation "{75E053EA-4A5A-4210-9188-699CF98212FE} 2.7:{24D46DFB-BA8C-4150-90D2-64D8006DAB2B}:'IDYN.Components'.CSideManager";
      CSideManagerDotNetOnRTC@1000000002 : DotNet "'IDYN.Components, Version=2.7.1.712, Culture=neutral, PublicKeyToken=0f5532c6f6903616'.IDYN.Components.CSideManager" RUNONCLIENT;
      CSideManagerDotNetOnNST@1000000003 : DotNet "'IDYN.Components, Version=2.7.1.712, Culture=neutral, PublicKeyToken=0f5532c6f6903616'.IDYN.Components.CSideManager";
      Mode@1000000001 : 'Automation,DotNet on NST,DotNet on RTC';

    PROCEDURE Create@1000000000(NewServer@1000000001 : Boolean;ClientSide@1000000000 : Boolean) : Boolean;
    BEGIN
      SetMode(ClientSide);

      CASE Mode OF
        Mode::Automation: EXIT(CreateAutomation(NewServer, ClientSide));
        Mode::"DotNet on RTC": EXIT(CreateDotNetOnRTC(NewServer, ClientSide));
        Mode::"DotNet on NST": EXIT(CreateDotNetOnNST(NewServer, ClientSide));
      END;
    END;

    LOCAL PROCEDURE CreateAutomation@1000000005(NewServer@1000000001 : Boolean;ClientSide@1000000000 : Boolean) : Boolean;
    BEGIN
      IF NOT ISCLEAR(CSideManagerAutomation) THEN
        CLEAR(CSideManagerAutomation);

      EXIT(CREATE(CSideManagerAutomation, NewServer, ClientSide));
    END;

    LOCAL PROCEDURE CreateDotNetOnRTC@1000000007(NewServer@1000000001 : Boolean;ClientSide@1000000000 : Boolean) : Boolean;
    BEGIN
      CSideManagerDotNetOnRTC := CSideManagerDotNetOnRTC.CSideManager();
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE CreateDotNetOnNST@1000000008(NewServer@1000000001 : Boolean;ClientSide@1000000000 : Boolean) : Boolean;
    BEGIN
      CSideManagerDotNetOnNST := CSideManagerDotNetOnNST.CSideManager();
      EXIT(TRUE);
    END;

    PROCEDURE GetClient@1000000006(DatabaseName@1000000000 : Text[1024]) : Boolean;
    BEGIN
      CASE Mode OF
        Mode::Automation: EXIT(CSideManagerAutomation.GetClient(DatabaseName));
        Mode::"DotNet on RTC": EXIT(CSideManagerDotNetOnRTC.GetClient(DatabaseName));
        Mode::"DotNet on NST": EXIT(CSideManagerDotNetOnNST.GetClient(DatabaseName));
      END;
    END;

    PROCEDURE GetLastError@1000000009() : Text[1024];
    BEGIN
      CASE Mode OF
        Mode::Automation: EXIT(CSideManagerAutomation.LastError);
        Mode::"DotNet on RTC": EXIT(CSideManagerDotNetOnRTC.LastError);
        Mode::"DotNet on NST": EXIT(CSideManagerDotNetOnNST.LastError);
      END;
    END;

    PROCEDURE ExportObjectToFile@1000000013(FileName@1000000000 : Text[260];ObjectType@1000000001 : Integer;ObjectID@1000000002 : Integer) : Boolean;
    BEGIN
      CASE Mode OF
        Mode::Automation: EXIT(CSideManagerAutomation.ExportObjectToFile(FileName, ObjectType, ObjectID));
        Mode::"DotNet on RTC": EXIT(CSideManagerDotNetOnRTC.ExportObjectToFile(FileName, ObjectType, ObjectID));
        Mode::"DotNet on NST": EXIT(CSideManagerDotNetOnNST.ExportObjectToFile(FileName, ObjectType, ObjectID));
      END;
    END;

    LOCAL PROCEDURE SetMode@1000000003(ClientSide@1000000000 : Boolean);
    BEGIN
      IF NOT ISSERVICETIER THEN BEGIN
        Mode := Mode::Automation;
        EXIT;
      END;

      IF ClientSide THEN BEGIN
        Mode := Mode::"DotNet on RTC";
        EXIT;
      END;

      Mode := Mode::"DotNet on NST";
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148652 IN - Directory
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    OnRun=VAR
            Continue@1000000000 : Boolean;
            FileName@1000000001 : Text[250];
          BEGIN
            FindFiles(TRUE, 'D:\Temp', '*.Xml');

            Continue := TRUE;

            WHILE Continue DO BEGIN
              Continue := FindNextFile(FileName);
              IF Continue THEN
                MESSAGE(FileName)
            END;
          END;

  }
  CODE
  {
    VAR
      Files@1000000000 : Record 2000000022;
      DirectoryDotNetOnRTC@1002 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Directory" RUNONCLIENT;
      DirectoryDotNetOnNST@1003 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Directory";
      EnumeratorDotNetOnRTC@1005 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Collections.IEnumerator" RUNONCLIENT;
      EnumeratorDotNetOnNST@1006 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Collections.IEnumerator";
      Mode@1000 : 'Classic Client,DotNet on RTC,DotNet on NST';
      IsFirstFile@1000000001 : Boolean;

    PROCEDURE GetMode@1() : Integer;
    BEGIN
      EXIT(Mode);
    END;

    LOCAL PROCEDURE SetMode@2(ClientSide@1000 : Boolean);
    BEGIN
      IF NOT ISSERVICETIER THEN BEGIN
        Mode := Mode::"Classic Client";
        EXIT;
      END;

      IF ClientSide THEN BEGIN
        Mode := Mode::"DotNet on RTC";
        EXIT;
      END;

      Mode := Mode::"DotNet on NST";
    END;

    PROCEDURE FindFiles@3(ClientSide@1000 : Boolean;Path@1001 : Text[260];FileNamePattern@1002 : Text[1024]);
    BEGIN
      SetMode(ClientSide);

      CASE Mode OF
        Mode::"Classic Client":
          BEGIN
            ResetFileCache(Files);
            Files.SETRANGE(Path, Path);
            Files.SETRANGE("Is a file", TRUE);
            IF FileNamePattern <> '' THEN
              Files.SETFILTER(Name, '@' + FileNamePattern);
            IsFirstFile := TRUE;
          END;
        Mode::"DotNet on RTC":
          BEGIN
            IF FileNamePattern <> '' THEN
              EnumeratorDotNetOnRTC := DirectoryDotNetOnRTC.GetFiles(Path, FileNamePattern).GetEnumerator()
            ELSE
              EnumeratorDotNetOnRTC := DirectoryDotNetOnRTC.GetFiles(Path).GetEnumerator();
          END;
        Mode::"DotNet on NST":
          BEGIN
            IF FileNamePattern <> '' THEN
              EnumeratorDotNetOnNST := DirectoryDotNetOnNST.GetFiles(Path, FileNamePattern).GetEnumerator()
            ELSE
              EnumeratorDotNetOnNST := DirectoryDotNetOnNST.GetFiles(Path).GetEnumerator();
          END;
      END;
    END;

    PROCEDURE FindNextFile@4(VAR FileName@1001 : Text[260]) Found : Boolean;
    BEGIN
      CASE Mode OF
        Mode::"Classic Client":
          BEGIN
            CASE IsFirstFile OF
              TRUE: Found := Files.FINDSET;
              FALSE: Found := Files.NEXT <> 0;
            END;

            IsFirstFile := FALSE;

            IF Found THEN
              FileName := Files.Name;
          END;
        Mode::"DotNet on RTC":
          BEGIN
            IF ISNULL(EnumeratorDotNetOnRTC) THEN
              EXIT(FALSE);

            IF EnumeratorDotNetOnRTC.MoveNext THEN BEGIN
              FileName := GetFileName(EnumeratorDotNetOnRTC.Current);
              EXIT(TRUE);
            END;
          END;
        Mode::"DotNet on NST":
          BEGIN
            IF ISNULL(EnumeratorDotNetOnNST) THEN
              EXIT(FALSE);

            IF EnumeratorDotNetOnNST.MoveNext THEN BEGIN
              FileName := GetFileName(EnumeratorDotNetOnNST.Current);
              EXIT(TRUE);
            END;
          END;
      END;
    END;

    LOCAL PROCEDURE GetFileName@5(FullName@1000 : Text[260]) : Text[260];
    VAR
      Path@1001 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path";
    BEGIN
      EXIT(Path.GetFileName(FullName));
    END;

    PROCEDURE ResetFileCache@1000000000(VAR Files@1000000000 : Record 2000000022);
    BEGIN
      Files.RESET;
      Files.SETRANGE(Path, 'c:\');
      IF NOT Files.FINDFIRST THEN;
      Files.RESET;
    END;

    BEGIN
    {
      CI-175: In Classic Client mode, the file name pattern was not taken into account when enumerating files
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148653 IN - Timer
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    SingleInstance=Yes;
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      TimerParameterBuffer@1000000005 : TEMPORARY Record 11148646;
      TimerAutomation@1001 : Automation "{3B311C81-140E-11D5-8B18-00D0590B4EC5} 1.0:{3B311C92-140E-11D5-8B18-00D0590B4EC5}:'Navision Timer 1.0'.Timer" WITHEVENTS;
      TimerDotNet@1000 : DotNet "'Microsoft.Dynamics.Nav.Timer, Version=7.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.Timer" WITHEVENTS;
      Mode@1002 : 'Automation,,DotNet on NST';
      CallbackCodeunitID@1000000002 : Integer;
      Initialized@1000000001 : Boolean;
      Text000@1000000003 : TextConst 'ENU=An exception occurred in the Timer codeunit:\\%1.;NLD=Er heeft zich een uitzondering voorgedaan in de Timer-codeunit:\\%1.';
      Text001@1000000004 : TextConst 'ENU=The timer has not been initialized.;NLD=De timer is niet genitialiseerd.';

    PROCEDURE Initialize@1000000000(Interval@1000000000 : Integer;CallbackCodeunitID2@1000000001 : Integer;VAR TimerParameterBuffer2@1000000002 : TEMPORARY Record 11148646);
    BEGIN
      SetMode;

      CASE Mode OF
        Mode::Automation: InitializeAutomation(Interval);
        Mode::"DotNet on NST": InitializeDotNetOnNST(Interval);
      END;

      CallbackCodeunitID := CallbackCodeunitID2;
      TimerParameterBuffer.COPY(TimerParameterBuffer2, TRUE);

      Initialized := TRUE;
    END;

    LOCAL PROCEDURE InitializeAutomation@10(Interval@1000 : Integer);
    BEGIN
      IF NOT ISCLEAR(TimerAutomation) THEN
        CLEAR(TimerAutomation);

      CREATE(TimerAutomation, TRUE, TRUE);
      TimerAutomation.Interval := Interval;
    END;

    LOCAL PROCEDURE InitializeDotNetOnNST@11(Interval@1000 : Integer);
    BEGIN
      IF NOT ISNULL(TimerDotNet) THEN
        CLEAR(TimerDotNet);

      TimerDotNet := TimerDotNet.Timer();
      TimerDotNet.Interval := Interval;
    END;

    PROCEDURE Start@1000000012();
    BEGIN
      IF NOT Initialized THEN
        ERROR(Text001);

      CASE Mode OF
        Mode::Automation: TimerAutomation.Enabled := TRUE;
        Mode::"DotNet on NST": TimerDotNet.Start;
      END;
    END;

    PROCEDURE Stop@1000000013();
    BEGIN
      IF NOT Initialized THEN
        ERROR(Text001);

      CASE Mode OF
        Mode::Automation: TimerAutomation.Enabled := FALSE;
        Mode::"DotNet on NST": TimerDotNet.Stop;
      END;
    END;

    PROCEDURE GetMode@1() : Integer;
    BEGIN
      EXIT(Mode);
    END;

    LOCAL PROCEDURE SetMode@2();
    BEGIN
      CASE ISSERVICETIER OF
        FALSE: Mode := Mode::Automation;
        TRUE: Mode := Mode::"DotNet on NST";
      END;
    END;

    PROCEDURE IsInitialized@5() : Boolean;
    BEGIN
      EXIT(Initialized);
    END;

    EVENT TimerDotNet@1000::Elapsed@12(sender@1001 : Variant;e@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.EventArgs");
    BEGIN
      CODEUNIT.RUN(CallbackCodeunitID, TimerParameterBuffer);
    END;

    EVENT TimerDotNet@1000::ExceptionOccurred@13(sender@1001 : Variant;e@1000 : DotNet "'Microsoft.Dynamics.Nav.Timer, Version=7.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.ExceptionOccurredEventArgs");
    BEGIN
      ERROR(Text000, e.Exception.Message);
    END;

    EVENT TimerAutomation@1001::Timer@1(Milliseconds@1000 : Integer);
    BEGIN
      CODEUNIT.RUN(CallbackCodeunitID, TimerParameterBuffer);
    END;

    EVENT TimerAutomation@1001::TimerError@2(ErrorString@1000 : Text[1024]);
    BEGIN
      ERROR(Text000, ErrorString);
    END;

    BEGIN
    {
      This being a SingleInstance codeunit reduces the number of possible
      timers in each NAV session (RTC, CC, NAS, NAS on NST etc.) to exactly
      one. Since, at the time of this writing, the timers are used primarily
      in the NAS handlers, this should not pose any problems - each NAS
      handler runs as a separate session in the classic NAS or on the NST.
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148654 IN - Event Log
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      WindowsShell@1000 : Automation "{F935DC20-1CF0-11D0-ADB9-00C04FD58A0B} 1.0:{72C24DD5-D70A-438B-8A42-98424B88AFB8}:'Windows Script Host Object Model'.WshShell";
      EventLog@1003 : DotNet "'System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.EventLog";
      EntryType@1001 : 'Information,Warning,Error';
      Text000@1002 : TextConst 'ENU=Unknown log entry type "%1".;NLD=Onbekende logboekpostsoort "%1".';

    PROCEDURE WriteInfo@3(Message@1000 : Text[1024]);
    BEGIN
      WriteEntry(EntryType::Information, Message);
    END;

    PROCEDURE WriteWarning@4(Message@1000 : Text[1024]);
    BEGIN
      WriteEntry(EntryType::Warning, Message);
    END;

    PROCEDURE WriteError@5(Message@1000 : Text[1024]);
    BEGIN
      WriteEntry(EntryType::Error, Message);
    END;

    LOCAL PROCEDURE WriteEntry@2(Type@1001 : Integer;Message@1000 : Text[1024]);
    BEGIN
      IF DELCHR(Message, '<>') = '' THEN
        EXIT;

      CASE ISSERVICETIER OF
        TRUE: WriteEntryDotNet(Type, Message);
        FALSE: WriteEntryAutomation(Type, Message);
      END;
    END;

    LOCAL PROCEDURE WriteEntryAutomation@13(Type@1001 : Integer;Message@1000 : Text[1024]);
    VAR
      EntryTypeAutomation@1002 : Integer;
    BEGIN
      IF ISCLEAR(WindowsShell) THEN
        CREATE(WindowsShell, TRUE, TRUE);

      CASE Type OF
        EntryType::Information: EntryTypeAutomation := 4;
        EntryType::Warning: EntryTypeAutomation := 2;
        EntryType::Error: EntryTypeAutomation := 1;
      ELSE
        ERROR(Text000, Type);
      END;

      WindowsShell.LogEvent(EntryTypeAutomation, Message);
    END;

    LOCAL PROCEDURE WriteEntryDotNet@14(Type@1001 : Integer;Message@1000 : Text[1024]);
    VAR
      EventLogEntryType@1002 : DotNet "'System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.EventLogEntryType";
    BEGIN
      IF ISNULL(EventLog) THEN BEGIN
        EventLog := EventLog.EventLog();
        // Reusing the NST's event source name because creating our
        // own requires admin privileges, which the account under
        // which the NST runs typically doesn't have.
        EventLog.Source := 'MicrosoftDynamicsNAVServer';
      END;

      // DotNet enumerations like EventLogEntryType are not supported in
      // version 2009R2; using numeric constants instead.
      CASE Type OF
        EntryType::Information: EventLogEntryType := 4;
        EntryType::Warning: EventLogEntryType := 2;
        EntryType::Error: EventLogEntryType := 1;
      END;

      EventLog.WriteEntry(Message, EventLogEntryType);
    END;

    EVENT EventLog@1003::EntryWritten@60(sender@1001 : Variant;e@1000 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.EntryWrittenEventArgs");
    BEGIN
    END;

    EVENT EventLog@1003::Disposed@61(sender@1001 : Variant;e@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.EventArgs");
    BEGIN
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148655 IN - Change Log Mgt.
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE LogInsertion@4(VAR RecRef@1000 : RecordRef);
    VAR
      ChangeLogManagement@1001 : Codeunit 423;
    BEGIN
      ChangeLogManagement.LogInsertion(RecRef);
    END;

    PROCEDURE LogModification@5(VAR RecRef@1000 : RecordRef;VAR xRecRef@1001 : RecordRef);
    VAR
      ChangeLogManagement@1002 : Codeunit 423;
    BEGIN
      ChangeLogManagement.LogModification(RecRef);
    END;

    PROCEDURE LogDeletion@6(VAR RecRef@1000 : RecordRef);
    VAR
      ChangeLogManagement@1001 : Codeunit 423;
    BEGIN
      ChangeLogManagement.LogDeletion(RecRef);
    END;

    BEGIN
    {
      This wrapper codeunit is intented to hide differences in the function
      signatures between different versions of the base application's Change
      Log Management codeunit (423).
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148656 IN - Task Handler
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    SingleInstance=Yes;
    OnRun=BEGIN
            Start;
          END;

  }
  CODE
  {
    VAR
      Timer@1000 : Codeunit 11148653;
      Started@1000000 : Boolean;
      TaskGroup@1000000000 : Code[10];

    PROCEDURE Start@1000001();
    VAR
      Setup@1000000 : Record 11148589;
      TimerParameterBuffer@1000 : TEMPORARY Record 11148646;
    BEGIN
      Setup.GET;
      Setup.TESTFIELD("Seconds Between Execute Task");

      IF TaskGroup <> '' THEN
        TimerParameterBuffer.InsertTextParameter('TASKGROUP', TaskGroup);

      Timer.Initialize(
        Setup."Seconds Between Execute Task" * 1000,
        CODEUNIT::"IN - Task Runner",
        TimerParameterBuffer);
      Timer.Start;

      Started := TRUE;
    END;

    PROCEDURE Stop@1000002();
    BEGIN
      IF Timer.IsInitialized THEN
        Timer.Stop;

      Started := FALSE;
    END;

    PROCEDURE IsStarted@1000000() : Boolean;
    BEGIN
      EXIT(Started);
    END;

    PROCEDURE SetTaskGroup@1000000000(TaskGroupCode@1000000000 : Code[10]);
    BEGIN
      TaskGroup := TaskGroupCode;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148657 IN - Task Runner
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    TableNo=11148646;
    OnRun=VAR
            TaskPlanning@1001 : Record 11148616;
            Task@1000 : Record 11148614;
            TaskGroup@1002 : Code[10];
          BEGIN
            SELECTLATESTVERSION;

            TaskPlanning.SETCURRENTKEY("Start Next Time");
            TaskPlanning.SETFILTER("Start Next Time", '<=%1&<>%2', CURRENTDATETIME, 0DT);

            IF GET('TASKGROUP') THEN BEGIN
              TESTFIELD(Type, Type::Text);
              TaskGroup := "Text Value";
            END;

            IF TaskGroup <> '' THEN
              TaskPlanning.SETRANGE("Task Group Code", TaskGroup);

            IF TaskPlanning.FINDSET THEN
              REPEAT
                IF Task.GET(TaskPlanning."Task Code") THEN
                  IF Task.Status = Task.Status::Automated THEN
                    Task.Process;
              UNTIL TaskPlanning.NEXT = 0;
          END;

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148658 IN - Sync. Inbox Handler
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    SingleInstance=Yes;
    OnRun=BEGIN
            Start;
          END;

  }
  CODE
  {
    VAR
      Timer@1000 : Codeunit 11148653;
      Started@1000000 : Boolean;

    PROCEDURE Start@1000001();
    VAR
      Setup@1000000 : Record 11148589;
      TimerParameterBuffer@1000 : TEMPORARY Record 11148646;
    BEGIN
      Setup.GET;
      Setup.TESTFIELD("Seconds Between Inbox Exec.");

      Timer.Initialize(
        Setup."Seconds Between Inbox Exec." * 1000,
        CODEUNIT::"IN - Sync. Inbox Runner",
        TimerParameterBuffer);
      Timer.Start;

      Started := TRUE;
    END;

    PROCEDURE Stop@1000002();
    BEGIN
      IF Timer.IsInitialized THEN
        Timer.Stop;

      Started := FALSE;
    END;

    PROCEDURE IsStarted@1000000() : Boolean;
    BEGIN
      EXIT(Started);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148659 IN - Sync. Inbox Runner
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    TableNo=11148646;
    OnRun=VAR
            SynchonizationInbox@1000 : Record 11148618;
          BEGIN
            SELECTLATESTVERSION;

            SynchonizationInbox.LOCKTABLE;
            SynchonizationInbox.SETRANGE(Status, SynchonizationInbox.Status::New);
            IF SynchonizationInbox.FINDFIRST THEN
              SynchonizationInbox.Process;
          END;

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148660 IN - Connector Handler
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    SingleInstance=Yes;
    OnRun=BEGIN
            Start;
          END;

  }
  CODE
  {
    VAR
      Timer@1000 : Codeunit 11148653;
      Started@1000000 : Boolean;

    PROCEDURE Start@1000001();
    VAR
      Setup@1000000 : Record 11148589;
      TimerParameterBuffer@1000 : TEMPORARY Record 11148646;
    BEGIN
      Setup.GET;
      Setup.TESTFIELD("Seconds Betw. Check Conn. Han.");

      Timer.Initialize(
        Setup."Seconds Betw. Check Conn. Han." * 1000,
        CODEUNIT::"IN - Connector Runner",
        TimerParameterBuffer);
      Timer.Start;

      Started := TRUE;
    END;

    PROCEDURE Stop@1000002();
    VAR
      Connector@1000000 : Record 11148623;
    BEGIN
      IF Timer.IsInitialized THEN
        Timer.Stop;

      Connector.SETRANGE(Status, Connector.Status::Automated);
      IF Connector.FINDSET THEN
        REPEAT
          IF Connector.IsActive THEN
            Connector.Stop;
        UNTIL Connector.NEXT = 0;

      Started := FALSE;
    END;

    PROCEDURE IsStarted@1000000() : Boolean;
    BEGIN
      EXIT(Started);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Codeunit 11148661 IN - Connector Runner
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    OnRun=VAR
            Connector@1000 : Record 11148623;
          BEGIN
            SELECTLATESTVERSION;

            Connector.SETRANGE(Status, Connector.Status::Automated);
            IF Connector.FINDSET THEN
              REPEAT
                IF NOT Connector.IsActive THEN
                  Connector.Start;
              UNTIL Connector.NEXT = 0;
          END;

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT MenuSuite 1052 Dept - CI - ConnectIT
{
  OBJECT-PROPERTIES
  {
    Date=30-07-13;
    Time=12:00:00;
    Version List=IDYN-CI5.00.1;
  }
  PROPERTIES
  {
  }
  MENUNODES
  {
    { Menu           ;[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}] ;Name=ConnectIT;
                                                                CaptionML=[ENU=ConnectIT;
                                                                           NLD=ConnectIT];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                ParentNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                Image=5;
                                                                IsShortcut=No;
                                                                Visible=Yes;
                                                                Enabled=Yes;
                                                                NextNodeID=[{19A352FE-D90D-424E-B85F-CF3B8E98CF0E}];
                                                                FirstChild=[{3619BA7E-E937-4A07-A8AE-9604E03D1BAA}] }
    { MenuGroup      ;[{93883F2C-0B3D-44F0-860B-CDEC7E611A18}] ;Name=New Group;
                                                                CaptionML=[ENU=Setup;
                                                                           NLD=Instellingen];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                ParentNodeID=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                FirstChild=[{5C548F9F-DD96-402E-B856-88F17FF87E18}] }
    { MenuItem       ;[{5C548F9F-DD96-402E-B856-88F17FF87E18}] ;Name=Setup;
                                                                CaptionML=[ENU=ConnectIT Setup;
                                                                           NLD=ConnectIT-instellingen];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Page;
                                                                RunObjectID=11116997;
                                                                ParentNodeID=[{93883F2C-0B3D-44F0-860B-CDEC7E611A18}];
                                                                Visible=Yes;
                                                                NextNodeID=[{7B436721-86BA-4339-8F67-C5E429DBAFD0}];
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{8A71DAB0-FD5B-443C-8B9D-AB1FE41E6E70}] ;Name=Projects;
                                                                CaptionML=[ENU=Projects;
                                                                           NLD=Projecten];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Page;
                                                                RunObjectID=11117056;
                                                                ParentNodeID=[{93883F2C-0B3D-44F0-860B-CDEC7E611A18}];
                                                                Visible=Yes;
                                                                NextNodeID=[{6AB37034-8EF3-450C-8896-2225899F851E}];
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{6AB37034-8EF3-450C-8896-2225899F851E}] ;Name=IN - Conversions;
                                                                CaptionML=[ENU=Conversions;
                                                                           NLD=Conversies];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Page;
                                                                RunObjectID=11148596;
                                                                ParentNodeID=[{93883F2C-0B3D-44F0-860B-CDEC7E611A18}];
                                                                Visible=Yes;
                                                                NextNodeID=[{EC9DCEDA-1966-4EEB-9254-68CAD71348AD}];
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{EC9DCEDA-1966-4EEB-9254-68CAD71348AD}] ;Name=Variables;
                                                                CaptionML=[ENU=Variables;
                                                                           NLD=Variabelen];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Page;
                                                                RunObjectID=11148595;
                                                                ParentNodeID=[{93883F2C-0B3D-44F0-860B-CDEC7E611A18}];
                                                                Visible=Yes;
                                                                NextNodeID=[{BAA19880-65B3-4BA2-BFEC-0143E42170A0}];
                                                                DepartmentCategory=Administration }
    { MenuGroup      ;[{3619BA7E-E937-4A07-A8AE-9604E03D1BAA}] ;Name=New Group;
                                                                CaptionML=[ENU=Export Management;
                                                                           NLD=Export Management];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                ParentNodeID=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                Visible=Yes;
                                                                NextNodeID=[{3AE95A0F-FC3C-4926-BA8C-5AFDD88B26B6}];
                                                                FirstChild=[{A1B7B6C1-A1E5-4DA6-97EA-E0DD08295877}] }
    { MenuItem       ;[{9A4B94AC-38A4-41F4-BB68-8FD0D8B3E08D}] ;Name=Monitoring Setup;
                                                                CaptionML=[ENU=Monitoring Setup;
                                                                           NLD=Monitoringinstellingen];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Page;
                                                                RunObjectID=11117027;
                                                                ParentNodeID=[{3619BA7E-E937-4A07-A8AE-9604E03D1BAA}];
                                                                Visible=Yes;
                                                                NextNodeID=[{160C5655-1260-4CB0-B804-16A28A041E0E}];
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{160C5655-1260-4CB0-B804-16A28A041E0E}] ;Name=IN - Export Jobs;
                                                                CaptionML=[ENU=Export Jobs;
                                                                           NLD=Exporteeropdrachten];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Page;
                                                                RunObjectID=11117028;
                                                                ParentNodeID=[{3619BA7E-E937-4A07-A8AE-9604E03D1BAA}];
                                                                Visible=Yes;
                                                                NextNodeID=[{14AEA5FA-5C68-4BAA-B8C1-DB33717C3484}];
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{14AEA5FA-5C68-4BAA-B8C1-DB33717C3484}] ;Name=Log;
                                                                CaptionML=[ENU=Messages;
                                                                           NLD=Berichten];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Page;
                                                                RunObjectID=11117036;
                                                                ParentNodeID=[{3619BA7E-E937-4A07-A8AE-9604E03D1BAA}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Tasks }
    { MenuGroup      ;[{3AE95A0F-FC3C-4926-BA8C-5AFDD88B26B6}] ;Name=New Group;
                                                                CaptionML=[ENU=Import Management;
                                                                           NLD=Import Management];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                ParentNodeID=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                Visible=Yes;
                                                                NextNodeID=[{66C80545-7F39-4CF1-9C27-9C820ABC872A}];
                                                                FirstChild=[{D63FE6D3-0575-441B-847F-0439A21CDCF8}] }
    { MenuItem       ;[{FF16C5EE-C4AA-42CE-B7ED-27CCA97450CD}] ;Name=Synchronisation Inbox;
                                                                CaptionML=[ENU=Synchronization Inbox;
                                                                           NLD=Synchronisatie inbox];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Page;
                                                                RunObjectID=11117051;
                                                                ParentNodeID=[{3AE95A0F-FC3C-4926-BA8C-5AFDD88B26B6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{FE80D9F6-EB05-442F-B0CA-C3860F46A7B8}];
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{FE80D9F6-EB05-442F-B0CA-C3860F46A7B8}] ;Name=Log;
                                                                CaptionML=[ENU=Messages;
                                                                           NLD=Berichten];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Page;
                                                                RunObjectID=11117032;
                                                                ParentNodeID=[{3AE95A0F-FC3C-4926-BA8C-5AFDD88B26B6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{6A0184AC-968E-40A7-A627-D7E2B095A86A}];
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{6A0184AC-968E-40A7-A627-D7E2B095A86A}] ;Name=Comments;
                                                                CaptionML=[ENU=Comments;
                                                                           NLD=Opmerkingen];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Page;
                                                                RunObjectID=11117035;
                                                                ParentNodeID=[{3AE95A0F-FC3C-4926-BA8C-5AFDD88B26B6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Tasks }
    { MenuGroup      ;[{66C80545-7F39-4CF1-9C27-9C820ABC872A}] ;Name=New Group;
                                                                CaptionML=[ENU=Task Management;
                                                                           NLD=Taak Management];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                ParentNodeID=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                Visible=Yes;
                                                                NextNodeID=[{553CB687-9FC5-44D5-9AB5-4D92760E5E77}];
                                                                FirstChild=[{D7F7829E-7C46-42A1-9934-B82F7029E936}] }
    { MenuItem       ;[{D7F7829E-7C46-42A1-9934-B82F7029E936}] ;Name=Tasks;
                                                                CaptionML=[ENU=Tasks;
                                                                           NLD=Taken];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Page;
                                                                RunObjectID=11117042;
                                                                ParentNodeID=[{66C80545-7F39-4CF1-9C27-9C820ABC872A}];
                                                                Visible=Yes;
                                                                NextNodeID=[{269C7D83-E983-45D9-B24C-A6348E1DE0BD}];
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{269C7D83-E983-45D9-B24C-A6348E1DE0BD}] ;Name=Task Log;
                                                                CaptionML=[ENU=Task Log;
                                                                           NLD=Taakhistorie];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Page;
                                                                RunObjectID=11117047;
                                                                ParentNodeID=[{66C80545-7F39-4CF1-9C27-9C820ABC872A}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Tasks }
    { MenuGroup      ;[{46CEF40D-3471-4FAD-BF99-949B2994978C}] ;Name=New Group;
                                                                CaptionML=[ENU=Automatic Processing;
                                                                           NLD=Automatische verwerking];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                ParentNodeID=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                Visible=Yes;
                                                                NextNodeID=[{93883F2C-0B3D-44F0-860B-CDEC7E611A18}];
                                                                FirstChild=[{31D56A82-A90B-4681-B8AB-94BA58CCB1CB}] }
    { MenuItem       ;[{31D56A82-A90B-4681-B8AB-94BA58CCB1CB}] ;Name=Start MSMQ Handler;
                                                                CaptionML=[ENU=Start Handlers;
                                                                           NLD=Verwerkers starten];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Page;
                                                                RunObjectID=11117041;
                                                                ParentNodeID=[{46CEF40D-3471-4FAD-BF99-949B2994978C}];
                                                                Visible=Yes;
                                                                NextNodeID=[{7343D05A-6732-4467-BD50-CAB6642DF61F}];
                                                                DepartmentCategory=Tasks }
    { MenuGroup      ;[{7343D05A-6732-4467-BD50-CAB6642DF61F}] ;Name=New Group;
                                                                CaptionML=[ENU=Periodic Activities;
                                                                           NLD=Periodieke activiteiten];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                ParentNodeID=[{46CEF40D-3471-4FAD-BF99-949B2994978C}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                FirstChild=[{68983801-6EC4-4BB0-B233-76111084682B}] }
    { MenuItem       ;[{68983801-6EC4-4BB0-B233-76111084682B}] ;Name=Process Export Definitions;
                                                                CaptionML=[ENU=Process Export Definitions;
                                                                           NLD=Exportdefinities verwerken];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Report;
                                                                RunObjectID=11116999;
                                                                ParentNodeID=[{7343D05A-6732-4467-BD50-CAB6642DF61F}];
                                                                Visible=Yes;
                                                                NextNodeID=[{D364DDBA-3770-44A6-9745-92BBE9F22E90}];
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{D364DDBA-3770-44A6-9745-92BBE9F22E90}] ;Name=Process Open Export Jobs;
                                                                CaptionML=[ENU=Process Export Jobs;
                                                                           NLD=Exporteeropdrachten verwerken];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Report;
                                                                RunObjectID=11117000;
                                                                ParentNodeID=[{7343D05A-6732-4467-BD50-CAB6642DF61F}];
                                                                Visible=Yes;
                                                                NextNodeID=[{1E7E943E-4BDF-4BC6-8411-DB22BC749785}];
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{1E7E943E-4BDF-4BC6-8411-DB22BC749785}] ;Name=Process Import Definitions;
                                                                CaptionML=[ENU=Process Import Definitions;
                                                                           NLD=Importdefinities verwerken];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Report;
                                                                RunObjectID=11116998;
                                                                ParentNodeID=[{7343D05A-6732-4467-BD50-CAB6642DF61F}];
                                                                Visible=Yes;
                                                                NextNodeID=[{CC9DDA96-77E4-47B5-91E7-EA0A0CBA3937}];
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{CC9DDA96-77E4-47B5-91E7-EA0A0CBA3937}] ;Name=Locaties verwerken;
                                                                CaptionML=[ENU=Process Tranports;
                                                                           NLD=Transporten verwerken];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Report;
                                                                RunObjectID=11116997;
                                                                ParentNodeID=[{7343D05A-6732-4467-BD50-CAB6642DF61F}];
                                                                Visible=Yes;
                                                                NextNodeID=[{2970F72F-39D8-427A-8036-1C9BB3860BCB}];
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{2970F72F-39D8-427A-8036-1C9BB3860BCB}] ;Name=Execute Tasks;
                                                                CaptionML=[ENU=Process Tasks;
                                                                           NLD=Taken verwerken];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Report;
                                                                RunObjectID=11117005;
                                                                ParentNodeID=[{7343D05A-6732-4467-BD50-CAB6642DF61F}];
                                                                Visible=Yes;
                                                                NextNodeID=[{FB2C0B97-6A41-4D8D-A154-304D95946AEC}];
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{FB2C0B97-6A41-4D8D-A154-304D95946AEC}] ;Name=Process Sync. Inbox;
                                                                CaptionML=[ENU=Process Sync. Inbox;
                                                                           NLD=Sync. inbox verwerken];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Report;
                                                                RunObjectID=11117006;
                                                                ParentNodeID=[{7343D05A-6732-4467-BD50-CAB6642DF61F}];
                                                                Visible=Yes;
                                                                NextNodeID=[{B02F67FA-F7D2-4800-A7EA-3DFB163826E4}];
                                                                DepartmentCategory=Tasks }
    {                ;[{3F1D5EE3-5D38-4692-AC2F-E43C299726CF}] ;NextNodeID=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}] }
    { MenuGroup      ;[{553CB687-9FC5-44D5-9AB5-4D92760E5E77}] ;Name=New Group;
                                                                CaptionML=[ENU=Connector Management;
                                                                           NLD=Connector Management];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                ParentNodeID=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                Visible=Yes;
                                                                NextNodeID=[{3E826080-C11D-4CF2-A853-C38BBC727E27}];
                                                                FirstChild=[{E3638408-9FED-41CC-8EF8-EF87EE536750}] }
    { MenuItem       ;[{E3638408-9FED-41CC-8EF8-EF87EE536750}] ;Name=Folder Monitoring;
                                                                CaptionML=[ENU=Folder Monitoring;
                                                                           NLD=Foldermonitoring];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Page;
                                                                RunObjectID=11117005;
                                                                ParentNodeID=[{553CB687-9FC5-44D5-9AB5-4D92760E5E77}];
                                                                Visible=Yes;
                                                                NextNodeID=[{A10C4D50-189A-44D4-AA39-72764D87691A}];
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{2380F533-D1BF-4C5C-A29B-AE287805500C}] ;Name=Message Queues;
                                                                CaptionML=[ENU=Message Queues;
                                                                           NLD=Message Queue's];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Page;
                                                                RunObjectID=11117014;
                                                                ParentNodeID=[{553CB687-9FC5-44D5-9AB5-4D92760E5E77}];
                                                                Visible=Yes;
                                                                NextNodeID=[{A5913403-AE58-4862-B517-96718200E2A5}];
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{A10C4D50-189A-44D4-AA39-72764D87691A}] ;Name=Web Services;
                                                                CaptionML=[ENU=Web Services;
                                                                           NLD=Webservices];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Page;
                                                                RunObjectID=11117012;
                                                                ParentNodeID=[{553CB687-9FC5-44D5-9AB5-4D92760E5E77}];
                                                                Visible=Yes;
                                                                NextNodeID=[{2380F533-D1BF-4C5C-A29B-AE287805500C}];
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{B02F67FA-F7D2-4800-A7EA-3DFB163826E4}] ;Name=Start Connectors;
                                                                CaptionML=[ENU=Start Connectors;
                                                                           NLD=Connectoren starten];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Report;
                                                                RunObjectID=11117007;
                                                                ParentNodeID=[{7343D05A-6732-4467-BD50-CAB6642DF61F}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{D63FE6D3-0575-441B-847F-0439A21CDCF8}] ;Name=IN - XML Import Card;
                                                                CaptionML=[ENU=XML Definitions;
                                                                           NLD=XML Definities];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Page;
                                                                RunObjectID=11117001;
                                                                ParentNodeID=[{3AE95A0F-FC3C-4926-BA8C-5AFDD88B26B6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{12650CF9-9E03-4095-9316-A760ABDD654E}];
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{12650CF9-9E03-4095-9316-A760ABDD654E}] ;Name=IN - CSV Import Card;
                                                                CaptionML=[ENU=CSV Definitions;
                                                                           NLD=CSV Definities];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Page;
                                                                RunObjectID=11117002;
                                                                ParentNodeID=[{3AE95A0F-FC3C-4926-BA8C-5AFDD88B26B6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{67C90A68-5B5B-4780-8A46-06E7AFFBA58D}];
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{67C90A68-5B5B-4780-8A46-06E7AFFBA58D}] ;Name=IN - Fixed Width Import Card;
                                                                CaptionML=[ENU=Fixed Width Definitions;
                                                                           NLD=Fixed Width Definities];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Page;
                                                                RunObjectID=11117003;
                                                                ParentNodeID=[{3AE95A0F-FC3C-4926-BA8C-5AFDD88B26B6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{8F9906C0-AF47-4043-85CF-6C640A66098B}];
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{8F9906C0-AF47-4043-85CF-6C640A66098B}] ;Name=IN - Excel Import Card;
                                                                CaptionML=[ENU=Excel Definitions;
                                                                           NLD=Excel Definities];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Page;
                                                                RunObjectID=11117004;
                                                                ParentNodeID=[{3AE95A0F-FC3C-4926-BA8C-5AFDD88B26B6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{FF16C5EE-C4AA-42CE-B7ED-27CCA97450CD}];
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{A1B7B6C1-A1E5-4DA6-97EA-E0DD08295877}] ;Name=IN - XML Export Card;
                                                                CaptionML=[ENU=XML Definitions;
                                                                           NLD=XML Definities];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Page;
                                                                RunObjectID=11117006;
                                                                ParentNodeID=[{3619BA7E-E937-4A07-A8AE-9604E03D1BAA}];
                                                                Visible=Yes;
                                                                NextNodeID=[{2EF1110E-F32B-4C07-87EB-C44C54186F9B}];
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{2EF1110E-F32B-4C07-87EB-C44C54186F9B}] ;Name=IN - CSV Export Card;
                                                                CaptionML=[ENU=CSV Definitions;
                                                                           NLD=CSV Definities];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Page;
                                                                RunObjectID=11117007;
                                                                ParentNodeID=[{3619BA7E-E937-4A07-A8AE-9604E03D1BAA}];
                                                                Visible=Yes;
                                                                NextNodeID=[{C07B46EE-EB74-4E7E-BF4A-484CF931FD7D}];
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{C07B46EE-EB74-4E7E-BF4A-484CF931FD7D}] ;Name=IN - Fixed Width Export Card;
                                                                CaptionML=[ENU=Fixed Width Definitions;
                                                                           NLD=Fixed Width Definities];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Page;
                                                                RunObjectID=11117008;
                                                                ParentNodeID=[{3619BA7E-E937-4A07-A8AE-9604E03D1BAA}];
                                                                Visible=Yes;
                                                                NextNodeID=[{729AA9D5-ABD9-450E-9725-388919577CCA}];
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{729AA9D5-ABD9-450E-9725-388919577CCA}] ;Name=IN - Excel Export Card;
                                                                CaptionML=[ENU=Excel Definitions;
                                                                           NLD=Excel Definities];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Page;
                                                                RunObjectID=11117009;
                                                                ParentNodeID=[{3619BA7E-E937-4A07-A8AE-9604E03D1BAA}];
                                                                Visible=Yes;
                                                                NextNodeID=[{9A4B94AC-38A4-41F4-BB68-8FD0D8B3E08D}];
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{A5913403-AE58-4862-B517-96718200E2A5}] ;Name=Port Listner;
                                                                CaptionML=[ENU=Port Connectors;
                                                                           NLD=Poortconnectoren];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Page;
                                                                RunObjectID=11117016;
                                                                ParentNodeID=[{553CB687-9FC5-44D5-9AB5-4D92760E5E77}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{7B436721-86BA-4339-8F67-C5E429DBAFD0}] ;Name=IN - Relation Conditions;
                                                                CaptionML=[ENU=Relations;
                                                                           NLD=Relaties];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Page;
                                                                RunObjectID=11117029;
                                                                ParentNodeID=[{93883F2C-0B3D-44F0-860B-CDEC7E611A18}];
                                                                Visible=Yes;
                                                                NextNodeID=[{8A71DAB0-FD5B-443C-8B9D-AB1FE41E6E70}];
                                                                DepartmentCategory=Administration }
    { MenuGroup      ;[{3E826080-C11D-4CF2-A853-C38BBC727E27}] ;Name=New Group;
                                                                CaptionML=[ENU=Transport Management;
                                                                           NLD=Transportmanagement];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                ParentNodeID=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                Visible=Yes;
                                                                NextNodeID=[{CC20BD13-2168-4BEC-9402-149CB540A3D0}];
                                                                FirstChild=[{E32F01A8-58E2-4672-9F6D-5A4D05CBCF72}] }
    { MenuGroup      ;[{CC20BD13-2168-4BEC-9402-149CB540A3D0}] ;Name=New Group;
                                                                CaptionML=[ENU=Trace Management;
                                                                           NLD=Traceermanagement];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                ParentNodeID=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                Visible=Yes;
                                                                NextNodeID=[{46CEF40D-3471-4FAD-BF99-949B2994978C}];
                                                                FirstChild=[{A8817935-7517-46F2-8588-9B191120CCC2}] }
    { MenuItem       ;[{A8817935-7517-46F2-8588-9B191120CCC2}] ;Name=Trace Rules;
                                                                CaptionML=[ENU=Trace Rules;
                                                                           NLD=Traceerregels];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Page;
                                                                RunObjectID=11117017;
                                                                ParentNodeID=[{CC20BD13-2168-4BEC-9402-149CB540A3D0}];
                                                                Visible=Yes;
                                                                NextNodeID=[{6EABDF96-DB4C-4CD5-A8DC-896E3823393B}];
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{6EABDF96-DB4C-4CD5-A8DC-896E3823393B}] ;Name=Trace List;
                                                                CaptionML=[ENU=Trace Entries;
                                                                           NLD=Traceerposten];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Page;
                                                                RunObjectID=11117020;
                                                                ParentNodeID=[{CC20BD13-2168-4BEC-9402-149CB540A3D0}];
                                                                Visible=Yes;
                                                                NextNodeID=[{F59CC6EF-6164-4CAA-9C62-0E0DC78A56CD}];
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{E32F01A8-58E2-4672-9F6D-5A4D05CBCF72}] ;Name=IN - Transport Executable;
                                                                CaptionML=[ENU=FTP Upload;
                                                                           NLD=FTP Upload];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Page;
                                                                RunObjectID=11117023;
                                                                ParentNodeID=[{3E826080-C11D-4CF2-A853-C38BBC727E27}];
                                                                Visible=Yes;
                                                                NextNodeID=[{60A87D61-1EE4-4BDA-84F4-3CAACABA95D3}];
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{60A87D61-1EE4-4BDA-84F4-3CAACABA95D3}] ;Name=IN - Transport FTP Download;
                                                                CaptionML=[ENU=FTP Download;
                                                                           NLD=FTP Download];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Page;
                                                                RunObjectID=11117024;
                                                                ParentNodeID=[{3E826080-C11D-4CF2-A853-C38BBC727E27}];
                                                                Visible=Yes;
                                                                NextNodeID=[{FB241CB8-E8B2-4E5E-92BD-4071C211264E}];
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{FB241CB8-E8B2-4E5E-92BD-4071C211264E}] ;Name=IN - Transport Movement;
                                                                CaptionML=[ENU=Movement;
                                                                           NLD=Verplaatsen];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Page;
                                                                RunObjectID=11117025;
                                                                ParentNodeID=[{3E826080-C11D-4CF2-A853-C38BBC727E27}];
                                                                Visible=Yes;
                                                                NextNodeID=[{7A2DDE3F-F399-4B98-9D15-4E78032330D0}];
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{7A2DDE3F-F399-4B98-9D15-4E78032330D0}] ;Name=Transport Executable;
                                                                CaptionML=[ENU=Executable;
                                                                           NLD=Executable];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Page;
                                                                RunObjectID=11117026;
                                                                ParentNodeID=[{3E826080-C11D-4CF2-A853-C38BBC727E27}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{BAA19880-65B3-4BA2-BFEC-0143E42170A0}] ;Name=Functions;
                                                                CaptionML=[ENU=Functions;
                                                                           NLD=Functies];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Page;
                                                                RunObjectID=11148591;
                                                                ParentNodeID=[{93883F2C-0B3D-44F0-860B-CDEC7E611A18}];
                                                                Visible=Yes;
                                                                NextNodeID=[{17F65248-697F-449A-BC26-5D2E54F03094}];
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{F59CC6EF-6164-4CAA-9C62-0E0DC78A56CD}] ;Name=Trace Messages;
                                                                CaptionML=[ENU=Trace Messages;
                                                                           NLD=Traceerberichten];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Page;
                                                                RunObjectID=11117048;
                                                                ParentNodeID=[{CC20BD13-2168-4BEC-9402-149CB540A3D0}];
                                                                Visible=Yes;
                                                                NextNodeID=[{99FFEED3-C64A-4AC9-A839-46D8BA316076}];
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{99FFEED3-C64A-4AC9-A839-46D8BA316076}] ;Name=Apply Rules;
                                                                CaptionML=[ENU=Apply Rules;
                                                                           NLD=Regels toepassen];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Codeunit;
                                                                RunObjectID=11148642;
                                                                ParentNodeID=[{CC20BD13-2168-4BEC-9402-149CB540A3D0}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Tasks }
    { MenuGroup      ;[{17F65248-697F-449A-BC26-5D2E54F03094}] ;Name=Periodic Activities;
                                                                CaptionML=[ENU=Periodic Activities;
                                                                           NLD=Periodieke activiteiten];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                ParentNodeID=[{93883F2C-0B3D-44F0-860B-CDEC7E611A18}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                FirstChild=[{0160F8E9-26DF-423E-B1AE-5E4F4BCCF72C}];
                                                                IsDepartmentPage=Yes }
    { MenuItem       ;[{0160F8E9-26DF-423E-B1AE-5E4F4BCCF72C}] ;Name=Log opschonen;
                                                                CaptionML=[ENU=Delete Logs;
                                                                           NLD=Log opschonen];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Report;
                                                                RunObjectID=11117009;
                                                                ParentNodeID=[{17F65248-697F-449A-BC26-5D2E54F03094}];
                                                                Visible=Yes;
                                                                NextNodeID=[{1ADF2043-9738-449E-8FF5-CDB55074F0C4}];
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{1ADF2043-9738-449E-8FF5-CDB55074F0C4}] ;Name=Paden vervangen;
                                                                CaptionML=[ENU=Replace Paths;
                                                                           NLD=Paden vervangen];
                                                                MemberOfMenu=[{A643DF52-BEA4-4592-AEFD-83CE5E913AFC}];
                                                                RunObjectType=Report;
                                                                RunObjectID=11117010;
                                                                ParentNodeID=[{17F65248-697F-449A-BC26-5D2E54F03094}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Administration }
  }
}
OBJECT Page 11116997 CI - ConnectIT Setup
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=ConnectIT Setup;
               NLD=ConnectIT-instellingen];
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table11148589;
    PageType=Card;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Setup;
                                NLD=Nieuw,Verwerken,Lijst,Instellingen];
    OnOpenPage=VAR
                 Initialize@1000000 : Codeunit 11148625;
               BEGIN
                 Initialize.CheckInitialize;
                 RESET;
                 FINDFIRST;
                 IF DataChangeSetup.GET THEN
                   ;
               END;

    OnAfterGetRecord=VAR
                       Management@1000 : Codeunit 11148589;
                     BEGIN
                       // CI-176.begin
                       CASE "Temp Directory" = '' OF
                         FALSE: TempDirectory := Management.TmpDir;
                         TRUE: TempDirectory := STRSUBSTNO('<%1>', Management.TmpDir);
                       END;
                       // CI-176.end
                     END;

    ActionList=ACTIONS
    {
      { 1000000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000030 ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NLD=F&uncties] }
      { 1000033 ;2   ;Action    ;
                      CaptionML=[ENU=Create Roles;
                                 NLD=Rollen aanmaken];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Lock;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 Initialize@1000000 : Codeunit 11148625;
                                 ctRolesCreated@1000002 : TextConst 'ENU=Roles created.;NLD=Rollen zijn aangemaakt.';
                               BEGIN
                                 Initialize.CreateRoles;
                                 MESSAGE(ctRolesCreated);
                               END;
                                }
      { 1000000000;2 ;Action    ;
                      CaptionML=[ENU=&Install ConnectIT Web Services;
                                 NLD=ConnectIT Web Services &installeren];
                      RunObject=Codeunit 11148647;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Setup;
                      PromotedCategory=Category4 }
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000004 ;1   ;ActionGroup;
                      CaptionML=[ENU=&Monitoring;
                                 NLD=&Monitoren] }
      { 1000005 ;2   ;Action    ;
                      CaptionML=[ENU=Tables;
                                 NLD=&Tabellen];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=SetupList;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ChangeLogSetupList@1000 : Page 11148609;
                               BEGIN
                                 ChangeLogSetupList.SetSource;
                                 ChangeLogSetupList.RUNMODAL;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                CaptionML=[ENU=General;
                           NLD=Algemeen] }

    { 1000006;2;Field     ;
                SourceExpr="Confirm Overwrite" }

    { 1000012;2;Field     ;
                SourceExpr="Captions of Fields and Tables" }

    { 1000026;2;Field     ;
                SourceExpr="Use Captions in Tag Names" }

    { 1000008;2;Field     ;
                SourceExpr="XML Declaration" }

    { 1000014;2;Field     ;
                SourceExpr="FTP Executable" }

    { 1000010;2;Field     ;
                SourceExpr="Seconds Between Execute Task" }

    { 1000022;2;Field     ;
                SourceExpr="Seconds Between Inbox Exec." }

    { 1000031;2;Field     ;
                SourceExpr="Seconds Betw. Check Conn. Han." }

    { 1100543000;2;Field  ;
                SourceExpr="Custom Function Codeunit";
                LookupPageID=IN - Objects }

    { 1901898801;1;Group  ;
                CaptionML=[ENU=Folders;
                           NLD=Mappen] }

    { 1000024;2;Field     ;
                CaptionML=[ENU=Temp Directory;
                           NLD=Tempmap];
                SourceExpr=TempDirectory;
                OnValidate=BEGIN
                             // CI-176.begin
                             VALIDATE("Temp Directory", TempDirectory);
                             CurrPage.UPDATE(TRUE);
                             // CI-176.end
                           END;
                            }

    { 1000028;2;Field     ;
                SourceExpr="Default Export Location";
                OnLookup=VAR
                           Mgt@1000003 : Codeunit 11148589;
                           NewFolder@1000002 : Text[250];
                         BEGIN
                           NewFolder := Mgt.BrowseForFolder('', '');
                           IF NewFolder <> '' THEN
                             "Default Export Location" := NewFolder;
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder("Default Export Location");
                             END;
                              }

    { 1100531002;2;Field  ;
                SourceExpr="Default Import Location";
                OnLookup=VAR
                           Mgt@1000003 : Codeunit 11148589;
                           NewFolder@1000002 : Text[250];
                         BEGIN
                           NewFolder := Mgt.BrowseForFolder('', '');
                           IF NewFolder <> '' THEN
                             "Default Import Location" := NewFolder;
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder("Default Import Location");
                             END;
                              }

    { 1000000001;2;Field  ;
                SourceExpr="Default Processed Path" }

    { 1000000002;2;Field  ;
                SourceExpr="Default Error Path" }

    { 1000000003;2;Field  ;
                SourceExpr="Default Log Path" }

    { 1905180301;1;Group  ;
                CaptionML=[ENU=Message Queue;
                           NLD=Message Queue] }

    { 1000020;2;Field     ;
                SourceExpr="Document Id Node" }

    { 1000016;2;Field     ;
                SourceExpr="Request Queue" }

    { 1000018;2;Field     ;
                SourceExpr="Reply Queue" }

    { 1905243201;1;Group  ;
                CaptionML=[ENU=Monitoring;
                           NLD=Monitoren] }

    { 1000002;2;Field     ;
                CaptionML=[ENU=Activate Change Log;
                           NLD=Activeer wijzigingslogbestand];
                SourceExpr=DataChangeSetup."Data Change Activated";
                OnValidate=BEGIN
                             IF NOT DataChangeSetup.MODIFY(TRUE) THEN BEGIN
                               DataChangeSetup.INSERT(TRUE);
                               DataChangeSetup.VALIDATE("Data Change Activated", TRUE);
                               DataChangeSetup.MODIFY(TRUE);
                             END;
                           END;
                            }

    { 1100531000;2;Field  ;
                SourceExpr="Save Trace Entries" }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=Advanced;
                           NLD=Geavanceerd];
                GroupType=Group }

    { 2   ;2   ;Field     ;
                SourceExpr="Use Error Handling" }

    { 3   ;2   ;Field     ;
                SourceExpr="Debugging Entries in Event Log" }

  }
  CODE
  {
    VAR
      DataChangeSetup@1001 : Record 11148638;
      TempDirectory@1000 : Text[250];

    LOCAL PROCEDURE DefaultExportLocationOnAfterIn@19044468(VAR Text@19044469 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFolder(Text);
    END;

    LOCAL PROCEDURE DefaultImportLocationOnAfterIn@19052567(VAR Text@19052568 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFolder(Text);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11116998 CI - Transport List
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Transport List;
               NLD=Transportoverzicht];
    SourceTable=Table11148590;
    PageType=List;
    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000024 ;1   ;ActionGroup;
                      CaptionML=[ENU=T&ransport;
                                 NLD=&Transport] }
      { 1000025 ;2   ;Action    ;
                      ShortCutKey=Shift+F5;
                      CaptionML=[ENU=Card;
                                 NLD=Kaart];
                      OnAction=BEGIN
                                 ShowCard;
                               END;
                                }
      { 1000005 ;2   ;Separator  }
      { 1000006 ;2   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Process;
                                 NLD=Verwerken];
                      OnAction=BEGIN
                                 Process(TRUE);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr=Code }

    { 1000003;2;Field     ;
                SourceExpr=Description }

    { 1000019;2;Field     ;
                SourceExpr="Project Code" }

    { 1000011;2;Field     ;
                SourceExpr=Status }

    { 1000007;2;Field     ;
                SourceExpr=Type }

    { 1000009;2;Field     ;
                SourceExpr=Address }

    { 1   ;2   ;Field     ;
                SourceExpr="Custom Port" }

    { 1000015;2;Field     ;
                SourceExpr="From Location" }

    { 1000017;2;Field     ;
                SourceExpr="To Location" }

    { 1000013;2;Field     ;
                SourceExpr="Transfer Mode" }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117000 CI - Import Definition List
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Import Definition List;
               NLD=Importdefinitieoverzicht];
    SourceTable=Table11148591;
    PageType=List;
    OnAfterGetRecord=BEGIN
                       MainTableNoOnFormat(FORMAT("Main Table No."));
                       SubTableNoOnFormat(FORMAT("Sub Table No."));
                     END;

    ActionList=ACTIONS
    {
      { 1000000000;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000012 ;1   ;Action    ;
                      ShortCutKey=Shift+F5;
                      CaptionML=[ENU=Card;
                                 NLD=Kaart];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=View;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ShowCard;
                               END;
                                }
      { 1000022 ;1   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Process;
                                 NLD=Verwerken];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Process;
                               END;
                                }
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000011 ;1   ;ActionGroup;
                      CaptionML=[ENU=&Import Def.;
                                 NLD=&Importdef.] }
      { 1000014 ;2   ;Action    ;
                      ShortCutKey=Ctrl+F5;
                      CaptionML=[ENU=Messages;
                                 NLD=Berichten];
                      RunObject=Page 11117032;
                      RunPageView=SORTING(Type,Code);
                      RunPageLink=Type=CONST(Import),
                                  Code=FIELD(Code);
                      Promoted=Yes;
                      Image=Note;
                      PromotedCategory=Process }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr=Code }

    { 1000003;2;Field     ;
                SourceExpr=Description }

    { 1000023;2;Field     ;
                SourceExpr="Project Code" }

    { 1100512000;2;Field  ;
                SourceExpr="File Format" }

    { 1000005;2;Field     ;
                SourceExpr=Location;
                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder(Location);
                             END;
                              }

    { 1000017;2;Field     ;
                SourceExpr=Filename }

    { 1000007;2;Field     ;
                SourceExpr="Processed Location";
                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder("Processed Location");
                             END;
                              }

    { 1000009;2;Field     ;
                SourceExpr="Log Location";
                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder("Log Location");
                             END;
                              }

    { 1000015;2;Field     ;
                SourceExpr=Status }

    { 1100512002;2;Field  ;
                SourceExpr="Main Table No.";
                OnLookup=VAR
                           Mgt@1100512000 : Codeunit 11148589;
                         BEGIN
                           EXIT(Mgt.LookupTableNo(Text));
                         END;
                          }

    { 1100512004;2;Field  ;
                SourceExpr="Sub Table No.";
                OnLookup=VAR
                           Mgt@1100512000 : Codeunit 11148589;
                         BEGIN
                           EXIT(Mgt.LookupTableNo(Text));
                         END;
                          }

  }
  CODE
  {

    LOCAL PROCEDURE MainTableNoOnAfterInput@19047063(VAR Text@19047064 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE SubTableNoOnAfterInput@19065603(VAR Text@19065604 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE MainTableNoOnFormat@19079044(Text@19015475 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Main Table No.");
    END;

    LOCAL PROCEDURE SubTableNoOnFormat@19052089(Text@19075565 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Sub Table No.");
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117001 CI - XML Import Def. List
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Import Definition List;
               NLD=Importdefinitieoverzicht];
    SourceTable=Table11148591;
    SourceTableView=SORTING(Code)
                    WHERE(File Format=CONST(XML));
    PageType=List;
    CardPageID=CI - XML Import Card;
    OnAfterGetRecord=BEGIN
                       MainTableNoOnFormat(FORMAT("Main Table No."));
                       SubTableNoOnFormat(FORMAT("Sub Table No."));
                     END;

    ActionList=ACTIONS
    {
      { 1000000000;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000022 ;1   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Process;
                                 NLD=Verwerken];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Process;
                               END;
                                }
      { 1000000001;1 ;Action    ;
                      Name=<Action1000087>;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Import Definition from XML;
                                 NLD=XML-Definitie &importeren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Import;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ImportXMLDefinition@1000000 : Codeunit 11148636;
                               BEGIN
                                 ImportXMLDefinition.ImportImportDefinition(Rec);
                               END;
                                }
      { 1000000002;1 ;Action    ;
                      Name=<Action1000083>;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Export Definition to &XML;
                                 NLD=Definitie exporteren naar &XML];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Export;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ExportDefinitionXML@1000000 : Codeunit 11148634;
                               BEGIN
                                 ExportDefinitionXML.ExportImportDefinition(Rec);
                               END;
                                }
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000011 ;1   ;ActionGroup;
                      CaptionML=[ENU=&Import Def.;
                                 NLD=&Importdef.] }
      { 1000014 ;2   ;Action    ;
                      ShortCutKey=Ctrl+F5;
                      CaptionML=[ENU=Messages;
                                 NLD=Berichten];
                      RunObject=Page 11117032;
                      RunPageView=SORTING(Type,Code);
                      RunPageLink=Type=CONST(Import),
                                  Code=FIELD(Code);
                      Promoted=Yes;
                      Image=Note;
                      PromotedCategory=Process }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr=Code }

    { 1000003;2;Field     ;
                SourceExpr=Description }

    { 1000023;2;Field     ;
                SourceExpr="Project Code" }

    { 1100512000;2;Field  ;
                SourceExpr="File Format" }

    { 1000005;2;Field     ;
                SourceExpr=Location;
                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder(Location);
                             END;
                              }

    { 1000017;2;Field     ;
                SourceExpr=Filename }

    { 1000007;2;Field     ;
                SourceExpr="Processed Location";
                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder("Processed Location");
                             END;
                              }

    { 1000009;2;Field     ;
                SourceExpr="Log Location";
                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder("Log Location");
                             END;
                              }

    { 1000015;2;Field     ;
                SourceExpr=Status }

    { 1100512002;2;Field  ;
                SourceExpr="Main Table No.";
                OnLookup=VAR
                           Mgt@1100512000 : Codeunit 11148589;
                         BEGIN
                           EXIT(Mgt.LookupTableNo(Text));
                         END;
                          }

    { 1100512004;2;Field  ;
                SourceExpr="Sub Table No.";
                OnLookup=VAR
                           Mgt@1100512000 : Codeunit 11148589;
                         BEGIN
                           EXIT(Mgt.LookupTableNo(Text));
                         END;
                          }

  }
  CODE
  {

    LOCAL PROCEDURE MainTableNoOnAfterInput@19047063(VAR Text@19047064 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE SubTableNoOnAfterInput@19065603(VAR Text@19065604 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE MainTableNoOnFormat@19079044(Text@19015475 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Main Table No.");
    END;

    LOCAL PROCEDURE SubTableNoOnFormat@19052089(Text@19075565 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Sub Table No.");
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117002 CI - CSV Import Def. List
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Import Definition List;
               NLD=Importdefinitieoverzicht];
    SourceTable=Table11148591;
    SourceTableView=SORTING(Code)
                    WHERE(File Format=CONST(CSV));
    PageType=List;
    CardPageID=CI - CSV Import Card;
    OnAfterGetRecord=BEGIN
                       MainTableNoOnFormat(FORMAT("Main Table No."));
                       SubTableNoOnFormat(FORMAT("Sub Table No."));
                     END;

    ActionList=ACTIONS
    {
      { 1000000000;  ;ActionContainer;
                      Name=<Action1000000000>;
                      ActionContainerType=ActionItems }
      { 1000022 ;1   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Process;
                                 NLD=Verwerken];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Process;
                               END;
                                }
      { 1000000001;1 ;Action    ;
                      Name=<Action1000087>;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Import Definition from XML;
                                 NLD=XML-Definitie &importeren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Import;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ImportXMLDefinition@1000000 : Codeunit 11148636;
                               BEGIN
                                 ImportXMLDefinition.ImportImportDefinition(Rec);
                               END;
                                }
      { 1000000002;1 ;Action    ;
                      Name=<Action1000083>;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Export Definition to &XML;
                                 NLD=Definitie exporteren naar &XML];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Export;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ExportDefinitionToXML@1000000 : Codeunit 11148634;
                               BEGIN
                                 ExportDefinitionToXML.ExportImportDefinition(Rec);
                               END;
                                }
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000011 ;1   ;ActionGroup;
                      CaptionML=[ENU=&Import Def.;
                                 NLD=&Importdef.] }
      { 1000014 ;2   ;Action    ;
                      ShortCutKey=Ctrl+F5;
                      CaptionML=[ENU=Messages;
                                 NLD=Berichten];
                      RunObject=Page 11117032;
                      RunPageView=SORTING(Type,Code);
                      RunPageLink=Type=CONST(Import),
                                  Code=FIELD(Code);
                      Promoted=Yes;
                      Image=Note;
                      PromotedCategory=Process }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr=Code }

    { 1000003;2;Field     ;
                SourceExpr=Description }

    { 1000023;2;Field     ;
                SourceExpr="Project Code" }

    { 1100512000;2;Field  ;
                SourceExpr="File Format" }

    { 1000005;2;Field     ;
                SourceExpr=Location;
                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder(Location);
                             END;
                              }

    { 1000017;2;Field     ;
                SourceExpr=Filename }

    { 1000007;2;Field     ;
                SourceExpr="Processed Location";
                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder("Processed Location");
                             END;
                              }

    { 1000009;2;Field     ;
                SourceExpr="Log Location";
                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder("Log Location");
                             END;
                              }

    { 1000015;2;Field     ;
                SourceExpr=Status }

    { 1100512002;2;Field  ;
                SourceExpr="Main Table No.";
                OnLookup=VAR
                           Mgt@1100512000 : Codeunit 11148589;
                         BEGIN
                           EXIT(Mgt.LookupTableNo(Text));
                         END;
                          }

    { 1100512004;2;Field  ;
                SourceExpr="Sub Table No.";
                OnLookup=VAR
                           Mgt@1100512000 : Codeunit 11148589;
                         BEGIN
                           EXIT(Mgt.LookupTableNo(Text));
                         END;
                          }

  }
  CODE
  {

    LOCAL PROCEDURE MainTableNoOnAfterInput@19047063(VAR Text@19047064 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE SubTableNoOnAfterInput@19065603(VAR Text@19065604 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE MainTableNoOnFormat@19079044(Text@19015475 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Main Table No.");
    END;

    LOCAL PROCEDURE SubTableNoOnFormat@19052089(Text@19075565 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Sub Table No.");
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117003 CI - Fixed Width Imp.Def. List
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Import Definition List;
               NLD=Importdefinitieoverzicht];
    SourceTable=Table11148591;
    SourceTableView=SORTING(Code)
                    WHERE(File Format=CONST(Fixed Width));
    PageType=List;
    CardPageID=CI - Fixed Width Import Card;
    OnAfterGetRecord=BEGIN
                       MainTableNoOnFormat(FORMAT("Main Table No."));
                       SubTableNoOnFormat(FORMAT("Sub Table No."));
                     END;

    ActionList=ACTIONS
    {
      { 1000000000;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000022 ;1   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Process;
                                 NLD=Verwerken];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Process;
                               END;
                                }
      { 1000000001;1 ;Action    ;
                      Name=<Action1000087>;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Import Definition from XML;
                                 NLD=XML-Definitie &importeren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Import;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ImportXMLDefinition@1000000 : Codeunit 11148636;
                               BEGIN
                                 ImportXMLDefinition.ImportImportDefinition(Rec);
                               END;
                                }
      { 1000000002;1 ;Action    ;
                      Name=<Action1000083>;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Export Definition to &XML;
                                 NLD=Definitie exporteren naar &XML];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Export;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ExportDefinitionToXML@1000000 : Codeunit 11148634;
                               BEGIN
                                 ExportDefinitionToXML.ExportImportDefinition(Rec);
                               END;
                                }
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000011 ;1   ;ActionGroup;
                      CaptionML=[ENU=&Import Def.;
                                 NLD=&Importdef.] }
      { 1000014 ;2   ;Action    ;
                      ShortCutKey=Ctrl+F5;
                      CaptionML=[ENU=Messages;
                                 NLD=Berichten];
                      RunObject=Page 11117032;
                      RunPageView=SORTING(Type,Code);
                      RunPageLink=Type=CONST(Import),
                                  Code=FIELD(Code);
                      Promoted=Yes;
                      Image=Note;
                      PromotedCategory=Process }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr=Code }

    { 1000003;2;Field     ;
                SourceExpr=Description }

    { 1000023;2;Field     ;
                SourceExpr="Project Code" }

    { 1100512000;2;Field  ;
                SourceExpr="File Format" }

    { 1000005;2;Field     ;
                SourceExpr=Location;
                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder(Location);
                             END;
                              }

    { 1000017;2;Field     ;
                SourceExpr=Filename }

    { 1000007;2;Field     ;
                SourceExpr="Processed Location";
                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder("Processed Location");
                             END;
                              }

    { 1000009;2;Field     ;
                SourceExpr="Log Location";
                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder("Log Location");
                             END;
                              }

    { 1000015;2;Field     ;
                SourceExpr=Status }

    { 1100512002;2;Field  ;
                SourceExpr="Main Table No.";
                OnLookup=VAR
                           Mgt@1100512000 : Codeunit 11148589;
                         BEGIN
                           EXIT(Mgt.LookupTableNo(Text));
                         END;
                          }

    { 1100512004;2;Field  ;
                SourceExpr="Sub Table No.";
                OnLookup=VAR
                           Mgt@1100512000 : Codeunit 11148589;
                         BEGIN
                           EXIT(Mgt.LookupTableNo(Text));
                         END;
                          }

  }
  CODE
  {

    LOCAL PROCEDURE MainTableNoOnAfterInput@19047063(VAR Text@19047064 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE SubTableNoOnAfterInput@19065603(VAR Text@19065604 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE MainTableNoOnFormat@19079044(Text@19015475 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Main Table No.");
    END;

    LOCAL PROCEDURE SubTableNoOnFormat@19052089(Text@19075565 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Sub Table No.");
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117004 CI - Excel Import Def. List
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Import Definition List;
               NLD=Importdefinitieoverzicht];
    SourceTable=Table11148591;
    SourceTableView=SORTING(Code)
                    WHERE(File Format=CONST(Excel));
    PageType=List;
    CardPageID=CI - Excel Import Card;
    OnAfterGetRecord=BEGIN
                       MainTableNoOnFormat(FORMAT("Main Table No."));
                       SubTableNoOnFormat(FORMAT("Sub Table No."));
                     END;

    ActionList=ACTIONS
    {
      { 1000000000;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000022 ;1   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Process;
                                 NLD=Verwerken];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Process;
                               END;
                                }
      { 1000000001;1 ;Action    ;
                      Name=<Action1000087>;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Import Definition from XML;
                                 NLD=XML-Definitie &importeren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Import;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ImportXMLDefinition@1000000 : Codeunit 11148636;
                               BEGIN
                                 ImportXMLDefinition.ImportImportDefinition(Rec);
                               END;
                                }
      { 1000000002;1 ;Action    ;
                      Name=<Action1000083>;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Export Definition to &XML;
                                 NLD=Definitie exporteren naar &XML];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Export;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ExportDefinitionToXML@1000000 : Codeunit 11148634;
                               BEGIN
                                 ExportDefinitionToXML.ExportImportDefinition(Rec);
                               END;
                                }
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000011 ;1   ;ActionGroup;
                      CaptionML=[ENU=&Import Def.;
                                 NLD=&Importdef.] }
      { 1000014 ;2   ;Action    ;
                      ShortCutKey=Ctrl+F5;
                      CaptionML=[ENU=Messages;
                                 NLD=Berichten];
                      RunObject=Page 11117032;
                      RunPageView=SORTING(Type,Code);
                      RunPageLink=Type=CONST(Import),
                                  Code=FIELD(Code);
                      Promoted=Yes;
                      Image=Note;
                      PromotedCategory=Process }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr=Code }

    { 1000003;2;Field     ;
                SourceExpr=Description }

    { 1000023;2;Field     ;
                SourceExpr="Project Code" }

    { 1100512000;2;Field  ;
                SourceExpr="File Format" }

    { 1000005;2;Field     ;
                SourceExpr=Location;
                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder(Location);
                             END;
                              }

    { 1000017;2;Field     ;
                SourceExpr=Filename }

    { 1000007;2;Field     ;
                SourceExpr="Processed Location";
                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder("Processed Location");
                             END;
                              }

    { 1000009;2;Field     ;
                SourceExpr="Log Location";
                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder("Log Location");
                             END;
                              }

    { 1000015;2;Field     ;
                SourceExpr=Status }

    { 1100512002;2;Field  ;
                SourceExpr="Main Table No.";
                OnLookup=VAR
                           Mgt@1100512000 : Codeunit 11148589;
                         BEGIN
                           EXIT(Mgt.LookupTableNo(Text));
                         END;
                          }

    { 1100512004;2;Field  ;
                SourceExpr="Sub Table No.";
                OnLookup=VAR
                           Mgt@1100512000 : Codeunit 11148589;
                         BEGIN
                           EXIT(Mgt.LookupTableNo(Text));
                         END;
                          }

  }
  CODE
  {

    LOCAL PROCEDURE MainTableNoOnAfterInput@19047063(VAR Text@19047064 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE SubTableNoOnAfterInput@19065603(VAR Text@19065604 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE MainTableNoOnFormat@19079044(Text@19015475 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Main Table No.");
    END;

    LOCAL PROCEDURE SubTableNoOnFormat@19052089(Text@19075565 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Sub Table No.");
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117005 CI - Folder Monitor List
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Connector List;
               NLD=Connectorenoverzicht];
    SourceTable=Table11148623;
    SourceTableView=SORTING(Code)
                    WHERE(Type=CONST(File System));
    PageType=List;
    CardPageID=CI - Folder Monitoring Card;
    ActionList=ACTIONS
    {
      { 1900000003;  ;ActionContainer;
                      Name=<Action1900000003>;
                      ActionContainerType=ActionItems }
      { 1000012 ;1   ;ActionGroup;
                      CaptionML=[ENU=&Connector;
                                 NLD=&Connector] }
      { 1000017 ;2   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Start;
                                 NLD=Start];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Start;
                               END;
                                }
      { 1000018 ;2   ;Action    ;
                      ShortCutKey=Shift+F11;
                      CaptionML=[ENU=S&top;
                                 NLD=S&top];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Cancel;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Stop;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr=Code }

    { 1000003;2;Field     ;
                SourceExpr=Description }

    { 1000005;2;Field     ;
                SourceExpr=Type }

    { 1000019;2;Field     ;
                CaptionML=[ENU=Active;
                           NLD=Aktief];
                SourceExpr=IsActive }

    { 1000010;2;Field     ;
                SourceExpr=Status }

    { 1000000000;2;Field  ;
                SourceExpr=Folder }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117006 CI - XML Export Def. List
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Export Definition List;
               NLD=Exportdefinitieoverzicht];
    SourceTable=Table11148599;
    SourceTableView=SORTING(Code)
                    WHERE(File Format=CONST(XML));
    PageType=List;
    CardPageID=CI - XML Export Card;
    OnAfterGetRecord=BEGIN
                       MainTableNoOnFormat(FORMAT("Main Table No."));
                       SubTableNoOnFormat(FORMAT("Sub Table No."));
                     END;

    ActionList=ACTIONS
    {
      { 1000000000;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000013 ;1   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Process;
                                 NLD=Verwerken];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Process;
                               END;
                                }
      { 1000000001;1 ;Action    ;
                      Name=<Action1000090>;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Import Definition from XML;
                                 NLD=XML-Definitie &importeren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Import;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ImportXMLDefinition@1000000 : Codeunit 11148636;
                               BEGIN
                                 ImportXMLDefinition.ImportExportDefinition(Rec);
                               END;
                                }
      { 1000000002;1 ;Action    ;
                      Name=<Action1000088>;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Export Definition to &XML;
                                 NLD=Definitie exporteren naar &XML];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Export;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ExportDefinitionToXML@1000000 : Codeunit 11148634;
                               BEGIN
                                 ExportDefinitionToXML.ExportExportDefinition(Rec);
                               END;
                                }
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000011 ;1   ;ActionGroup;
                      CaptionML=[ENU=Export &Def.;
                                 NLD=&Exportdef.] }
      { 1000007 ;2   ;Action    ;
                      ShortCutKey=Ctrl+F5;
                      CaptionML=[ENU=Messages;
                                 NLD=Berichten];
                      RunObject=Page 11117032;
                      RunPageView=SORTING(Type,Code);
                      RunPageLink=Type=CONST(Export),
                                  Code=FIELD(Code);
                      Promoted=Yes;
                      Image=Note;
                      PromotedCategory=Process }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr=Code }

    { 1000003;2;Field     ;
                SourceExpr=Description }

    { 1000009;2;Field     ;
                SourceExpr="Project Code" }

    { 1100512008;2;Field  ;
                SourceExpr="File Format" }

    { 1000005;2;Field     ;
                SourceExpr=Location;
                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder(Location);
                             END;
                              }

    { 1000017;2;Field     ;
                SourceExpr=Filename }

    { 1000015;2;Field     ;
                SourceExpr=Status }

    { 1100512000;2;Field  ;
                SourceExpr=Synchronize }

    { 1100512002;2;Field  ;
                SourceExpr="Main Table No.";
                OnLookup=VAR
                           Mgt@1100512000 : Codeunit 11148589;
                         BEGIN
                           EXIT(Mgt.LookupTableNo(Text));
                         END;
                          }

    { 1100512004;2;Field  ;
                SourceExpr="Sub Table No.";
                OnLookup=VAR
                           Mgt@1100512000 : Codeunit 11148589;
                         BEGIN
                           EXIT(Mgt.LookupTableNo(Text));
                         END;
                          }

    { 1100512006;2;Field  ;
                SourceExpr="Run Task" }

  }
  CODE
  {

    LOCAL PROCEDURE MainTableNoOnAfterInput@19047063(VAR Text@19047064 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE SubTableNoOnAfterInput@19065603(VAR Text@19065604 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE MainTableNoOnFormat@19079044(Text@19015475 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Main Table No.");
    END;

    LOCAL PROCEDURE SubTableNoOnFormat@19052089(Text@19075565 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Sub Table No.");
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117007 CI - CSV Export Def. List
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Export Definition List;
               NLD=Exportdefinitieoverzicht];
    SourceTable=Table11148599;
    SourceTableView=SORTING(Code)
                    WHERE(File Format=CONST(CSV));
    PageType=List;
    CardPageID=CI - CSV Export Card;
    OnAfterGetRecord=BEGIN
                       MainTableNoOnFormat(FORMAT("Main Table No."));
                       SubTableNoOnFormat(FORMAT("Sub Table No."));
                     END;

    ActionList=ACTIONS
    {
      { 1000000000;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000013 ;1   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Process;
                                 NLD=Verwerken];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Process;
                               END;
                                }
      { 1000000001;1 ;Action    ;
                      Name=<Action1000090>;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Import Definition from XML;
                                 NLD=XML-Definitie &importeren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Import;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ImportXMLDefinition@1000000 : Codeunit 11148636;
                               BEGIN
                                 ImportXMLDefinition.ImportExportDefinition(Rec);
                               END;
                                }
      { 1000000002;1 ;Action    ;
                      Name=<Action1000088>;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Export Definition to &XML;
                                 NLD=Definitie exporteren naar &XML];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Export;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ExportDefinitionToXML@1000000 : Codeunit 11148634;
                               BEGIN
                                 ExportDefinitionToXML.ExportExportDefinition(Rec);
                               END;
                                }
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000011 ;1   ;ActionGroup;
                      CaptionML=[ENU=Export &Def.;
                                 NLD=&Exportdef.] }
      { 1000007 ;2   ;Action    ;
                      ShortCutKey=Ctrl+F5;
                      CaptionML=[ENU=Messages;
                                 NLD=Berichten];
                      RunObject=Page 11117032;
                      RunPageView=SORTING(Type,Code);
                      RunPageLink=Type=CONST(Export),
                                  Code=FIELD(Code);
                      Promoted=Yes;
                      Image=Note;
                      PromotedCategory=Process }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr=Code }

    { 1000003;2;Field     ;
                SourceExpr=Description }

    { 1000009;2;Field     ;
                SourceExpr="Project Code" }

    { 1100512008;2;Field  ;
                SourceExpr="File Format" }

    { 1000005;2;Field     ;
                SourceExpr=Location;
                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder(Location);
                             END;
                              }

    { 1000017;2;Field     ;
                SourceExpr=Filename }

    { 1000015;2;Field     ;
                SourceExpr=Status }

    { 1100512000;2;Field  ;
                SourceExpr=Synchronize }

    { 1100512002;2;Field  ;
                SourceExpr="Main Table No.";
                OnLookup=VAR
                           Mgt@1100512000 : Codeunit 11148589;
                         BEGIN
                           EXIT(Mgt.LookupTableNo(Text));
                         END;
                          }

    { 1100512004;2;Field  ;
                SourceExpr="Sub Table No.";
                OnLookup=VAR
                           Mgt@1100512000 : Codeunit 11148589;
                         BEGIN
                           EXIT(Mgt.LookupTableNo(Text));
                         END;
                          }

    { 1100512006;2;Field  ;
                SourceExpr="Run Task" }

  }
  CODE
  {

    LOCAL PROCEDURE MainTableNoOnAfterInput@19047063(VAR Text@19047064 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE SubTableNoOnAfterInput@19065603(VAR Text@19065604 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE MainTableNoOnFormat@19079044(Text@19015475 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Main Table No.");
    END;

    LOCAL PROCEDURE SubTableNoOnFormat@19052089(Text@19075565 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Sub Table No.");
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117008 CI - Fixed Width Exp.Def. List
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Export Definition List;
               NLD=Exportdefinitieoverzicht];
    SourceTable=Table11148599;
    SourceTableView=SORTING(Code)
                    WHERE(File Format=CONST(Fixed Width));
    PageType=List;
    CardPageID=CI - Fixed Width Export Card;
    OnAfterGetRecord=BEGIN
                       MainTableNoOnFormat(FORMAT("Main Table No."));
                       SubTableNoOnFormat(FORMAT("Sub Table No."));
                     END;

    ActionList=ACTIONS
    {
      { 1000000000;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000013 ;1   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Process;
                                 NLD=Verwerken];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Process;
                               END;
                                }
      { 1000000001;1 ;Action    ;
                      Name=<Action1000090>;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Import Definition from XML;
                                 NLD=XML-Definitie &importeren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Import;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ImportXMLDefinition@1000000 : Codeunit 11148636;
                               BEGIN
                                 ImportXMLDefinition.ImportExportDefinition(Rec);
                               END;
                                }
      { 1000000002;1 ;Action    ;
                      Name=<Action1000088>;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Export Definition to &XML;
                                 NLD=Definitie exporteren naar &XML];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Export;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ExportDefinitionToXML@1000000 : Codeunit 11148634;
                               BEGIN
                                 ExportDefinitionToXML.ExportExportDefinition(Rec);
                               END;
                                }
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000011 ;1   ;ActionGroup;
                      CaptionML=[ENU=Export &Def.;
                                 NLD=&Exportdef.] }
      { 1000007 ;2   ;Action    ;
                      ShortCutKey=Ctrl+F5;
                      CaptionML=[ENU=Messages;
                                 NLD=Berichten];
                      RunObject=Page 11117032;
                      RunPageView=SORTING(Type,Code);
                      RunPageLink=Type=CONST(Export),
                                  Code=FIELD(Code);
                      Promoted=Yes;
                      Image=Note;
                      PromotedCategory=Process }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr=Code }

    { 1000003;2;Field     ;
                SourceExpr=Description }

    { 1000009;2;Field     ;
                SourceExpr="Project Code" }

    { 1100512008;2;Field  ;
                SourceExpr="File Format" }

    { 1000005;2;Field     ;
                SourceExpr=Location;
                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder(Location);
                             END;
                              }

    { 1000017;2;Field     ;
                SourceExpr=Filename }

    { 1000015;2;Field     ;
                SourceExpr=Status }

    { 1100512000;2;Field  ;
                SourceExpr=Synchronize }

    { 1100512002;2;Field  ;
                SourceExpr="Main Table No.";
                OnLookup=VAR
                           Mgt@1100512000 : Codeunit 11148589;
                         BEGIN
                           EXIT(Mgt.LookupTableNo(Text));
                         END;
                          }

    { 1100512004;2;Field  ;
                SourceExpr="Sub Table No.";
                OnLookup=VAR
                           Mgt@1100512000 : Codeunit 11148589;
                         BEGIN
                           EXIT(Mgt.LookupTableNo(Text));
                         END;
                          }

    { 1100512006;2;Field  ;
                SourceExpr="Run Task" }

  }
  CODE
  {

    LOCAL PROCEDURE MainTableNoOnAfterInput@19047063(VAR Text@19047064 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE SubTableNoOnAfterInput@19065603(VAR Text@19065604 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE MainTableNoOnFormat@19079044(Text@19015475 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Main Table No.");
    END;

    LOCAL PROCEDURE SubTableNoOnFormat@19052089(Text@19075565 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Sub Table No.");
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117009 CI - Excel Export Def. List
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Export Definition List;
               NLD=Exportdefinitieoverzicht];
    SourceTable=Table11148599;
    SourceTableView=SORTING(Code)
                    WHERE(File Format=CONST(Excel));
    PageType=List;
    CardPageID=CI - Excel Export Card;
    OnAfterGetRecord=BEGIN
                       MainTableNoOnFormat(FORMAT("Main Table No."));
                       SubTableNoOnFormat(FORMAT("Sub Table No."));
                     END;

    ActionList=ACTIONS
    {
      { 1000000000;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000013 ;1   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Process;
                                 NLD=Verwerken];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Process;
                               END;
                                }
      { 1000000001;1 ;Action    ;
                      Name=<Action1000090>;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Import Definition from XML;
                                 NLD=XML-Definitie &importeren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Import;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ImportXMLDefinition@1000000 : Codeunit 11148636;
                               BEGIN
                                 ImportXMLDefinition.ImportExportDefinition(Rec);
                               END;
                                }
      { 1000000002;1 ;Action    ;
                      Name=<Action1000088>;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Export Definition to &XML;
                                 NLD=Definitie exporteren naar &XML];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Export;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ExportDefinitionToXML@1000000 : Codeunit 11148634;
                               BEGIN
                                 ExportDefinitionToXML.ExportExportDefinition(Rec);
                               END;
                                }
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000011 ;1   ;ActionGroup;
                      CaptionML=[ENU=Export &Def.;
                                 NLD=&Exportdef.] }
      { 1000007 ;2   ;Action    ;
                      ShortCutKey=Ctrl+F5;
                      CaptionML=[ENU=Messages;
                                 NLD=Berichten];
                      RunObject=Page 11117032;
                      RunPageView=SORTING(Type,Code);
                      RunPageLink=Type=CONST(Export),
                                  Code=FIELD(Code);
                      Promoted=Yes;
                      Image=Note;
                      PromotedCategory=Process }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr=Code }

    { 1000003;2;Field     ;
                SourceExpr=Description }

    { 1000009;2;Field     ;
                SourceExpr="Project Code" }

    { 1100512008;2;Field  ;
                SourceExpr="File Format" }

    { 1000005;2;Field     ;
                SourceExpr=Location;
                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder(Location);
                             END;
                              }

    { 1000017;2;Field     ;
                SourceExpr=Filename }

    { 1000015;2;Field     ;
                SourceExpr=Status }

    { 1100512000;2;Field  ;
                SourceExpr=Synchronize }

    { 1100512002;2;Field  ;
                SourceExpr="Main Table No.";
                OnLookup=VAR
                           Mgt@1100512000 : Codeunit 11148589;
                         BEGIN
                           EXIT(Mgt.LookupTableNo(Text));
                         END;
                          }

    { 1100512004;2;Field  ;
                SourceExpr="Sub Table No.";
                OnLookup=VAR
                           Mgt@1100512000 : Codeunit 11148589;
                         BEGIN
                           EXIT(Mgt.LookupTableNo(Text));
                         END;
                          }

    { 1100512006;2;Field  ;
                SourceExpr="Run Task" }

  }
  CODE
  {

    LOCAL PROCEDURE MainTableNoOnAfterInput@19047063(VAR Text@19047064 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE SubTableNoOnAfterInput@19065603(VAR Text@19065604 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE MainTableNoOnFormat@19079044(Text@19015475 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Main Table No.");
    END;

    LOCAL PROCEDURE SubTableNoOnFormat@19052089(Text@19075565 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Sub Table No.");
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117010 CI - Import Restriction Values
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Import Restriction Values;
               NLD=Importrestrictiewaarden];
    SourceTable=Table11148597;
    PageType=List;
    AutoSplitKey=Yes;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr=Value }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117011 CI - Import Restr. Var. Filter
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Import Restriction Variable Filters;
               NLD=Importrestrictiesvariabelefilters];
    SourceTable=Table11148598;
    PageType=List;
    OnAfterGetRecord=BEGIN
                       FieldNoOnFormat(FORMAT("Field No."));
                     END;

    OnNewRecord=VAR
                  ImportRestriction@1000000000 : Record 11148596;
                BEGIN
                  IF ImportRestriction.GET("Import Definition", "Import Def. Entry No.", "Import Restriction Entry No.") THEN
                    "Table No." := ImportRestriction."Table No.";
                END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000000;1;Group  ;
                GroupType=Repeater }

    { 1000000001;2;Field  ;
                SourceExpr="Field No.";
                OnLookup=VAR
                           Mgt@1000000000 : Codeunit 11148589;
                         BEGIN
                           EXIT(Mgt.LookupFieldNo("Table No.", Text, TRUE));
                         END;
                          }

    { 1000000003;2;Field  ;
                SourceExpr=Variable }

  }
  CODE
  {

    LOCAL PROCEDURE FieldNoOnAfterInput@19063566(VAR Text@19063567 : Text[1024]);
    VAR
      Mgt@1000000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFieldNo(Text, "Table No.", TRUE);
    END;

    LOCAL PROCEDURE FieldNoOnFormat@19075355(Text@19041114 : Text[1024]);
    VAR
      Mgt@1000000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatFieldNo(Text, "Table No.", "Field No.");
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117012 CI - Web Service List
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Connector List;
               NLD=Connectorenoverzicht];
    SourceTable=Table11148623;
    SourceTableView=SORTING(Code)
                    WHERE(Type=CONST(Web Service));
    PageType=List;
    CardPageID=CI - Web Service Card;
    ActionList=ACTIONS
    {
      { 1000000003;  ;ActionContainer;
                      Name=<Action1900000003>;
                      ActionContainerType=ActionItems }
      { 1000000002;1 ;ActionGroup;
                      Name=<Action1000012>;
                      CaptionML=[ENU=&Connector;
                                 NLD=&Connector] }
      { 1000000001;2 ;Action    ;
                      Name=<Action1000017>;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Start;
                                 NLD=Start];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Start;
                               END;
                                }
      { 1000000000;2 ;Action    ;
                      Name=<Action1000018>;
                      ShortCutKey=Shift+F11;
                      CaptionML=[ENU=S&top;
                                 NLD=S&top];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Cancel;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Stop;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr=Code }

    { 1000003;2;Field     ;
                SourceExpr=Description }

    { 1000005;2;Field     ;
                SourceExpr=Type }

    { 1000019;2;Field     ;
                CaptionML=[ENU=Active;
                           NLD=Aktief];
                SourceExpr=IsActive }

    { 1000010;2;Field     ;
                SourceExpr=Status }

    { 1000000004;2;Field  ;
                SourceExpr=Port }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117013 CI - Export Definition List
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Export Definition List;
               NLD=Exportdefinitieoverzicht];
    SourceTable=Table11148599;
    PageType=List;
    OnAfterGetRecord=BEGIN
                       MainTableNoOnFormat(FORMAT("Main Table No."));
                       SubTableNoOnFormat(FORMAT("Sub Table No."));
                     END;

    ActionList=ACTIONS
    {
      { 1000000000;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000012 ;1   ;Action    ;
                      ShortCutKey=Shift+F5;
                      CaptionML=[ENU=Card;
                                 NLD=Kaart];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=View;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ShowCard;
                               END;
                                }
      { 1000013 ;1   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Process;
                                 NLD=Verwerken];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Process;
                               END;
                                }
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000011 ;1   ;ActionGroup;
                      CaptionML=[ENU=Export &Def.;
                                 NLD=&Exportdef.] }
      { 1000007 ;2   ;Action    ;
                      ShortCutKey=Ctrl+F5;
                      CaptionML=[ENU=Messages;
                                 NLD=Berichten];
                      RunObject=Page 11117032;
                      RunPageView=SORTING(Type,Code);
                      RunPageLink=Type=CONST(Export),
                                  Code=FIELD(Code);
                      Promoted=Yes;
                      Image=Note;
                      PromotedCategory=Process }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr=Code }

    { 1000003;2;Field     ;
                SourceExpr=Description }

    { 1000009;2;Field     ;
                SourceExpr="Project Code" }

    { 1100512008;2;Field  ;
                SourceExpr="File Format" }

    { 1000005;2;Field     ;
                SourceExpr=Location;
                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder(Location);
                             END;
                              }

    { 1000017;2;Field     ;
                SourceExpr=Filename }

    { 1000015;2;Field     ;
                SourceExpr=Status }

    { 1100512000;2;Field  ;
                SourceExpr=Synchronize }

    { 1100512002;2;Field  ;
                SourceExpr="Main Table No.";
                OnLookup=VAR
                           Mgt@1100512000 : Codeunit 11148589;
                         BEGIN
                           EXIT(Mgt.LookupTableNo(Text));
                         END;
                          }

    { 1100512004;2;Field  ;
                SourceExpr="Sub Table No.";
                OnLookup=VAR
                           Mgt@1100512000 : Codeunit 11148589;
                         BEGIN
                           EXIT(Mgt.LookupTableNo(Text));
                         END;
                          }

    { 1100512006;2;Field  ;
                SourceExpr="Run Task" }

  }
  CODE
  {

    LOCAL PROCEDURE MainTableNoOnAfterInput@19047063(VAR Text@19047064 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE SubTableNoOnAfterInput@19065603(VAR Text@19065604 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE MainTableNoOnFormat@19079044(Text@19015475 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Main Table No.");
    END;

    LOCAL PROCEDURE SubTableNoOnFormat@19052089(Text@19075565 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Sub Table No.");
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117014 CI - Message Queue List
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Connector List;
               NLD=Connectorenoverzicht];
    SourceTable=Table11148623;
    SourceTableView=SORTING(Code)
                    WHERE(Type=CONST(Message Queue));
    PageType=List;
    CardPageID=CI - Message Queue Card;
    ActionList=ACTIONS
    {
      { 1000000003;  ;ActionContainer;
                      Name=<Action1900000003>;
                      ActionContainerType=ActionItems }
      { 1000000002;1 ;ActionGroup;
                      Name=<Action1000012>;
                      CaptionML=[ENU=&Connector;
                                 NLD=&Connector] }
      { 1000000001;2 ;Action    ;
                      Name=<Action1000017>;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Start;
                                 NLD=Start];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Start;
                               END;
                                }
      { 1000000000;2 ;Action    ;
                      Name=<Action1000018>;
                      ShortCutKey=Shift+F11;
                      CaptionML=[ENU=S&top;
                                 NLD=S&top];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Cancel;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Stop;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr=Code }

    { 1000003;2;Field     ;
                SourceExpr=Description }

    { 1000005;2;Field     ;
                SourceExpr=Type }

    { 1000019;2;Field     ;
                CaptionML=[ENU=Active;
                           NLD=Aktief];
                SourceExpr=IsActive }

    { 1000010;2;Field     ;
                SourceExpr=Status }

    { 1000000004;2;Field  ;
                SourceExpr="Request Queue" }

    { 1000000005;2;Field  ;
                SourceExpr="Reply Queue" }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117015 CI - Import Def. Functions
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Import Def. Functions;
               NLD=Importdef. functies];
    SourceTable=Table11148594;
    PageType=List;
    AutoSplitKey=Yes;
    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  OnAfterGetCurrRecord;
                END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1100531000;1;Group  ;
                GroupType=Repeater }

    { 1100531001;2;Field  ;
                SourceExpr=Code;
                OnValidate=BEGIN
                             CodeOnAfterValidate;
                           END;
                            }

    { 1100531014;2;Field  ;
                SourceExpr=Description;
                Visible=FALSE }

    { 1100531012;2;Field  ;
                SourceExpr="Description 2" }

    { 1100531006;2;Field  ;
                SourceExpr="Parameter 1";
                Editable=Parameter1Editable }

    { 1100531008;2;Field  ;
                SourceExpr="Parameter 2";
                Editable=Parameter2Editable }

    { 1100531010;2;Field  ;
                SourceExpr="Parameter 3";
                Editable=Parameter3Editable }

  }
  CODE
  {
    VAR
      Parameter1Editable@1100543000 : Boolean INDATASET;
      Parameter2Editable@1100543001 : Boolean INDATASET;
      Parameter3Editable@1100543002 : Boolean INDATASET;

    LOCAL PROCEDURE SetColumns@1100531000();
    VAR
      INFunction@1100531000 : Record 11148595;
    BEGIN
      IF INFunction.GET(Code) THEN
        ;

      Parameter1Editable := (INFunction."Parameter 1" <> '') OR (INFunction.Code = '');
      Parameter2Editable := (INFunction."Parameter 2" <> '') OR (INFunction.Code = '');
      Parameter3Editable := (INFunction."Parameter 3" <> '') OR (INFunction.Code = '');
    END;

    LOCAL PROCEDURE CodeOnAfterValidate@19050293();
    BEGIN
      SetColumns;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      SetColumns;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117016 CI - Port Connector List
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Connector List;
               NLD=Connectorenoverzicht];
    SourceTable=Table11148623;
    SourceTableView=SORTING(Code)
                    WHERE(Type=CONST(Port Connector));
    PageType=List;
    CardPageID=CI - Port Connector Card;
    ActionList=ACTIONS
    {
      { 1000000003;  ;ActionContainer;
                      Name=<Action1900000003>;
                      ActionContainerType=ActionItems }
      { 1000000002;1 ;ActionGroup;
                      Name=<Action1000012>;
                      CaptionML=[ENU=&Connector;
                                 NLD=&Connector] }
      { 1000000001;2 ;Action    ;
                      Name=<Action1000017>;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Start;
                                 NLD=Start];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Start;
                               END;
                                }
      { 1000000000;2 ;Action    ;
                      Name=<Action1000018>;
                      ShortCutKey=Shift+F11;
                      CaptionML=[ENU=S&top;
                                 NLD=S&top];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Cancel;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Stop;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr=Code }

    { 1000003;2;Field     ;
                SourceExpr=Description }

    { 1000005;2;Field     ;
                SourceExpr=Type }

    { 1000019;2;Field     ;
                CaptionML=[ENU=Active;
                           NLD=Aktief];
                SourceExpr=IsActive }

    { 1000010;2;Field     ;
                SourceExpr=Status }

    { 1000000004;2;Field  ;
                SourceExpr=Port }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117017 CI - Trace Rule List
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Trace Rule List;
               NLD=Traceerregeloverzicht];
    SourceTable=Table11148628;
    PageType=List;
    CardPageID=CI - Trace Rule Card;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1100531000;1;Group  ;
                Editable=FALSE;
                GroupType=Repeater }

    { 1100531001;2;Field  ;
                SourceExpr=Code }

    { 1100531003;2;Field  ;
                SourceExpr=Description }

    { 1100531005;2;Field  ;
                SourceExpr="Apply Method" }

    { 1100531007;2;Field  ;
                SourceExpr="Rule Type" }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117018 CI - Trace Rule Card
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Trace Rule Card;
               NLD=Traceerregel];
    SourceTable=Table11148628;
    PageType=Card;
    OnInit=BEGIN
             "Measure Period (minutes)Enable" := TRUE;
             "E-Mail AddressEnable" := TRUE;
             "Send E-Mail MethodEnable" := TRUE;
           END;

    OnOpenPage=BEGIN
                 SetEnabled;
               END;

    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                       TableFilterOnFormat(FORMAT("Table Filter"));
                     END;

    OnNewRecord=BEGIN
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000003;  ;ActionContainer;
                      Name=<Action1900000003>;
                      ActionContainerType=ActionItems }
      { 1100531010;1 ;ActionGroup;
                      CaptionML=[ENU=Trace &Rule;
                                 NLD=&Traceerregel] }
      { 1100531026;2 ;Action    ;
                      CaptionML=[ENU=Apply;
                                 NLD=Toepassen];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=CarryOutActionMessage;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ApplyRules;
                               END;
                                }
      { 1100531027;2 ;Action    ;
                      CaptionML=[ENU=Send E-Mails;
                                 NLD=E-mails versturen];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=SendTo;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 SendEmails;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1100531000;1;Group  ;
                CaptionML=[ENU=General;
                           NLD=Algemeen] }

    { 1100531001;2;Field  ;
                SourceExpr=Code }

    { 1100531003;2;Field  ;
                SourceExpr=Description }

    { 1100531008;2;Field  ;
                SourceExpr="Rule Type";
                OnValidate=BEGIN
                             RuleTypeOnAfterValidate;
                           END;
                            }

    { 1100531013;2;Field  ;
                SourceExpr="Measure Period (minutes)";
                Enabled="Measure Period (minutes)Enable" }

    { 1100531015;2;Field  ;
                AssistEdit=Yes;
                SourceExpr="Table Filter";
                OnAssistEdit=VAR
                               INMgt@1000000000 : Codeunit 11148589;
                             BEGIN
                               EVALUATE("Table Filter", INMgt.SetTableFilter(DATABASE::"IN - Trace Entry", FORMAT("Table Filter"))); // CI-143
                             END;
                              }

    { 1100531017;2;Field  ;
                SourceExpr="Message Interval (minutes)" }

    { 1100531005;2;Field  ;
                SourceExpr="Apply Method" }

    { 1100531019;2;Field  ;
                SourceExpr="Send E-Mail";
                OnValidate=BEGIN
                             SendEMailOnPush;
                           END;
                            }

    { 1100531021;2;Field  ;
                SourceExpr="Send E-Mail Method";
                Enabled="Send E-Mail MethodEnable" }

    { 1100531023;2;Field  ;
                SourceExpr="E-Mail Address";
                Enabled="E-Mail AddressEnable" }

    { 1100531012;1;Part   ;
                SubPageView=SORTING(Trace Rule);
                SubPageLink=Trace Rule=FIELD(Code);
                PagePartID=Page11117019 }

  }
  CODE
  {
    VAR
      "Send E-Mail MethodEnable"@19022805 : Boolean INDATASET;
      "E-Mail AddressEnable"@19014464 : Boolean INDATASET;
      "Measure Period (minutes)Enable"@19027049 : Boolean INDATASET;

    LOCAL PROCEDURE SetEnabled@1100531000();
    BEGIN
      "Measure Period (minutes)Enable" := "Rule Type" = "Rule Type"::"Missing Trace";
      "Send E-Mail MethodEnable" := "Send E-Mail";
      "E-Mail AddressEnable" := "Send E-Mail";
    END;

    LOCAL PROCEDURE RuleTypeOnAfterValidate@19040923();
    BEGIN
      SetEnabled;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      SetEnabled;
    END;

    LOCAL PROCEDURE TableFilterOnAfterInput@19072298(VAR Text@19072299 : Text[1024]);
    VAR
      Mgt@1100531000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableFilter(Text, DATABASE::"IN - Trace Entry");
    END;

    LOCAL PROCEDURE SendEMailOnPush@19074038();
    BEGIN
      SetEnabled;
    END;

    LOCAL PROCEDURE TableFilterOnFormat@19013929(Text@19048068 : Text[1024]);
    VAR
      Mgt@1100531000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableFilter(Text, DATABASE::"IN - Trace Entry");
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117019 CI - Trace Rule Subform
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Trace Rule Subform;
               NLD=Traceerregel subform];
    SourceTable=Table11148629;
    PageType=ListPart;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1100531000;1;Group  ;
                GroupType=Repeater }

    { 1100531001;2;Field  ;
                SourceExpr=Date }

    { 1100531003;2;Field  ;
                SourceExpr=Time }

    { 1100531005;2;Field  ;
                SourceExpr="User Id" }

    { 1100531007;2;Field  ;
                SourceExpr="Trace Entry No." }

    { 1100531011;2;Field  ;
                DrillDown=No;
                SourceExpr=Type }

    { 1100531013;2;Field  ;
                DrillDown=No;
                SourceExpr=Code }

    { 1100531015;2;Field  ;
                SourceExpr=Error }

    { 1100531017;2;Field  ;
                SourceExpr="Error Message" }

    { 1100531019;2;Field  ;
                SourceExpr="No. of Records Processed" }

    { 1100531009;2;Field  ;
                SourceExpr="E-Mail Status" }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117020 CI - Trace Entries
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Trace Entries;
               NLD=Traceerposten];
    SourceTable=Table11148630;
    PageType=List;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1100531000;1;Group  ;
                GroupType=Repeater }

    { 1100531001;2;Field  ;
                SourceExpr="Entry No." }

    { 1100531003;2;Field  ;
                SourceExpr=Date }

    { 1100531005;2;Field  ;
                SourceExpr=Time }

    { 1100531007;2;Field  ;
                SourceExpr=DateTime }

    { 1100531009;2;Field  ;
                SourceExpr="User Id" }

    { 1100531011;2;Field  ;
                SourceExpr=Type }

    { 1100531013;2;Field  ;
                SourceExpr=Code }

    { 1100531015;2;Field  ;
                SourceExpr=Error }

    { 1100531017;2;Field  ;
                SourceExpr="Error Message" }

    { 1100531019;2;Field  ;
                SourceExpr="No. of Records Processed" }

    { 1100531021;2;Field  ;
                SourceExpr=Status }

    { 1100531027;2;Field  ;
                SourceExpr="No. of Message" }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117022 CI - Export Def. Functions
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Export Def. Functions;
               NLD=Exportdef. functies];
    SourceTable=Table11148602;
    DelayedInsert=Yes;
    PageType=List;
    AutoSplitKey=Yes;
    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  OnAfterGetCurrRecord;
                END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1100531000;1;Group  ;
                GroupType=Repeater }

    { 1100531016;2;Field  ;
                SourceExpr="Source Variable";
                Visible=FALSE }

    { 1100531001;2;Field  ;
                SourceExpr=Code;
                OnValidate=BEGIN
                             CodeOnAfterValidate;
                           END;
                            }

    { 1100531014;2;Field  ;
                SourceExpr=Description;
                Visible=FALSE }

    { 1100531012;2;Field  ;
                SourceExpr="Description 2" }

    { 1100531006;2;Field  ;
                SourceExpr="Parameter 1";
                Editable=Parameter1Editable }

    { 1100531008;2;Field  ;
                SourceExpr="Parameter 2";
                Editable=Parameter2Editable }

    { 1100531010;2;Field  ;
                SourceExpr="Parameter 3";
                Editable=Parameter3Editable }

    { 1100531018;2;Field  ;
                SourceExpr="Dest. Variable";
                Visible=FALSE }

  }
  CODE
  {
    VAR
      Parameter1Editable@1100543002 : Boolean INDATASET;
      Parameter2Editable@1100543001 : Boolean INDATASET;
      Parameter3Editable@1100543000 : Boolean INDATASET;

    LOCAL PROCEDURE SetColumns@1100531000();
    VAR
      INFunction@1100531000 : Record 11148595;
    BEGIN
      IF INFunction.GET(Code) THEN
        ;

      Parameter1Editable := (INFunction."Parameter 1" <> '') OR (INFunction.Code = '');
      Parameter2Editable := (INFunction."Parameter 2" <> '') OR (INFunction.Code = '');
      Parameter3Editable := (INFunction."Parameter 3" <> '') OR (INFunction.Code = '');
    END;

    LOCAL PROCEDURE CodeOnAfterValidate@19050293();
    BEGIN
      SetColumns;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      SetColumns;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117023 CI - FTP Upload List
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Transport List;
               NLD=Transportoverzicht];
    SourceTable=Table11148590;
    SourceTableView=WHERE(Type=CONST(FTP Upload));
    PageType=List;
    CardPageID=CI - Transport FTP Upload;
    ActionList=ACTIONS
    {
      { 1900000003;  ;ActionContainer;
                      Name=<Action1900000003>;
                      ActionContainerType=ActionItems }
      { 1000006 ;1   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Process;
                                 NLD=Verwerken];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Process(TRUE);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr=Code }

    { 1000003;2;Field     ;
                SourceExpr=Description }

    { 1000019;2;Field     ;
                SourceExpr="Project Code" }

    { 1000011;2;Field     ;
                SourceExpr=Status }

    { 1000007;2;Field     ;
                SourceExpr=Type }

    { 1000009;2;Field     ;
                SourceExpr=Address }

    { 1   ;2   ;Field     ;
                SourceExpr="Custom Port" }

    { 1000015;2;Field     ;
                SourceExpr="From Location" }

    { 1000017;2;Field     ;
                SourceExpr="To Location" }

    { 1000000000;2;Field  ;
                SourceExpr=Filename }

    { 1000013;2;Field     ;
                SourceExpr="Transfer Mode" }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117024 CI - FTP Download List
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Transport List;
               NLD=Transportoverzicht];
    SourceTable=Table11148590;
    SourceTableView=WHERE(Type=CONST(FTP Download));
    PageType=List;
    CardPageID=CI - Transport FTP Download;
    ActionList=ACTIONS
    {
      { 1900000003;  ;ActionContainer;
                      Name=<Action1900000003>;
                      ActionContainerType=ActionItems }
      { 1000006 ;1   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Process;
                                 NLD=Verwerken];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Process(TRUE);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr=Code }

    { 1000003;2;Field     ;
                SourceExpr=Description }

    { 1000019;2;Field     ;
                SourceExpr="Project Code" }

    { 1000011;2;Field     ;
                SourceExpr=Status }

    { 1000007;2;Field     ;
                SourceExpr=Type }

    { 1000009;2;Field     ;
                SourceExpr=Address }

    { 1   ;2   ;Field     ;
                SourceExpr="Custom Port" }

    { 1000015;2;Field     ;
                SourceExpr="From Location" }

    { 1000017;2;Field     ;
                SourceExpr="To Location" }

    { 1000000000;2;Field  ;
                SourceExpr=Filename }

    { 1000013;2;Field     ;
                SourceExpr="Transfer Mode" }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117025 CI - Move List
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Transport List;
               NLD=Transportoverzicht];
    SourceTable=Table11148590;
    SourceTableView=WHERE(Type=CONST(Move));
    PageType=List;
    CardPageID=CI - Transport Movement;
    ActionList=ACTIONS
    {
      { 1900000003;  ;ActionContainer;
                      Name=<Action1900000003>;
                      ActionContainerType=ActionItems }
      { 1000006 ;1   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Process;
                                 NLD=Verwerken];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Process(TRUE);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr=Code }

    { 1000003;2;Field     ;
                SourceExpr=Description }

    { 1000019;2;Field     ;
                SourceExpr="Project Code" }

    { 1000011;2;Field     ;
                SourceExpr=Status }

    { 1000007;2;Field     ;
                SourceExpr=Type }

    { 1000015;2;Field     ;
                SourceExpr="From Location" }

    { 1000017;2;Field     ;
                SourceExpr="To Location" }

    { 1000000000;2;Field  ;
                SourceExpr=Filename }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117026 CI - Executable List
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Transport List;
               NLD=Transportoverzicht];
    SourceTable=Table11148590;
    SourceTableView=WHERE(Type=CONST(Executable));
    PageType=List;
    CardPageID=CI - Transport Executable;
    ActionList=ACTIONS
    {
      { 1900000003;  ;ActionContainer;
                      Name=<Action1900000003>;
                      ActionContainerType=ActionItems }
      { 1000006 ;1   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Process;
                                 NLD=Verwerken];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Process(TRUE);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr=Code }

    { 1000003;2;Field     ;
                SourceExpr=Description }

    { 1000019;2;Field     ;
                SourceExpr="Project Code" }

    { 1000011;2;Field     ;
                SourceExpr=Status }

    { 1000007;2;Field     ;
                SourceExpr=Type }

    { 1000000000;2;Field  ;
                SourceExpr=Executable }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117027 CI - Monitoring Setup
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Monitoring Setup;
               NLD=Montoringinstellingen];
    SourceTable=Table11148607;
    SourceTableView=SORTING(Table No.);
    PageType=List;
    OnOpenPage=VAR
                 Initialize@1000001 : Codeunit 11148625;
               BEGIN
                 Initialize.CheckInitialize;
               END;

    OnAfterGetRecord=VAR
                       Mgt@1000000 : Codeunit 11148589;
                     BEGIN
                       IF FORMAT("Table Filter") = '' THEN
                         EVALUATE("Table Filter", Mgt.EmptyTableFilter("Table No."));
                       TableNoOnFormat(FORMAT("Table No."));
                       TableFilterOnFormat(FORMAT("Table Filter"));
                     END;

    OnNewRecord=VAR
                  ExportDefinition@1000000 : Record 11148599;
                BEGIN
                  IF GETFILTER("Export Definition") <> '' THEN
                    IF ExportDefinition.GET(GETFILTER("Export Definition")) THEN
                      VALIDATE("Export Definition", GETFILTER("Export Definition"));
                END;

    ActionList=ACTIONS
    {
      { 1900000003;  ;ActionContainer;
                      Name=<Action1900000003>;
                      ActionContainerType=ActionItems }
      { 1000024 ;1   ;ActionGroup;
                      CaptionML=[ENU=&Mon. Setup;
                                 NLD=&Mon. instelling] }
      { 1000026 ;2   ;Action    ;
                      ShortCutKey=Shift+F5;
                      CaptionML=[ENU=Export Definition;
                                 NLD=Exportdefinitie];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ImportExport;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ExportDefinition@1000000 : Record 11148599;
                               BEGIN
                                 ExportDefinition.GET("Export Definition");
                                 ExportDefinition.ShowCard;
                               END;
                                }
      { 1000025 ;2   ;Action    ;
                      ShortCutKey=Ctrl+F5;
                      CaptionML=[ENU=Export &Jobs;
                                 NLD=Exporteer&opdrachten];
                      RunObject=Page 11117028;
                      RunPageView=SORTING(Status,Export Definition);
                      RunPageLink=Setup Entry No.=FIELD(Entry No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Export;
                      PromotedCategory=Process }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                GroupType=Repeater }

    { 1000007;2;Field     ;
                SourceExpr="Export Definition" }

    { 1000000000;2;Field  ;
                SourceExpr="Processing Codeunit" }

    { 1000001;2;Field     ;
                SourceExpr="Table No.";
                OnLookup=VAR
                           Mgt@1000000 : Codeunit 11148589;
                         BEGIN
                           // IDYN EBK >>>>
                           IF Mgt.LookupTableNo(Text) THEN BEGIN
                             EVALUATE("Table No.",Text);
                             VALIDATE("Table No.");
                           END;
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //EXIT(Mgt.LookupTableNo(Text));
                           // IDYN EBK <<<<
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.AssistTableNo("Table No.");
                             END;
                              }

    { 1000005;2;Field     ;
                AssistEdit=Yes;
                SourceExpr="Table Filter";
                OnAssistEdit=VAR
                               INMgt@1000000000 : Codeunit 11148589;
                             BEGIN
                               EVALUATE("Table Filter", INMgt.SetTableFilter("Table No.", FORMAT("Table Filter"))); // CI-143
                             END;
                              }

    { 1000009;2;Field     ;
                SourceExpr="Export Moment" }

    { 1000022;2;Field     ;
                SourceExpr="Group per" }

    { 1000014;2;Field     ;
                SourceExpr="Export Modify" }

    { 1000016;2;Field     ;
                SourceExpr="Export Insert" }

    { 1000018;2;Field     ;
                SourceExpr="Export Delete" }

    { 1000020;2;Field     ;
                SourceExpr="Export Rename" }

    { 1000003;2;Field     ;
                SourceExpr="Export from all Companies";
                Visible=FALSE }

    { 1000027;2;Field     ;
                SourceExpr="Trigger Dest. Variable";
                Visible=FALSE }

    { 1000029;2;Field     ;
                SourceExpr="Job Entry No. Dest. Variable";
                Visible=FALSE }

  }
  CODE
  {

    LOCAL PROCEDURE TableNoOnAfterInput@19060375(VAR Text@19060376 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE TableFilterOnAfterInput@19072298(VAR Text@19072299 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableFilter(Text, "Table No.");
    END;

    LOCAL PROCEDURE TableNoOnFormat@19071785(Text@19016339 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Table No.");
    END;

    LOCAL PROCEDURE TableFilterOnFormat@19013929(Text@19048068 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableFilter(Text, "Table No.");
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117028 CI - Export Jobs
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Export Jobs;
               NLD=Exporteeropdrachten];
    SourceTable=Table11148608;
    PageType=List;
    OnOpenPage=VAR
                 Initialize@1000000 : Codeunit 11148625;
               BEGIN
                 Initialize.CheckInitialize;

                 IF GETFILTERS = '' THEN
                   SETFILTER(Status, '<>%1', Status::Exported);
               END;

    OnAfterGetRecord=BEGIN
                       TableNoText := FORMAT("Table No.");
                       TableNoTextOnFormat(TableNoText);
                       RecordFilterText := FORMAT("Record Filter");
                       RecordFilterTextOnFormat(RecordFilterText);
                       TableFilterText := FORMAT("Table Filter");
                       TableFilterTextOnFormat(TableFilterText);
                     END;

    ActionList=ACTIONS
    {
      { 1900000003;  ;ActionContainer;
                      Name=<Action1900000003>;
                      ActionContainerType=ActionItems }
      { 1000029 ;1   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Process;
                                 NLD=Verwerken];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ErrorMgt@1100531001 : Codeunit 11148630;
                               BEGIN
                                 ErrorMgt.ClearError;

                                 IF "Entry No." <> 0 THEN
                                   Process;

                                 IF NOT (ErrorMgt.GetError IN ['', 'Error']) THEN
                                   MESSAGE(ErrorMgt.GetError);
                               END;
                                }
      { 1000000001;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1100512000;1 ;Action    ;
                      CaptionML=[ENU=Field Values;
                                 NLD=Veld&waarden];
                      RunObject=Page 11148601;
                      RunPageView=SORTING(Type,Entry No.,Table No.,Field No.);
                      RunPageLink=Type=CONST(Export Job),
                                  Entry No.=FIELD(Entry No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=View;
                      PromotedCategory=Process }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr="Entry No.";
                Editable=FALSE }

    { 1000017;2;Field     ;
                SourceExpr=Status;
                Editable=FALSE }

    { 1000000000;2;Field  ;
                SourceExpr="Processing Codeunit" }

    { 1000011;2;Field     ;
                SourceExpr="Export Definition";
                Editable=FALSE }

    { 1000005;2;Field     ;
                SourceExpr=TableNoText;
                CaptionClass=FIELDCAPTION("Table No.");
                Editable=FALSE;
                OnLookup=VAR
                           Mgt@1000000 : Codeunit 11148589;
                         BEGIN
                           Mgt.FormatTableNo(Text, "Table No.");
                           EXIT(Mgt.LookupTableNo(Text));
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.AssistTableNo("Table No.");
                             END;
                              }

    { 1000021;2;Field     ;
                SourceExpr=Trigger;
                Editable=FALSE }

    { 1000015;2;Field     ;
                SourceExpr=RecordFilterText;
                CaptionClass=FIELDCAPTION("Record Filter");
                Editable=FALSE }

    { 1000030;2;Field     ;
                SourceExpr="DateTime Inserted";
                Visible=FALSE;
                Editable=FALSE }

    { 1000019;2;Field     ;
                SourceExpr="DateTime Exported";
                Editable=FALSE }

    { 1000023;2;Field     ;
                SourceExpr="Group per";
                Editable=FALSE }

    { 1000003;2;Field     ;
                SourceExpr="Setup Entry No.";
                Visible=FALSE;
                Editable=FALSE }

    { 1000009;2;Field     ;
                SourceExpr=TableFilterText;
                CaptionClass=FIELDCAPTION("Table Filter");
                Visible=FALSE;
                Editable=FALSE }

    { 1000013;2;Field     ;
                SourceExpr="Export Moment";
                Visible=FALSE;
                Editable=FALSE }

    { 1100512002;2;Field  ;
                SourceExpr="Export Definition Location";
                Visible=FALSE;
                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder("Export Definition Location");
                             END;
                              }

  }
  CODE
  {
    VAR
      TableNoText@19054277 : Text[1024] INDATASET;
      RecordFilterText@19070337 : Text[1024] INDATASET;
      TableFilterText@19034498 : Text[1024] INDATASET;

    LOCAL PROCEDURE TableNoTextOnFormat@19026104(VAR Text@19073337 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Table No.");
    END;

    LOCAL PROCEDURE RecordFilterTextOnFormat@19057545(VAR Text@19018585 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableFilter(Text, "Table No.");
    END;

    LOCAL PROCEDURE TableFilterTextOnFormat@19007962(VAR Text@19047238 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableFilter(Text, "Table No.");
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117029 CI - Relations
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Relations;
               NLD=Relaties];
    SourceTable=Table11148625;
    SourceTableView=SORTING(Table No.,Field No.);
    PageType=List;
    ActionList=ACTIONS
    {
      { 1900000003;  ;ActionContainer;
                      Name=<Action1900000003>;
                      ActionContainerType=ActionItems }
      { 1100531016;1 ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NLD=F&uncties] }
      { 1100531017;2 ;Action    ;
                      ShortCutKey=F5;
                      CaptionML=[ENU=Refresh;
                                 NLD=Vernieuwen];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Refresh;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 RelationMgt@1100531000 : Codeunit 11148641;
                               BEGIN
                                 RelationMgt.RUN;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1100531000;1;Group  ;
                Editable=FALSE;
                GroupType=Repeater }

    { 1000000000;2;Field  ;
                CaptionML=[ENU=Table;
                           NLD=Tabel];
                SourceExpr=TableNoText;
                OnLookup=VAR
                           TableText@1000000000 : Text[30];
                         BEGIN
                           TableText := FORMAT("Table No.");
                           EXIT(Mgt.LookupTableNo(TableText));
                         END;

                OnAssistEdit=BEGIN
                               Mgt.AssistTableNo("Table No.");
                             END;
                              }

    { 1000000001;2;Field  ;
                CaptionML=[ENU=Field;
                           NLD=Veld];
                SourceExpr=FieldNoText;
                OnLookup=VAR
                           FieldText@1000000000 : Text[30];
                         BEGIN
                           FieldText := FORMAT("Field No.");
                           EXIT(Mgt.LookupFieldNo("Table No.", FieldText, FALSE));
                         END;
                          }

    { 1000000002;2;Field  ;
                CaptionML=[ENU=Relation Table;
                           NLD=Relatietabel];
                SourceExpr=RelTableNoText;
                OnLookup=VAR
                           TableText@1000000000 : Text[30];
                         BEGIN
                           TableText := FORMAT("Relation Table No.");
                           EXIT(Mgt.LookupTableNo(TableText));
                         END;

                OnAssistEdit=BEGIN
                               Mgt.AssistTableNo("Relation Table No.");
                             END;
                              }

    { 1000000003;2;Field  ;
                CaptionML=[ENU=Relation Field;
                           NLD=Relatieveld];
                SourceExpr=RelFieldNoText;
                OnLookup=VAR
                           FieldText@1000000000 : Text[30];
                         BEGIN
                           FieldText := FORMAT("Relation Field No.");
                           EXIT(Mgt.LookupFieldNo("Relation Table No.", FieldText, FALSE));
                         END;
                          }

    { 1000000004;2;Field  ;
                CaptionML=[ENU=Conditions;
                           NLD=Voorwaarden];
                SourceExpr=ConditionText;
                OnDrillDown=BEGIN
                              ConditionDrilldown;
                            END;
                             }

    { 1000000005;2;Field  ;
                CaptionML=[ENU=Filters;
                           NLD=Filters];
                SourceExpr=FilterText;
                OnDrillDown=BEGIN
                              FilterDrilldown;
                            END;
                             }

  }
  CODE
  {
    VAR
      Mgt@1000000000 : Codeunit 11148589;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117030 CI - Relation Conditions
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Relation Conditions;
               NLD=Relatievoorwaarden];
    SourceTable=Table11148626;
    PageType=List;
    ShowFilter=No;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1100531000;1;Group  ;
                Editable=FALSE;
                GroupType=Repeater }

    { 1100531001;2;Field  ;
                SourceExpr="Field No.";
                OnLookup=VAR
                           Relation@1100531003 : Record 11148625;
                           Mgt@1100531002 : Codeunit 11148589;
                         BEGIN
                           IF Relation.GET("Relation Entry No.") THEN
                             EXIT(Mgt.LookupFieldNo(Relation."Table No.", Text, FALSE));
                         END;
                          }

    { 1000000000;2;Field  ;
                CaptionML=[ENU=Field;
                           NLD=Veld];
                SourceExpr=FieldNoText;
                OnLookup=VAR
                           Relation@1000000001 : Record 11148625;
                           FieldText@1000000000 : Text[30];
                         BEGIN
                           IF Relation.GET("Relation Entry No.") THEN BEGIN
                             FieldText := FORMAT("Field No.");
                             EXIT(Mgt.LookupFieldNo(Relation."Table No.", FieldText, FALSE));
                           END;
                         END;
                          }

    { 1100531003;2;Field  ;
                SourceExpr=Type }

    { 1100531005;2;Field  ;
                SourceExpr=Value }

  }
  CODE
  {
    VAR
      Mgt@1000000000 : Codeunit 11148589;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117031 CI - Relation Filters
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Relation Filters;
               NLD=Relatiefilters];
    SourceTable=Table11148627;
    PageType=List;
    ShowFilter=No;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1100531000;1;Group  ;
                Editable=FALSE;
                GroupType=Repeater }

    { 1100531001;2;Field  ;
                SourceExpr="Field No.";
                OnLookup=VAR
                           Relation@1100531003 : Record 11148625;
                           Mgt@1100531002 : Codeunit 11148589;
                         BEGIN
                           IF Relation.GET("Relation Entry No.") THEN
                             EXIT(Mgt.LookupFieldNo(Relation."Relation Table No.", Text, FALSE));
                         END;
                          }

    { 1000000001;2;Field  ;
                CaptionML=[ENU=Field;
                           NLD=Veld];
                SourceExpr=FieldNoText;
                OnLookup=VAR
                           Relation@1000000001 : Record 11148625;
                           FieldText@1000000000 : Text[30];
                         BEGIN
                           IF Relation.GET("Relation Entry No.") THEN BEGIN
                             FieldText := FORMAT("Field No.");
                             EXIT(Mgt.LookupFieldNo(Relation."Table No.", FieldText, FALSE));
                           END;
                         END;
                          }

    { 1100531003;2;Field  ;
                SourceExpr=Type }

    { 1000000000;2;Field  ;
                CaptionML=[ENU=Value;
                           NLD=Waarde];
                SourceExpr=ValueText }

  }
  CODE
  {
    VAR
      Mgt@1000000000 : Codeunit 11148589;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117032 CI - Import Messages
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Messages;
               NLD=Berichtenoverzicht];
    InsertAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table11148609;
    PageType=List;
    CardPageID=CI - Import Message Card;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Related;
                                NLD=Nieuw,Verwerken,Lijst,Gerelateerd];
    ActionList=ACTIONS
    {
      { 1000000011;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000003;1 ;Action    ;
                      Name=<Action1000020>;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Process;
                                 NLD=Verwerken];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Process;
                               END;
                                }
      { 1000000010;  ;ActionContainer;
                      Name=<Action1900000003>;
                      ActionContainerType=RelatedInformation }
      { 1000000009;1 ;ActionGroup;
                      Name=<Action1000013>;
                      CaptionML=[ENU=&Message;
                                 NLD=Be&richt] }
      { 1000000007;2 ;Action    ;
                      Name=<Action1000030>;
                      ShortCutKey=Ctrl+F5;
                      CaptionML=[ENU=History;
                                 NLD=Historie];
                      RunObject=Page 11117034;
                      RunPageView=SORTING(Message Entry No.);
                      RunPageLink=Message Entry No.=FIELD(Entry No.);
                      Promoted=Yes;
                      Image=History;
                      PromotedCategory=Category4 }
      { 1000000006;2 ;Action    ;
                      Name=<Action1000031>;
                      CaptionML=[ENU=Comments;
                                 NLD=Op&merkingen];
                      RunObject=Page 11117035;
                      RunPageView=SORTING(Message Entry No.);
                      RunPageLink=Message Entry No.=FIELD(Entry No.);
                      Promoted=Yes;
                      Image=Note;
                      PromotedCategory=Category4 }
      { 1000000005;2 ;Action    ;
                      Name=<Action1000000000>;
                      CaptionML=[ENU=Show;
                                 NLD=Toon];
                      Promoted=Yes;
                      Image=View;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 Show;
                               END;
                                }
      { 1000000004;1 ;ActionGroup;
                      Name=<Action1000014>;
                      CaptionML=[ENU=F&unctions;
                                 NLD=F&uncties] }
      { 1000000001;2 ;Action    ;
                      Name=<Action1000028>;
                      CaptionML=[ENU=Export;
                                 NLD=Exporteren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Export;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Export;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr="Entry No.";
                Editable=FALSE }

    { 1000003;2;Field     ;
                SourceExpr=Type;
                Editable=FALSE }

    { 1000005;2;Field     ;
                SourceExpr=Code;
                Editable=FALSE }

    { 1000007;2;Field     ;
                SourceExpr=Path;
                Editable=FALSE;
                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder(Path);
                             END;
                              }

    { 1000009;2;Field     ;
                SourceExpr=File;
                Editable=FALSE }

    { 1000011;2;Field     ;
                SourceExpr="Logged By";
                Editable=FALSE }

    { 1000013;2;Field     ;
                SourceExpr=Date;
                Editable=FALSE }

    { 1000015;2;Field     ;
                SourceExpr=Time;
                Editable=FALSE }

    { 1000020;2;Field     ;
                SourceExpr=Status;
                Editable=FALSE }

    { 1000031;2;Field     ;
                SourceExpr="No. of History Lines" }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117033 CI - Message Subform
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Message Subform;
               NLD=Berichtsubform];
    SourceTable=Table11148610;
    PageType=ListPart;
    OnNewRecord=VAR
                  NewPos@1000000 : Integer;
                  NewPos2@1000001 : Integer;
                BEGIN
                  IF xRec.COUNT = 0 THEN BEGIN
                    "Line No." := 10000;
                    EXIT;
                  END;

                  IF BelowxRec THEN BEGIN
                    "Line No." := xRec."Line No." + 10000;
                    EXIT;
                  END;

                  NewPos := xRec."Line No.";
                  IF xRec.NEXT(-1) <> 0 THEN BEGIN
                    NewPos2 := xRec."Line No.";
                    xRec.NEXT(1);
                  END;

                  "Line No." := ROUND(NewPos2 + ((NewPos - NewPos2) / 2), 1);
                END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr=Text }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117034 CI - Message History
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Message History;
               NLD=Berichtenhistorie];
    SourceTable=Table11148611;
    PageType=List;
    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000022 ;1   ;ActionGroup;
                      CaptionML=[ENU=H&istory;
                                 NLD=H&istorie] }
      { 1000023 ;2   ;Action    ;
                      ShortCutKey=Shift+F5;
                      CaptionML=[ENU=Message;
                                 NLD=Kaart];
                      OnAction=VAR
                                 Message@1000002 : Record 11148609;
                                 ImportMessageCard@1000000 : Page 11117054;
                                 ExportMessageCard@1000001 : Page 11117055;
                               BEGIN
                                 Message.SETRANGE("Entry No.", "Message Entry No.");

                                 CASE Type OF
                                   Type::Import :
                                     BEGIN
                                       ImportMessageCard.SETTABLEVIEW(Message);
                                       ImportMessageCard.RUNMODAL;
                                     END;

                                   Type::Export :
                                     BEGIN
                                       ExportMessageCard.SETTABLEVIEW(Message);
                                       ExportMessageCard.RUNMODAL;
                                     END;

                                 END;
                               END;
                                }
      { 1000026 ;2   ;Action    ;
                      CaptionML=[ENU=Comments;
                                 NLD=Opmerkingen];
                      RunObject=Page 11117035;
                      RunPageView=SORTING(Message Entry No.);
                      RunPageLink=Message Entry No.=FIELD(Message Entry No.) }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr="Entry No." }

    { 1000003;2;Field     ;
                SourceExpr="Message Entry No." }

    { 1000005;2;Field     ;
                SourceExpr=Type }

    { 1000007;2;Field     ;
                SourceExpr=Code }

    { 1000024;2;Field     ;
                SourceExpr=Path;
                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder(Path);
                             END;
                              }

    { 1000027;2;Field     ;
                SourceExpr=File }

    { 1000029;2;Field     ;
                SourceExpr=Status }

    { 1000009;2;Field     ;
                SourceExpr="Executed By" }

    { 1000011;2;Field     ;
                SourceExpr=Date }

    { 1000013;2;Field     ;
                SourceExpr=Time }

    { 1000015;2;Field     ;
                SourceExpr=Error }

    { 1000020;2;Field     ;
                SourceExpr="No. of Comments" }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117035 CI - History Comments
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=History Comments;
               NLD=Historie opmerkingen];
    InsertAllowed=No;
    DeleteAllowed=Yes;
    ModifyAllowed=No;
    SourceTable=Table11148612;
    SourceTableView=SORTING(History Entry No.,Line No.)
                    ORDER(Descending);
    PageType=List;
    ActionList=ACTIONS
    {
      { 1000000001;  ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000000002;1 ;Action    ;
                      CaptionML=[ENU=Messages;
                                 NLD=Berichten];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=View;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 message@1000000000 : Record 11148609;
                               BEGIN
                                 message.SETRANGE("Entry No.", "History Entry No.");

                                 CASE Type OF
                                   Type::Import : PAGE.RUN(PAGE::"CI - Import Message Card", message);
                                   Type::Export : PAGE.RUN(PAGE::"CI - Export Message Card", message);
                                 END;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr="History Entry No.";
                Editable=FALSE }

    { 1000003;2;Field     ;
                SourceExpr="Line No.";
                Editable=FALSE }

    { 1000005;2;Field     ;
                SourceExpr=File;
                Editable=FALSE }

    { 1000007;2;Field     ;
                SourceExpr=Key;
                Editable=FALSE }

    { 1000013;2;Field     ;
                SourceExpr=Error;
                Editable=FALSE }

    { 1000000000;2;Field  ;
                SourceExpr="Error No.";
                Editable=FALSE }

    { 1000018;2;Field     ;
                SourceExpr="Error Type";
                Editable=FALSE }

    { 1000009;2;Field     ;
                SourceExpr=Comment;
                Editable=FALSE }

    { 1000011;2;Field     ;
                SourceExpr="Comment 2";
                Editable=FALSE }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
      CI-166: Changed sort order to descending; newer entries tend to be more relevant to the average user
    }
    END.
  }
}

OBJECT Page 11117036 CI - Export Messages
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Messages;
               NLD=Berichtenoverzicht];
    InsertAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table11148609;
    SourceTableView=SORTING(Entry No.)
                    ORDER(Descending);
    PageType=List;
    CardPageID=CI - Export Message Card;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Related;
                                NLD=Nieuw,Verwerken,Lijst,Gerelateerd];
    ActionList=ACTIONS
    {
      { 1000000009;  ;ActionContainer;
                      Name=<Action1000000011>;
                      ActionContainerType=ActionItems }
      { 1000000008;1 ;Action    ;
                      Name=<Action1000020>;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Process;
                                 NLD=Verwerken];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Process;
                               END;
                                }
      { 1000000007;  ;ActionContainer;
                      Name=<Action1900000003>;
                      ActionContainerType=RelatedInformation }
      { 1000000006;1 ;ActionGroup;
                      Name=<Action1000013>;
                      CaptionML=[ENU=&Message;
                                 NLD=Be&richt] }
      { 1000000005;2 ;Action    ;
                      Name=<Action1000030>;
                      ShortCutKey=Ctrl+F5;
                      CaptionML=[ENU=History;
                                 NLD=Historie];
                      RunObject=Page 11117034;
                      RunPageView=SORTING(Message Entry No.);
                      RunPageLink=Message Entry No.=FIELD(Entry No.);
                      Promoted=Yes;
                      Image=History;
                      PromotedCategory=Category4 }
      { 1000000004;2 ;Action    ;
                      Name=<Action1000031>;
                      CaptionML=[ENU=Comments;
                                 NLD=Op&merkingen];
                      RunObject=Page 11117035;
                      RunPageView=SORTING(Message Entry No.);
                      RunPageLink=Message Entry No.=FIELD(Entry No.);
                      Promoted=Yes;
                      Image=Note;
                      PromotedCategory=Category4 }
      { 1000000003;2 ;Action    ;
                      Name=<Action1000000000>;
                      CaptionML=[ENU=Show;
                                 NLD=Toon];
                      Promoted=Yes;
                      Image=View;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 Show;
                               END;
                                }
      { 1000000002;1 ;ActionGroup;
                      Name=<Action1000014>;
                      CaptionML=[ENU=F&unctions;
                                 NLD=F&uncties] }
      { 1000000000;2 ;Action    ;
                      Name=<Action1000028>;
                      CaptionML=[ENU=Export;
                                 NLD=Exporteren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Export;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Export;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr="Entry No.";
                Editable=FALSE }

    { 1000003;2;Field     ;
                SourceExpr=Type;
                Editable=FALSE }

    { 1000005;2;Field     ;
                SourceExpr=Code;
                Editable=FALSE }

    { 1000007;2;Field     ;
                SourceExpr=Path;
                Editable=FALSE;
                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder(Path);
                             END;
                              }

    { 1000009;2;Field     ;
                SourceExpr=File;
                Editable=FALSE }

    { 1000011;2;Field     ;
                SourceExpr="Logged By";
                Editable=FALSE }

    { 1000013;2;Field     ;
                SourceExpr=Date;
                Editable=FALSE }

    { 1000015;2;Field     ;
                SourceExpr=Time;
                Editable=FALSE }

    { 1000020;2;Field     ;
                SourceExpr=Status;
                Editable=FALSE }

    { 1000031;2;Field     ;
                SourceExpr="No. of History Lines" }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
      CI-166: Changed sort order to descending; newer entries tend to be more relevant to the average user
    }
    END.
  }
}

OBJECT Page 11117039 CI - Comment Sheet
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Comment Sheet;
               NLD=Opmerkingen];
    MultipleNewLines=Yes;
    SourceTable=Table11148613;
    DelayedInsert=Yes;
    DataCaptionFields=Code;
    PageType=List;
    AutoSplitKey=Yes;
    OnNewRecord=BEGIN
                  SetUpNewLine;
                END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr=Date }

    { 4   ;2   ;Field     ;
                SourceExpr=Comment }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117040 CI - Comment List
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Comment List;
               NLD=Opmerkingoverzicht];
    SourceTable=Table11148613;
    DataCaptionFields=Code;
    PageType=List;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr=Code }

    { 4   ;2   ;Field     ;
                SourceExpr=Date }

    { 6   ;2   ;Field     ;
                SourceExpr=Comment }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117041 CI - Start Handlers
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Start Handlers;
               NLD=Verwerkers starten];
    PageType=List;
    OnOpenPage=VAR
                 Initialize@1000000 : Codeunit 11148625;
               BEGIN
                 Initialize.CheckInitialize;
                   OnActivateForm;
               END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000005 ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NLD=F&uncties] }
      { 1000009 ;2   ;Action    ;
                      CaptionML=[ENU=Start &Sync. Inbox Handler;
                                 NLD=Synchr. &postvak verwerker starten];
                      OnAction=BEGIN
                                 SyncInboxHandler.Start;
                               END;
                                }
      { 1000017 ;2   ;Action    ;
                      CaptionML=[ENU=Stop Sync. Inbox &Handler;
                                 NLD=Synchr. postvak verwerker st&oppen];
                      OnAction=BEGIN
                                 SyncInboxHandler.Stop;
                               END;
                                }
      { 1000018 ;2   ;Separator  }
      { 1000019 ;2   ;Action    ;
                      CaptionML=[ENU=Start &Task Handler;
                                 NLD=Taakverwerker starten];
                      OnAction=BEGIN
                                 TaskHandler.Start;
                               END;
                                }
      { 1000020 ;2   ;Action    ;
                      CaptionML=[ENU=St&op Task Handler;
                                 NLD=Taakverwerker stoppe&n];
                      OnAction=BEGIN
                                 TaskHandler.Stop;
                               END;
                                }
      { 1000021 ;2   ;Action    ;
                      CaptionML=[ENU=Task Han&dler Log;
                                 NLD=Taakverwerker &log];
                      RunObject=Page 11117047 }
      { 1000007 ;2   ;Separator  }
      { 1000008 ;2   ;Action    ;
                      CaptionML=[ENU=Start &Connector Handler;
                                 NLD=Connectorverwerker starten];
                      OnAction=BEGIN
                                 ConnectorHandler.Start;
                               END;
                                }
      { 1000010 ;2   ;Action    ;
                      CaptionML=[ENU=Sto&p Connector Handler;
                                 NLD=Connectorver&werker stoppen];
                      OnAction=BEGIN
                                 ConnectorHandler.Stop;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                CaptionML=[ENU=General;
                           NLD=Algemeen] }

    { 1000015;2;Field     ;
                CaptionML=[ENU=Sync. Inbox Handler Started;
                           NLD=Synchr. postvak verwerker gestart];
                SourceExpr=SyncInboxHandler.IsStarted }

    { 1000012;2;Field     ;
                CaptionML=[ENU=No. of Messages in Inbox;
                           NLD=Aantal berichten in inbox];
                SourceExpr=NoOfRecords;
                Editable=FALSE;
                OnDrillDown=VAR
                              SynchronisationInbox@1000000 : Page 11117051;
                            BEGIN
                              SynchronisationInbox.RUN;
                            END;
                             }

    { 1000011;2;Field     ;
                CaptionML=[ENU=No. of Messages in Failed;
                           NLD=Aantal berichten mislukt];
                SourceExpr=NoOfRecordsFailed;
                Editable=FALSE;
                OnDrillDown=VAR
                              SynchronizationInbox@1000002 : Record 11148618;
                              FormSynchronisationInbox@1000000 : Page 11117051;
                            BEGIN
                              SynchronizationInbox.SETRANGE(Status, SynchronizationInbox.Status::Error);
                              FormSynchronisationInbox.SETTABLEVIEW(SynchronizationInbox);

                              FormSynchronisationInbox.RUN;
                            END;
                             }

    { 1000001;2;Field     ;
                CaptionML=[ENU=Task Handler Started;
                           NLD=Taakverwerker gestart];
                SourceExpr=TaskHandler.IsStarted }

    { 1000003;2;Field     ;
                CaptionML=[ENU=Connector Handler Started;
                           NLD=Connectorverwerker gestart];
                SourceExpr=ConnectorHandler.IsStarted }

  }
  CODE
  {
    VAR
      TaskHandler@1000001 : Codeunit 11148656;
      SyncInboxHandler@1000002 : Codeunit 11148658;
      ConnectorHandler@1000000 : Codeunit 11148660;
      NoOfRecords@1000004 : Integer;
      NoOfRecordsFailed@1000003 : Integer;

    LOCAL PROCEDURE UpdateNoOfRecords@1000000();
    VAR
      SynchronizationInbox@1000000 : Record 11148618;
    BEGIN
      NoOfRecords := SynchronizationInbox.COUNT;
      SynchronizationInbox.SETRANGE(Status, SynchronizationInbox.Status::Error);
      NoOfRecordsFailed := SynchronizationInbox.COUNT;
    END;

    LOCAL PROCEDURE OnDeactivateForm@19063942();
    BEGIN
      UpdateNoOfRecords;
    END;

    LOCAL PROCEDURE OnActivateForm@19002417();
    BEGIN
      UpdateNoOfRecords;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117042 CI - Task List
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Task List;
               NLD=Taakoverzicht];
    SourceTable=Table11148614;
    PageType=List;
    CardPageID=CI - Task Card;
    OnAfterGetRecord=BEGIN
                       TableFilterOnFormat(FORMAT("Table Filter"));
                     END;

    ActionList=ACTIONS
    {
      { 1900000003;  ;ActionContainer;
                      Name=<Action1900000003>;
                      ActionContainerType=ActionItems }
      { 1000023 ;1   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Execute;
                                 NLD=Uitvoeren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ctExecuted@1000001 : TextConst 'ENU=Task Executed.;NLD=Taak uitgevoerd.';
                               BEGIN
                                 Process;
                                 MESSAGE(ctExecuted);
                               END;
                                }
      { 1000024 ;1   ;Action    ;
                      CaptionML=[ENU=Reset Status;
                                 NLD=Status resetten];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Cancel;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ResetStatus;
                               END;
                                }
      { 1000018 ;1   ;ActionGroup;
                      CaptionML=[ENU=Tas&k;
                                 NLD=&Taak] }
      { 1000020 ;2   ;Action    ;
                      ShortCutKey=Shift+Ctrl+O;
                      CaptionML=[ENU=Objects;
                                 NLD=Objecten];
                      Promoted=Yes;
                      Image=Setup;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ShowObjects;
                               END;
                                }
      { 1000021 ;2   ;Action    ;
                      ShortCutKey=Ctrl+L;
                      CaptionML=[ENU=Log;
                                 NLD=Log];
                      RunObject=Page 11117047;
                      RunPageView=SORTING(Task Code);
                      RunPageLink=Task Code=FIELD(Code);
                      Promoted=Yes;
                      Image=Note;
                      PromotedCategory=Process }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr=Code }

    { 1000003;2;Field     ;
                SourceExpr=Description }

    { 1000025;2;Field     ;
                SourceExpr="Project Code" }

    { 1000005;2;Field     ;
                SourceExpr="Object Type" }

    { 1000007;2;Field     ;
                SourceExpr="Table Filter";
                OnAssistEdit=VAR
                               INMgt@1000000000 : Codeunit 11148589;
                             BEGIN
                               EVALUATE("Table Filter", INMgt.SetTableFilter("Table No.", FORMAT("Table Filter"))); // CI-143
                             END;
                              }

    { 1000012;2;Field     ;
                SourceExpr="Start Next Time" }

    { 1000016;2;Field     ;
                SourceExpr=Result }

    { 1000014;2;Field     ;
                SourceExpr="Error Text" }

  }
  CODE
  {

    LOCAL PROCEDURE TableFilterOnFormat@19013929(Text@19048068 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableFilter(Text, "Table No.");
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117043 CI - Task Card
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Task Card;
               NLD=Taak];
    SourceTable=Table11148614;
    PageType=Card;
    OnInit=BEGIN
             TypeEnable := TRUE;
             PlanningEditable := TRUE;
             "Project CodeEditable" := TRUE;
             WaitAfterRunObjectsEditable := TRUE;
             "Single ObjectEditable" := TRUE;
             "Table FilterEditable" := TRUE;
             TypeEditable := TRUE;
             DescriptionEditable := TRUE;
             CodeEditable := TRUE;
           END;

    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                       TableFilterOnFormat(FORMAT("Table Filter"));
                       ObjectNoOnFormat(FORMAT("Object No."));
                     END;

    OnNewRecord=BEGIN
                  VALIDATE("Object Type");
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000003;  ;ActionContainer;
                      Name=<Action1900000003>;
                      ActionContainerType=ActionItems }
      { 1000014 ;1   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Process;
                                 NLD=Verwerken];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ctExecuted@1000001 : TextConst 'ENU=Task Executed.;NLD=Taak uitgevoerd.';
                               BEGIN
                                 Process;
                                 MESSAGE(ctExecuted);
                               END;
                                }
      { 1000035 ;1   ;Action    ;
                      CaptionML=[ENU=Reset Result;
                                 NLD=Resultaat resetten];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Cancel;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ResetStatus;
                               END;
                                }
      { 1000011 ;1   ;ActionGroup;
                      CaptionML=[ENU=Tas&k;
                                 NLD=&Taak] }
      { 1000023 ;2   ;Action    ;
                      ShortCutKey=Shift+Ctrl+O;
                      CaptionML=[ENU=Objects;
                                 NLD=O&bjecten];
                      Promoted=Yes;
                      Image=Setup;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ShowObjects;
                               END;
                                }
      { 1000032 ;2   ;Action    ;
                      ShortCutKey=Ctrl+F5;
                      CaptionML=[ENU=Lo&g;
                                 NLD=Log];
                      RunObject=Page 11117047;
                      RunPageView=SORTING(Task Code);
                      RunPageLink=Task Code=FIELD(Code);
                      Promoted=Yes;
                      Image=Note;
                      PromotedCategory=Process }
      { 1000000000;1 ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NLD=F&uncties];
                      ActionContainerType=NewDocumentItems }
      { 1000000001;2 ;Action    ;
                      CaptionML=[ENU=Copy To;
                                 NLD=Kopieer naar];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Copy;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CopyTo;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                CaptionML=[ENU=General;
                           NLD=Algemeen] }

    { 1000001;2;Field     ;
                SourceExpr=Code;
                Editable=CodeEditable }

    { 1000003;2;Field     ;
                SourceExpr=Description;
                Editable=DescriptionEditable }

    { 1000021;2;Field     ;
                SourceExpr="Single Object";
                Editable="Single ObjectEditable";
                OnValidate=BEGIN
                             SingleObjectOnAfterValidate;
                           END;
                            }

    { 1000005;2;Field     ;
                SourceExpr="Object Type";
                Enabled=TypeEnable;
                Editable=TypeEditable;
                OnValidate=BEGIN
                             TypeOnAfterValidate;
                           END;
                            }

    { 1000007;2;Field     ;
                AssistEdit=Yes;
                SourceExpr="Table Filter";
                Enabled=TableFilterEnabled;
                Editable="Table FilterEditable";
                OnAssistEdit=VAR
                               INMgt@1000000000 : Codeunit 11148589;
                             BEGIN
                               EVALUATE("Table Filter", INMgt.SetTableFilter("Table No.", FORMAT("Table Filter"))); // CI-143
                             END;
                              }

    { 1000038;2;Field     ;
                SourceExpr="Object No.";
                Enabled=ObjectNoEnabled;
                OnLookup=VAR
                           Mgt@1000000 : Codeunit 11148589;
                         BEGIN
                           EXIT(Mgt.LookupObjectNo("Object Type" - 6, Text));
                         END;
                          }

    { 1000000002;2;Field  ;
                SourceExpr="Continue on Failure";
                Enabled=ContinueOnFailureEnabled;
                Editable=ContinueOnFailureEditable }

    { 1100512002;2;Field  ;
                SourceExpr="Wait After Run Object (s.)";
                Editable=WaitAfterRunObjectsEditable }

    { 1000019;2;Field     ;
                SourceExpr=Status;
                OnValidate=BEGIN
                             StatusOnAfterValidate;
                           END;
                            }

    { 1000017;2;Field     ;
                DrillDown=No;
                SourceExpr="Start Next Time" }

    { 1000024;2;Field     ;
                SourceExpr=Result }

    { 1000026;2;Field     ;
                SourceExpr="Last Time Started" }

    { 1000028;2;Field     ;
                SourceExpr="Last Time Ended" }

    { 1000030;2;Field     ;
                SourceExpr="Error Text" }

    { 1000010;1;Part      ;
                Name=Planning;
                SubPageView=SORTING(Task Code);
                SubPageLink=Task Code=FIELD(Code);
                PagePartID=Page11117044;
                Editable=PlanningEditable }

    { 1902793001;1;Group  ;
                CaptionML=[ENU=Project;
                           NLD=Project] }

    { 1000036;2;Field     ;
                SourceExpr="Project Code";
                Editable="Project CodeEditable" }

  }
  CODE
  {
    VAR
      CodeEditable@19001698 : Boolean INDATASET;
      DescriptionEditable@19061412 : Boolean INDATASET;
      TypeEditable@19028748 : Boolean INDATASET;
      "Table FilterEditable"@19054732 : Boolean INDATASET;
      "Single ObjectEditable"@19045661 : Boolean INDATASET;
      WaitAfterRunObjectsEditable@19042780 : Boolean INDATASET;
      "Project CodeEditable"@19062497 : Boolean INDATASET;
      PlanningEditable@19026975 : Boolean INDATASET;
      TypeEnable@19061234 : Boolean INDATASET;
      ObjectNoEnabled@1100543000 : Boolean INDATASET;
      TableFilterEnabled@1100543001 : Boolean INDATASET;
      ContinueOnFailureEnabled@1000000000 : Boolean INDATASET;
      ContinueOnFailureEditable@1000000001 : Boolean INDATASET;

    LOCAL PROCEDURE SetEnabled@1000001();
    BEGIN
      TypeEnable := "Single Object";
      ObjectNoEnabled := ("Single Object") AND ("Object Type" >= "Object Type"::Report);
      TableFilterEnabled := ("Single Object") AND ("Object Type" < "Object Type"::Report);
      ContinueOnFailureEnabled := "Single Object"; // CI-136
    END;

    LOCAL PROCEDURE SetEditable@1000000();
    BEGIN
      CodeEditable := (Status = Status::Edit);
      DescriptionEditable := (Status = Status::Edit);
      TypeEditable := (Status = Status::Edit);
      "Table FilterEditable" := (Status = Status::Edit);
      "Single ObjectEditable" := (Status = Status::Edit);
      WaitAfterRunObjectsEditable := (Status = Status::Edit);
      "Project CodeEditable" := (Status = Status::Edit);
      PlanningEditable := (Status = Status::Edit);
      ContinueOnFailureEditable := (Status = Status::Edit); // CI-136
    END;

    LOCAL PROCEDURE TypeOnAfterValidate@19069045();
    BEGIN
      SetEnabled;
    END;

    LOCAL PROCEDURE SingleObjectOnAfterValidate@19038921();
    BEGIN
      SetEnabled;
    END;

    LOCAL PROCEDURE StatusOnAfterValidate@19072689();
    BEGIN
      SetEditable;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      SetEnabled;
      SetEditable;
    END;

    LOCAL PROCEDURE TableFilterOnAfterInput@19072298(VAR Text@19072299 : Text[1024]);
    VAR
      Mgt@1000002 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableFilter(Text, "Table No.");
    END;

    LOCAL PROCEDURE ObjectNoOnAfterInput@19005964(VAR Text@19005965 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputObjectNo("Object Type" - 6, Text);
    END;

    LOCAL PROCEDURE TableFilterOnFormat@19013929(Text@19048068 : Text[1024]);
    VAR
      Mgt@1000002 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableFilter(Text, "Table No.");
    END;

    LOCAL PROCEDURE ObjectNoOnFormat@19060290(Text@19048661 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatObjectNo("Object Type" - 6, Text, "Object No.");
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117044 CI - Task Planning
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Task Planning;
               NLD=Taakplanning];
    SourceTable=Table11148616;
    PageType=List;
    OnInit=BEGIN
             SundayEditable := TRUE;
             SaterdayEditable := TRUE;
             FridayEditable := TRUE;
             ThirsdayEditable := TRUE;
             WednesdayEditable := TRUE;
             TuesdayEditable := TRUE;
             MondayEditable := TRUE;
             "Moment TimeEditable" := TRUE;
             MomentEditable := TRUE;
             IntervalEditable := TRUE;
             "Active TillEditable" := TRUE;
             "Active FromEditable" := TRUE;
           END;

    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                       MomentOnFormat(FORMAT(Moment));
                     END;

    OnNewRecord=BEGIN
                  SetupNewLine(xRec, BelowxRec);
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1906717604;1 ;ActionGroup;
                      CaptionML=[ENU=&Planning;
                                 NLD=&Planning] }
      { 1900342704;2 ;Action    ;
                      ShortCutKey=Shift+F5;
                      CaptionML=[ENU=Card;
                                 NLD=Kaart];
                      OnAction=BEGIN
                                 _ShowProperties;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                GroupType=Repeater }

    { 1000000000;2;Field  ;
                SourceExpr="Task Group Code" }

    { 1000027;2;Field     ;
                SourceExpr="Start Next Time" }

    { 1000001;2;Field     ;
                SourceExpr=Cycle;
                OnValidate=BEGIN
                             CycleOnAfterValidate;
                           END;
                            }

    { 1000003;2;Field     ;
                SourceExpr=Interval;
                Editable=IntervalEditable }

    { 1000005;2;Field     ;
                SourceExpr=Moment;
                Editable=MomentEditable }

    { 1000007;2;Field     ;
                SourceExpr="Moment Time";
                Editable="Moment TimeEditable" }

    { 1000009;2;Field     ;
                SourceExpr="Active From";
                Editable="Active FromEditable" }

    { 1000011;2;Field     ;
                SourceExpr="Active Till";
                Editable="Active TillEditable" }

    { 1000013;2;Field     ;
                SourceExpr=Monday;
                Editable=MondayEditable;
                OnValidate=BEGIN
                             MondayOnAfterValidate;
                           END;
                            }

    { 1000015;2;Field     ;
                SourceExpr=Tuesday;
                Editable=TuesdayEditable;
                OnValidate=BEGIN
                             TuesdayOnAfterValidate;
                           END;
                            }

    { 1000017;2;Field     ;
                SourceExpr=Wednesday;
                Editable=WednesdayEditable;
                OnValidate=BEGIN
                             WednesdayOnAfterValidate;
                           END;
                            }

    { 1000019;2;Field     ;
                SourceExpr=Thursday;
                Editable=ThirsdayEditable;
                OnValidate=BEGIN
                             ThirsdayOnAfterValidate;
                           END;
                            }

    { 1000021;2;Field     ;
                SourceExpr=Friday;
                Editable=FridayEditable;
                OnValidate=BEGIN
                             FridayOnAfterValidate;
                           END;
                            }

    { 1000023;2;Field     ;
                SourceExpr=Saturday;
                Editable=SaterdayEditable;
                OnValidate=BEGIN
                             SaterdayOnAfterValidate;
                           END;
                            }

    { 1000025;2;Field     ;
                SourceExpr=Sunday;
                Editable=SundayEditable;
                OnValidate=BEGIN
                             SundayOnAfterValidate;
                           END;
                            }

  }
  CODE
  {
    VAR
      "Active FromEditable"@19037316 : Boolean INDATASET;
      "Active TillEditable"@19046064 : Boolean INDATASET;
      IntervalEditable@19008219 : Boolean INDATASET;
      MomentEditable@19000405 : Boolean INDATASET;
      "Moment TimeEditable"@19007244 : Boolean INDATASET;
      MondayEditable@19073569 : Boolean INDATASET;
      TuesdayEditable@19033640 : Boolean INDATASET;
      WednesdayEditable@19016869 : Boolean INDATASET;
      ThirsdayEditable@19041650 : Boolean INDATASET;
      FridayEditable@19008797 : Boolean INDATASET;
      SaterdayEditable@19052307 : Boolean INDATASET;
      SundayEditable@19075793 : Boolean INDATASET;

    PROCEDURE _ShowProperties@19005009();
    BEGIN
      ShowProperties;
    END;

    PROCEDURE ShowProperties@1000000();
    BEGIN
      ShowProperties;
    END;

    LOCAL PROCEDURE SetFormEditable@1000001();
    BEGIN
      "Active FromEditable" := (Cycle IN [Cycle::Second, Cycle::Minute, Cycle::Hour]);
      "Active TillEditable" := (Cycle IN [Cycle::Second, Cycle::Minute, Cycle::Hour]);

      IF Cycle <> Cycle::Day THEN
        IntervalEditable := (TRUE)
      ELSE
        IntervalEditable := (Monday AND Tuesday AND Wednesday AND Thursday AND Friday AND Saturday AND Sunday);

      MomentEditable := (Cycle IN [Cycle::Hour, Cycle::Week, Cycle::Month, Cycle::Year]);
      "Moment TimeEditable" := (Cycle IN [Cycle::Day, Cycle::Week, Cycle::Month, Cycle::Year]);

      MondayEditable := (Cycle IN [Cycle::Second, Cycle::Minute, Cycle::Hour, Cycle::Day]);
      TuesdayEditable := (Cycle IN [Cycle::Second, Cycle::Minute, Cycle::Hour, Cycle::Day]);
      WednesdayEditable := (Cycle IN [Cycle::Second, Cycle::Minute, Cycle::Hour, Cycle::Day]);
      ThirsdayEditable := (Cycle IN [Cycle::Second, Cycle::Minute, Cycle::Hour, Cycle::Day]);
      FridayEditable := (Cycle IN [Cycle::Second, Cycle::Minute, Cycle::Hour, Cycle::Day]);
      SaterdayEditable := (Cycle IN [Cycle::Second, Cycle::Minute, Cycle::Hour, Cycle::Day]);
      SundayEditable := (Cycle IN [Cycle::Second, Cycle::Minute, Cycle::Hour, Cycle::Day]);
    END;

    LOCAL PROCEDURE CycleOnAfterValidate@19052976();
    BEGIN
      SetFormEditable;
    END;

    LOCAL PROCEDURE MondayOnAfterValidate@19007363();
    BEGIN
      SetFormEditable;
    END;

    LOCAL PROCEDURE TuesdayOnAfterValidate@19056583();
    BEGIN
      SetFormEditable;
    END;

    LOCAL PROCEDURE WednesdayOnAfterValidate@19034974();
    BEGIN
      SetFormEditable;
    END;

    LOCAL PROCEDURE ThirsdayOnAfterValidate@19056144();
    BEGIN
      SetFormEditable;
    END;

    LOCAL PROCEDURE FridayOnAfterValidate@19048746();
    BEGIN
      SetFormEditable;
    END;

    LOCAL PROCEDURE SaterdayOnAfterValidate@19068851();
    BEGIN
      SetFormEditable;
    END;

    LOCAL PROCEDURE SundayOnAfterValidate@19007756();
    BEGIN
      SetFormEditable;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      SetFormEditable;
    END;

    LOCAL PROCEDURE MomentOnAfterInput@19003652(VAR Text@19003653 : Text[1024]);
    BEGIN
      AfterInputMoment(Text);
    END;

    LOCAL PROCEDURE MomentOnFormat@19071274(Text@19064655 : Text[1024]);
    BEGIN
      FormatMoment(Text);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117045 CI - Task Planning Card
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Task Planning Card;
               NLD=Taakplanning];
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table11148616;
    PageType=Card;
    OnInit=BEGIN
             IntervalEnable := TRUE;
           END;

    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                       MomentOnFormat(FORMAT(Moment));
                     END;

    OnNewRecord=BEGIN
                  OnAfterGetCurrRecord;
                END;

    OnModifyRecord=BEGIN
                     IF NOT MODIFY(TRUE) THEN
                       INSERT(TRUE);

                     EXIT(FALSE);
                   END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000002;1;Group      }

    { 1000000000;2;Field  ;
                SourceExpr="Task Group Code" }

    { 1000003;2;Field     ;
                SourceExpr=Cycle;
                OnValidate=BEGIN
                             CycleOnAfterValidate;
                           END;
                            }

    { 1000009;2;Field     ;
                SourceExpr=Interval;
                Enabled=IntervalEnable }

    { 1000025;2;Field     ;
                SourceExpr=Moment;
                Enabled=momentenable }

    { 1000000;2;Field     ;
                SourceExpr="Moment Time";
                Enabled=momenttimeenable }

    { 1000005;2;Field     ;
                SourceExpr="Active From";
                Enabled=activefromenable }

    { 1000007;2;Field     ;
                SourceExpr="Active Till";
                Enabled=activetillenable }

    { 1000028;2;Field     ;
                SourceExpr="Start Next Time" }

    { 1000011;2;Field     ;
                SourceExpr=Monday;
                Enabled=mondayenable;
                OnValidate=BEGIN
                             MondayOnAfterValidate;
                           END;
                            }

    { 1000013;2;Field     ;
                SourceExpr=Tuesday;
                Enabled=tuesdayenable;
                OnValidate=BEGIN
                             TuesdayOnAfterValidate;
                           END;
                            }

    { 1000015;2;Field     ;
                SourceExpr=Wednesday;
                Enabled=wednesdayenable;
                OnValidate=BEGIN
                             WednesdayOnAfterValidate;
                           END;
                            }

    { 1000017;2;Field     ;
                SourceExpr=Thursday;
                Enabled=thursday;
                OnValidate=BEGIN
                             ThirsdayOnAfterValidate;
                           END;
                            }

    { 1000019;2;Field     ;
                SourceExpr=Friday;
                Enabled=fridayenable;
                OnValidate=BEGIN
                             FridayOnAfterValidate;
                           END;
                            }

    { 1000021;2;Field     ;
                SourceExpr=Saturday;
                Enabled=saturdayenable;
                OnValidate=BEGIN
                             SaterdayOnAfterValidate;
                           END;
                            }

    { 1000023;2;Field     ;
                SourceExpr=Sunday;
                Enabled=sundayenable;
                OnValidate=BEGIN
                             SundayOnAfterValidate;
                           END;
                            }

  }
  CODE
  {
    VAR
      IntervalEnable@19068897 : Boolean INDATASET;
      ActiveFromEnable@1100543014 : Boolean INDATASET;
      ActiveTillEnable@1100543013 : Boolean INDATASET;
      MomentEnable@1100543012 : Boolean INDATASET;
      MomentTimeEnable@1100543011 : Boolean INDATASET;
      MondayEnable@1100543010 : Boolean INDATASET;
      TuesdayEnable@1100543009 : Boolean INDATASET;
      WednesdayEnable@1100543008 : Boolean INDATASET;
      ThursdayEnable@1100543007 : Boolean INDATASET;
      FridayEnable@1100543006 : Boolean INDATASET;
      SaturdayEnable@1100543005 : Boolean INDATASET;
      SundayEnable@1100543004 : Boolean INDATASET;

    LOCAL PROCEDURE SetFormEnabled@1000000();
    BEGIN
      ActiveFromEnable := Cycle IN [Cycle::Second, Cycle::Minute, Cycle::Hour];
      ActiveTillEnable := Cycle IN [Cycle::Second, Cycle::Minute, Cycle::Hour];

      IF Cycle <> Cycle::Day THEN
        IntervalEnable := TRUE
      ELSE
        IntervalEnable := Monday AND Tuesday AND Wednesday AND Thursday AND Friday AND Saturday AND Sunday;

      MomentEnable := Cycle IN [Cycle::Hour, Cycle::Week, Cycle::Month, Cycle::Year];
      MomentTimeEnable := Cycle IN [Cycle::Day, Cycle::Week, Cycle::Month, Cycle::Year];

      MondayEnable := Cycle IN [Cycle::Second, Cycle::Minute, Cycle::Hour, Cycle::Day];
      TuesdayEnable := Cycle IN [Cycle::Second, Cycle::Minute, Cycle::Hour, Cycle::Day];
      WednesdayEnable := Cycle IN [Cycle::Second, Cycle::Minute, Cycle::Hour, Cycle::Day];
      ThursdayEnable := Cycle IN [Cycle::Second, Cycle::Minute, Cycle::Hour, Cycle::Day];
      FridayEnable := Cycle IN [Cycle::Second, Cycle::Minute, Cycle::Hour, Cycle::Day];
      SaturdayEnable := Cycle IN [Cycle::Second, Cycle::Minute, Cycle::Hour, Cycle::Day];
      SundayEnable := Cycle IN [Cycle::Second, Cycle::Minute, Cycle::Hour, Cycle::Day];
    END;

    LOCAL PROCEDURE SetFormEditable@1000001();
    VAR
      Task@1000000 : Record 11148614;
    BEGIN
      IF Task.GET("Task Code") THEN
        ;
      CurrPage.EDITABLE(Task.Status = Task.Status::Edit);
    END;

    LOCAL PROCEDURE CycleOnAfterValidate@19052976();
    BEGIN
      SetFormEnabled;
    END;

    LOCAL PROCEDURE MondayOnAfterValidate@19007363();
    BEGIN
      SetFormEnabled;
    END;

    LOCAL PROCEDURE TuesdayOnAfterValidate@19056583();
    BEGIN
      SetFormEnabled;
    END;

    LOCAL PROCEDURE WednesdayOnAfterValidate@19034974();
    BEGIN
      SetFormEnabled;
    END;

    LOCAL PROCEDURE ThirsdayOnAfterValidate@19056144();
    BEGIN
      SetFormEnabled;
    END;

    LOCAL PROCEDURE FridayOnAfterValidate@19048746();
    BEGIN
      SetFormEnabled;
    END;

    LOCAL PROCEDURE SaterdayOnAfterValidate@19068851();
    BEGIN
      SetFormEnabled;
    END;

    LOCAL PROCEDURE SundayOnAfterValidate@19007756();
    BEGIN
      SetFormEnabled;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      SetFormEnabled;
      SetFormEditable;
    END;

    LOCAL PROCEDURE MomentOnAfterInput@19003652(VAR Text@19003653 : Text[1024]);
    BEGIN
    END;

    LOCAL PROCEDURE MomentOnFormat@19071274(Text@19064655 : Text[1024]);
    BEGIN
      FormatMoment(Text);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117046 CI - Task Objects
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Task Objects;
               NLD=Taakobjecten];
    SourceTable=Table11148615;
    PageType=List;
    AutoSplitKey=Yes;
    OnInit=BEGIN
             "Table FilterEditable" := TRUE;
             "Object No.Editable" := TRUE;
           END;

    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                       TableFilterOnFormat(FORMAT("Table Filter"));
                       ObjectNoOnFormat(FORMAT("Object No."));
                     END;

    OnNewRecord=BEGIN
                  VALIDATE(Type);
                  OnAfterGetCurrRecord;
                END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                GroupType=Repeater }

    { 1000004;2;Field     ;
                SourceExpr=Type;
                OnValidate=BEGIN
                             TypeOnAfterValidate;
                           END;
                            }

    { 1000006;2;Field     ;
                AssistEdit=Yes;
                SourceExpr="Table Filter";
                Editable="Table FilterEditable";
                OnAssistEdit=VAR
                               INMgt@1000000000 : Codeunit 11148589;
                             BEGIN
                               EVALUATE("Table Filter", INMgt.SetTableFilter("Table No.", FORMAT("Table Filter"))); // CI-143
                             END;
                              }

    { 1000008;2;Field     ;
                SourceExpr="Object No.";
                Editable="Object No.Editable";
                OnLookup=VAR
                           Mgt@1000000 : Codeunit 11148589;
                         BEGIN
                           EXIT(Mgt.LookupObjectNo(Type - 6, Text));
                         END;
                          }

    { 1000000000;2;Field  ;
                SourceExpr="Continue on Failure" }

  }
  CODE
  {
    VAR
      "Object No.Editable"@19056942 : Boolean INDATASET;
      "Table FilterEditable"@19054732 : Boolean INDATASET;

    LOCAL PROCEDURE SetEditable@1000001();
    BEGIN
      "Object No.Editable" := (Type >= Type::Report);
      "Table FilterEditable" := (Type < Type::Report);
    END;

    LOCAL PROCEDURE TypeOnAfterValidate@19069045();
    BEGIN
      SetEditable;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      SetEditable;
    END;

    LOCAL PROCEDURE TableFilterOnAfterInput@19072298(VAR Text@19072299 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableFilter(Text, "Table No.");
    END;

    LOCAL PROCEDURE ObjectNoOnAfterInput@19005964(VAR Text@19005965 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputObjectNo(Type - 6, Text);
    END;

    LOCAL PROCEDURE TableFilterOnFormat@19013929(Text@19048068 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableFilter(Text, "Table No.");
    END;

    LOCAL PROCEDURE ObjectNoOnFormat@19060290(Text@19048661 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatObjectNo(Type - 6, Text, "Object No.");
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117047 CI - Task Log
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Task Log;
               NLD=Taakhistorie];
    InsertAllowed=No;
    SourceTable=Table11148617;
    DataCaptionFields=Task Code;
    PageType=List;
    OnAfterGetRecord=BEGIN
                       TableFilterText := FORMAT("Table Filter");
                       TableFilterTextOnFormat(TableFilterText);
                     END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr="Entry No." }

    { 1000014;2;Field     ;
                SourceExpr="Executed By" }

    { 1000003;2;Field     ;
                SourceExpr="Task Code" }

    { 1000016;2;Field     ;
                SourceExpr=Type }

    { 1000018;2;Field     ;
                SourceExpr=TableFilterText;
                CaptionClass=FIELDCAPTION("Table Filter");
                Editable=FALSE }

    { 1000005;2;Field     ;
                SourceExpr=Started }

    { 1000007;2;Field     ;
                SourceExpr=Ended }

    { 1000009;2;Field     ;
                SourceExpr="Error Text" }

  }
  CODE
  {
    VAR
      TableFilterText@19034498 : Text[1024] INDATASET;

    LOCAL PROCEDURE TableFilterTextOnFormat@19007962(VAR Text@19047238 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableFilter(Text, "Table No.");
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117048 CI - Trace Message List
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Trace Messages List;
               NLD=Traceerberichtenoverzicht];
    SourceTable=Table11148629;
    PageType=List;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1100531000;1;Group  ;
                Editable=FALSE;
                GroupType=Repeater }

    { 1100531001;2;Field  ;
                SourceExpr="Entry No." }

    { 1100531003;2;Field  ;
                SourceExpr="Trace Rule" }

    { 1100531005;2;Field  ;
                SourceExpr=Date }

    { 1100531007;2;Field  ;
                SourceExpr=Time }

    { 1100531009;2;Field  ;
                SourceExpr="User Id" }

    { 1100531011;2;Field  ;
                SourceExpr="Trace Entry No." }

    { 1100531013;2;Field  ;
                SourceExpr="E-Mail Status" }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117049 CI - Companies
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Companies;
               NLD=Bedrijven];
    SourceTable=Table2000000006;
    PageType=List;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1100496000;1;Group  ;
                GroupType=Repeater }

    { 1100496001;2;Field  ;
                SourceExpr=Name }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117051 CI - Synchronization Inbox
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Synchronization Inbox;
               NLD=Synchronisatie inbox];
    InsertAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table11148618;
    PageType=List;
    ActionList=ACTIONS
    {
      { 1900000003;  ;ActionContainer;
                      Name=<Action1900000003>;
                      ActionContainerType=ActionItems }
      { 1000017 ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NLD=F&uncties] }
      { 1000016 ;2   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Process;
                                 NLD=Verwerken];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Process;
                               END;
                                }
      { 1000018 ;2   ;Action    ;
                      CaptionML=[ENU=Show Message;
                                 NLD=Bericht tonen];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=View;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ShowDocument;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr="Entry No." }

    { 1000003;2;Field     ;
                SourceExpr="Import Definition" }

    { 1000005;2;Field     ;
                SourceExpr="Date Time Inserted" }

    { 1000007;2;Field     ;
                SourceExpr="Source Company" }

    { 1000009;2;Field     ;
                SourceExpr=Document;
                Editable=FALSE }

    { 1000011;2;Field     ;
                SourceExpr=Status }

    { 1000019;2;Field     ;
                SourceExpr="Error Text" }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117052 CI - Show Inbox Message
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Show Inbox Message;
               NLD=Inbox bericht tonen];
    SourceTable=Table11148610;
    PageType=List;
    OnNewRecord=VAR
                  NewPos@1000000 : Integer;
                  NewPos2@1000001 : Integer;
                BEGIN
                  IF xRec.COUNT = 0 THEN BEGIN
                    "Line No." := 10000;
                    EXIT;
                  END;

                  IF BelowxRec THEN BEGIN
                    "Line No." := xRec."Line No." + 10000;
                    EXIT;
                  END;

                  NewPos := xRec."Line No.";
                  IF xRec.NEXT(-1) <> 0 THEN BEGIN
                    NewPos2 := xRec."Line No.";
                    xRec.NEXT(1);
                  END;

                  "Line No." := ROUND(NewPos2 + ((NewPos - NewPos2) / 2), 1);
                END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr=Text }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117054 CI - Import Message Card
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Import Message Card;
               NLD=Importbericht];
    InsertAllowed=No;
    SourceTable=Table11148609;
    SourceTableView=SORTING(Entry No.)
                    WHERE(Type=CONST(Import));
    PageType=Card;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Related;
                                NLD=Nieuw,Verwerken,Lijst,Gerelateerd];
    OnOpenPage=VAR
                 Initialize@1000000 : Codeunit 11148625;
               BEGIN
                 Initialize.CheckInitialize;
               END;

    ActionList=ACTIONS
    {
      { 1000000008;  ;ActionContainer;
                      Name=<Action1000000011>;
                      ActionContainerType=ActionItems }
      { 1000000009;1 ;Action    ;
                      Name=<Action1000020>;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Process;
                                 NLD=Verwerken];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Process;
                               END;
                                }
      { 1000000006;  ;ActionContainer;
                      Name=<Action1900000003>;
                      ActionContainerType=RelatedInformation }
      { 1000000007;1 ;ActionGroup;
                      Name=<Action1000013>;
                      CaptionML=[ENU=&Message;
                                 NLD=Be&richt] }
      { 1000000004;2 ;Action    ;
                      Name=<Action1000030>;
                      ShortCutKey=Ctrl+F5;
                      CaptionML=[ENU=History;
                                 NLD=Historie];
                      RunObject=Page 11117034;
                      RunPageView=SORTING(Message Entry No.);
                      RunPageLink=Message Entry No.=FIELD(Entry No.);
                      Promoted=Yes;
                      Image=History;
                      PromotedCategory=Category4 }
      { 1000000005;2 ;Action    ;
                      Name=<Action1000031>;
                      CaptionML=[ENU=Comments;
                                 NLD=Op&merkingen];
                      RunObject=Page 11117035;
                      RunPageView=SORTING(Message Entry No.);
                      RunPageLink=Message Entry No.=FIELD(Entry No.);
                      Promoted=Yes;
                      Image=Note;
                      PromotedCategory=Category4 }
      { 1000000002;2 ;Action    ;
                      Name=<Action1000000000>;
                      CaptionML=[ENU=Show;
                                 NLD=Toon];
                      Promoted=Yes;
                      Image=View;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 Show;
                               END;
                                }
      { 1000000003;1 ;ActionGroup;
                      Name=<Action1000014>;
                      CaptionML=[ENU=F&unctions;
                                 NLD=F&uncties] }
      { 1000000001;2 ;Action    ;
                      Name=<Action1000028>;
                      CaptionML=[ENU=Export;
                                 NLD=Exporteren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Export;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Export;
                               END;
                                }
      { 1000000000;2 ;Action    ;
                      Name=<Action1000034>;
                      CaptionML=[ENU=Import;
                                 NLD=Importeren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Import;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Import;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                CaptionML=[ENU=General;
                           NLD=Algemeen] }

    { 1000001;2;Field     ;
                SourceExpr="Entry No." }

    { 1000003;2;Field     ;
                SourceExpr=Type }

    { 1000005;2;Field     ;
                SourceExpr=Code }

    { 1000016;2;Field     ;
                SourceExpr=Path;
                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder(Path);
                             END;
                              }

    { 1000018;2;Field     ;
                SourceExpr=File }

    { 1000007;2;Field     ;
                SourceExpr="Logged By" }

    { 1000022;2;Field     ;
                SourceExpr=Date }

    { 1000024;2;Field     ;
                SourceExpr=Time }

    { 1000032;2;Field     ;
                SourceExpr="No. of History Lines" }

    { 1000035;2;Field     ;
                SourceExpr="No. of Comments" }

    { 1000026;2;Field     ;
                SourceExpr=Status }

    { 1000011;1;Part      ;
                SubPageView=SORTING(Message Entry No.,Line No.);
                SubPageLink=Message Entry No.=FIELD(Entry No.);
                PagePartID=Page11117033 }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117055 CI - Export Message Card
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Export Message Card;
               NLD=Exportbericht];
    InsertAllowed=No;
    SourceTable=Table11148609;
    SourceTableView=SORTING(Entry No.)
                    WHERE(Type=CONST(Export));
    PageType=Card;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Related;
                                NLD=Nieuw,Verwerken,Lijst,Gerelateerd];
    OnOpenPage=VAR
                 Initialize@1000000 : Codeunit 11148625;
               BEGIN
                 Initialize.CheckInitialize;
               END;

    ActionList=ACTIONS
    {
      { 1000000008;  ;ActionContainer;
                      Name=<Action1000000011>;
                      ActionContainerType=ActionItems }
      { 1000000009;1 ;Action    ;
                      Name=<Action1000020>;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Process;
                                 NLD=Verwerken];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Process;
                               END;
                                }
      { 1000000006;  ;ActionContainer;
                      Name=<Action1900000003>;
                      ActionContainerType=RelatedInformation }
      { 1000000007;1 ;ActionGroup;
                      Name=<Action1000013>;
                      CaptionML=[ENU=&Message;
                                 NLD=Be&richt] }
      { 1000000004;2 ;Action    ;
                      Name=<Action1000030>;
                      ShortCutKey=Ctrl+F5;
                      CaptionML=[ENU=History;
                                 NLD=Historie];
                      RunObject=Page 11117034;
                      RunPageView=SORTING(Message Entry No.);
                      RunPageLink=Message Entry No.=FIELD(Entry No.);
                      Promoted=Yes;
                      Image=History;
                      PromotedCategory=Category4 }
      { 1000000005;2 ;Action    ;
                      Name=<Action1000031>;
                      CaptionML=[ENU=Comments;
                                 NLD=Op&merkingen];
                      RunObject=Page 11117035;
                      RunPageView=SORTING(Message Entry No.);
                      RunPageLink=Message Entry No.=FIELD(Entry No.);
                      Promoted=Yes;
                      Image=Note;
                      PromotedCategory=Category4 }
      { 1000000002;2 ;Action    ;
                      Name=<Action1000000000>;
                      CaptionML=[ENU=Show;
                                 NLD=Toon];
                      Promoted=Yes;
                      Image=View;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 Show;
                               END;
                                }
      { 1000000003;1 ;ActionGroup;
                      Name=<Action1000014>;
                      CaptionML=[ENU=F&unctions;
                                 NLD=F&uncties] }
      { 1000000001;2 ;Action    ;
                      Name=<Action1000028>;
                      CaptionML=[ENU=Export;
                                 NLD=Exporteren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Export;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Export;
                               END;
                                }
      { 1000000000;2 ;Action    ;
                      Name=<Action1000034>;
                      CaptionML=[ENU=Import;
                                 NLD=Importeren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Import;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Import;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                CaptionML=[ENU=General;
                           NLD=Algemeen] }

    { 1000001;2;Field     ;
                SourceExpr="Entry No." }

    { 1000003;2;Field     ;
                SourceExpr=Type }

    { 1000005;2;Field     ;
                SourceExpr=Code }

    { 1000016;2;Field     ;
                SourceExpr=Path;
                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder(Path);
                             END;
                              }

    { 1000018;2;Field     ;
                SourceExpr=File }

    { 1000007;2;Field     ;
                SourceExpr="Logged By" }

    { 1000022;2;Field     ;
                SourceExpr=Date }

    { 1000024;2;Field     ;
                SourceExpr=Time }

    { 1000032;2;Field     ;
                SourceExpr="No. of History Lines" }

    { 1000026;2;Field     ;
                SourceExpr=Status }

    { 1000011;1;Part      ;
                SubPageView=SORTING(Message Entry No.,Line No.);
                SubPageLink=Message Entry No.=FIELD(Entry No.);
                PagePartID=Page11117033 }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117056 CI - Project List
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Project List;
               NLD=Projectenoverzicht];
    SourceTable=Table11148620;
    PageType=List;
    CardPageID=CI - Project Card;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr=Code }

    { 1000003;2;Field     ;
                SourceExpr=Description }

    { 1000000001;2;Field  ;
                SourceExpr="Created On" }

    { 1000000002;2;Field  ;
                SourceExpr="Created By" }

    { 1000000003;2;Field  ;
                SourceExpr="Modified On" }

    { 1000000004;2;Field  ;
                SourceExpr="Modified By" }

    { 1000000005;2;Field  ;
                SourceExpr=Blocked }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117057 CI - Project Card
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Project Card;
               NLD=Project];
    SourceTable=Table11148620;
    PageType=Card;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Setup;
                                NLD=Nieuw,Verwerken,Lijst,Instellingen];
    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000003;  ;ActionContainer;
                      Name=<Action1900000003>;
                      ActionContainerType=ActionItems }
      { 1000009 ;1   ;ActionGroup;
                      CaptionML=[ENU=&Project;
                                 NLD=&Project] }
      { 1100531000;2 ;Action    ;
                      CaptionML=[ENU=Export XML Definition;
                                 NLD=Exporteer definitie naar XML];
                      Promoted=Yes;
                      Image=Export;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ExportDefinitionToXML@1100531000 : Codeunit 11148634;
                               BEGIN
                                 ExportDefinitionToXML.ExportProjectDefinition(Rec);
                               END;
                                }
      { 1100531001;2 ;Action    ;
                      CaptionML=[ENU=Import XML Definition;
                                 NLD=XML-Definitie importeren];
                      Promoted=Yes;
                      Image=Import;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ImportXMLDefinition@1100531000 : Codeunit 11148636;
                               BEGIN
                                 ImportXMLDefinition.ImportProjectDefinition(Rec);
                               END;
                                }
      { 1100531002;2 ;Separator  }
      { 1000015 ;2   ;Action    ;
                      ShortCutKey=Ctrl+R;
                      CaptionML=[ENU=Refresh Lines;
                                 NLD=Regels vernieuwen];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Refresh;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 RefreshLines;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                CaptionML=[ENU=General;
                           NLD=Algemeen] }

    { 1000003;2;Field     ;
                SourceExpr=Code }

    { 1000001;2;Field     ;
                SourceExpr=Description }

    { 1000000002;2;Field  ;
                SourceExpr="Created On" }

    { 1000000003;2;Field  ;
                SourceExpr="Created By" }

    { 1000000004;2;Field  ;
                SourceExpr="Modified On" }

    { 1000000005;2;Field  ;
                SourceExpr="Modified By" }

    { 1000016;2;Field     ;
                SourceExpr=Blocked;
                OnValidate=BEGIN
                             BlockedOnAfterValidate;
                           END;
                            }

    { 1000008;1;Part      ;
                Name=ProjectLines;
                SubPageView=SORTING(Project,Line No.);
                SubPageLink=Project=FIELD(Code);
                PagePartID=Page11117058 }

  }
  CODE
  {

    LOCAL PROCEDURE RefreshLines@1000000();
    BEGIN
      CurrPage.ProjectLines.PAGE.RebuildProjectLine(Rec, TRUE);
    END;

    LOCAL PROCEDURE BlockedOnAfterValidate@19012791();
    BEGIN
      RefreshLines;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      CurrPage.ProjectLines.PAGE.RebuildProjectLine(Rec, FALSE);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117058 CI - Project Subform
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Project Subform;
               NLD=Projectsubform];
    SaveValues=Yes;
    SourceTable=Table11148621;
    PageType=ListPart;
    OnFindRecord=BEGIN
                   //EXIT(FIND(Which));

                   gTmpProjectLine.COPYFILTERS(Rec);
                   gTmpProjectLine := Rec;

                   IF gTmpProjectLine.FIND(Which) THEN BEGIN
                     Rec := gTmpProjectLine;
                     EXIT(TRUE);
                   END;
                 END;

    OnNextRecord=VAR
                   ExitValue@1000000 : Integer;
                 BEGIN
                   //EXIT(NEXT(Steps));

                   gTmpProjectLine.COPYFILTERS(Rec);
                   gTmpProjectLine := Rec;

                   ExitValue := gTmpProjectLine.NEXT(Steps);
                   Rec := gTmpProjectLine;

                   EXIT(ExitValue);
                 END;

    OnAfterGetRecord=BEGIN
                       NoOfExportJobsHideValue := FALSE;
                       MonitoringSetupHideValue := FALSE;
                       NoOfCommentsHideValue := FALSE;
                       NoOfMessagesHideValue := FALSE;
                       DescriptionOnFormat;
                       NoOfMessagesOnFormat;
                       NoOfCommentsOnFormat;
                       MonitoringSetupOnFormat;
                       NoOfExportJobsOnFormat;
                     END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1907935204;1 ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 NLD=&Regel] }
      { 1905189504;2 ;Action    ;
                      ShortCutKey=Shift+F5;
                      CaptionML=[ENU=Card;
                                 NLD=Kaart];
                      OnAction=BEGIN
                                 _ShowCard;
                               END;
                                }
      { 1904795404;2 ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Verwerken;
                                 NLD=Verwerken];
                      OnAction=BEGIN
                                 _Process;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr=Type;
                Visible=FALSE }

    { 1000003;2;Field     ;
                Lookup=No;
                SourceExpr=Code;
                OnDrillDown=BEGIN
                              ShowCard;
                            END;
                             }

    { 1000005;2;Field     ;
                SourceExpr=Description;
                StyleExpr=DescriptionEmphasize }

    { 1000007;2;Field     ;
                SourceExpr=Status }

    { 1000009;2;Field     ;
                CaptionML=[ENU=No. of Messages;
                           NLD=Aantal berichten];
                SourceExpr=NoOfMessages;
                HideValue=NoOfMessagesHideValue;
                OnDrillDown=BEGIN
                              DrillDownNoOfMessages;
                            END;
                             }

    { 1000011;2;Field     ;
                CaptionML=[ENU=No. of Comments;
                           NLD=Aantal opmerkingen];
                SourceExpr=NoOfComments;
                HideValue=NoOfCommentsHideValue;
                OnDrillDown=BEGIN
                              DrillDownNoOfComments;
                            END;
                             }

    { 1000015;2;Field     ;
                CaptionML=[ENU=Monitoring Setup;
                           NLD=Aantal monitorinstellingen];
                SourceExpr=MonitoringSetup;
                HideValue=MonitoringSetupHideValue;
                OnDrillDown=BEGIN
                              DrillDownMonitoringSetup;
                            END;
                             }

    { 1000013;2;Field     ;
                CaptionML=[ENU=No. of Export Jobs;
                           NLD=Aantal exporteeropdrachten];
                SourceExpr=NoOfExportJobs;
                HideValue=NoOfExportJobsHideValue;
                OnDrillDown=BEGIN
                              DrillDownNoOfExportJobs;
                            END;
                             }

  }
  CODE
  {
    VAR
      gTmpProjectLine@1000000 : TEMPORARY Record 11148621;
      DescriptionEmphasize@19010547 : Boolean INDATASET;
      NoOfMessagesHideValue@19045320 : Boolean INDATASET;
      NoOfCommentsHideValue@19007343 : Boolean INDATASET;
      MonitoringSetupHideValue@19005879 : Boolean INDATASET;
      NoOfExportJobsHideValue@19058771 : Boolean INDATASET;

    PROCEDURE RebuildProjectLine@1000000(Project@1000005 : Record 11148620;CreateDummyLines@1000007 : Boolean);
    VAR
      Transport@1000002 : Record 11148590;
      ImportDefinition@1000000 : Record 11148591;
      ExportDefinition@1000001 : Record 11148599;
      Task@1000003 : Record 11148614;
      ProjectLine@1000006 : Record 11148621;
      Connector@1000013 : Record 11148623;
      ctConnectors@1000008 : TextConst 'ENU=Connectors;NLD=Connecters';
      ctExportDefinitions@1000009 : TextConst 'ENU=Export Definitions;NLD=Exportdefinities';
      ctImportDefinitions@1000012 : TextConst 'ENU=Import Definitions;NLD=Importdefinities';
      ctTasks@1000011 : TextConst 'ENU=Tasks;NLD=Taken';
      ctTransports@1000010 : TextConst 'ENU=Transports;NLD=Tarnsporten';
    BEGIN
      gTmpProjectLine.RESET;
      gTmpProjectLine.DELETEALL;

      gTmpProjectLine.Project := Project.Code;
      gTmpProjectLine."Line No." := 0;

      Task.SETCURRENTKEY("Project Code");
      Task.SETRANGE("Project Code", Project.Code);
      IF Task.FINDSET THEN BEGIN
        gTmpProjectLine."Line No." += 10000;
        gTmpProjectLine.Type := gTmpProjectLine.Type::" ";
        gTmpProjectLine.Code := '';
        gTmpProjectLine.Description := ctTasks;
        gTmpProjectLine.Status := gTmpProjectLine.Status::" ";
        gTmpProjectLine.INSERT;
        REPEAT
          gTmpProjectLine."Line No." += 10000;
          gTmpProjectLine.Type := gTmpProjectLine.Type::Task;
          gTmpProjectLine.Code := Task.Code;
          gTmpProjectLine.Description := Task.Description;
          gTmpProjectLine.Status := Task.Status;
          gTmpProjectLine.INSERT;
        UNTIL Task.NEXT = 0;
        gTmpProjectLine."Line No." += 10000;
        gTmpProjectLine.Type := gTmpProjectLine.Type::" ";
        gTmpProjectLine.Code := '';
        gTmpProjectLine.Description := '';
        gTmpProjectLine.Status := gTmpProjectLine.Status::" ";
        gTmpProjectLine.INSERT;
      END;

      ExportDefinition.SETCURRENTKEY("Project Code");
      ExportDefinition.SETRANGE("Project Code", Project.Code);
      IF ExportDefinition.FINDSET THEN BEGIN
        gTmpProjectLine."Line No." += 10000;
        gTmpProjectLine.Type := gTmpProjectLine.Type::" ";
        gTmpProjectLine.Code := '';
        gTmpProjectLine.Description := ctExportDefinitions;
        gTmpProjectLine.Status := gTmpProjectLine.Status::" ";
        gTmpProjectLine.INSERT;
        REPEAT
          gTmpProjectLine."Line No." += 10000;
          gTmpProjectLine.Type := gTmpProjectLine.Type::"Export Definition";
          gTmpProjectLine.Code := ExportDefinition.Code;
          gTmpProjectLine.Description := ExportDefinition.Description;
          gTmpProjectLine.Status := ExportDefinition.Status;
          gTmpProjectLine.INSERT;
        UNTIL ExportDefinition.NEXT = 0;
        gTmpProjectLine."Line No." += 10000;
        gTmpProjectLine.Type := gTmpProjectLine.Type::" ";
        gTmpProjectLine.Code := '';
        gTmpProjectLine.Description := '';
        gTmpProjectLine.Status := gTmpProjectLine.Status::" ";
        gTmpProjectLine.INSERT;
      END;

      ImportDefinition.SETCURRENTKEY("Project Code");
      ImportDefinition.SETRANGE("Project Code", Project.Code);
      IF ImportDefinition.FINDSET THEN BEGIN
        gTmpProjectLine."Line No." += 10000;
        gTmpProjectLine.Type := gTmpProjectLine.Type::" ";
        gTmpProjectLine.Code := '';
        gTmpProjectLine.Description := ctImportDefinitions;
        gTmpProjectLine.Status := gTmpProjectLine.Status::" ";
        gTmpProjectLine.INSERT;
        REPEAT
          gTmpProjectLine."Line No." += 10000;
          gTmpProjectLine.Type := gTmpProjectLine.Type::"Import Definition";
          gTmpProjectLine.Code := ImportDefinition.Code;
          gTmpProjectLine.Description := ImportDefinition.Description;
          gTmpProjectLine.Status := ImportDefinition.Status;
          gTmpProjectLine.INSERT;
        UNTIL ImportDefinition.NEXT = 0;
        gTmpProjectLine."Line No." += 10000;
        gTmpProjectLine.Type := gTmpProjectLine.Type::" ";
        gTmpProjectLine.Code := '';
        gTmpProjectLine.Description := '';
        gTmpProjectLine.Status := gTmpProjectLine.Status::" ";
        gTmpProjectLine.INSERT;
      END;

      Transport.SETCURRENTKEY("Project Code");
      Transport.SETRANGE("Project Code", Project.Code);
      IF Transport.FINDSET THEN BEGIN
        gTmpProjectLine."Line No." += 10000;
        gTmpProjectLine.Type := gTmpProjectLine.Type::" ";
        gTmpProjectLine.Code := '';
        gTmpProjectLine.Description := ctTransports;
        gTmpProjectLine.Status := gTmpProjectLine.Status::" ";
        gTmpProjectLine.INSERT;
        REPEAT
          gTmpProjectLine."Line No." += 10000;
          gTmpProjectLine.Type := gTmpProjectLine.Type::Transport;
          gTmpProjectLine.Code := Transport.Code;
          gTmpProjectLine.Description := Transport.Description;
          gTmpProjectLine.Status := Transport.Status;
          gTmpProjectLine.INSERT;
        UNTIL Transport.NEXT = 0;
        gTmpProjectLine."Line No." += 10000;
        gTmpProjectLine.Type := gTmpProjectLine.Type::" ";
        gTmpProjectLine.Code := '';
        gTmpProjectLine.Description := '';
        gTmpProjectLine.Status := gTmpProjectLine.Status::" ";
        gTmpProjectLine.INSERT;
      END;

      Connector.SETCURRENTKEY("Project Code");
      Connector.SETRANGE("Project Code", Project.Code);
      IF Connector.FINDSET THEN BEGIN
        gTmpProjectLine."Line No." += 10000;
        gTmpProjectLine.Type := gTmpProjectLine.Type::" ";
        gTmpProjectLine.Code := '';
        gTmpProjectLine.Description := ctConnectors;
        gTmpProjectLine.Status := gTmpProjectLine.Status::" ";
        gTmpProjectLine.INSERT;
        REPEAT
          gTmpProjectLine."Line No." += 10000;
          gTmpProjectLine.Type := gTmpProjectLine.Type::Connector;
          gTmpProjectLine.Code := Connector.Code;
          gTmpProjectLine.Description := Connector.Description;
          gTmpProjectLine.Status := Connector.Status;
          gTmpProjectLine.INSERT;
        UNTIL Connector.NEXT = 0;
        gTmpProjectLine."Line No." += 10000;
        gTmpProjectLine.Type := gTmpProjectLine.Type::" ";
        gTmpProjectLine.Code := '';
        gTmpProjectLine.Description := '';
        gTmpProjectLine.Status := gTmpProjectLine.Status::" ";
        gTmpProjectLine.INSERT;
      END;

      IF CreateDummyLines THEN
        IF gTmpProjectLine.FINDSET THEN
          REPEAT
            ProjectLine := gTmpProjectLine;
            IF NOT ProjectLine.INSERT THEN
              ProjectLine.MODIFY;
          UNTIL gTmpProjectLine.NEXT = 0;

      ProjectLine.SETRANGE(Project, Project.Code);
      IF NOT ProjectLine.ISEMPTY THEN
        CurrPage.UPDATE(FALSE);
    END;

    PROCEDURE _ShowCard@19003319();
    BEGIN
      ShowCard;
    END;

    PROCEDURE ShowCard@1000001();
    BEGIN
      ShowCard;
    END;

    PROCEDURE _Process@19003717();
    BEGIN
      Process;
    END;

    PROCEDURE Process@1000002();
    BEGIN
      Process;
    END;

    LOCAL PROCEDURE DescriptionOnFormat@19023855();
    BEGIN
      IF Status = Status::" " THEN
        DescriptionEmphasize := (TRUE);
    END;

    LOCAL PROCEDURE NoOfMessagesOnFormat@19005561();
    BEGIN
      IF NOT (Type IN [Type::"Import Definition", Type::"Export Definition"]) THEN
        NoOfMessagesHideValue := TRUE;
    END;

    LOCAL PROCEDURE NoOfCommentsOnFormat@19023763();
    BEGIN
      IF Type <> Type::"Import Definition" THEN
        NoOfCommentsHideValue := TRUE;
    END;

    LOCAL PROCEDURE MonitoringSetupOnFormat@19002405();
    BEGIN
      IF Type <> Type::"Export Definition" THEN
        MonitoringSetupHideValue := TRUE;
    END;

    LOCAL PROCEDURE NoOfExportJobsOnFormat@19037578();
    BEGIN
      IF Type <> Type::"Export Definition" THEN
        NoOfExportJobsHideValue := TRUE;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117061 CI - Monitoring Excluded Table
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Monitoring Excluded Tables;
               NLD=Monitoren uitgesloten tabellen];
    SourceTable=Table11148622;
    PageType=List;
    OnAfterGetRecord=BEGIN
                       TableNoOnFormat(FORMAT("Table No."));
                     END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr="Table No.";
                OnLookup=VAR
                           Mgt@1000000 : Codeunit 11148589;
                         BEGIN
                           EXIT(Mgt.LookupObjectNo(1, Text));
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.AssistTableNo("Table No.");
                             END;
                              }

  }
  CODE
  {

    LOCAL PROCEDURE TableNoOnAfterInput@19060375(VAR Text@19060376 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputObjectNo(1, Text);
    END;

    LOCAL PROCEDURE TableNoOnFormat@19071785(Text@19016339 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Table No.");
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117062 CI - Connector List
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Connector List;
               NLD=Connectorenoverzicht];
    SourceTable=Table11148623;
    PageType=List;
    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000012 ;1   ;ActionGroup;
                      CaptionML=[ENU=&Connector;
                                 NLD=&Connecter] }
      { 1000015 ;2   ;Action    ;
                      ShortCutKey=Shift+F5;
                      CaptionML=[ENU=Card;
                                 NLD=Kaart];
                      OnAction=BEGIN
                                 ShowCard;
                               END;
                                }
      { 1000016 ;2   ;Separator  }
      { 1000017 ;2   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Start;
                                 NLD=Start];
                      OnAction=BEGIN
                                 Start;
                               END;
                                }
      { 1000018 ;2   ;Action    ;
                      ShortCutKey=Shift+F11;
                      CaptionML=[ENU=S&top;
                                 NLD=S&top];
                      OnAction=BEGIN
                                 Stop;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr=Code }

    { 1000003;2;Field     ;
                SourceExpr=Description }

    { 1000005;2;Field     ;
                SourceExpr=Type }

    { 1000019;2;Field     ;
                CaptionML=[ENU=Active;
                           NLD=Aktief];
                SourceExpr=IsActive }

    { 1000010;2;Field     ;
                SourceExpr=Status }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117063 CI - Folder Monitoring Card
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Folder Monitoring Card;
               NLD=Foldermonitoring];
    SourceTable=Table11148623;
    SourceTableView=SORTING(Code)
                    WHERE(Type=CONST(File System));
    PageType=Card;
    OnInit=BEGIN
             StatusEditable := TRUE;
           END;

    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  Type := Type::"File System";
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000012 ;1   ;ActionGroup;
                      CaptionML=[ENU=&Connector;
                                 NLD=&Connecter] }
      { 1000014 ;2   ;Separator  }
      { 1000015 ;2   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Start;
                                 NLD=Start];
                      OnAction=BEGIN
                                 Start;
                               END;
                                }
      { 1000016 ;2   ;Action    ;
                      ShortCutKey=Shift+F11;
                      CaptionML=[ENU=S&top;
                                 NLD=S&top];
                      OnAction=BEGIN
                                 Stop;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                CaptionML=[ENU=General;
                           NLD=Algemeen] }

    { 1000001;2;Field     ;
                SourceExpr=Code;
                Editable=Codeeditable }

    { 1000003;2;Field     ;
                SourceExpr=Description;
                Editable=descriptioneditable }

    { 1000017;2;Field     ;
                SourceExpr=Folder;
                Editable=foldereditable;
                OnLookup=VAR
                           Mgt@1000003 : Codeunit 11148589;
                           NewFolder@1000002 : Text[250];
                         BEGIN
                           NewFolder := Mgt.BrowseForFolder('', '');
                           IF NewFolder <> '' THEN
                             Folder := NewFolder;
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder(Folder);
                             END;
                              }

    { 1000005;2;Field     ;
                SourceExpr=Status;
                Editable=StatusEditable;
                OnValidate=BEGIN
                             StatusOnAfterValidate;
                           END;
                            }

    { 1000018;2;Field     ;
                CaptionML=[ENU=Active;
                           NLD=Aktief];
                SourceExpr=IsActive }

    { 1000022;2;Field     ;
                SourceExpr="Run Import Def.";
                Editable=runimportdefeditable }

    { 1000035;2;Field     ;
                SourceExpr="Run Task";
                Editable=runtaskeditable }

    { 1000026;1;Part      ;
                Name=Lines;
                SubPageLink=Connector Code=FIELD(Code);
                PagePartID=Page11117064;
                Editable=lineseditable }

    { 1902793001;1;Group  ;
                CaptionML=[ENU=Project;
                           NLD=Project] }

    { 1000037;2;Field     ;
                SourceExpr="Project Code" }

  }
  CODE
  {
    VAR
      StatusEditable@19074876 : Boolean INDATASET;
      CodeEditable@1000000005 : Boolean INDATASET;
      DescriptionEditable@1000000004 : Boolean INDATASET;
      FolderEditable@1000000003 : Boolean INDATASET;
      RunImportDefEditable@1000000002 : Boolean INDATASET;
      RunTaskEditable@1000000001 : Boolean INDATASET;
      LinesEditable@1000000000 : Boolean INDATASET;

    LOCAL PROCEDURE SetEditable@1000003();
    VAR
      IsActive2@1000000 : Boolean;
    BEGIN
      IsActive2 := IsActive;

      CodeEditable := (Status = Status::Edit) AND NOT IsActive2;
      DescriptionEditable := (Status = Status::Edit) AND NOT IsActive2;
      StatusEditable := NOT IsActive2;
      FolderEditable := (Status = Status::Edit) AND NOT IsActive2;
      RunImportDefEditable := (Status = Status::Edit) AND NOT IsActive2;
      RunTaskEditable := (Status = Status::Edit) AND NOT IsActive2;

      LinesEditable := (Status = Status::Edit) AND NOT IsActive2;
    END;

    LOCAL PROCEDURE StatusOnAfterValidate@19072689();
    BEGIN
      SetEditable;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      SetEditable;
    END;

    LOCAL PROCEDURE FolderOnAfterInput@19053936(VAR Text@19053937 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFolder(Text);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117064 CI - Folder Monitoring Subform
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Folder Monitoring Subform;
               NLD=Foldermonitoringsubform];
    SourceTable=Table11148624;
    PageType=ListPart;
    AutoSplitKey=Yes;
    OnNewRecord=BEGIN
                  Type := Type::Filename;
                END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                OptionCaptionML=[ENU=Filename,Filename contains;
                                 NLD=Bestandsnaam,Bestandsnaam bevat];
                SourceExpr=Type }

    { 1000005;2;Field     ;
                SourceExpr=Value }

    { 1000007;2;Field     ;
                SourceExpr="Run Import Def." }

    { 1000013;2;Field     ;
                SourceExpr="Run Task" }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117065 CI - Message Queue Card
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Message Queue Card;
               NLD=Message Queue];
    SourceTable=Table11148623;
    SourceTableView=SORTING(Code)
                    WHERE(Type=CONST(Message Queue));
    PageType=Card;
    OnInit=BEGIN
             "Reply QueueEditable" := TRUE;
             "Request QueueEditable" := TRUE;
             StatusEditable := TRUE;
           END;

    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  Type := Type::"Message Queue";
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000012 ;1   ;ActionGroup;
                      CaptionML=[ENU=&Connector;
                                 NLD=&Connecter] }
      { 1000014 ;2   ;Separator  }
      { 1000015 ;2   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Start;
                                 NLD=Start];
                      OnAction=BEGIN
                                 Start;
                               END;
                                }
      { 1000016 ;2   ;Action    ;
                      ShortCutKey=Shift+F11;
                      CaptionML=[ENU=S&top;
                                 NLD=S&top];
                      OnAction=BEGIN
                                 Stop;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                CaptionML=[ENU=General;
                           NLD=Algemeen] }

    { 1000001;2;Field     ;
                SourceExpr=Code;
                Editable=codeeditable }

    { 1000003;2;Field     ;
                SourceExpr=Description;
                Editable=descriptioneditable }

    { 1000008;2;Field     ;
                SourceExpr="Request Queue";
                Editable="Request QueueEditable" }

    { 1000027;2;Field     ;
                SourceExpr="Reply Queue";
                Editable="Reply QueueEditable" }

    { 1000005;2;Field     ;
                SourceExpr=Status;
                Editable=StatusEditable;
                OnValidate=BEGIN
                             StatusOnAfterValidate;
                           END;
                            }

    { 1000018;2;Field     ;
                CaptionML=[ENU=Active;
                           NLD=Aktief];
                SourceExpr=IsActive }

    { 1000022;2;Field     ;
                SourceExpr="Run Import Def.";
                Editable=[RunimportDefEditable ] }

    { 1000017;2;Field     ;
                SourceExpr="Run Export Def. Ok";
                Editable=[RunExportDefOkEditable ] }

    { 1000024;2;Field     ;
                SourceExpr="Run Export Def. Error";
                Editable=[RunExportDeferrorEditable ] }

    { 1000035;2;Field     ;
                SourceExpr="Run Task";
                Editable=runtaskeditable }

    { 1000026;1;Part      ;
                Name=Lines;
                SubPageLink=Connector Code=FIELD(Code);
                PagePartID=Page11117066;
                Editable=lineseditable }

    { 1902793001;1;Group  ;
                CaptionML=[ENU=Project;
                           NLD=Project] }

    { 1000037;2;Field     ;
                SourceExpr="Project Code" }

  }
  CODE
  {
    VAR
      StatusEditable@19074876 : Boolean INDATASET;
      "Request QueueEditable"@19003274 : Boolean INDATASET;
      "Reply QueueEditable"@19020404 : Boolean INDATASET;
      CodeEditable@1000000005 : Boolean INDATASET;
      DescriptionEditable@1000000004 : Boolean INDATASET;
      RunImportDefEditable@1000000003 : Boolean INDATASET;
      RunExportDefOkEditable@1000000002 : Boolean INDATASET;
      RunExportDefErrorEditable@1000000001 : Boolean INDATASET;
      RunTaskEditable@1000000000 : Boolean INDATASET;
      LinesEditable@1000000006 : Boolean INDATASET;

    LOCAL PROCEDURE SetEditable@1000003();
    VAR
      IsActive2@1000000 : Boolean;
    BEGIN
      IsActive2 := IsActive;

      CodeEditable := (Status = Status::Edit) AND NOT IsActive2;
      DescriptionEditable := (Status = Status::Edit) AND NOT IsActive2;
      StatusEditable := (NOT IsActive2);
      "Request QueueEditable" := (NOT IsActive2);
      "Reply QueueEditable" := (NOT IsActive2);
      RunImportDefEditable := (Status = Status::Edit) AND NOT IsActive2;
      RunExportDefOkEditable := (Status = Status::Edit) AND NOT IsActive2;
      RunExportDefErrorEditable := (Status = Status::Edit) AND NOT IsActive2;
      RunTaskEditable := (Status = Status::Edit) AND NOT IsActive2;

      LinesEditable := (Status = Status::Edit) AND NOT IsActive2;
    END;

    LOCAL PROCEDURE StatusOnAfterValidate@19072689();
    BEGIN
      SetEditable;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      SetEditable;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117066 CI - Message Queue Subform
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Message Queue Subform;
               NLD=Message Queue subform];
    SourceTable=Table11148624;
    PageType=ListPart;
    AutoSplitKey=Yes;
    OnNewRecord=BEGIN
                  Type := Type::"Element Value";
                END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                OptionCaptionML=[ENU=,,Element Value;
                                 NLD=,,Elementwaarde];
                SourceExpr=Type }

    { 1000003;2;Field     ;
                SourceExpr=Element }

    { 1000005;2;Field     ;
                SourceExpr=Value }

    { 1000007;2;Field     ;
                SourceExpr="Run Import Def." }

    { 1000009;2;Field     ;
                SourceExpr="Run Export Def. Ok" }

    { 1000011;2;Field     ;
                SourceExpr="Run Export Def. Error" }

    { 1000013;2;Field     ;
                SourceExpr="Run Task" }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117067 CI - Web Service Card
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Web Service Card;
               NLD=Webservice];
    SourceTable=Table11148623;
    SourceTableView=SORTING(Code)
                    WHERE(Type=CONST(Web Service));
    PageType=Card;
    OnInit=BEGIN
             PortEditable := TRUE;
             FolderEditable := TRUE;
             StatusEditable := TRUE;
           END;

    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  Type := Type::"Web Service";
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000012 ;1   ;ActionGroup;
                      CaptionML=[ENU=&Connector;
                                 NLD=&Connecter] }
      { 1000014 ;2   ;Separator  }
      { 1000015 ;2   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Start;
                                 NLD=Start];
                      OnAction=BEGIN
                                 Start;
                               END;
                                }
      { 1000016 ;2   ;Action    ;
                      ShortCutKey=Shift+F11;
                      CaptionML=[ENU=S&top;
                                 NLD=S&top];
                      OnAction=BEGIN
                                 Stop;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                CaptionML=[ENU=General;
                           NLD=Algemeen] }

    { 1000001;2;Field     ;
                SourceExpr=Code;
                Editable=codeEditable }

    { 1000003;2;Field     ;
                SourceExpr=Description;
                Editable=descriptionEditable }

    { 1000008;2;Field     ;
                SourceExpr=Port;
                Editable=PortEditable }

    { 1000005;2;Field     ;
                SourceExpr=Status;
                Editable=StatusEditable;
                OnValidate=BEGIN
                             StatusOnAfterValidate;
                           END;
                            }

    { 1000018;2;Field     ;
                CaptionML=[ENU=Active;
                           NLD=Aktief];
                SourceExpr=IsActive }

    { 1902793001;1;Group  ;
                CaptionML=[ENU=Project;
                           NLD=Project] }

    { 1000037;2;Field     ;
                SourceExpr="Project Code" }

  }
  CODE
  {
    VAR
      StatusEditable@19074876 : Boolean INDATASET;
      FolderEditable@19040546 : Boolean INDATASET;
      PortEditable@19053792 : Boolean INDATASET;
      CodeEditable@1000000005 : Boolean INDATASET;
      DescriptionEditable@1000000004 : Boolean INDATASET;
      RunImportDefEditable@1000000003 : Boolean INDATASET;
      RunExportDefOkEditable@1000000002 : Boolean INDATASET;
      RunExportDefErrorEditable@1000000001 : Boolean INDATASET;
      RunTaskEditable@1000000000 : Boolean INDATASET;

    LOCAL PROCEDURE SetEditable@1000003();
    VAR
      IsActive2@1000000 : Boolean;
    BEGIN
      IsActive2 := IsActive;
      CodeEditable := (Status = Status::Edit) AND NOT IsActive2;
      DescriptionEditable := (Status = Status::Edit) AND NOT IsActive2;
      StatusEditable := (NOT IsActive2);
      FolderEditable := (NOT IsActive2);
      PortEditable := (NOT IsActive2);
      RunImportDefEditable := (Status = Status::Edit) AND NOT IsActive2;
      RunExportDefOkEditable := (Status = Status::Edit) AND NOT IsActive2;
      RunExportDefErrorEditable := (Status = Status::Edit) AND NOT IsActive2;
      RunTaskEditable := (Status = Status::Edit) AND NOT IsActive2;

      //CurrForm.Lines.EDITABLE((Status = Status::Edit) AND NOT IsActive2);
    END;

    LOCAL PROCEDURE StatusOnAfterValidate@19072689();
    BEGIN
      SetEditable;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      SetEditable;
    END;

    LOCAL PROCEDURE FolderOnAfterInput@19053936(VAR Text@19053937 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFolder(Text);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117068 CI - Web Service Subform
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Web Service Subform;
               NLD=Webservicesubform];
    SourceTable=Table11148624;
    PageType=ListPart;
    AutoSplitKey=Yes;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr=Type }

    { 1000003;2;Field     ;
                SourceExpr=Element }

    { 1000005;2;Field     ;
                SourceExpr=Value }

    { 1000007;2;Field     ;
                SourceExpr="Run Import Def." }

    { 1000009;2;Field     ;
                SourceExpr="Run Export Def. Ok" }

    { 1000011;2;Field     ;
                SourceExpr="Run Export Def. Error" }

    { 1000013;2;Field     ;
                SourceExpr="Run Task" }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117069 CI - XML Import Card
{
  OBJECT-PROPERTIES
  {
    Date=14-07-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.1;
  }
  PROPERTIES
  {
    CaptionML=[ENU=XML Import Card;
               NLD=XML Importdefinitie];
    SourceTable=Table11148591;
    SourceTableView=WHERE(File Format=CONST(XML));
    PageType=Card;
    OnInit=BEGIN
             RightEnable := TRUE;
             LeftEnable := TRUE;
             "Archive add YYYYMMDDEnable" := TRUE;
             "Sub Table No. of FieldsEnable" := TRUE;
             "Sub Table No.Enable" := TRUE;
             ErrorNotificIncludeFileEnable := TRUE;
             "Save to MessagesEnable" := TRUE;
             "Error LocationEnable" := TRUE;
             "Log LocationEnable" := TRUE;
             "Processed LocationEnable" := TRUE;
             FilenameEnable := TRUE;
             LocationEnable := TRUE;
             "Run TaskEditable" := TRUE;
             "Monitor ModificationsEditable" := TRUE;
             "Archive add YYYYMMDDEditable" := TRUE;
             LinesEditable := TRUE;
             "Project CodeEditable" := TRUE;
             ErrorNotificIncludeFileEditabl := TRUE;
             ErrorNotificEMailAddressEditab := TRUE;
             "Sub Table No.Editable" := TRUE;
             "Main Table No.Editable" := TRUE;
             "Company NameEditable" := TRUE;
             "Run Codeunit No.Editable" := TRUE;
             "Save to MessagesEditable" := TRUE;
             "Log LocationEditable" := TRUE;
             "Processed LocationEditable" := TRUE;
             "File FormatEditable" := TRUE;
             FilenameEditable := TRUE;
             "Error LocationEditable" := TRUE;
             LocationEditable := TRUE;
             DescriptionEditable := TRUE;
             CodeEditable := TRUE;
             ValidateXMLOnParseEditable := TRUE; // CI-210
           END;

    OnOpenPage=VAR
                 Initialize@1000001 : Codeunit 11148625;
               BEGIN
                 Initialize.CheckInitialize;
               END;

    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                       MainTableNoOnFormat(FORMAT("Main Table No."));
                       SubTableNoOnFormat(FORMAT("Sub Table No."));
                       RunCodeunitNoOnFormat(FORMAT("Run Codeunit No."));
                     END;

    OnNewRecord=VAR
                  Setup@1000000 : Record 11148589;
                BEGIN
                  Setup.GET;
                  VALIDATE(Location, Setup."Default Import Location");

                  "File Format" := "File Format"::XML;
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1000000001;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000049 ;1   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Process;
                                 NLD=Verwerken];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Setup@1100512001 : Record 11148589;
                                 ProcessImportDef@1000001 : Codeunit 11148592;
                                 Progressbar@1000002 : Codeunit 11148624;
                                 ErrorMgt@1000006 : Codeunit 11148630;
                                 FileImported@1000003 : Boolean;
                                 ctImportCancelled@1000004 : TextConst 'ENU=Import cancelled.;NLD=Importeren afgebroken.';
                               BEGIN
                                 ErrorMgt.ClearError;

                                 Progressbar.Open(2);

                                 Setup.GET;
                                 IF Setup."Use Error Handling" THEN
                                   FileImported := ProcessImportDef.RUN(Rec)
                                 ELSE BEGIN
                                   ProcessImportDef.RUN(Rec);
                                   FileImported := TRUE;
                                 END;

                                 Progressbar.Close;

                                 IF NOT FileImported THEN
                                   IF ErrorMgt.GetError = '' THEN
                                     MESSAGE(ctImportCancelled)
                                   ELSE
                                     MESSAGE(ErrorMgt.GetError);
                               END;
                                }
      { 1000000002;1 ;Action    ;
                      CaptionML=[ENU=Copy;
                                 NLD=Kopiren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=CopyDocument;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Copy;
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1000000000;1 ;Action    ;
                      CaptionML=[ENU=Copy To;
                                 NLD=Kopiren naar];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=CopyDocument;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CopyTo;
                               END;
                                }
      { 1000000004;1 ;ActionGroup;
                      CaptionML=[ENU=Move;
                                 NLD=Verplaatsen] }
      { 1000050 ;2   ;Action    ;
                      Name=Left;
                      Promoted=Yes;
                      Enabled=LeftEnable;
                      PromotedIsBig=Yes;
                      Image=PreviousSet;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+L');
                               END;
                                }
      { 1000048 ;2   ;Action    ;
                      Name=Right;
                      Promoted=Yes;
                      Enabled=RightEnable;
                      PromotedIsBig=Yes;
                      Image=NextSet;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+R');
                               END;
                                }
      { 1000047 ;2   ;Action    ;
                      Name=<Action1000047>;
                      CaptionML=[ENU=Up;
                                 NLD=Omhoog];
                      Promoted=Yes;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+U');
                               END;
                                }
      { 1000028 ;2   ;Action    ;
                      Name=<Action1000028>;
                      CaptionML=[ENU=Down;
                                 NLD=Omlaag];
                      Promoted=Yes;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+D');
                               END;
                                }
      { 1000000003;1 ;ActionGroup;
                      Name=<Action1000000003>;
                      CaptionML=[ENU=Messages and History;
                                 NLD=Berichten en historie] }
      { 1000063 ;2   ;Action    ;
                      ShortCutKey=Ctrl+F5;
                      CaptionML=[ENU=Messages;
                                 NLD=Berichten];
                      RunObject=Page 11117032;
                      RunPageView=SORTING(Type,Code);
                      RunPageLink=Type=CONST(Import),
                                  Code=FIELD(Code);
                      Promoted=Yes;
                      Image=Note;
                      PromotedCategory=Process }
      { 1000062 ;2   ;Action    ;
                      CaptionML=[ENU=History;
                                 NLD=Historie];
                      RunObject=Page 11117034;
                      RunPageView=SORTING(Type,Code)
                                  WHERE(Type=CONST(Import));
                      RunPageLink=Code=FIELD(Code);
                      Image=History }
      { 1000009 ;2   ;Action    ;
                      CaptionML=[ENU=Message Hist. &Comments;
                                 NLD=Bericht hist. op&merkingen];
                      RunObject=Page 11117035;
                      RunPageView=SORTING(Type,Code);
                      RunPageLink=Type=CONST(Import),
                                  Code=FIELD(Code) }
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000016 ;1   ;ActionGroup;
                      CaptionML=[ENU=&Import Def.;
                                 NLD=&Importdef.] }
      { 1100531001;2 ;Action    ;
                      ShortCutKey=Ctrl+Alt+V;
                      CaptionML=[ENU=Versions;
                                 NLD=Versies];
                      RunObject=Page 11117095;
                      RunPageView=SORTING(Code,Version No.);
                      RunPageLink=Code=FIELD(Code) }
      { 1100531000;2 ;Action    ;
                      ShortCutKey=Ctrl+S;
                      CaptionML=[ENU=Save as New Version;
                                 NLD=Op&slaan als nieuwe versie];
                      OnAction=BEGIN
                                 SaveNewVersion;
                               END;
                                }
      { 1000021 ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NLD=F&uncties] }
      { 1000040 ;2   ;Action    ;
                      CaptionML=[ENU=Renumber Lines;
                                 NLD=Regels hernummeren];
                      OnAction=BEGIN
                                 RenumberLines;
                               END;
                                }
      { 1000045 ;2   ;Action    ;
                      CaptionML=[ENU=Reversed Data &Mapping;
                                 NLD=Reversed data&mapping];
                      OnAction=BEGIN
                                 ReversedDataMapping;
                               END;
                                }
      { 1000086 ;2   ;Separator  }
      { 1000071 ;2   ;Action    ;
                      CaptionML=[ENU=Pri&nt;
                                 NLD=Afdrukken];
                      OnAction=VAR
                                 ImportDefinition@1000000 : Record 11148591;
                               BEGIN
                                 ImportDefinition := Rec;
                                 ImportDefinition.SETRECFILTER;
                                 REPORT.RUN(REPORT::"CI - Import Definitions", TRUE, FALSE, ImportDefinition);
                               END;
                                }
      { 1000088 ;2   ;Separator  }
      { 1000087 ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Import Definition from XML;
                                 NLD=XML-Definitie &importeren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Import;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ImportXMLDefinition@1000000 : Codeunit 11148636;
                               BEGIN
                                 ImportXMLDefinition.ImportImportDefinition(Rec);
                               END;
                                }
      { 1000083 ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Export Definition to &XML;
                                 NLD=Definitie exporteren naar &XML];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Export;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ExportDefinitionXML@1000000 : Codeunit 11148634;
                               BEGIN
                                 ExportDefinitionXML.ExportImportDefinition(Rec);
                               END;
                                }
      { 1000070 ;2   ;Separator  }
      { 1000075 ;2   ;Action    ;
                      CaptionML=[ENU=Test File;
                                 NLD=Bestand controleren];
                      OnAction=BEGIN
                                 TestFile;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                CaptionML=[ENU=General;
                           NLD=Algemeen] }

    { 1000001;2;Field     ;
                SourceExpr=Code;
                Editable=CodeEditable }

    { 1000003;2;Field     ;
                SourceExpr=Description;
                Editable=DescriptionEditable }

    { 1000005;2;Field     ;
                SourceExpr=Location;
                Enabled=LocationEnable;
                Editable=LocationEditable;
                OnLookup=VAR
                           Mgt@1000001 : Codeunit 11148589;
                           NewFolder@1000000 : Text[1024];
                         BEGIN
                           NewFolder := Mgt.BrowseForFolder('', '');
                           IF NewFolder <> '' THEN
                             VALIDATE(Location, NewFolder);
                         END;

                OnAssistEdit=VAR
                               Mgt@1000002 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder(Location);
                             END;
                              }

    { 1000014;2;Field     ;
                SourceExpr=Filename;
                Enabled=FilenameEnable;
                Editable=FilenameEditable }

    { 1000035;2;Field     ;
                SourceExpr="Processed Location";
                Enabled="Processed LocationEnable";
                Editable="Processed LocationEditable";
                OnLookup=VAR
                           Mgt@1000001 : Codeunit 11148589;
                           NewFolder@1000000 : Text[1024];
                         BEGIN
                           NewFolder := Mgt.BrowseForFolder('', '');
                           IF NewFolder <> '' THEN
                             "Processed Location" := NewFolder;
                         END;

                OnAssistEdit=VAR
                               Mgt@1000001 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder("Processed Location");
                             END;
                              }

    { 1000037;2;Field     ;
                SourceExpr="Log Location";
                Enabled="Log LocationEnable";
                Editable="Log LocationEditable";
                OnLookup=VAR
                           Mgt@1000001 : Codeunit 11148589;
                           NewFolder@1000000 : Text[1024];
                         BEGIN
                           NewFolder := Mgt.BrowseForFolder('', '');
                           IF NewFolder <> '' THEN
                             "Log Location" := NewFolder;
                         END;

                OnAssistEdit=VAR
                               Mgt@1000001 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder("Log Location");
                             END;
                              }

    { 1000084;2;Field     ;
                SourceExpr="Error Location";
                Enabled="Error LocationEnable";
                Editable="Error LocationEditable";
                OnLookup=VAR
                           Mgt@1000001 : Codeunit 11148589;
                           NewFolder@1000000 : Text[1024];
                         BEGIN
                           NewFolder := Mgt.BrowseForFolder('', '');
                           IF NewFolder <> '' THEN
                             "Error Location" := NewFolder;
                         END;

                OnAssistEdit=VAR
                               Mgt@1000001 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder("Error Location");
                             END;
                              }

    { 1000011;2;Field     ;
                SourceExpr=Status;
                OnValidate=BEGIN
                             StatusOnAfterValidate;
                           END;
                            }

    { 1000053;2;Field     ;
                SourceExpr="Save to Messages";
                Enabled="Save to MessagesEnable";
                Editable="Save to MessagesEditable" }

    { 1000024;1;Part      ;
                Name=Lines;
                SubPageLink=Import Definition=FIELD(Code);
                PagePartID=Page11117070;
                Editable=LinesEditable }

    { 1905328801;1;Group  ;
                CaptionML=[ENU=Field Selection;
                           NLD=Veldselectie] }

    { 1000010;2;Field     ;
                SourceExpr="Main Table No.";
                Editable="Main Table No.Editable";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           // IDYN EBK >>>>
                           IF Mgt.LookupTableNo(Text) THEN BEGIN
                             EVALUATE("Main Table No.",Text);
                             VALIDATE("Main Table No.");
                           END;
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //EXIT(Mgt.LookupTableNo(Text));
                           // IDYN EBK <<<<
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.AssistTableNo("Main Table No.");
                             END;
                              }

    { 1000031;2;Field     ;
                DrillDown=No;
                SourceExpr="Main Table No. of Fields";
                OnAssistEdit=VAR
                               TmpFld@1000000 : TEMPORARY Record 2000000041;
                               SelectFields@1000001 : Page 11148589;
                             BEGIN
                               TESTFIELD("Main Table No.");
                               SelectFields.SetImportDefinition(TRUE, Rec);
                               SelectFields.SetFormBlocked(Status <> Status::Edit);

                               IF SelectFields.RUNMODAL = ACTION::OK THEN BEGIN
                                 SelectFields.GetSelectedFields(TmpFld);
                                 UpdateTableFields(TRUE, "Main Table No.", TmpFld);
                                 CurrPage.UPDATE(TRUE);
                               END;
                             END;
                              }

    { 1000025;2;Field     ;
                SourceExpr="Sub Table No.";
                Enabled="Sub Table No.Enable";
                Editable="Sub Table No.Editable";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           // IDYN EBK >>>>
                           IF Mgt.LookupTableNo(Text) THEN BEGIN
                             EVALUATE("Sub Table No.",Text);
                             VALIDATE("Sub Table No.");
                           END;
                           // IDYN EBK >>>>
                           //Mgt.LookupRelatedTableNo("Main Table No.", Text);
                           //EVALUATE("Sub Table No.",Text);
                           //VALIDATE("Sub Table No.");
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //EXIT(Mgt.LookupRelatedTableNo("Main Table No.", Text));
                           // IDYN EBK <<<<
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.AssistTableNo("Sub Table No.");
                             END;
                              }

    { 1000033;2;Field     ;
                DrillDown=No;
                SourceExpr="Sub Table No. of Fields";
                Enabled="Sub Table No. of FieldsEnable";
                OnAssistEdit=VAR
                               TmpFld@1000000 : TEMPORARY Record 2000000041;
                               SelectFields@1000001 : Page 11148589;
                             BEGIN
                               TESTFIELD("Sub Table No.");
                               SelectFields.SetImportDefinition(FALSE, Rec);
                               SelectFields.SetFormBlocked(Status <> Status::Edit);
                               IF SelectFields.RUNMODAL = ACTION::OK THEN BEGIN
                                 SelectFields.GetSelectedFields(TmpFld);
                                 UpdateTableFields(FALSE, "Sub Table No.", TmpFld);
                                 CurrPage.UPDATE(TRUE);
                               END;
                             END;
                              }

    { 1903121901;1;Group  ;
                CaptionML=[ENU=Options;
                           NLD=Opties] }

    { 1000078;2;Field     ;
                SourceExpr="Project Code";
                Editable="Project CodeEditable" }

    { 1000076;2;Field     ;
                SourceExpr="Company Name";
                Editable="Company NameEditable" }

    { 1000068;2;Field     ;
                SourceExpr="Error Notific. E-Mail Address";
                Editable=ErrorNotificEMailAddressEditab }

    { 1000046;2;Field     ;
                SourceExpr="Error Notific. Include File";
                Enabled=ErrorNotificIncludeFileEnable;
                Editable=ErrorNotificIncludeFileEditabl }

    { 1000023;2;Field     ;
                SourceExpr="Monitor Modifications";
                Editable="Monitor ModificationsEditable" }

    { 1000041;2;Field     ;
                SourceExpr="Run Task";
                Editable="Run TaskEditable" }

    { 1100512000;2;Field  ;
                SourceExpr="Run Codeunit No.";
                Visible=FALSE;
                Editable="Run Codeunit No.Editable";
                OnLookup=VAR
                           Mgt@1100512000 : Codeunit 11148589;
                         BEGIN
                           EXIT(Mgt.LookupObjectNo(5, Text));
                         END;
                          }

    { 1000022;2;Field     ;
                SourceExpr="Archive add YYYYMMDD";
                Enabled="Archive add YYYYMMDDEnable";
                Editable="Archive add YYYYMMDDEditable" }

    { 1000000005;2;Field  ;
                SourceExpr="Validate XML on Parse";
                Editable=ValidateXMLOnParseEditable }

  }
  CODE
  {
    VAR
      INMgt@1000000000 : Codeunit 11148589;
      CodeEditable@19001698 : Boolean INDATASET;
      DescriptionEditable@19061412 : Boolean INDATASET;
      LocationEditable@19035910 : Boolean INDATASET;
      "Error LocationEditable"@19032989 : Boolean INDATASET;
      FilenameEditable@19007928 : Boolean INDATASET;
      "File FormatEditable"@19047526 : Boolean INDATASET;
      "Processed LocationEditable"@19079254 : Boolean INDATASET;
      "Log LocationEditable"@19072655 : Boolean INDATASET;
      "Save to MessagesEditable"@19046008 : Boolean INDATASET;
      "Run Codeunit No.Editable"@19055664 : Boolean INDATASET;
      "Company NameEditable"@19027413 : Boolean INDATASET;
      "Main Table No.Editable"@19066361 : Boolean INDATASET;
      "Sub Table No.Editable"@19054278 : Boolean INDATASET;
      ErrorNotificEMailAddressEditab@19034665 : Boolean INDATASET;
      ErrorNotificIncludeFileEditabl@19002766 : Boolean INDATASET;
      "Project CodeEditable"@19062497 : Boolean INDATASET;
      LinesEditable@19010511 : Boolean INDATASET;
      "Archive add YYYYMMDDEditable"@19050215 : Boolean INDATASET;
      "Monitor ModificationsEditable"@19075968 : Boolean INDATASET;
      "Run TaskEditable"@19005185 : Boolean INDATASET;
      LocationEnable@19013618 : Boolean INDATASET;
      FilenameEnable@19043700 : Boolean INDATASET;
      "Processed LocationEnable"@19043375 : Boolean INDATASET;
      "Log LocationEnable"@19050707 : Boolean INDATASET;
      "Error LocationEnable"@19002018 : Boolean INDATASET;
      "Save to MessagesEnable"@19010110 : Boolean INDATASET;
      ErrorNotificIncludeFileEnable@19047165 : Boolean INDATASET;
      "Sub Table No.Enable"@19033464 : Boolean INDATASET;
      "Sub Table No. of FieldsEnable"@19016380 : Boolean INDATASET;
      "Archive add YYYYMMDDEnable"@19000830 : Boolean INDATASET;
      LeftEnable@19065291 : Boolean INDATASET;
      RightEnable@19037326 : Boolean INDATASET;
      ValidateXMLOnParseEditable@1000000001 : Boolean INDATASET;

    LOCAL PROCEDURE EnableFields@1000000();
    BEGIN
      LocationEnable := "File Format" <> "File Format"::ADO;
      FilenameEnable := "File Format" <> "File Format"::ADO;
      "Processed LocationEnable" := "File Format" <> "File Format"::ADO;
      "Log LocationEnable" := "File Format" <> "File Format"::ADO;
      "Error LocationEnable" := "File Format" <> "File Format"::ADO;
      "Save to MessagesEnable" := "File Format" <> "File Format"::ADO;
      ErrorNotificIncludeFileEnable := "File Format" <> "File Format"::ADO;

      "Sub Table No.Enable" := "File Format" <> "File Format"::ADO;
      "Sub Table No. of FieldsEnable" := "File Format" <> "File Format"::ADO;

      "Archive add YYYYMMDDEnable" := "File Format" <> "File Format"::ADO;

      LeftEnable := "File Format" <> "File Format"::ADO;
      RightEnable := "File Format" <> "File Format"::ADO;
    END;

    LOCAL PROCEDURE SetFileFormatToLines@1000002();
    BEGIN
      CurrPage.Lines.PAGE.SetFileFormat("File Format");
    END;

    LOCAL PROCEDURE SetEditable@1000003();
    BEGIN
      CodeEditable := (Status = Status::Edit);
      DescriptionEditable := (Status = Status::Edit);
      LocationEditable := (Status = Status::Edit);
      "Error LocationEditable" := (Status = Status::Edit);
      FilenameEditable := (Status = Status::Edit);
      "File FormatEditable" := (Status = Status::Edit);
      "Processed LocationEditable" := (Status = Status::Edit);
      "Log LocationEditable" := (Status = Status::Edit);
      "Save to MessagesEditable" := (Status = Status::Edit);
      "Run Codeunit No.Editable" := (Status = Status::Edit);
      "Company NameEditable" := (Status = Status::Edit);
      "Main Table No.Editable" := (Status = Status::Edit);
      "Sub Table No.Editable" := (Status = Status::Edit);
      ErrorNotificEMailAddressEditab := (Status = Status::Edit);
      ErrorNotificIncludeFileEditabl := (Status = Status::Edit);
      "Project CodeEditable" := (Status = Status::Edit);
      LinesEditable := (Status = Status::Edit);
      "Archive add YYYYMMDDEditable" := (Status = Status::Edit);
      "Monitor ModificationsEditable" := (Status = Status::Edit);
      "Run TaskEditable" := (Status = Status::Edit);
      ValidateXMLOnParseEditable := (Status = Status::Edit); // CI-210
    END;

    LOCAL PROCEDURE StatusOnAfterValidate@19072689();
    BEGIN
      SetEditable;
    END;

    LOCAL PROCEDURE FileFormatOnAfterValidate@19065317();
    BEGIN
      EnableFields;
      SetFileFormatToLines;
      CurrPage.Lines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      EnableFields;

      SetFileFormatToLines;

      SetEditable;
    END;

    LOCAL PROCEDURE LocationOnAfterInput@19074197(VAR Text@19074198 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFolder(Text);
    END;

    LOCAL PROCEDURE ProcessedLocationOnAfterInput@19066889(VAR Text@19066890 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFolder(Text);
    END;

    LOCAL PROCEDURE LogLocationOnAfterInput@19076406(VAR Text@19076407 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFolder(Text);
    END;

    LOCAL PROCEDURE ErrorLocationOnAfterInput@19032366(VAR Text@19032367 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFolder(Text);
    END;

    LOCAL PROCEDURE MainTableNoOnAfterInput@19047063(VAR Text@19047064 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE SubTableNoOnAfterInput@19065603(VAR Text@19065604 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE RunCodeunitNoOnAfterInput@19017510(VAR Text@19017511 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputObjectNo(5, Text);
    END;

    LOCAL PROCEDURE MainTableNoOnFormat@19079044(Text@19015475 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Main Table No.");
    END;

    LOCAL PROCEDURE SubTableNoOnFormat@19052089(Text@19075565 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Sub Table No.");
    END;

    LOCAL PROCEDURE RunCodeunitNoOnFormat@19054474(Text@19073072 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatObjectNo(5, Text, "Run Codeunit No.");
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117070 CI - XML Import Subform
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=XML Import Subform;
               NLD=XML Importdefinitiesubform];
    SourceTable=Table11148592;
    SourceTableView=SORTING(Import Definition,Line No.);
    PageType=ListPart;
    OnInit=BEGIN
             "New RecordEditable" := TRUE;
             "Existing RecordEditable" := TRUE;
             "Increment MethodEditable" := TRUE;
             LinktoTableTagNameEditable := TRUE;
             "Option TypeEditable" := TRUE;
             "Original ValueEditable" := TRUE;
             "Conversion CodeEditable" := TRUE;
             "Field No.Editable" := TRUE;
             "Table No.Editable" := TRUE;
           END;

    OnAfterGetRecord=BEGIN
                       "Option TypeHideValue" := FALSE;
                       "New RecordHideValue" := FALSE;
                       "Existing RecordHideValue" := FALSE;
                       "Tag NameIndent" := 0;
                       OnAfterGetCurrRecord;
                       TagNameOnFormat;
                       TableNoOnFormat(FORMAT("Table No."));
                       FieldNoOnFormat(FORMAT("Field No."));
                       ExistingRecordOnFormat;
                       NewRecordOnFormat;
                       OptionTypeOnFormat;
                     END;

    OnNewRecord=BEGIN
                  SetupNewLine(xRec, BelowxRec);
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1904677404;1 ;ActionGroup;
                      CaptionML=[ENU=&Import Def.;
                                 NLD=&Importdef.] }
      { 1903294104;2 ;Action    ;
                      ShortCutKey=Ctrl+L;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Link &Tables;
                                 NLD=Tabellen linken];
                      OnAction=BEGIN
                                 LinkTables;
                               END;
                                }
      { 1906522404;2 ;Action    ;
                      ShortCutKey=Ctrl+R;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Restrictions;
                                 NLD=Restricties];
                      OnAction=BEGIN
                                 _OpenRestrictions;
                               END;
                                }
      { 1000000007;1 ;Separator  }
      { 1000000006;1 ;Action    ;
                      Name=<Action1000000000>;
                      ShortCutKey=Shift+Ctrl+R;
                      CaptionML=[ENU=Right;
                                 NLD=Rechts];
                      Promoted=Yes;
                      OnAction=BEGIN
                                 Right;
                               END;
                                }
      { 1000000005;1 ;Action    ;
                      Name=<Action1000000001>;
                      ShortCutKey=Shift+Ctrl+L;
                      CaptionML=[ENU=Left;
                                 NLD=Links];
                      OnAction=BEGIN
                                 Left;
                               END;
                                }
      { 1000000003;1 ;Action    ;
                      Name=<Action1000000002>;
                      ShortCutKey=Shift+Ctrl+U;
                      CaptionML=[ENU=Up;
                                 NLD=Omhoog];
                      OnAction=BEGIN
                                 Up;
                               END;
                                }
      { 1000000001;1 ;Action    ;
                      Name=<Action1000000003>;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Down;
                                 NLD=Omlaag];
                      OnAction=BEGIN
                                 Down;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                IndentationColumnName="Tag NameIndent";
                IndentationControls=Tag Name;
                GroupType=Repeater }

    { 1   ;2   ;Field     ;
                SourceExpr=Indent;
                Visible=false }

    { 1000011;2;Field     ;
                SourceExpr="Tag Name" }

    { 1000001;2;Field     ;
                SourceExpr=Type;
                ValuesAllowed=[" ";Tag;Table;Value;Const;Variable];
                OnValidate=BEGIN
                             TypeOnAfterValidate;
                           END;
                            }

    { 1000031;2;Field     ;
                SourceExpr=Code }

    { 1100531000;2;Field  ;
                SourceExpr="No. of Functions";
                Visible=FALSE }

    { 1000005;2;Field     ;
                SourceExpr="Table No.";
                Editable="Table No.Editable";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           // IDYN EBK >>>>
                           IF Mgt.LookupTableNo(Text) THEN BEGIN
                             EVALUATE("Table No.",Text);
                             VALIDATE("Table No.");
                           END;
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //EXIT(Mgt.LookupTableNo(Text));
                           // IDYN EBK <<<<
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.AssistTableNo("Table No.");
                             END;
                              }

    { 1000000010;2;Field  ;
                Name=Table Name;
                SourceExpr="Table Name" }

    { 1000009;2;Field     ;
                SourceExpr="Field No.";
                Editable="Field No.Editable";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           // IDYN EBK >>>>
                           IF Mgt.LookupFieldNo("Table No.",Text,TRUE) THEN BEGIN
                             EVALUATE("Field No.",Text);
                             VALIDATE("Field No.");
                           END;
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //EXIT(Mgt.LookupFieldNo("Table No.", Text, TRUE));
                           // IDYN EBK <<<<
                         END;
                          }

    { 1000000011;2;Field  ;
                Name=Field Name;
                SourceExpr="Field Name" }

    { 1000029;2;Field     ;
                SourceExpr="Original Value";
                Visible=FALSE;
                Editable="Original ValueEditable" }

    { 1000023;2;Field     ;
                SourceExpr="Link to Table (Tag Name)";
                Editable=LinktoTableTagNameEditable;
                OnAssistEdit=BEGIN
                               SetupLinkToTable;
                             END;
                              }

    { 1000041;2;Field     ;
                SourceExpr="Existing Record";
                Editable="Existing RecordEditable";
                HideValue="Existing RecordHideValue" }

    { 1000000004;2;Field  ;
                SourceExpr="Error No. Existing Record";
                Visible=FALSE }

    { 1000043;2;Field     ;
                SourceExpr="New Record";
                Editable="New RecordEditable";
                HideValue="New RecordHideValue" }

    { 1000000002;2;Field  ;
                SourceExpr="Error No. New Record";
                Visible=FALSE }

    { 1000035;2;Field     ;
                SourceExpr="No. of Restrictions" }

    { 1000007;2;Field     ;
                SourceExpr="Increment Method";
                Visible=FALSE;
                Editable="Increment MethodEditable" }

    { 1000021;2;Field     ;
                SourceExpr="Conversion Code";
                Editable="Conversion CodeEditable" }

    { 1000027;2;Field     ;
                SourceExpr="Dest. Variable";
                Visible=FALSE }

    { 1000003;2;Field     ;
                SourceExpr="As Attribute";
                Visible=FALSE }

    { 1000015;2;Field     ;
                SourceExpr="Validate Field";
                Visible=FALSE }

    { 1000013;2;Field     ;
                SourceExpr="Skip If Empty";
                Visible=FALSE }

    { 1000025;2;Field     ;
                SourceExpr="Save Record";
                Visible=FALSE }

    { 1000017;2;Field     ;
                SourceExpr="Data Format";
                Visible=FALSE }

    { 1000000008;2;Field  ;
                SourceExpr="Custom Date Order";
                Visible=False }

    { 1000000009;2;Field  ;
                SourceExpr="Custom Date Separator";
                Visible=false }

    { 1000033;2;Field     ;
                SourceExpr="Option Type";
                Visible=FALSE;
                Editable="Option TypeEditable";
                HideValue="Option TypeHideValue" }

    { 1000039;2;Field     ;
                SourceExpr=Mandatory;
                Visible=FALSE }

    { 1000000000;2;Field  ;
                SourceExpr="Error No. Field Mandatory";
                Visible=FALSE }

    { 2   ;2   ;Field     ;
                SourceExpr="XML Namespace Prefix";
                Visible=false }

    { 3   ;2   ;Field     ;
                SourceExpr="XML Namespace";
                Visible=false }

  }
  CODE
  {
    VAR
      FileFormat@1000000 : 'XML,CSV,FixedWidth,Excel';
      "Tag NameIndent"@19056250 : Integer INDATASET;
      "Existing RecordHideValue"@19025366 : Boolean INDATASET;
      "New RecordHideValue"@19012537 : Boolean INDATASET;
      "Option TypeHideValue"@19002310 : Boolean INDATASET;
      "Table No.Editable"@19076806 : Boolean INDATASET;
      "Field No.Editable"@19022826 : Boolean INDATASET;
      "Conversion CodeEditable"@19074872 : Boolean INDATASET;
      "Original ValueEditable"@19060489 : Boolean INDATASET;
      "Option TypeEditable"@19019138 : Boolean INDATASET;
      LinktoTableTagNameEditable@19004008 : Boolean INDATASET;
      "Increment MethodEditable"@19041957 : Boolean INDATASET;
      "Existing RecordEditable"@19014716 : Boolean INDATASET;
      "New RecordEditable"@19061505 : Boolean INDATASET;

    PROCEDURE Left@1000000();
    VAR
      ImportDefinitionLine@1100512000 : Record 11148592;
    BEGIN
      CurrPage.SETSELECTIONFILTER(ImportDefinitionLine);
      IF ImportDefinitionLine.FINDSET THEN
        REPEAT
          IF ImportDefinitionLine."Entry No." <> 0 THEN
            IF ImportDefinitionLine.Indent > 0 THEN BEGIN
              ImportDefinitionLine.Indent -= 1;
              ImportDefinitionLine.MODIFY;
            END;
        UNTIL ImportDefinitionLine.NEXT = 0;
    END;

    PROCEDURE Right@1000001();
    VAR
      ImportDefinitionLine@1100512000 : Record 11148592;
    BEGIN
      CurrPage.SETSELECTIONFILTER(ImportDefinitionLine);
      IF ImportDefinitionLine.FINDSET THEN
        REPEAT
          IF ImportDefinitionLine."Entry No." <> 0 THEN BEGIN
            ImportDefinitionLine.Indent += 1;
            ImportDefinitionLine.MODIFY;
          END;
        UNTIL ImportDefinitionLine.NEXT = 0;
    END;

    PROCEDURE Up@1000004();
    VAR
      CurrLine@1000004 : Record 11148592;
      ImportDefinitionLine@1000000 : Record 11148592;
      SelectedLine@1000002 : Record 11148592;
      LineNo@1000001 : Integer;
    BEGIN
      CurrLine := Rec;

      CurrPage.SETSELECTIONFILTER(SelectedLine);
      IF SelectedLine.COUNT = 0 THEN BEGIN
        SelectedLine.RESET;
        SelectedLine := Rec;
        SelectedLine.SETRECFILTER;
      END;

      IF SelectedLine.FINDSET THEN
        REPEAT
          ImportDefinitionLine.SETCURRENTKEY("Import Definition", "Line No.");
          ImportDefinitionLine.SETRANGE("Import Definition", "Import Definition");
          ImportDefinitionLine := SelectedLine;
          IF ImportDefinitionLine.NEXT(-1) <> 0 THEN BEGIN
            LineNo := ImportDefinitionLine."Line No.";
            ImportDefinitionLine."Line No." := SelectedLine."Line No.";
            ImportDefinitionLine.MODIFY;
            SelectedLine."Line No." := LineNo;
            SelectedLine.MODIFY;
          END;
        UNTIL SelectedLine.NEXT = 0;

      GET(CurrLine."Import Definition", CurrLine."Entry No.");
    END;

    PROCEDURE Down@1000005();
    VAR
      CurrLine@1000001 : Record 11148592;
      ImportDefinitionLine@1000003 : Record 11148592;
      SelectedLine@1000002 : Record 11148592;
      LineNo@1000000 : Integer;
    BEGIN
      CurrLine := Rec;

      CurrPage.SETSELECTIONFILTER(SelectedLine);
      IF SelectedLine.COUNT = 0 THEN BEGIN
        SelectedLine.RESET;
        SelectedLine := Rec;
        SelectedLine.SETRECFILTER;
      END;

      IF SelectedLine.FINDLAST THEN
        REPEAT
          ImportDefinitionLine.SETCURRENTKEY("Import Definition", "Line No.");
          ImportDefinitionLine.SETRANGE("Import Definition", "Import Definition");
          ImportDefinitionLine := SelectedLine;
          IF ImportDefinitionLine.NEXT(1) <> 0 THEN BEGIN
            LineNo := ImportDefinitionLine."Line No.";
            ImportDefinitionLine."Line No." := SelectedLine."Line No.";
            ImportDefinitionLine.MODIFY;
            SelectedLine."Line No." := LineNo;
            SelectedLine.MODIFY;
          END;
        UNTIL SelectedLine.NEXT(-1) = 0;

      GET(CurrLine."Import Definition", CurrLine."Entry No.");
    END;

    PROCEDURE LinkTables@1000002();
    BEGIN
      SetupLinkToTable;
    END;

    PROCEDURE UpdateForm@1000003();
    BEGIN
      CurrPage.UPDATE(FALSE);
    END;

    PROCEDURE _OpenRestrictions@19068975();
    BEGIN
      OpenRestrictions;
    END;

    PROCEDURE OpenRestrictions@1000006();
    BEGIN
      OpenRestrictions;
    END;

    PROCEDURE SetFileFormat@1000008(NewValue@1000000 : Option);
    BEGIN
      FileFormat := NewValue;
    END;

    LOCAL PROCEDURE SetFieldsEditable@1000009();
    BEGIN
      "Table No.Editable" := (Type IN [Type::Table, Type::Value, Type::Const, Type::Variable, Type::Skip]);
      "Field No.Editable" := (Type IN [Type::Value, Type::Const, Type::Variable, Type::Skip]);
      "Conversion CodeEditable" := (Type IN [Type::Value, Type::Const, Type::Variable]);
      "Original ValueEditable" := (Type IN [Type::Value, Type::Const, Type::Variable]);
      "Option TypeEditable" := (Type IN [Type::Value, Type::Const, Type::Variable]);

      IF FileFormat = FileFormat::XML THEN BEGIN
        LinktoTableTagNameEditable := (Type = Type::Table);
        "Increment MethodEditable" := (Type IN [Type::Value, Type::Const, Type::Variable]);
        "Existing RecordEditable" := (Type = Type::Table);
        "New RecordEditable" := (Type = Type::Table);
      END ELSE BEGIN
        LinktoTableTagNameEditable := (FALSE);
        "Increment MethodEditable" := (TRUE);
        "Existing RecordEditable" := (Type IN [Type::Table, Type::Value]);
        "New RecordEditable" := (Type IN [Type::Table, Type::Value]);
      END;
    END;

    LOCAL PROCEDURE TypeOnAfterValidate@19069045();
    BEGIN
      SetFieldsEditable;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      SetFieldsEditable;
    END;

    LOCAL PROCEDURE TableNoOnAfterInput@19060375(VAR Text@19060376 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE FieldNoOnAfterInput@19063566(VAR Text@19063567 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFieldNo(Text, "Table No.", TRUE);
    END;

    LOCAL PROCEDURE TagNameOnFormat@19023679();
    BEGIN
      "Tag NameIndent" := Indent;
    END;

    LOCAL PROCEDURE TableNoOnFormat@19071785(Text@19016339 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Table No.");
    END;

    LOCAL PROCEDURE FieldNoOnFormat@19075355(Text@19041114 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatFieldNo(Text, "Table No.", "Field No.");
    END;

    LOCAL PROCEDURE ExistingRecordOnFormat@19009624();
    BEGIN
      IF FileFormat = FileFormat::XML THEN BEGIN
        IF Type <> Type::Table THEN
          "Existing RecordHideValue" := TRUE;
      END ELSE
        IF NOT (Type IN [Type::Table, Type::Value]) THEN
          "Existing RecordHideValue" := TRUE;
    END;

    LOCAL PROCEDURE NewRecordOnFormat@19036900();
    BEGIN
      IF FileFormat = FileFormat::XML THEN BEGIN
        IF Type <> Type::Table THEN
          "New RecordHideValue" := TRUE;
      END ELSE
        IF NOT (Type IN [Type::Table, Type::Value]) THEN
          "New RecordHideValue" := TRUE;
    END;

    LOCAL PROCEDURE OptionTypeOnFormat@19077341();
    BEGIN
      IF NOT (Type IN [Type::Value, Type::Const, Type::Variable, Type::Skip]) THEN
        "Option TypeHideValue" := TRUE;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117071 CI - CSV Import Card
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=CSV Import Card;
               NLD=CSV Importdefinitie];
    SourceTable=Table11148591;
    SourceTableView=WHERE(File Format=CONST(CSV));
    PageType=Card;
    OnInit=BEGIN
             RightEnable := TRUE;
             LeftEnable := TRUE;
             "Archive add YYYYMMDDEnable" := TRUE;
             "Sub Table No. of FieldsEnable" := TRUE;
             "Sub Table No.Enable" := TRUE;
             ErrorNotificIncludeFileEnable := TRUE;
             "Save to MessagesEnable" := TRUE;
             "Error LocationEnable" := TRUE;
             "Log LocationEnable" := TRUE;
             "Processed LocationEnable" := TRUE;
             FilenameEnable := TRUE;
             LocationEnable := TRUE;
             "Field SeparatorEnable" := TRUE;
             "Field DelimiterEnable" := TRUE;
             "Run TaskEditable" := TRUE;
             "Monitor ModificationsEditable" := TRUE;
             "Archive add YYYYMMDDEditable" := TRUE;
             LinesEditable := TRUE;
             "Project CodeEditable" := TRUE;
             ErrorNotificIncludeFileEditabl := TRUE;
             ErrorNotificEMailAddressEditab := TRUE;
             "Sub Table No.Editable" := TRUE;
             "Main Table No.Editable" := TRUE;
             "Company NameEditable" := TRUE;
             "Run Codeunit No.Editable" := TRUE;
             "Field SeparatorEditable" := TRUE;
             "Field DelimiterEditable" := TRUE;
             "Save to MessagesEditable" := TRUE;
             HeadersEditable := TRUE;
             "Log LocationEditable" := TRUE;
             "Processed LocationEditable" := TRUE;
             "File FormatEditable" := TRUE;
             FilenameEditable := TRUE;
             "Error LocationEditable" := TRUE;
             LocationEditable := TRUE;
             DescriptionEditable := TRUE;
             CodeEditable := TRUE;
           END;

    OnOpenPage=VAR
                 Initialize@1000001 : Codeunit 11148625;
               BEGIN
                 Initialize.CheckInitialize;
               END;

    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                       MainTableNoOnFormat(FORMAT("Main Table No."));
                       SubTableNoOnFormat(FORMAT("Sub Table No."));
                       RunCodeunitNoOnFormat(FORMAT("Run Codeunit No."));
                     END;

    OnNewRecord=VAR
                  Setup@1000000 : Record 11148589;
                BEGIN
                  Setup.GET;
                  VALIDATE(Location, Setup."Default Import Location");

                  "File Format" := "File Format"::CSV;
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000049 ;1   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Process;
                                 NLD=Verwerken];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Setup@1100512001 : Record 11148589;
                                 ProcessImportDef@1000001 : Codeunit 11148592;
                                 Progressbar@1000002 : Codeunit 11148624;
                                 ErrorMgt@1000006 : Codeunit 11148630;
                                 FileImported@1000003 : Boolean;
                                 ctImportCancelled@1000004 : TextConst 'ENU=Import cancelled.;NLD=Importeren afgebroken.';
                               BEGIN
                                 ErrorMgt.ClearError;

                                 Progressbar.Open(2);

                                 Setup.GET;
                                 IF Setup."Use Error Handling" THEN
                                   FileImported := ProcessImportDef.RUN(Rec)
                                 ELSE BEGIN
                                   ProcessImportDef.RUN(Rec);
                                   FileImported := TRUE;
                                 END;

                                 Progressbar.Close;

                                 IF NOT FileImported THEN
                                   IF ErrorMgt.GetError = '' THEN
                                     MESSAGE(ctImportCancelled)
                                   ELSE
                                     MESSAGE(ErrorMgt.GetError);
                               END;
                                }
      { 1000000002;1 ;Action    ;
                      CaptionML=[ENU=Copy;
                                 NLD=Kopiren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Copy;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Copy;
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1000000001;1 ;Action    ;
                      Name=<Action1000000000>;
                      CaptionML=[ENU=Copy To;
                                 NLD=Kopiren naar];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Copy;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CopyTo;
                               END;
                                }
      { 1000000003;1 ;ActionGroup;
                      CaptionML=[ENU=Move;
                                 NLD=Verplaatsen] }
      { 1000050 ;2   ;Action    ;
                      Name=Left;
                      Promoted=Yes;
                      Enabled=LeftEnable;
                      PromotedIsBig=Yes;
                      Image=PreviousSet;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+L');
                               END;
                                }
      { 1000048 ;2   ;Action    ;
                      Name=Right;
                      Promoted=Yes;
                      Enabled=RightEnable;
                      PromotedIsBig=Yes;
                      Image=NextSet;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+R');
                               END;
                                }
      { 1000047 ;2   ;Action    ;
                      Name=<Action1000047>;
                      CaptionML=[ENU=Up;
                                 NLD=Omhoog];
                      Promoted=Yes;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+U');
                               END;
                                }
      { 1000028 ;2   ;Action    ;
                      Name=<Action1000028>;
                      CaptionML=[ENU=Down;
                                 NLD=Omlaag];
                      Promoted=Yes;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+D');
                               END;
                                }
      { 1000000000;1 ;ActionGroup;
                      CaptionML=[ENU=Messages and History;
                                 NLD=Berichten en historie] }
      { 1000063 ;2   ;Action    ;
                      ShortCutKey=Ctrl+F5;
                      CaptionML=[ENU=Messages;
                                 NLD=Berichten];
                      RunObject=Page 11117032;
                      RunPageView=SORTING(Type,Code);
                      RunPageLink=Type=CONST(Import),
                                  Code=FIELD(Code);
                      Promoted=Yes;
                      Image=Note;
                      PromotedCategory=Process }
      { 1000062 ;2   ;Action    ;
                      CaptionML=[ENU=History;
                                 NLD=Historie];
                      RunObject=Page 11117034;
                      RunPageView=SORTING(Type,Code)
                                  WHERE(Type=CONST(Import));
                      RunPageLink=Code=FIELD(Code);
                      Image=History }
      { 1000009 ;2   ;Action    ;
                      CaptionML=[ENU=Message Hist. &Comments;
                                 NLD=Bericht hist. op&merkingen];
                      RunObject=Page 11117035;
                      RunPageView=SORTING(Type,Code);
                      RunPageLink=Type=CONST(Import),
                                  Code=FIELD(Code) }
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000016 ;1   ;ActionGroup;
                      CaptionML=[ENU=&Import Def.;
                                 NLD=&Importdef.] }
      { 1100531001;2 ;Action    ;
                      ShortCutKey=Ctrl+Alt+V;
                      CaptionML=[ENU=Versions;
                                 NLD=Versies];
                      RunObject=Page 11117095;
                      RunPageView=SORTING(Code,Version No.);
                      RunPageLink=Code=FIELD(Code) }
      { 1100531000;2 ;Action    ;
                      ShortCutKey=Ctrl+S;
                      CaptionML=[ENU=Save as New Version;
                                 NLD=Op&slaan als nieuwe versie];
                      OnAction=BEGIN
                                 SaveNewVersion;
                               END;
                                }
      { 1000021 ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NLD=F&uncties] }
      { 1000040 ;2   ;Action    ;
                      CaptionML=[ENU=Renumber Lines;
                                 NLD=Regels hernummeren];
                      OnAction=BEGIN
                                 RenumberLines;
                               END;
                                }
      { 1000045 ;2   ;Action    ;
                      CaptionML=[ENU=Reversed Data &Mapping;
                                 NLD=Reversed data&mapping];
                      OnAction=BEGIN
                                 ReversedDataMapping;
                               END;
                                }
      { 1000086 ;2   ;Separator  }
      { 1000071 ;2   ;Action    ;
                      CaptionML=[ENU=Pri&nt;
                                 NLD=Afdrukken];
                      OnAction=VAR
                                 ImportDefinition@1000000 : Record 11148591;
                               BEGIN
                                 ImportDefinition := Rec;
                                 ImportDefinition.SETRECFILTER;
                                 REPORT.RUN(REPORT::"CI - Import Definitions", TRUE, FALSE, ImportDefinition);
                               END;
                                }
      { 1000088 ;2   ;Separator  }
      { 1000087 ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Import Definition from XML;
                                 NLD=XML-Definitie &importeren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Import;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ImportXMLDefinition@1000000 : Codeunit 11148636;
                               BEGIN
                                 ImportXMLDefinition.ImportImportDefinition(Rec);
                               END;
                                }
      { 1000083 ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Export Definition to &XML;
                                 NLD=Definitie exporteren naar &XML];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Export;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ExportDefinitionToXML@1000000 : Codeunit 11148634;
                               BEGIN
                                 ExportDefinitionToXML.ExportImportDefinition(Rec);
                               END;
                                }
      { 1000070 ;2   ;Separator  }
      { 1000075 ;2   ;Action    ;
                      CaptionML=[ENU=Test File;
                                 NLD=Bestand controleren];
                      OnAction=BEGIN
                                 TestFile;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                CaptionML=[ENU=General;
                           NLD=Algemeen] }

    { 1000001;2;Field     ;
                SourceExpr=Code;
                Editable=CodeEditable }

    { 1000003;2;Field     ;
                SourceExpr=Description;
                Editable=DescriptionEditable }

    { 1000005;2;Field     ;
                SourceExpr=Location;
                Enabled=LocationEnable;
                Editable=LocationEditable;
                OnLookup=VAR
                           Mgt@1000001 : Codeunit 11148589;
                           NewFolder@1000000 : Text[1024];
                         BEGIN
                           NewFolder := Mgt.BrowseForFolder('', '');
                           IF NewFolder <> '' THEN
                             VALIDATE(Location, NewFolder);
                         END;

                OnAssistEdit=VAR
                               Mgt@1000002 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder(Location);
                             END;
                              }

    { 1000014;2;Field     ;
                SourceExpr=Filename;
                Enabled=FilenameEnable;
                Editable=FilenameEditable }

    { 1000035;2;Field     ;
                SourceExpr="Processed Location";
                Enabled="Processed LocationEnable";
                Editable="Processed LocationEditable";
                OnLookup=VAR
                           Mgt@1000001 : Codeunit 11148589;
                           NewFolder@1000000 : Text[1024];
                         BEGIN
                           NewFolder := Mgt.BrowseForFolder('', '');
                           IF NewFolder <> '' THEN
                             "Processed Location" := NewFolder;
                         END;

                OnAssistEdit=VAR
                               Mgt@1000001 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder("Processed Location");
                             END;
                              }

    { 1000037;2;Field     ;
                SourceExpr="Log Location";
                Enabled="Log LocationEnable";
                Editable="Log LocationEditable";
                OnLookup=VAR
                           Mgt@1000001 : Codeunit 11148589;
                           NewFolder@1000000 : Text[1024];
                         BEGIN
                           NewFolder := Mgt.BrowseForFolder('', '');
                           IF NewFolder <> '' THEN
                             "Log Location" := NewFolder;
                         END;

                OnAssistEdit=VAR
                               Mgt@1000001 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder("Log Location");
                             END;
                              }

    { 1000084;2;Field     ;
                SourceExpr="Error Location";
                Enabled="Error LocationEnable";
                Editable="Error LocationEditable";
                OnLookup=VAR
                           Mgt@1000001 : Codeunit 11148589;
                           NewFolder@1000000 : Text[1024];
                         BEGIN
                           NewFolder := Mgt.BrowseForFolder('', '');
                           IF NewFolder <> '' THEN
                             "Error Location" := NewFolder;
                         END;

                OnAssistEdit=VAR
                               Mgt@1000001 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder("Error Location");
                             END;
                              }

    { 1000011;2;Field     ;
                SourceExpr=Status;
                ValuesAllowed=[Edit;Manual;Automated;Blocked];
                OnValidate=BEGIN
                             StatusOnAfterValidate;
                           END;
                            }

    { 1000053;2;Field     ;
                SourceExpr="Save to Messages";
                Enabled="Save to MessagesEnable";
                Editable="Save to MessagesEditable" }

    { 1000024;1;Part      ;
                Name=Lines;
                SubPageLink=Import Definition=FIELD(Code);
                PagePartID=Page11117072;
                Editable=LinesEditable }

    { 1905328801;1;Group  ;
                CaptionML=[ENU=Field Selection;
                           NLD=Veldselectie] }

    { 1000010;2;Field     ;
                SourceExpr="Main Table No.";
                Editable="Main Table No.Editable";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           // IDYN EBK >>>>
                           IF Mgt.LookupTableNo(Text) THEN BEGIN
                             EVALUATE("Main Table No.",Text);
                             VALIDATE("Main Table No.");
                           END;
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //EXIT(Mgt.LookupTableNo(Text));
                           // IDYN EBK <<<<
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.AssistTableNo("Main Table No.");
                             END;
                              }

    { 1000031;2;Field     ;
                DrillDown=No;
                SourceExpr="Main Table No. of Fields";
                OnAssistEdit=VAR
                               TmpFld@1000000 : TEMPORARY Record 2000000041;
                               SelectFields@1000001 : Page 11148589;
                             BEGIN
                               TESTFIELD("Main Table No.");
                               SelectFields.SetImportDefinition(TRUE, Rec);
                               SelectFields.SetFormBlocked(Status <> Status::Edit);

                               IF SelectFields.RUNMODAL = ACTION::OK THEN BEGIN
                                 SelectFields.GetSelectedFields(TmpFld);
                                 UpdateTableFields(TRUE, "Main Table No.", TmpFld);
                                 CurrPage.UPDATE(TRUE);
                               END;
                             END;
                              }

    { 1000025;2;Field     ;
                SourceExpr="Sub Table No.";
                Enabled="Sub Table No.Enable";
                Editable="Sub Table No.Editable";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           IF Mgt.LookupTableNo(Text) THEN BEGIN
                             EVALUATE("Sub Table No.",Text);
                             VALIDATE("Sub Table No.");
                           END;

                           // IDYN EBK >>>>
                           //Mgt.LookupRelatedTableNo("Main Table No.",Text);
                           //EVALUATE("Sub Table No.",Text);
                           //VALIDATE("Sub Table No.");
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //EXIT(Mgt.LookupRelatedTableNo("Main Table No.", Text));
                           // IDYN EBK <<<<
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.AssistTableNo("Sub Table No.");
                             END;
                              }

    { 1000033;2;Field     ;
                DrillDown=No;
                SourceExpr="Sub Table No. of Fields";
                Enabled="Sub Table No. of FieldsEnable";
                OnAssistEdit=VAR
                               TmpFld@1000000 : TEMPORARY Record 2000000041;
                               SelectFields@1000001 : Page 11148589;
                             BEGIN
                               TESTFIELD("Sub Table No.");
                               SelectFields.SetImportDefinition(FALSE, Rec);
                               SelectFields.SetFormBlocked(Status <> Status::Edit);
                               IF SelectFields.RUNMODAL = ACTION::OK THEN BEGIN
                                 SelectFields.GetSelectedFields(TmpFld);
                                 UpdateTableFields(FALSE, "Sub Table No.", TmpFld);
                                 CurrPage.UPDATE(TRUE);
                               END;
                             END;
                              }

    { 1903121901;1;Group  ;
                CaptionML=[ENU=Options;
                           NLD=Opties] }

    { 1000078;2;Field     ;
                SourceExpr="Project Code";
                Editable="Project CodeEditable" }

    { 1000076;2;Field     ;
                SourceExpr="Company Name";
                Editable="Company NameEditable" }

    { 1000064;2;Field     ;
                SourceExpr="Field Delimiter";
                Enabled="Field DelimiterEnable";
                Editable="Field DelimiterEditable" }

    { 1000066;2;Field     ;
                SourceExpr="Field Separator";
                Enabled="Field SeparatorEnable";
                Editable="Field SeparatorEditable" }

    { 1000068;2;Field     ;
                SourceExpr="Error Notific. E-Mail Address";
                Editable=ErrorNotificEMailAddressEditab }

    { 1000046;2;Field     ;
                SourceExpr="Error Notific. Include File";
                Enabled=ErrorNotificIncludeFileEnable;
                Editable=ErrorNotificIncludeFileEditabl }

    { 1000041;2;Field     ;
                SourceExpr="Monitor Modifications";
                Editable="Monitor ModificationsEditable" }

    { 1000043;2;Field     ;
                SourceExpr="Run Task";
                Editable="Run TaskEditable" }

    { 1000023;2;Field     ;
                SourceExpr=Headers;
                Enabled=HeadersEnable;
                Editable=HeadersEditable;
                OnValidate=BEGIN
                             HeadersOnAfterValidate;
                           END;
                            }

    { 1000022;2;Field     ;
                SourceExpr="Archive add YYYYMMDD";
                Enabled="Archive add YYYYMMDDEnable";
                Editable="Archive add YYYYMMDDEditable" }

    { 1100512000;2;Field  ;
                SourceExpr="Run Codeunit No.";
                Visible=FALSE;
                Editable="Run Codeunit No.Editable";
                OnLookup=VAR
                           Mgt@1100512000 : Codeunit 11148589;
                         BEGIN
                           EXIT(Mgt.LookupObjectNo(5, Text));
                         END;
                          }

  }
  CODE
  {
    VAR
      INMgt@1000000001 : Codeunit 11148589;
      CodeEditable@19001698 : Boolean INDATASET;
      DescriptionEditable@19061412 : Boolean INDATASET;
      LocationEditable@19035910 : Boolean INDATASET;
      "Error LocationEditable"@19032989 : Boolean INDATASET;
      FilenameEditable@19007928 : Boolean INDATASET;
      "File FormatEditable"@19047526 : Boolean INDATASET;
      "Processed LocationEditable"@19079254 : Boolean INDATASET;
      "Log LocationEditable"@19072655 : Boolean INDATASET;
      HeadersEditable@19062436 : Boolean INDATASET;
      "Save to MessagesEditable"@19046008 : Boolean INDATASET;
      "Field DelimiterEditable"@19049277 : Boolean INDATASET;
      "Field SeparatorEditable"@19009402 : Boolean INDATASET;
      "Run Codeunit No.Editable"@19055664 : Boolean INDATASET;
      "Company NameEditable"@19027413 : Boolean INDATASET;
      "Main Table No.Editable"@19066361 : Boolean INDATASET;
      "Sub Table No.Editable"@19054278 : Boolean INDATASET;
      ErrorNotificEMailAddressEditab@19034665 : Boolean INDATASET;
      ErrorNotificIncludeFileEditabl@19002766 : Boolean INDATASET;
      "Project CodeEditable"@19062497 : Boolean INDATASET;
      LinesEditable@19010511 : Boolean INDATASET;
      "Archive add YYYYMMDDEditable"@19050215 : Boolean INDATASET;
      "Monitor ModificationsEditable"@19075968 : Boolean INDATASET;
      "Run TaskEditable"@19005185 : Boolean INDATASET;
      "Field DelimiterEnable"@19000188 : Boolean INDATASET;
      "Field SeparatorEnable"@19035090 : Boolean INDATASET;
      LocationEnable@19013618 : Boolean INDATASET;
      FilenameEnable@19043700 : Boolean INDATASET;
      "Processed LocationEnable"@19043375 : Boolean INDATASET;
      "Log LocationEnable"@19050707 : Boolean INDATASET;
      "Error LocationEnable"@19002018 : Boolean INDATASET;
      "Save to MessagesEnable"@19010110 : Boolean INDATASET;
      ErrorNotificIncludeFileEnable@19047165 : Boolean INDATASET;
      "Sub Table No.Enable"@19033464 : Boolean INDATASET;
      "Sub Table No. of FieldsEnable"@19016380 : Boolean INDATASET;
      "Archive add YYYYMMDDEnable"@19000830 : Boolean INDATASET;
      LeftEnable@19065291 : Boolean INDATASET;
      RightEnable@19037326 : Boolean INDATASET;
      HeadersEnable@1000000000 : Boolean INDATASET;

    LOCAL PROCEDURE EnableFields@1000000();
    BEGIN
      LocationEnable := "File Format" <> "File Format"::ADO;
      FilenameEnable := "File Format" <> "File Format"::ADO;
      "Processed LocationEnable" := "File Format" <> "File Format"::ADO;
      "Log LocationEnable" := "File Format" <> "File Format"::ADO;
      "Error LocationEnable" := "File Format" <> "File Format"::ADO;
      "Save to MessagesEnable" := "File Format" <> "File Format"::ADO;
      ErrorNotificIncludeFileEnable := "File Format" <> "File Format"::ADO;

      "Sub Table No.Enable" := "File Format" <> "File Format"::ADO;
      "Sub Table No. of FieldsEnable" := "File Format" <> "File Format"::ADO;

      HeadersEnable := "File Format" IN ["File Format"::CSV, "File Format"::"Fixed Width", "File Format"::Excel];

      "Field DelimiterEnable" := "File Format" = "File Format"::CSV;
      "Field SeparatorEnable" := "File Format" = "File Format"::CSV;

      "Archive add YYYYMMDDEnable" := "File Format" <> "File Format"::ADO;

      LeftEnable := "File Format" <> "File Format"::ADO;
      RightEnable := "File Format" <> "File Format"::ADO;
    END;

    LOCAL PROCEDURE SetFileFormatToLines@1000002();
    BEGIN
      CurrPage.Lines.PAGE.SetFileFormat("File Format");
    END;

    LOCAL PROCEDURE SetEditable@1000003();
    BEGIN
      CodeEditable := (Status = Status::Edit);
      DescriptionEditable := (Status = Status::Edit);
      LocationEditable := (Status = Status::Edit);
      "Error LocationEditable" := (Status = Status::Edit);
      FilenameEditable := (Status = Status::Edit);
      "File FormatEditable" := (Status = Status::Edit);
      "Processed LocationEditable" := (Status = Status::Edit);
      "Log LocationEditable" := (Status = Status::Edit);
      HeadersEditable := (Status = Status::Edit);
      "Save to MessagesEditable" := (Status = Status::Edit);
      "Field DelimiterEditable" := (Status = Status::Edit);
      "Field SeparatorEditable" := (Status = Status::Edit);
      "Run Codeunit No.Editable" := (Status = Status::Edit);
      "Company NameEditable" := (Status = Status::Edit);
      "Main Table No.Editable" := (Status = Status::Edit);
      "Sub Table No.Editable" := (Status = Status::Edit);
      ErrorNotificEMailAddressEditab := (Status = Status::Edit);
      ErrorNotificIncludeFileEditabl := (Status = Status::Edit);
      "Project CodeEditable" := (Status = Status::Edit);
      LinesEditable := (Status = Status::Edit);
      "Archive add YYYYMMDDEditable" := (Status = Status::Edit);
      "Monitor ModificationsEditable" := (Status = Status::Edit);
      "Run TaskEditable" := (Status = Status::Edit);
    END;

    LOCAL PROCEDURE StatusOnAfterValidate@19072689();
    BEGIN
      SetEditable;
    END;

    LOCAL PROCEDURE FileFormatOnAfterValidate@19065317();
    BEGIN
      EnableFields;
      SetFileFormatToLines;
      CurrPage.Lines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE HeadersOnAfterValidate@19010236();
    BEGIN
      EnableFields;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      EnableFields;

      SetFileFormatToLines;

      SetEditable;
    END;

    LOCAL PROCEDURE LocationOnAfterInput@19074197(VAR Text@19074198 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFolder(Text);
    END;

    LOCAL PROCEDURE ProcessedLocationOnAfterInput@19066889(VAR Text@19066890 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFolder(Text);
    END;

    LOCAL PROCEDURE LogLocationOnAfterInput@19076406(VAR Text@19076407 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFolder(Text);
    END;

    LOCAL PROCEDURE ErrorLocationOnAfterInput@19032366(VAR Text@19032367 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFolder(Text);
    END;

    LOCAL PROCEDURE MainTableNoOnAfterInput@19047063(VAR Text@19047064 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE SubTableNoOnAfterInput@19065603(VAR Text@19065604 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE RunCodeunitNoOnAfterInput@19017510(VAR Text@19017511 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputObjectNo(5, Text);
    END;

    LOCAL PROCEDURE MainTableNoOnFormat@19079044(Text@19015475 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Main Table No.");
    END;

    LOCAL PROCEDURE SubTableNoOnFormat@19052089(Text@19075565 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Sub Table No.");
    END;

    LOCAL PROCEDURE RunCodeunitNoOnFormat@19054474(Text@19073072 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatObjectNo(5, Text, "Run Codeunit No.");
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117072 CI - CSV Import Subform
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=CSV Import Subform;
               NLD=CSV Importdefinitiesubform];
    SourceTable=Table11148592;
    SourceTableView=SORTING(Import Definition,Line No.);
    PageType=ListPart;
    OnInit=BEGIN
             "New RecordEditable" := TRUE;
             "Existing RecordEditable" := TRUE;
             "Increment MethodEditable" := TRUE;
             LinktoTableTagNameEditable := TRUE;
             "Option TypeEditable" := TRUE;
             "Original ValueEditable" := TRUE;
             "Conversion CodeEditable" := TRUE;
             "Field No.Editable" := TRUE;
             "Table No.Editable" := TRUE;
           END;

    OnAfterGetRecord=BEGIN
                       "Option TypeHideValue" := FALSE;
                       "New RecordHideValue" := FALSE;
                       "Existing RecordHideValue" := FALSE;
                       "Tag NameIndent" := 0;
                       OnAfterGetCurrRecord;
                       TagNameOnFormat;
                       TableNoOnFormat(FORMAT("Table No."));
                       FieldNoOnFormat(FORMAT("Field No."));
                       ExistingRecordOnFormat;
                       NewRecordOnFormat;
                       OptionTypeOnFormat;
                     END;

    OnNewRecord=BEGIN
                  SetupNewLine(xRec, BelowxRec);
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1904677404;1 ;ActionGroup;
                      CaptionML=[ENU=&Import Def.;
                                 NLD=&Importdef.] }
      { 1903294104;2 ;Action    ;
                      ShortCutKey=Ctrl+L;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Link &Tables;
                                 NLD=Tabellen linken];
                      OnAction=BEGIN
                                 LinkTables;
                               END;
                                }
      { 1906522404;2 ;Action    ;
                      ShortCutKey=Ctrl+R;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Restrictions;
                                 NLD=Restricties];
                      OnAction=BEGIN
                                 _OpenRestrictions;
                               END;
                                }
      { 1000000007;1 ;Separator  }
      { 1000000006;1 ;Action    ;
                      Name=<Action1000000000>;
                      ShortCutKey=Shift+Ctrl+R;
                      CaptionML=[ENU=Right;
                                 NLD=Rechts];
                      Promoted=Yes;
                      OnAction=BEGIN
                                 Right;
                               END;
                                }
      { 1000000005;1 ;Action    ;
                      Name=<Action1000000001>;
                      ShortCutKey=Shift+Ctrl+L;
                      CaptionML=[ENU=Left;
                                 NLD=Links];
                      OnAction=BEGIN
                                 Left;
                               END;
                                }
      { 1000000003;1 ;Action    ;
                      Name=<Action1000000002>;
                      ShortCutKey=Shift+Ctrl+U;
                      CaptionML=[ENU=Up;
                                 NLD=Omhoog];
                      OnAction=BEGIN
                                 Up;
                               END;
                                }
      { 1000000001;1 ;Action    ;
                      Name=<Action1000000003>;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Down;
                                 NLD=Omlaag];
                      OnAction=BEGIN
                                 Down;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                IndentationColumnName="Tag NameIndent";
                IndentationControls=Tag Name;
                GroupType=Repeater }

    { 1000011;2;Field     ;
                SourceExpr="Tag Name" }

    { 1000001;2;Field     ;
                SourceExpr=Type;
                ValuesAllowed=[Table;Value;Const;Variable;Skip];
                OnValidate=BEGIN
                             TypeOnAfterValidate;
                           END;
                            }

    { 1000031;2;Field     ;
                SourceExpr=Code }

    { 1100531000;2;Field  ;
                SourceExpr="No. of Functions" }

    { 1000005;2;Field     ;
                SourceExpr="Table No.";
                Editable="Table No.Editable";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           // IDYN EBK >>>>
                           IF Mgt.LookupTableNo(Text) THEN BEGIN
                             EVALUATE("Table No.",Text);
                             VALIDATE("Table No.");
                           END;
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //EXIT(Mgt.LookupTableNo(Text));
                           // IDYN EBK <<<<
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.AssistTableNo("Table No.");
                             END;
                              }

    { 1000000012;2;Field  ;
                Name=Table Name;
                SourceExpr="Table Name" }

    { 1000009;2;Field     ;
                SourceExpr="Field No.";
                Editable="Field No.Editable";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           // IDYN EBK >>>>
                           IF Mgt.LookupFieldNo("Table No.",Text,TRUE) THEN BEGIN
                             EVALUATE("Field No.",Text);
                             VALIDATE("Field No.");
                           END;
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //EXIT(Mgt.LookupFieldNo("Table No.", Text, TRUE));
                           // IDYN EBK <<<<
                         END;
                          }

    { 1000000013;2;Field  ;
                Name=Field Name;
                SourceExpr="Field Name" }

    { 1000037;2;Field     ;
                SourceExpr=Identifier }

    { 1000000010;2;Field  ;
                SourceExpr="No. Series" }

    { 1000029;2;Field     ;
                SourceExpr="Original Value";
                Visible=FALSE;
                Editable="Original ValueEditable" }

    { 1000023;2;Field     ;
                SourceExpr="Link to Table (Tag Name)";
                Editable=LinktoTableTagNameEditable;
                OnAssistEdit=BEGIN
                               SetupLinkToTable;
                             END;
                              }

    { 1000041;2;Field     ;
                SourceExpr="Existing Record";
                Editable="Existing RecordEditable";
                HideValue="Existing RecordHideValue" }

    { 1000000004;2;Field  ;
                SourceExpr="Error No. Existing Record";
                Visible=FALSE }

    { 1000043;2;Field     ;
                SourceExpr="New Record";
                Editable="New RecordEditable";
                HideValue="New RecordHideValue" }

    { 1000000002;2;Field  ;
                SourceExpr="Error No. New Record";
                Visible=FALSE }

    { 1000035;2;Field     ;
                SourceExpr="No. of Restrictions" }

    { 1000007;2;Field     ;
                SourceExpr="Increment Method";
                Visible=FALSE;
                Editable="Increment MethodEditable" }

    { 1000021;2;Field     ;
                SourceExpr="Conversion Code";
                Editable="Conversion CodeEditable" }

    { 1000027;2;Field     ;
                SourceExpr="Dest. Variable";
                Visible=FALSE }

    { 1000015;2;Field     ;
                SourceExpr="Validate Field";
                Visible=FALSE }

    { 1000013;2;Field     ;
                SourceExpr="Skip If Empty";
                Visible=FALSE }

    { 1000025;2;Field     ;
                SourceExpr="Save Record";
                Visible=FALSE }

    { 1000017;2;Field     ;
                SourceExpr="Data Format";
                Visible=FALSE }

    { 1000000008;2;Field  ;
                SourceExpr="Custom Date Order";
                Visible=false }

    { 1000000009;2;Field  ;
                SourceExpr="Custom Date Separator";
                Visible=False }

    { 1000033;2;Field     ;
                SourceExpr="Option Type";
                Visible=FALSE;
                Editable="Option TypeEditable";
                HideValue="Option TypeHideValue" }

    { 1000039;2;Field     ;
                SourceExpr=Mandatory;
                Visible=FALSE }

    { 1000000000;2;Field  ;
                SourceExpr="Error No. Field Mandatory";
                Visible=FALSE }

  }
  CODE
  {
    VAR
      FileFormat@1000000 : 'XML,CSV,FixedWidth,Excel';
      "Tag NameIndent"@19056250 : Integer INDATASET;
      "Existing RecordHideValue"@19025366 : Boolean INDATASET;
      "New RecordHideValue"@19012537 : Boolean INDATASET;
      "Option TypeHideValue"@19002310 : Boolean INDATASET;
      "Table No.Editable"@19076806 : Boolean INDATASET;
      "Field No.Editable"@19022826 : Boolean INDATASET;
      "Conversion CodeEditable"@19074872 : Boolean INDATASET;
      "Original ValueEditable"@19060489 : Boolean INDATASET;
      "Option TypeEditable"@19019138 : Boolean INDATASET;
      LinktoTableTagNameEditable@19004008 : Boolean INDATASET;
      "Increment MethodEditable"@19041957 : Boolean INDATASET;
      "Existing RecordEditable"@19014716 : Boolean INDATASET;
      "New RecordEditable"@19061505 : Boolean INDATASET;

    PROCEDURE Left@1000000();
    VAR
      ImportDefinitionLine@1100512000 : Record 11148592;
    BEGIN
      CurrPage.SETSELECTIONFILTER(ImportDefinitionLine);
      IF ImportDefinitionLine.FINDSET THEN
        REPEAT
          IF ImportDefinitionLine."Entry No." <> 0 THEN
            IF ImportDefinitionLine.Indent > 0 THEN BEGIN
              ImportDefinitionLine.Indent -= 1;
              ImportDefinitionLine.MODIFY;
            END;
        UNTIL ImportDefinitionLine.NEXT = 0;
    END;

    PROCEDURE Right@1000001();
    VAR
      ImportDefinitionLine@1100512000 : Record 11148592;
    BEGIN
      CurrPage.SETSELECTIONFILTER(ImportDefinitionLine);
      IF ImportDefinitionLine.FINDSET THEN
        REPEAT
          IF ImportDefinitionLine."Entry No." <> 0 THEN BEGIN
            ImportDefinitionLine.Indent += 1;
            ImportDefinitionLine.MODIFY;
          END;
        UNTIL ImportDefinitionLine.NEXT = 0;
    END;

    PROCEDURE Up@1000004();
    VAR
      CurrLine@1000004 : Record 11148592;
      ImportDefinitionLine@1000000 : Record 11148592;
      SelectedLine@1000002 : Record 11148592;
      LineNo@1000001 : Integer;
    BEGIN
      CurrLine := Rec;

      CurrPage.SETSELECTIONFILTER(SelectedLine);
      IF SelectedLine.COUNT = 0 THEN BEGIN
        SelectedLine.RESET;
        SelectedLine := Rec;
        SelectedLine.SETRECFILTER;
      END;

      IF SelectedLine.FINDSET THEN
        REPEAT
          ImportDefinitionLine.SETCURRENTKEY("Import Definition", "Line No.");
          ImportDefinitionLine.SETRANGE("Import Definition", "Import Definition");
          ImportDefinitionLine := SelectedLine;
          IF ImportDefinitionLine.NEXT(-1) <> 0 THEN BEGIN
            LineNo := ImportDefinitionLine."Line No.";
            ImportDefinitionLine."Line No." := SelectedLine."Line No.";
            ImportDefinitionLine.MODIFY;
            SelectedLine."Line No." := LineNo;
            SelectedLine.MODIFY;
          END;
        UNTIL SelectedLine.NEXT = 0;

      GET(CurrLine."Import Definition", CurrLine."Entry No.");
    END;

    PROCEDURE Down@1000005();
    VAR
      CurrLine@1000001 : Record 11148592;
      ImportDefinitionLine@1000003 : Record 11148592;
      SelectedLine@1000002 : Record 11148592;
      LineNo@1000000 : Integer;
    BEGIN
      CurrLine := Rec;

      CurrPage.SETSELECTIONFILTER(SelectedLine);
      IF SelectedLine.COUNT = 0 THEN BEGIN
        SelectedLine.RESET;
        SelectedLine := Rec;
        SelectedLine.SETRECFILTER;
      END;

      IF SelectedLine.FINDLAST THEN
        REPEAT
          ImportDefinitionLine.SETCURRENTKEY("Import Definition", "Line No.");
          ImportDefinitionLine.SETRANGE("Import Definition", "Import Definition");
          ImportDefinitionLine := SelectedLine;
          IF ImportDefinitionLine.NEXT(1) <> 0 THEN BEGIN
            LineNo := ImportDefinitionLine."Line No.";
            ImportDefinitionLine."Line No." := SelectedLine."Line No.";
            ImportDefinitionLine.MODIFY;
            SelectedLine."Line No." := LineNo;
            SelectedLine.MODIFY;
          END;
        UNTIL SelectedLine.NEXT(-1) = 0;

      GET(CurrLine."Import Definition", CurrLine."Entry No.");
    END;

    PROCEDURE LinkTables@1000002();
    BEGIN
      SetupLinkToTable;
    END;

    PROCEDURE UpdateForm@1000003();
    BEGIN
      CurrPage.UPDATE(FALSE);
    END;

    PROCEDURE _OpenRestrictions@19068975();
    BEGIN
      OpenRestrictions;
    END;

    PROCEDURE OpenRestrictions@1000006();
    BEGIN
      OpenRestrictions;
    END;

    PROCEDURE SetFileFormat@1000008(NewValue@1000000 : Option);
    BEGIN
      FileFormat := NewValue;
    END;

    LOCAL PROCEDURE SetFieldsEditable@1000009();
    BEGIN
      "Table No.Editable" := (Type IN [Type::Table, Type::Value, Type::Const, Type::Variable, Type::Skip]);
      "Field No.Editable" := (Type IN [Type::Value, Type::Const, Type::Variable, Type::Skip]);
      "Conversion CodeEditable" := (Type IN [Type::Value, Type::Const, Type::Variable]);
      "Original ValueEditable" := (Type IN [Type::Value, Type::Const, Type::Variable]);
      "Option TypeEditable" := (Type IN [Type::Value, Type::Const, Type::Variable]);
      LinktoTableTagNameEditable := (Type = Type::Table);
      "Increment MethodEditable" := (Type IN [Type::Value, Type::Const, Type::Variable]);
      "Existing RecordEditable" := (Type = Type::Table);
      "New RecordEditable" := (Type = Type::Table);
    END;

    LOCAL PROCEDURE TypeOnAfterValidate@19069045();
    BEGIN
      SetFieldsEditable;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      SetFieldsEditable;
    END;

    LOCAL PROCEDURE TableNoOnAfterInput@19060375(VAR Text@19060376 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE FieldNoOnAfterInput@19063566(VAR Text@19063567 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFieldNo(Text, "Table No.", TRUE);
    END;

    LOCAL PROCEDURE TagNameOnFormat@19023679();
    BEGIN
      "Tag NameIndent" := Indent;
    END;

    LOCAL PROCEDURE TableNoOnFormat@19071785(Text@19016339 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Table No.");
    END;

    LOCAL PROCEDURE FieldNoOnFormat@19075355(Text@19041114 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatFieldNo(Text, "Table No.", "Field No.");
    END;

    LOCAL PROCEDURE ExistingRecordOnFormat@19009624();
    BEGIN
      IF FileFormat = FileFormat::XML THEN BEGIN
        IF Type <> Type::Table THEN
          "Existing RecordHideValue" := TRUE;
      END ELSE
        IF NOT (Type IN [Type::Table, Type::Value]) THEN
          "Existing RecordHideValue" := TRUE;
    END;

    LOCAL PROCEDURE NewRecordOnFormat@19036900();
    BEGIN
      IF FileFormat = FileFormat::XML THEN BEGIN
        IF Type <> Type::Table THEN
          "New RecordHideValue" := TRUE;
      END ELSE
        IF NOT (Type IN [Type::Table, Type::Value]) THEN
          "New RecordHideValue" := TRUE;
    END;

    LOCAL PROCEDURE OptionTypeOnFormat@19077341();
    BEGIN
      IF NOT (Type IN [Type::Value, Type::Const, Type::Variable, Type::Skip]) THEN
        "Option TypeHideValue" := TRUE;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117073 CI - Fixed Width Import Card
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Fixed Width Import Card;
               NLD=Fixed Width Importdefinitie];
    SourceTable=Table11148591;
    SourceTableView=WHERE(File Format=CONST(Fixed Width));
    PageType=Card;
    OnInit=BEGIN
             RightEnable := TRUE;
             LeftEnable := TRUE;
             "Archive add YYYYMMDDEnable" := TRUE;
             "Sub Table No. of FieldsEnable" := TRUE;
             "Sub Table No.Enable" := TRUE;
             ErrorNotificIncludeFileEnable := TRUE;
             "Save to MessagesEnable" := TRUE;
             "Error LocationEnable" := TRUE;
             "Log LocationEnable" := TRUE;
             "Processed LocationEnable" := TRUE;
             FilenameEnable := TRUE;
             LocationEnable := TRUE;
             "Run TaskEditable" := TRUE;
             "Monitor ModificationsEditable" := TRUE;
             "Archive add YYYYMMDDEditable" := TRUE;
             LinesEditable := TRUE;
             "Project CodeEditable" := TRUE;
             ErrorNotificIncludeFileEditabl := TRUE;
             ErrorNotificEMailAddressEditab := TRUE;
             "Sub Table No.Editable" := TRUE;
             "Main Table No.Editable" := TRUE;
             "Company NameEditable" := TRUE;
             "Run Codeunit No.Editable" := TRUE;
             "Save to MessagesEditable" := TRUE;
             HeadersEditable := TRUE;
             "Log LocationEditable" := TRUE;
             "Processed LocationEditable" := TRUE;
             "File FormatEditable" := TRUE;
             FilenameEditable := TRUE;
             "Error LocationEditable" := TRUE;
             LocationEditable := TRUE;
             DescriptionEditable := TRUE;
             CodeEditable := TRUE;
           END;

    OnOpenPage=VAR
                 Initialize@1000001 : Codeunit 11148625;
               BEGIN
                 Initialize.CheckInitialize;
               END;

    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                       MainTableNoOnFormat(FORMAT("Main Table No."));
                       SubTableNoOnFormat(FORMAT("Sub Table No."));
                       RunCodeunitNoOnFormat(FORMAT("Run Codeunit No."));
                     END;

    OnNewRecord=VAR
                  Setup@1000000 : Record 11148589;
                BEGIN
                  Setup.GET;
                  VALIDATE(Location, Setup."Default Import Location");

                  "File Format" := "File Format"::"Fixed Width";
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000049 ;1   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Process;
                                 NLD=Verwerken];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Setup@1100512001 : Record 11148589;
                                 ProcessImportDef@1000001 : Codeunit 11148592;
                                 Progressbar@1000002 : Codeunit 11148624;
                                 ErrorMgt@1000006 : Codeunit 11148630;
                                 FileImported@1000003 : Boolean;
                                 ctImportCancelled@1000004 : TextConst 'ENU=Import cancelled.;NLD=Importeren afgebroken.';
                               BEGIN
                                 ErrorMgt.ClearError;

                                 Progressbar.Open(2);

                                 Setup.GET;
                                 IF Setup."Use Error Handling" THEN
                                   FileImported := ProcessImportDef.RUN(Rec)
                                 ELSE BEGIN
                                   ProcessImportDef.RUN(Rec);
                                   FileImported := TRUE;
                                 END;

                                 Progressbar.Close;

                                 IF NOT FileImported THEN
                                   IF ErrorMgt.GetError = '' THEN
                                     MESSAGE(ctImportCancelled)
                                   ELSE
                                     MESSAGE(ErrorMgt.GetError);
                               END;
                                }
      { 1000000002;1 ;Action    ;
                      CaptionML=[ENU=Copy;
                                 NLD=Kopiren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Copy;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Copy;
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1000000001;1 ;Action    ;
                      Name=<Action1000000000>;
                      CaptionML=[ENU=Copy To;
                                 NLD=Kopiren naar];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Copy;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CopyTo;
                               END;
                                }
      { 1000000000;1 ;ActionGroup;
                      CaptionML=[ENU=Move;
                                 NLD=Verplaatsen] }
      { 1000050 ;2   ;Action    ;
                      Name=Left;
                      Promoted=Yes;
                      Enabled=LeftEnable;
                      PromotedIsBig=Yes;
                      Image=PreviousSet;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+L');
                               END;
                                }
      { 1000048 ;2   ;Action    ;
                      Name=Right;
                      Promoted=Yes;
                      Enabled=RightEnable;
                      PromotedIsBig=Yes;
                      Image=NextSet;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+R');
                               END;
                                }
      { 1000047 ;2   ;Action    ;
                      Name=<Action1000047>;
                      CaptionML=[ENU=Up;
                                 NLD=Omhoog];
                      Promoted=Yes;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+U');
                               END;
                                }
      { 1000028 ;2   ;Action    ;
                      Name=<Action1000028>;
                      CaptionML=[ENU=Down;
                                 NLD=Omlaag];
                      Promoted=Yes;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+D');
                               END;
                                }
      { 1000000003;1 ;ActionGroup;
                      CaptionML=[ENU=Messages and History;
                                 NLD=Berichten en historie] }
      { 1000063 ;2   ;Action    ;
                      ShortCutKey=Ctrl+F5;
                      CaptionML=[ENU=Messages;
                                 NLD=Berichten];
                      RunObject=Page 11117032;
                      RunPageView=SORTING(Type,Code);
                      RunPageLink=Type=CONST(Import),
                                  Code=FIELD(Code);
                      Promoted=Yes;
                      Image=Note;
                      PromotedCategory=Process }
      { 1000062 ;2   ;Action    ;
                      CaptionML=[ENU=History;
                                 NLD=Historie];
                      RunObject=Page 11117034;
                      RunPageView=SORTING(Type,Code)
                                  WHERE(Type=CONST(Import));
                      RunPageLink=Code=FIELD(Code);
                      Image=History }
      { 1000009 ;2   ;Action    ;
                      CaptionML=[ENU=Message Hist. &Comments;
                                 NLD=Bericht hist. op&merkingen];
                      RunObject=Page 11117035;
                      RunPageView=SORTING(Type,Code);
                      RunPageLink=Type=CONST(Import),
                                  Code=FIELD(Code) }
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000016 ;1   ;ActionGroup;
                      CaptionML=[ENU=&Import Def.;
                                 NLD=&Importdef.] }
      { 1100531001;2 ;Action    ;
                      ShortCutKey=Ctrl+Alt+V;
                      CaptionML=[ENU=Versions;
                                 NLD=Versies];
                      RunObject=Page 11117095;
                      RunPageView=SORTING(Code,Version No.);
                      RunPageLink=Code=FIELD(Code) }
      { 1100531000;2 ;Action    ;
                      ShortCutKey=Ctrl+S;
                      CaptionML=[ENU=Save as New Version;
                                 NLD=Op&slaan als nieuwe versie];
                      OnAction=BEGIN
                                 SaveNewVersion;
                               END;
                                }
      { 1000021 ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NLD=F&uncties] }
      { 1000040 ;2   ;Action    ;
                      CaptionML=[ENU=Renumber Lines;
                                 NLD=Regels hernummeren];
                      OnAction=BEGIN
                                 RenumberLines;
                               END;
                                }
      { 1000086 ;2   ;Separator  }
      { 1000071 ;2   ;Action    ;
                      CaptionML=[ENU=Pri&nt;
                                 NLD=Afdrukken];
                      OnAction=VAR
                                 ImportDefinition@1000000 : Record 11148591;
                               BEGIN
                                 ImportDefinition := Rec;
                                 ImportDefinition.SETRECFILTER;
                                 REPORT.RUN(REPORT::"CI - Import Definitions", TRUE, FALSE, ImportDefinition);
                               END;
                                }
      { 1000088 ;2   ;Separator  }
      { 1000087 ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Import Definition from XML;
                                 NLD=XML-Definitie &importeren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Import;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ImportXMLDefinition@1000000 : Codeunit 11148636;
                               BEGIN
                                 ImportXMLDefinition.ImportImportDefinition(Rec);
                               END;
                                }
      { 1000083 ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Export Definition to &XML;
                                 NLD=Definitie exporteren naar &XML];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Export;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ExportDefinitionToXML@1000000 : Codeunit 11148634;
                               BEGIN
                                 ExportDefinitionToXML.ExportImportDefinition(Rec);
                               END;
                                }
      { 1000070 ;2   ;Separator  }
      { 1000075 ;2   ;Action    ;
                      CaptionML=[ENU=Test File;
                                 NLD=Bestand controleren];
                      OnAction=BEGIN
                                 TestFile;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                CaptionML=[ENU=General;
                           NLD=Algemeen] }

    { 1000001;2;Field     ;
                SourceExpr=Code;
                Editable=CodeEditable }

    { 1000003;2;Field     ;
                SourceExpr=Description;
                Editable=DescriptionEditable }

    { 1000005;2;Field     ;
                SourceExpr=Location;
                Enabled=LocationEnable;
                Editable=LocationEditable;
                OnLookup=VAR
                           Mgt@1000001 : Codeunit 11148589;
                           NewFolder@1000000 : Text[1024];
                         BEGIN
                           NewFolder := Mgt.BrowseForFolder('', '');
                           IF NewFolder <> '' THEN
                             VALIDATE(Location, NewFolder);
                         END;

                OnAssistEdit=VAR
                               Mgt@1000002 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder(Location);
                             END;
                              }

    { 1000014;2;Field     ;
                SourceExpr=Filename;
                Enabled=FilenameEnable;
                Editable=FilenameEditable }

    { 1000035;2;Field     ;
                SourceExpr="Processed Location";
                Enabled="Processed LocationEnable";
                Editable="Processed LocationEditable";
                OnLookup=VAR
                           Mgt@1000001 : Codeunit 11148589;
                           NewFolder@1000000 : Text[1024];
                         BEGIN
                           NewFolder := Mgt.BrowseForFolder('', '');
                           IF NewFolder <> '' THEN
                             "Processed Location" := NewFolder;
                         END;

                OnAssistEdit=VAR
                               Mgt@1000001 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder("Processed Location");
                             END;
                              }

    { 1000037;2;Field     ;
                SourceExpr="Log Location";
                Enabled="Log LocationEnable";
                Editable="Log LocationEditable";
                OnLookup=VAR
                           Mgt@1000001 : Codeunit 11148589;
                           NewFolder@1000000 : Text[1024];
                         BEGIN
                           NewFolder := Mgt.BrowseForFolder('', '');
                           IF NewFolder <> '' THEN
                             "Log Location" := NewFolder;
                         END;

                OnAssistEdit=VAR
                               Mgt@1000001 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder("Log Location");
                             END;
                              }

    { 1000084;2;Field     ;
                SourceExpr="Error Location";
                Enabled="Error LocationEnable";
                Editable="Error LocationEditable";
                OnLookup=VAR
                           Mgt@1000001 : Codeunit 11148589;
                           NewFolder@1000000 : Text[1024];
                         BEGIN
                           NewFolder := Mgt.BrowseForFolder('', '');
                           IF NewFolder <> '' THEN
                             "Error Location" := NewFolder;
                         END;

                OnAssistEdit=VAR
                               Mgt@1000001 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder("Error Location");
                             END;
                              }

    { 1000011;2;Field     ;
                SourceExpr=Status;
                ValuesAllowed=[Edit;Manual;Automated;Blocked];
                OnValidate=BEGIN
                             StatusOnAfterValidate;
                           END;
                            }

    { 1000053;2;Field     ;
                SourceExpr="Save to Messages";
                Enabled="Save to MessagesEnable";
                Editable="Save to MessagesEditable" }

    { 1000024;1;Part      ;
                Name=Lines;
                SubPageLink=Import Definition=FIELD(Code);
                PagePartID=Page11117074;
                Editable=LinesEditable }

    { 1905328801;1;Group  ;
                CaptionML=[ENU=Field Selection;
                           NLD=Veldselectie] }

    { 1000010;2;Field     ;
                SourceExpr="Main Table No.";
                Editable="Main Table No.Editable";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           // IDYN EBK >>>>
                           IF Mgt.LookupTableNo(Text) THEN BEGIN
                             EVALUATE("Main Table No.",Text);
                             VALIDATE("Main Table No.");
                           END;
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //EXIT(Mgt.LookupTableNo(Text));
                           // IDYN EBK <<<<
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.AssistTableNo("Main Table No.");
                             END;
                              }

    { 1000031;2;Field     ;
                DrillDown=No;
                SourceExpr="Main Table No. of Fields";
                OnAssistEdit=VAR
                               TmpFld@1000000 : TEMPORARY Record 2000000041;
                               SelectFields@1000001 : Page 11148589;
                             BEGIN
                               TESTFIELD("Main Table No.");
                               SelectFields.SetImportDefinition(TRUE, Rec);
                               SelectFields.SetFormBlocked(Status <> Status::Edit);

                               IF SelectFields.RUNMODAL = ACTION::OK THEN BEGIN
                                 SelectFields.GetSelectedFields(TmpFld);
                                 UpdateTableFields(TRUE, "Main Table No.", TmpFld);
                                 CurrPage.UPDATE(TRUE);
                               END;
                             END;
                              }

    { 1000025;2;Field     ;
                SourceExpr="Sub Table No.";
                Enabled="Sub Table No.Enable";
                Editable="Sub Table No.Editable";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           IF Mgt.LookupTableNo(Text) THEN BEGIN
                             EVALUATE("Sub Table No.",Text);
                             VALIDATE("Sub Table No.");
                           END;

                           // IDYN EBK >>>>
                           //Mgt.LookupRelatedTableNo("Main Table No.",Text);
                           //EVALUATE("Sub Table No.",Text);
                           //VALIDATE("Sub Table No.");
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //EXIT(Mgt.LookupRelatedTableNo("Main Table No.", Text));
                           // IDYN EBK <<<<
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.AssistTableNo("Sub Table No.");
                             END;
                              }

    { 1000033;2;Field     ;
                DrillDown=No;
                SourceExpr="Sub Table No. of Fields";
                Enabled="Sub Table No. of FieldsEnable";
                OnAssistEdit=VAR
                               TmpFld@1000000 : TEMPORARY Record 2000000041;
                               SelectFields@1000001 : Page 11148589;
                             BEGIN
                               TESTFIELD("Sub Table No.");
                               SelectFields.SetImportDefinition(FALSE, Rec);
                               SelectFields.SetFormBlocked(Status <> Status::Edit);
                               IF SelectFields.RUNMODAL = ACTION::OK THEN BEGIN
                                 SelectFields.GetSelectedFields(TmpFld);
                                 UpdateTableFields(FALSE, "Sub Table No.", TmpFld);
                                 CurrPage.UPDATE(TRUE);
                               END;
                             END;
                              }

    { 1903121901;1;Group  ;
                CaptionML=[ENU=Options;
                           NLD=Opties] }

    { 1000078;2;Field     ;
                SourceExpr="Project Code";
                Editable="Project CodeEditable" }

    { 1000076;2;Field     ;
                SourceExpr="Company Name";
                Editable="Company NameEditable" }

    { 1000068;2;Field     ;
                SourceExpr="Error Notific. E-Mail Address";
                Editable=ErrorNotificEMailAddressEditab }

    { 1000046;2;Field     ;
                SourceExpr="Error Notific. Include File";
                Enabled=ErrorNotificIncludeFileEnable;
                Editable=ErrorNotificIncludeFileEditabl }

    { 1000041;2;Field     ;
                SourceExpr="Monitor Modifications";
                Editable="Monitor ModificationsEditable" }

    { 1000043;2;Field     ;
                SourceExpr="Run Task";
                Editable="Run TaskEditable" }

    { 1100512000;2;Field  ;
                SourceExpr="Run Codeunit No.";
                Visible=FALSE;
                Editable="Run Codeunit No.Editable";
                OnLookup=VAR
                           Mgt@1100512000 : Codeunit 11148589;
                         BEGIN
                           EXIT(Mgt.LookupObjectNo(5, Text));
                         END;
                          }

    { 1000023;2;Field     ;
                SourceExpr=Headers;
                Enabled=HeadersEnable;
                Editable=HeadersEditable;
                OnValidate=BEGIN
                             HeadersOnAfterValidate;
                           END;
                            }

    { 1000022;2;Field     ;
                SourceExpr="Archive add YYYYMMDD";
                Enabled="Archive add YYYYMMDDEnable";
                Editable="Archive add YYYYMMDDEditable" }

  }
  CODE
  {
    VAR
      INMgt@1000000001 : Codeunit 11148589;
      CodeEditable@19001698 : Boolean INDATASET;
      DescriptionEditable@19061412 : Boolean INDATASET;
      LocationEditable@19035910 : Boolean INDATASET;
      "Error LocationEditable"@19032989 : Boolean INDATASET;
      FilenameEditable@19007928 : Boolean INDATASET;
      "File FormatEditable"@19047526 : Boolean INDATASET;
      "Processed LocationEditable"@19079254 : Boolean INDATASET;
      "Log LocationEditable"@19072655 : Boolean INDATASET;
      HeadersEditable@19062436 : Boolean INDATASET;
      "Save to MessagesEditable"@19046008 : Boolean INDATASET;
      "Run Codeunit No.Editable"@19055664 : Boolean INDATASET;
      "Company NameEditable"@19027413 : Boolean INDATASET;
      "Main Table No.Editable"@19066361 : Boolean INDATASET;
      "Sub Table No.Editable"@19054278 : Boolean INDATASET;
      ErrorNotificEMailAddressEditab@19034665 : Boolean INDATASET;
      ErrorNotificIncludeFileEditabl@19002766 : Boolean INDATASET;
      "Project CodeEditable"@19062497 : Boolean INDATASET;
      LinesEditable@19010511 : Boolean INDATASET;
      "Archive add YYYYMMDDEditable"@19050215 : Boolean INDATASET;
      "Monitor ModificationsEditable"@19075968 : Boolean INDATASET;
      "Run TaskEditable"@19005185 : Boolean INDATASET;
      LocationEnable@19013618 : Boolean INDATASET;
      FilenameEnable@19043700 : Boolean INDATASET;
      "Processed LocationEnable"@19043375 : Boolean INDATASET;
      "Log LocationEnable"@19050707 : Boolean INDATASET;
      "Error LocationEnable"@19002018 : Boolean INDATASET;
      "Save to MessagesEnable"@19010110 : Boolean INDATASET;
      ErrorNotificIncludeFileEnable@19047165 : Boolean INDATASET;
      "Sub Table No.Enable"@19033464 : Boolean INDATASET;
      "Sub Table No. of FieldsEnable"@19016380 : Boolean INDATASET;
      "Archive add YYYYMMDDEnable"@19000830 : Boolean INDATASET;
      LeftEnable@19065291 : Boolean INDATASET;
      RightEnable@19037326 : Boolean INDATASET;
      HeadersEnable@1000000000 : Boolean INDATASET;

    LOCAL PROCEDURE EnableFields@1000000();
    BEGIN
      LocationEnable := "File Format" <> "File Format"::ADO;
      FilenameEnable := "File Format" <> "File Format"::ADO;
      "Processed LocationEnable" := "File Format" <> "File Format"::ADO;
      "Log LocationEnable" := "File Format" <> "File Format"::ADO;
      "Error LocationEnable" := "File Format" <> "File Format"::ADO;
      "Save to MessagesEnable" := "File Format" <> "File Format"::ADO;
      ErrorNotificIncludeFileEnable := "File Format" <> "File Format"::ADO;

      "Sub Table No.Enable" := "File Format" <> "File Format"::ADO;
      "Sub Table No. of FieldsEnable" := "File Format" <> "File Format"::ADO;

      HeadersEnable := "File Format" IN ["File Format"::CSV, "File Format"::"Fixed Width", "File Format"::Excel];

      "Archive add YYYYMMDDEnable" := "File Format" <> "File Format"::ADO;

      LeftEnable := "File Format" <> "File Format"::ADO;
      RightEnable := "File Format" <> "File Format"::ADO;
    END;

    LOCAL PROCEDURE SetFileFormatToLines@1000002();
    BEGIN
      CurrPage.Lines.PAGE.SetFileFormat("File Format");
    END;

    LOCAL PROCEDURE SetEditable@1000003();
    BEGIN
      CodeEditable := (Status = Status::Edit);
      DescriptionEditable := (Status = Status::Edit);
      LocationEditable := (Status = Status::Edit);
      "Error LocationEditable" := (Status = Status::Edit);
      FilenameEditable := (Status = Status::Edit);
      "File FormatEditable" := (Status = Status::Edit);
      "Processed LocationEditable" := (Status = Status::Edit);
      "Log LocationEditable" := (Status = Status::Edit);
      HeadersEditable := (Status = Status::Edit);
      "Save to MessagesEditable" := (Status = Status::Edit);
      "Run Codeunit No.Editable" := (Status = Status::Edit);
      "Company NameEditable" := (Status = Status::Edit);
      "Main Table No.Editable" := (Status = Status::Edit);
      "Sub Table No.Editable" := (Status = Status::Edit);
      ErrorNotificEMailAddressEditab := (Status = Status::Edit);
      ErrorNotificIncludeFileEditabl := (Status = Status::Edit);
      "Project CodeEditable" := (Status = Status::Edit);
      LinesEditable := (Status = Status::Edit);
      "Archive add YYYYMMDDEditable" := (Status = Status::Edit);
      "Monitor ModificationsEditable" := (Status = Status::Edit);
      "Run TaskEditable" := (Status = Status::Edit);
    END;

    LOCAL PROCEDURE StatusOnAfterValidate@19072689();
    BEGIN
      SetEditable;
    END;

    LOCAL PROCEDURE FileFormatOnAfterValidate@19065317();
    BEGIN
      EnableFields;
      SetFileFormatToLines;
      CurrPage.Lines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE HeadersOnAfterValidate@19010236();
    BEGIN
      EnableFields;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      EnableFields;

      SetFileFormatToLines;

      SetEditable;
    END;

    LOCAL PROCEDURE LocationOnAfterInput@19074197(VAR Text@19074198 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFolder(Text);
    END;

    LOCAL PROCEDURE ProcessedLocationOnAfterInput@19066889(VAR Text@19066890 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFolder(Text);
    END;

    LOCAL PROCEDURE LogLocationOnAfterInput@19076406(VAR Text@19076407 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFolder(Text);
    END;

    LOCAL PROCEDURE ErrorLocationOnAfterInput@19032366(VAR Text@19032367 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFolder(Text);
    END;

    LOCAL PROCEDURE MainTableNoOnAfterInput@19047063(VAR Text@19047064 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE SubTableNoOnAfterInput@19065603(VAR Text@19065604 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE RunCodeunitNoOnAfterInput@19017510(VAR Text@19017511 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputObjectNo(5, Text);
    END;

    LOCAL PROCEDURE MainTableNoOnFormat@19079044(Text@19015475 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Main Table No.");
    END;

    LOCAL PROCEDURE SubTableNoOnFormat@19052089(Text@19075565 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Sub Table No.");
    END;

    LOCAL PROCEDURE RunCodeunitNoOnFormat@19054474(Text@19073072 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatObjectNo(5, Text, "Run Codeunit No.");
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117074 CI - Fixed Width Imp. Subform
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Fixed Width Imp. Subform;
               NLD=Fixed Wisth Importdefinitiesubform];
    SourceTable=Table11148592;
    SourceTableView=SORTING(Import Definition,Line No.);
    PageType=ListPart;
    OnInit=BEGIN
             "New RecordEditable" := TRUE;
             "Existing RecordEditable" := TRUE;
             "Increment MethodEditable" := TRUE;
             LinktoTableTagNameEditable := TRUE;
             "Option TypeEditable" := TRUE;
             "Original ValueEditable" := TRUE;
             "Conversion CodeEditable" := TRUE;
             "Field No.Editable" := TRUE;
             "Table No.Editable" := TRUE;
           END;

    OnAfterGetRecord=BEGIN
                       "Option TypeHideValue" := FALSE;
                       "New RecordHideValue" := FALSE;
                       "Existing RecordHideValue" := FALSE;
                       "Tag NameIndent" := 0;
                       OnAfterGetCurrRecord;
                       TagNameOnFormat;
                       TableNoOnFormat(FORMAT("Table No."));
                       FieldNoOnFormat(FORMAT("Field No."));
                       ExistingRecordOnFormat;
                       NewRecordOnFormat;
                       OptionTypeOnFormat;
                     END;

    OnNewRecord=BEGIN
                  SetupNewLine(xRec, BelowxRec);
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1904677404;1 ;ActionGroup;
                      CaptionML=[ENU=&Import Def.;
                                 NLD=&Importdef.] }
      { 1903294104;2 ;Action    ;
                      ShortCutKey=Ctrl+L;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Link &Tables;
                                 NLD=Tabellen linken];
                      OnAction=BEGIN
                                 LinkTables;
                               END;
                                }
      { 1906522404;2 ;Action    ;
                      ShortCutKey=Ctrl+R;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Restrictions;
                                 NLD=Restricties];
                      OnAction=BEGIN
                                 _OpenRestrictions;
                               END;
                                }
      { 1000000007;1 ;Separator  }
      { 1000000006;1 ;Action    ;
                      Name=<Action1000000000>;
                      ShortCutKey=Shift+Ctrl+R;
                      CaptionML=[ENU=Right;
                                 NLD=Rechts];
                      Promoted=Yes;
                      OnAction=BEGIN
                                 Right;
                               END;
                                }
      { 1000000005;1 ;Action    ;
                      Name=<Action1000000001>;
                      ShortCutKey=Shift+Ctrl+L;
                      CaptionML=[ENU=Left;
                                 NLD=Links];
                      OnAction=BEGIN
                                 Left;
                               END;
                                }
      { 1000000003;1 ;Action    ;
                      Name=<Action1000000002>;
                      ShortCutKey=Shift+Ctrl+U;
                      CaptionML=[ENU=Up;
                                 NLD=Omhoog];
                      OnAction=BEGIN
                                 Up;
                               END;
                                }
      { 1000000001;1 ;Action    ;
                      Name=<Action1000000003>;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Down;
                                 NLD=Omlaag];
                      OnAction=BEGIN
                                 Down;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                IndentationColumnName="Tag NameIndent";
                IndentationControls=Tag Name;
                GroupType=Repeater }

    { 1000011;2;Field     ;
                SourceExpr="Tag Name" }

    { 1000001;2;Field     ;
                SourceExpr=Type;
                ValuesAllowed=[Table;Value;Const;Variable;Skip];
                OnValidate=BEGIN
                             TypeOnAfterValidate;
                           END;
                            }

    { 1000031;2;Field     ;
                SourceExpr=Code }

    { 1100531000;2;Field  ;
                SourceExpr="No. of Functions" }

    { 1000005;2;Field     ;
                SourceExpr="Table No.";
                Editable="Table No.Editable";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           // IDYN EBK >>>>
                           IF Mgt.LookupTableNo(Text) THEN BEGIN
                             EVALUATE("Table No.",Text);
                             VALIDATE("Table No.");
                           END;
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //EXIT(Mgt.LookupTableNo(Text));
                           // IDYN EBK <<<<
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.AssistTableNo("Table No.");
                             END;
                              }

    { 1000000012;2;Field  ;
                Name=Table Name;
                SourceExpr="Table Name" }

    { 1000009;2;Field     ;
                SourceExpr="Field No.";
                Editable="Field No.Editable";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           // IDYN EBK >>>>
                           IF Mgt.LookupFieldNo("Table No.",Text,TRUE) THEN BEGIN
                             EVALUATE("Field No.",Text);
                             VALIDATE("Field No.");
                           END;
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //EXIT(Mgt.LookupFieldNo("Table No.", Text, TRUE));
                           // IDYN EBK <<<<
                         END;
                          }

    { 1000000013;2;Field  ;
                Name=Field Name;
                SourceExpr="Field Name" }

    { 1000037;2;Field     ;
                SourceExpr=Identifier }

    { 1000019;2;Field     ;
                SourceExpr=Width }

    { 1000029;2;Field     ;
                SourceExpr="Original Value";
                Visible=FALSE;
                Editable="Original ValueEditable" }

    { 1000023;2;Field     ;
                SourceExpr="Link to Table (Tag Name)";
                Editable=LinktoTableTagNameEditable;
                OnAssistEdit=BEGIN
                               SetupLinkToTable;
                             END;
                              }

    { 1000041;2;Field     ;
                SourceExpr="Existing Record";
                Editable="Existing RecordEditable";
                HideValue="Existing RecordHideValue" }

    { 1000000004;2;Field  ;
                SourceExpr="Error No. Existing Record";
                Visible=FALSE }

    { 1000043;2;Field     ;
                SourceExpr="New Record";
                Editable="New RecordEditable";
                HideValue="New RecordHideValue" }

    { 1000000002;2;Field  ;
                SourceExpr="Error No. New Record";
                Visible=FALSE }

    { 1000035;2;Field     ;
                SourceExpr="No. of Restrictions" }

    { 1000007;2;Field     ;
                SourceExpr="Increment Method";
                Visible=FALSE;
                Editable="Increment MethodEditable" }

    { 1000021;2;Field     ;
                SourceExpr="Conversion Code";
                Editable="Conversion CodeEditable" }

    { 1000027;2;Field     ;
                SourceExpr="Dest. Variable";
                Visible=FALSE }

    { 1000015;2;Field     ;
                SourceExpr="Validate Field";
                Visible=FALSE }

    { 1000013;2;Field     ;
                SourceExpr="Skip If Empty";
                Visible=FALSE }

    { 1000025;2;Field     ;
                SourceExpr="Save Record";
                Visible=FALSE }

    { 1000017;2;Field     ;
                SourceExpr="Data Format";
                Visible=FALSE }

    { 1000000008;2;Field  ;
                SourceExpr="Custom Date Order";
                Visible=False }

    { 1000000009;2;Field  ;
                SourceExpr="Custom Date Separator";
                Visible=False }

    { 1000033;2;Field     ;
                SourceExpr="Option Type";
                Visible=FALSE;
                Editable="Option TypeEditable";
                HideValue="Option TypeHideValue" }

    { 1000039;2;Field     ;
                SourceExpr=Mandatory;
                Visible=FALSE }

    { 1000000000;2;Field  ;
                SourceExpr="Error No. Field Mandatory";
                Visible=FALSE }

  }
  CODE
  {
    VAR
      FileFormat@1000000 : 'XML,CSV,FixedWidth,Excel';
      "Tag NameIndent"@19056250 : Integer INDATASET;
      "Existing RecordHideValue"@19025366 : Boolean INDATASET;
      "New RecordHideValue"@19012537 : Boolean INDATASET;
      "Option TypeHideValue"@19002310 : Boolean INDATASET;
      "Table No.Editable"@19076806 : Boolean INDATASET;
      "Field No.Editable"@19022826 : Boolean INDATASET;
      "Conversion CodeEditable"@19074872 : Boolean INDATASET;
      "Original ValueEditable"@19060489 : Boolean INDATASET;
      "Option TypeEditable"@19019138 : Boolean INDATASET;
      LinktoTableTagNameEditable@19004008 : Boolean INDATASET;
      "Increment MethodEditable"@19041957 : Boolean INDATASET;
      "Existing RecordEditable"@19014716 : Boolean INDATASET;
      "New RecordEditable"@19061505 : Boolean INDATASET;

    PROCEDURE Left@1000000();
    VAR
      ImportDefinitionLine@1100512000 : Record 11148592;
    BEGIN
      CurrPage.SETSELECTIONFILTER(ImportDefinitionLine);
      IF ImportDefinitionLine.FINDSET THEN
        REPEAT
          IF ImportDefinitionLine."Entry No." <> 0 THEN
            IF ImportDefinitionLine.Indent > 0 THEN BEGIN
              ImportDefinitionLine.Indent -= 1;
              ImportDefinitionLine.MODIFY;
            END;
        UNTIL ImportDefinitionLine.NEXT = 0;
    END;

    PROCEDURE Right@1000001();
    VAR
      ImportDefinitionLine@1100512000 : Record 11148592;
    BEGIN
      CurrPage.SETSELECTIONFILTER(ImportDefinitionLine);
      IF ImportDefinitionLine.FINDSET THEN
        REPEAT
          IF ImportDefinitionLine."Entry No." <> 0 THEN BEGIN
            ImportDefinitionLine.Indent += 1;
            ImportDefinitionLine.MODIFY;
          END;
        UNTIL ImportDefinitionLine.NEXT = 0;
    END;

    PROCEDURE Up@1000004();
    VAR
      CurrLine@1000004 : Record 11148592;
      ImportDefinitionLine@1000000 : Record 11148592;
      SelectedLine@1000002 : Record 11148592;
      LineNo@1000001 : Integer;
    BEGIN
      CurrLine := Rec;

      CurrPage.SETSELECTIONFILTER(SelectedLine);
      IF SelectedLine.COUNT = 0 THEN BEGIN
        SelectedLine.RESET;
        SelectedLine := Rec;
        SelectedLine.SETRECFILTER;
      END;

      IF SelectedLine.FINDSET THEN
        REPEAT
          ImportDefinitionLine.SETCURRENTKEY("Import Definition", "Line No.");
          ImportDefinitionLine.SETRANGE("Import Definition", "Import Definition");
          ImportDefinitionLine := SelectedLine;
          IF ImportDefinitionLine.NEXT(-1) <> 0 THEN BEGIN
            LineNo := ImportDefinitionLine."Line No.";
            ImportDefinitionLine."Line No." := SelectedLine."Line No.";
            ImportDefinitionLine.MODIFY;
            SelectedLine."Line No." := LineNo;
            SelectedLine.MODIFY;
          END;
        UNTIL SelectedLine.NEXT = 0;

      GET(CurrLine."Import Definition", CurrLine."Entry No.");
    END;

    PROCEDURE Down@1000005();
    VAR
      CurrLine@1000001 : Record 11148592;
      ImportDefinitionLine@1000003 : Record 11148592;
      SelectedLine@1000002 : Record 11148592;
      LineNo@1000000 : Integer;
    BEGIN
      CurrLine := Rec;

      CurrPage.SETSELECTIONFILTER(SelectedLine);
      IF SelectedLine.COUNT = 0 THEN BEGIN
        SelectedLine.RESET;
        SelectedLine := Rec;
        SelectedLine.SETRECFILTER;
      END;

      IF SelectedLine.FINDLAST THEN
        REPEAT
          ImportDefinitionLine.SETCURRENTKEY("Import Definition", "Line No.");
          ImportDefinitionLine.SETRANGE("Import Definition", "Import Definition");
          ImportDefinitionLine := SelectedLine;
          IF ImportDefinitionLine.NEXT(1) <> 0 THEN BEGIN
            LineNo := ImportDefinitionLine."Line No.";
            ImportDefinitionLine."Line No." := SelectedLine."Line No.";
            ImportDefinitionLine.MODIFY;
            SelectedLine."Line No." := LineNo;
            SelectedLine.MODIFY;
          END;
        UNTIL SelectedLine.NEXT(-1) = 0;

      GET(CurrLine."Import Definition", CurrLine."Entry No.");
    END;

    PROCEDURE LinkTables@1000002();
    BEGIN
      SetupLinkToTable;
    END;

    PROCEDURE UpdateForm@1000003();
    BEGIN
      CurrPage.UPDATE(FALSE);
    END;

    PROCEDURE _OpenRestrictions@19068975();
    BEGIN
      OpenRestrictions;
    END;

    PROCEDURE OpenRestrictions@1000006();
    BEGIN
      OpenRestrictions;
    END;

    PROCEDURE SetFileFormat@1000008(NewValue@1000000 : Option);
    BEGIN
      FileFormat := NewValue;
    END;

    LOCAL PROCEDURE SetFieldsEditable@1000009();
    BEGIN
      "Table No.Editable" := (Type IN [Type::Table, Type::Value, Type::Const, Type::Variable, Type::Skip]);
      "Field No.Editable" := (Type IN [Type::Value, Type::Const, Type::Variable, Type::Skip]);
      "Conversion CodeEditable" := (Type IN [Type::Value, Type::Const, Type::Variable]);
      "Original ValueEditable" := (Type IN [Type::Value, Type::Const, Type::Variable]);
      "Option TypeEditable" := (Type IN [Type::Value, Type::Const, Type::Variable]);
      LinktoTableTagNameEditable := (Type = Type::Table);
      "Increment MethodEditable" := (Type IN [Type::Value, Type::Const, Type::Variable]);
      "Existing RecordEditable" := (Type = Type::Table);
      "New RecordEditable" := (Type = Type::Table);
    END;

    LOCAL PROCEDURE TypeOnAfterValidate@19069045();
    BEGIN
      SetFieldsEditable;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      SetFieldsEditable;
    END;

    LOCAL PROCEDURE TableNoOnAfterInput@19060375(VAR Text@19060376 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE FieldNoOnAfterInput@19063566(VAR Text@19063567 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFieldNo(Text, "Table No.", TRUE);
    END;

    LOCAL PROCEDURE TagNameOnFormat@19023679();
    BEGIN
      "Tag NameIndent" := Indent;
    END;

    LOCAL PROCEDURE TableNoOnFormat@19071785(Text@19016339 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Table No.");
    END;

    LOCAL PROCEDURE FieldNoOnFormat@19075355(Text@19041114 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatFieldNo(Text, "Table No.", "Field No.");
    END;

    LOCAL PROCEDURE ExistingRecordOnFormat@19009624();
    BEGIN
      IF FileFormat = FileFormat::XML THEN BEGIN
        IF Type <> Type::Table THEN
          "Existing RecordHideValue" := TRUE;
      END ELSE
        IF NOT (Type IN [Type::Table, Type::Value]) THEN
          "Existing RecordHideValue" := TRUE;
    END;

    LOCAL PROCEDURE NewRecordOnFormat@19036900();
    BEGIN
      IF FileFormat = FileFormat::XML THEN BEGIN
        IF Type <> Type::Table THEN
          "New RecordHideValue" := TRUE;
      END ELSE
        IF NOT (Type IN [Type::Table, Type::Value]) THEN
          "New RecordHideValue" := TRUE;
    END;

    LOCAL PROCEDURE OptionTypeOnFormat@19077341();
    BEGIN
      IF NOT (Type IN [Type::Value, Type::Const, Type::Variable, Type::Skip]) THEN
        "Option TypeHideValue" := TRUE;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117075 CI - Excel Import Card
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Excel Import Card;
               NLD=Excel Importdefinitie];
    SourceTable=Table11148591;
    SourceTableView=WHERE(File Format=CONST(Excel));
    PageType=Card;
    OnInit=BEGIN
             RightEnable := TRUE;
             LeftEnable := TRUE;
             "Archive add YYYYMMDDEnable" := TRUE;
             "Sub Table No. of FieldsEnable" := TRUE;
             "Sub Table No.Enable" := TRUE;
             ErrorNotificIncludeFileEnable := TRUE;
             "Save to MessagesEnable" := TRUE;
             "Error LocationEnable" := TRUE;
             "Log LocationEnable" := TRUE;
             "Processed LocationEnable" := TRUE;
             FilenameEnable := TRUE;
             LocationEnable := TRUE;
             "Run TaskEditable" := TRUE;
             "Monitor ModificationsEditable" := TRUE;
             "Archive add YYYYMMDDEditable" := TRUE;
             LinesEditable := TRUE;
             "Project CodeEditable" := TRUE;
             ErrorNotificIncludeFileEditabl := TRUE;
             ErrorNotificEMailAddressEditab := TRUE;
             "Sub Table No.Editable" := TRUE;
             "Main Table No.Editable" := TRUE;
             "Company NameEditable" := TRUE;
             "Run Codeunit No.Editable" := TRUE;
             "Save to MessagesEditable" := TRUE;
             HeadersEditable := TRUE;
             "Log LocationEditable" := TRUE;
             "Processed LocationEditable" := TRUE;
             "File FormatEditable" := TRUE;
             FilenameEditable := TRUE;
             "Error LocationEditable" := TRUE;
             LocationEditable := TRUE;
             DescriptionEditable := TRUE;
             CodeEditable := TRUE;
           END;

    OnOpenPage=VAR
                 Initialize@1000001 : Codeunit 11148625;
               BEGIN
                 Initialize.CheckInitialize;
               END;

    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                       MainTableNoOnFormat(FORMAT("Main Table No."));
                       SubTableNoOnFormat(FORMAT("Sub Table No."));
                       RunCodeunitNoOnFormat(FORMAT("Run Codeunit No."));
                     END;

    OnNewRecord=VAR
                  Setup@1000000 : Record 11148589;
                BEGIN
                  Setup.GET;
                  VALIDATE(Location, Setup."Default Import Location");

                  "File Format" := "File Format"::Excel;
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000049 ;1   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Process;
                                 NLD=Verwerken];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Setup@1100512001 : Record 11148589;
                                 ProcessImportDef@1000001 : Codeunit 11148592;
                                 Progressbar@1000002 : Codeunit 11148624;
                                 ErrorMgt@1000006 : Codeunit 11148630;
                                 FileImported@1000003 : Boolean;
                                 ctImportCancelled@1000004 : TextConst 'ENU=Import cancelled.;NLD=Importeren afgebroken.';
                               BEGIN
                                 ErrorMgt.ClearError;

                                 Progressbar.Open(2);

                                 Setup.GET;
                                 IF Setup."Use Error Handling" THEN
                                   FileImported := ProcessImportDef.RUN(Rec)
                                 ELSE BEGIN
                                   ProcessImportDef.RUN(Rec);
                                   FileImported := TRUE;
                                 END;

                                 Progressbar.Close;

                                 IF NOT FileImported THEN
                                   IF ErrorMgt.GetError = '' THEN
                                     MESSAGE(ctImportCancelled)
                                   ELSE
                                     MESSAGE(ErrorMgt.GetError);
                               END;
                                }
      { 1000000002;1 ;Action    ;
                      CaptionML=[ENU=Copy;
                                 NLD=Kopiren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Copy;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Copy;
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1000000001;1 ;Action    ;
                      Name=<Action1000000000>;
                      CaptionML=[ENU=Copy To;
                                 NLD=Kopiren naar];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Copy;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CopyTo;
                               END;
                                }
      { 1000000003;1 ;ActionGroup;
                      CaptionML=[ENU=Move;
                                 NLD=Verplaatsen] }
      { 1000050 ;2   ;Action    ;
                      Name=Left;
                      Promoted=Yes;
                      Enabled=LeftEnable;
                      PromotedIsBig=Yes;
                      Image=PreviousSet;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+L');
                               END;
                                }
      { 1000048 ;2   ;Action    ;
                      Name=Right;
                      Promoted=Yes;
                      Enabled=RightEnable;
                      PromotedIsBig=Yes;
                      Image=NextSet;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+R');
                               END;
                                }
      { 1000047 ;2   ;Action    ;
                      Name=<Action1000047>;
                      CaptionML=[ENU=Up;
                                 NLD=Omhoog];
                      Promoted=Yes;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+U');
                               END;
                                }
      { 1000028 ;2   ;Action    ;
                      Name=<Action1000028>;
                      CaptionML=[ENU=Down;
                                 NLD=Omlaag];
                      Promoted=Yes;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+D');
                               END;
                                }
      { 1000000000;1 ;ActionGroup;
                      CaptionML=[ENU=Messages and History;
                                 NLD=Berichten en historie] }
      { 1000063 ;2   ;Action    ;
                      ShortCutKey=Ctrl+F5;
                      CaptionML=[ENU=Messages;
                                 NLD=Berichten];
                      RunObject=Page 11117032;
                      RunPageView=SORTING(Type,Code);
                      RunPageLink=Type=CONST(Import),
                                  Code=FIELD(Code);
                      Promoted=Yes;
                      Image=Note;
                      PromotedCategory=Process }
      { 1000062 ;2   ;Action    ;
                      CaptionML=[ENU=History;
                                 NLD=Historie];
                      RunObject=Page 11117034;
                      RunPageView=SORTING(Type,Code)
                                  WHERE(Type=CONST(Import));
                      RunPageLink=Code=FIELD(Code);
                      Image=History }
      { 1000009 ;2   ;Action    ;
                      CaptionML=[ENU=Message Hist. &Comments;
                                 NLD=Bericht hist. op&merkingen];
                      RunObject=Page 11117035;
                      RunPageView=SORTING(Type,Code);
                      RunPageLink=Type=CONST(Import),
                                  Code=FIELD(Code) }
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000016 ;1   ;ActionGroup;
                      CaptionML=[ENU=&Import Def.;
                                 NLD=&Importdef.] }
      { 1000029 ;2   ;Separator  }
      { 1100531001;2 ;Action    ;
                      ShortCutKey=Ctrl+Alt+V;
                      CaptionML=[ENU=Versions;
                                 NLD=Versies];
                      RunObject=Page 11117095;
                      RunPageView=SORTING(Code,Version No.);
                      RunPageLink=Code=FIELD(Code) }
      { 1100531000;2 ;Action    ;
                      ShortCutKey=Ctrl+S;
                      CaptionML=[ENU=Save as New Version;
                                 NLD=Op&slaan als nieuwe versie];
                      OnAction=BEGIN
                                 SaveNewVersion;
                               END;
                                }
      { 1100531004;2 ;Separator  }
      { 1000021 ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NLD=F&uncties] }
      { 1000040 ;2   ;Action    ;
                      CaptionML=[ENU=Renumber Lines;
                                 NLD=Regels hernummeren];
                      OnAction=BEGIN
                                 RenumberLines;
                               END;
                                }
      { 1000045 ;2   ;Action    ;
                      CaptionML=[ENU=Reversed Data &Mapping;
                                 NLD=Reversed data&mapping];
                      OnAction=BEGIN
                                 ReversedDataMapping;
                               END;
                                }
      { 1000086 ;2   ;Separator  }
      { 1000071 ;2   ;Action    ;
                      CaptionML=[ENU=Pri&nt;
                                 NLD=Afdrukken];
                      OnAction=VAR
                                 ImportDefinition@1000000 : Record 11148591;
                               BEGIN
                                 ImportDefinition := Rec;
                                 ImportDefinition.SETRECFILTER;
                                 REPORT.RUN(REPORT::"CI - Import Definitions", TRUE, FALSE, ImportDefinition);
                               END;
                                }
      { 1000088 ;2   ;Separator  }
      { 1000087 ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Import Definition from XML;
                                 NLD=XML-Definitie &importeren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Import;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ImportXMLDefinition@1000000 : Codeunit 11148636;
                               BEGIN
                                 ImportXMLDefinition.ImportImportDefinition(Rec);
                               END;
                                }
      { 1000083 ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Export Definition to &XML;
                                 NLD=Definitie exporteren naar &XML];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Export;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ExportDefinitionToXML@1000000 : Codeunit 11148634;
                               BEGIN
                                 ExportDefinitionToXML.ExportImportDefinition(Rec);
                               END;
                                }
      { 1000070 ;2   ;Separator  }
      { 1000075 ;2   ;Action    ;
                      CaptionML=[ENU=Test File;
                                 NLD=Bestand controleren];
                      OnAction=BEGIN
                                 TestFile;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                CaptionML=[ENU=General;
                           NLD=Algemeen] }

    { 1000001;2;Field     ;
                SourceExpr=Code;
                Editable=CodeEditable }

    { 1000003;2;Field     ;
                SourceExpr=Description;
                Editable=DescriptionEditable }

    { 1000005;2;Field     ;
                SourceExpr=Location;
                Enabled=LocationEnable;
                Editable=LocationEditable;
                OnLookup=VAR
                           Mgt@1000001 : Codeunit 11148589;
                           NewFolder@1000000 : Text[1024];
                         BEGIN
                           NewFolder := Mgt.BrowseForFolder('', '');
                           IF NewFolder <> '' THEN
                             VALIDATE(Location, NewFolder);
                         END;

                OnAssistEdit=VAR
                               Mgt@1000002 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder(Location);
                             END;
                              }

    { 1000014;2;Field     ;
                SourceExpr=Filename;
                Enabled=FilenameEnable;
                Editable=FilenameEditable }

    { 1000035;2;Field     ;
                SourceExpr="Processed Location";
                Enabled="Processed LocationEnable";
                Editable="Processed LocationEditable";
                OnLookup=VAR
                           Mgt@1000001 : Codeunit 11148589;
                           NewFolder@1000000 : Text[1024];
                         BEGIN
                           NewFolder := Mgt.BrowseForFolder('', '');
                           IF NewFolder <> '' THEN
                             "Processed Location" := NewFolder;
                         END;

                OnAssistEdit=VAR
                               Mgt@1000001 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder("Processed Location");
                             END;
                              }

    { 1000037;2;Field     ;
                SourceExpr="Log Location";
                Enabled="Log LocationEnable";
                Editable="Log LocationEditable";
                OnLookup=VAR
                           Mgt@1000001 : Codeunit 11148589;
                           NewFolder@1000000 : Text[1024];
                         BEGIN
                           NewFolder := Mgt.BrowseForFolder('', '');
                           IF NewFolder <> '' THEN
                             "Log Location" := NewFolder;
                         END;

                OnAssistEdit=VAR
                               Mgt@1000001 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder("Log Location");
                             END;
                              }

    { 1000084;2;Field     ;
                SourceExpr="Error Location";
                Enabled="Error LocationEnable";
                Editable="Error LocationEditable";
                OnLookup=VAR
                           Mgt@1000001 : Codeunit 11148589;
                           NewFolder@1000000 : Text[1024];
                         BEGIN
                           NewFolder := Mgt.BrowseForFolder('', '');
                           IF NewFolder <> '' THEN
                             "Error Location" := NewFolder;
                         END;

                OnAssistEdit=VAR
                               Mgt@1000001 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder("Error Location");
                             END;
                              }

    { 1000011;2;Field     ;
                SourceExpr=Status;
                ValuesAllowed=[Edit;Manual;Automated;Blocked];
                OnValidate=BEGIN
                             StatusOnAfterValidate;
                           END;
                            }

    { 1000053;2;Field     ;
                SourceExpr="Save to Messages";
                Enabled="Save to MessagesEnable";
                Editable="Save to MessagesEditable" }

    { 1000024;1;Part      ;
                Name=Lines;
                SubPageLink=Import Definition=FIELD(Code);
                PagePartID=Page11117076;
                Editable=LinesEditable }

    { 1905328801;1;Group  ;
                CaptionML=[ENU=Field Selection;
                           NLD=Veldselectie] }

    { 1000010;2;Field     ;
                SourceExpr="Main Table No.";
                Editable="Main Table No.Editable";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           // IDYN EBK >>>>
                           IF Mgt.LookupTableNo(Text) THEN BEGIN
                             EVALUATE("Main Table No.",Text);
                             VALIDATE("Main Table No.");
                           END;
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //EXIT(Mgt.LookupTableNo(Text));
                           // IDYN EBK <<<<
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.AssistTableNo("Main Table No.");
                             END;
                              }

    { 1000031;2;Field     ;
                DrillDown=No;
                SourceExpr="Main Table No. of Fields";
                OnAssistEdit=VAR
                               TmpFld@1000000 : TEMPORARY Record 2000000041;
                               SelectFields@1000001 : Page 11148589;
                             BEGIN
                               TESTFIELD("Main Table No.");
                               SelectFields.SetImportDefinition(TRUE, Rec);
                               SelectFields.SetFormBlocked(Status <> Status::Edit);

                               IF SelectFields.RUNMODAL = ACTION::OK THEN BEGIN
                                 SelectFields.GetSelectedFields(TmpFld);
                                 UpdateTableFields(TRUE, "Main Table No.", TmpFld);
                                 CurrPage.UPDATE(TRUE);
                               END;
                             END;
                              }

    { 1000025;2;Field     ;
                SourceExpr="Sub Table No.";
                Enabled="Sub Table No.Enable";
                Editable="Sub Table No.Editable";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           IF Mgt.LookupTableNo(Text) THEN BEGIN
                             EVALUATE("Sub Table No.",Text);
                             VALIDATE("Sub Table No.");
                           END;

                           // IDYN EBK >>>>
                           //Mgt.LookupRelatedTableNo("Main Table No.",Text);
                           //EVALUATE("Sub Table No.",Text);
                           //VALIDATE("Sub Table No.");
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //EXIT(Mgt.LookupRelatedTableNo("Main Table No.", Text));
                           // IDYN EBK <<<<
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.AssistTableNo("Sub Table No.");
                             END;
                              }

    { 1000033;2;Field     ;
                DrillDown=No;
                SourceExpr="Sub Table No. of Fields";
                Enabled="Sub Table No. of FieldsEnable";
                OnAssistEdit=VAR
                               TmpFld@1000000 : TEMPORARY Record 2000000041;
                               SelectFields@1000001 : Page 11148589;
                             BEGIN
                               TESTFIELD("Sub Table No.");
                               SelectFields.SetImportDefinition(FALSE, Rec);
                               SelectFields.SetFormBlocked(Status <> Status::Edit);
                               IF SelectFields.RUNMODAL = ACTION::OK THEN BEGIN
                                 SelectFields.GetSelectedFields(TmpFld);
                                 UpdateTableFields(FALSE, "Sub Table No.", TmpFld);
                                 CurrPage.UPDATE(TRUE);
                               END;
                             END;
                              }

    { 1903121901;1;Group  ;
                CaptionML=[ENU=Options;
                           NLD=Opties] }

    { 1000078;2;Field     ;
                SourceExpr="Project Code";
                Editable="Project CodeEditable" }

    { 1000076;2;Field     ;
                SourceExpr="Company Name";
                Editable="Company NameEditable" }

    { 1000068;2;Field     ;
                SourceExpr="Error Notific. E-Mail Address";
                Editable=ErrorNotificEMailAddressEditab }

    { 1000046;2;Field     ;
                SourceExpr="Error Notific. Include File";
                Enabled=ErrorNotificIncludeFileEnable;
                Editable=ErrorNotificIncludeFileEditabl }

    { 1000041;2;Field     ;
                SourceExpr="Monitor Modifications";
                Editable="Monitor ModificationsEditable" }

    { 1000043;2;Field     ;
                SourceExpr="Run Task";
                Editable="Run TaskEditable" }

    { 1100512000;2;Field  ;
                SourceExpr="Run Codeunit No.";
                Visible=FALSE;
                Editable="Run Codeunit No.Editable";
                OnLookup=VAR
                           Mgt@1100512000 : Codeunit 11148589;
                         BEGIN
                           EXIT(Mgt.LookupObjectNo(5, Text));
                         END;
                          }

    { 1000023;2;Field     ;
                SourceExpr=Headers;
                Enabled=HeadersEnable;
                Editable=HeadersEditable;
                OnValidate=BEGIN
                             HeadersOnAfterValidate;
                           END;
                            }

    { 1000022;2;Field     ;
                SourceExpr="Archive add YYYYMMDD";
                Enabled="Archive add YYYYMMDDEnable";
                Editable="Archive add YYYYMMDDEditable" }

  }
  CODE
  {
    VAR
      INMgt@1000000001 : Codeunit 11148589;
      CodeEditable@19001698 : Boolean INDATASET;
      DescriptionEditable@19061412 : Boolean INDATASET;
      LocationEditable@19035910 : Boolean INDATASET;
      "Error LocationEditable"@19032989 : Boolean INDATASET;
      FilenameEditable@19007928 : Boolean INDATASET;
      "File FormatEditable"@19047526 : Boolean INDATASET;
      "Processed LocationEditable"@19079254 : Boolean INDATASET;
      "Log LocationEditable"@19072655 : Boolean INDATASET;
      HeadersEditable@19062436 : Boolean INDATASET;
      "Save to MessagesEditable"@19046008 : Boolean INDATASET;
      "Run Codeunit No.Editable"@19055664 : Boolean INDATASET;
      "Company NameEditable"@19027413 : Boolean INDATASET;
      "Main Table No.Editable"@19066361 : Boolean INDATASET;
      "Sub Table No.Editable"@19054278 : Boolean INDATASET;
      ErrorNotificEMailAddressEditab@19034665 : Boolean INDATASET;
      ErrorNotificIncludeFileEditabl@19002766 : Boolean INDATASET;
      "Project CodeEditable"@19062497 : Boolean INDATASET;
      LinesEditable@19010511 : Boolean INDATASET;
      "Archive add YYYYMMDDEditable"@19050215 : Boolean INDATASET;
      "Monitor ModificationsEditable"@19075968 : Boolean INDATASET;
      "Run TaskEditable"@19005185 : Boolean INDATASET;
      LocationEnable@19013618 : Boolean INDATASET;
      FilenameEnable@19043700 : Boolean INDATASET;
      "Processed LocationEnable"@19043375 : Boolean INDATASET;
      "Log LocationEnable"@19050707 : Boolean INDATASET;
      "Error LocationEnable"@19002018 : Boolean INDATASET;
      "Save to MessagesEnable"@19010110 : Boolean INDATASET;
      ErrorNotificIncludeFileEnable@19047165 : Boolean INDATASET;
      "Sub Table No.Enable"@19033464 : Boolean INDATASET;
      "Sub Table No. of FieldsEnable"@19016380 : Boolean INDATASET;
      "Archive add YYYYMMDDEnable"@19000830 : Boolean INDATASET;
      LeftEnable@19065291 : Boolean INDATASET;
      RightEnable@19037326 : Boolean INDATASET;
      HeadersEnable@1000000000 : Boolean INDATASET;

    LOCAL PROCEDURE EnableFields@1000000();
    BEGIN
      LocationEnable := "File Format" <> "File Format"::ADO;
      FilenameEnable := "File Format" <> "File Format"::ADO;
      "Processed LocationEnable" := "File Format" <> "File Format"::ADO;
      "Log LocationEnable" := "File Format" <> "File Format"::ADO;
      "Error LocationEnable" := "File Format" <> "File Format"::ADO;
      "Save to MessagesEnable" := "File Format" <> "File Format"::ADO;
      ErrorNotificIncludeFileEnable := "File Format" <> "File Format"::ADO;

      "Sub Table No.Enable" := "File Format" <> "File Format"::ADO;
      "Sub Table No. of FieldsEnable" := "File Format" <> "File Format"::ADO;

      HeadersEnable := "File Format" IN ["File Format"::CSV, "File Format"::"Fixed Width", "File Format"::Excel];

      "Archive add YYYYMMDDEnable" := "File Format" <> "File Format"::ADO;

      LeftEnable := "File Format" <> "File Format"::ADO;
      RightEnable := "File Format" <> "File Format"::ADO;
    END;

    LOCAL PROCEDURE SetFileFormatToLines@1000002();
    BEGIN
      CurrPage.Lines.PAGE.SetFileFormat("File Format");
    END;

    LOCAL PROCEDURE SetEditable@1000003();
    BEGIN
      CodeEditable := (Status = Status::Edit);
      DescriptionEditable := (Status = Status::Edit);
      LocationEditable := (Status = Status::Edit);
      "Error LocationEditable" := (Status = Status::Edit);
      FilenameEditable := (Status = Status::Edit);
      "File FormatEditable" := (Status = Status::Edit);
      "Processed LocationEditable" := (Status = Status::Edit);
      "Log LocationEditable" := (Status = Status::Edit);
      HeadersEditable := (Status = Status::Edit);
      "Save to MessagesEditable" := (Status = Status::Edit);
      "Run Codeunit No.Editable" := (Status = Status::Edit);
      "Company NameEditable" := (Status = Status::Edit);
      "Main Table No.Editable" := (Status = Status::Edit);
      "Sub Table No.Editable" := (Status = Status::Edit);
      ErrorNotificEMailAddressEditab := (Status = Status::Edit);
      ErrorNotificIncludeFileEditabl := (Status = Status::Edit);
      "Project CodeEditable" := (Status = Status::Edit);
      LinesEditable := (Status = Status::Edit);
      "Archive add YYYYMMDDEditable" := (Status = Status::Edit);
      "Monitor ModificationsEditable" := (Status = Status::Edit);
      "Run TaskEditable" := (Status = Status::Edit);
    END;

    LOCAL PROCEDURE StatusOnAfterValidate@19072689();
    BEGIN
      SetEditable;
    END;

    LOCAL PROCEDURE FileFormatOnAfterValidate@19065317();
    BEGIN
      EnableFields;
      SetFileFormatToLines;
      CurrPage.Lines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE HeadersOnAfterValidate@19010236();
    BEGIN
      EnableFields;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      EnableFields;

      SetFileFormatToLines;

      SetEditable;
    END;

    LOCAL PROCEDURE LocationOnAfterInput@19074197(VAR Text@19074198 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFolder(Text);
    END;

    LOCAL PROCEDURE ProcessedLocationOnAfterInput@19066889(VAR Text@19066890 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFolder(Text);
    END;

    LOCAL PROCEDURE LogLocationOnAfterInput@19076406(VAR Text@19076407 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFolder(Text);
    END;

    LOCAL PROCEDURE ErrorLocationOnAfterInput@19032366(VAR Text@19032367 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFolder(Text);
    END;

    LOCAL PROCEDURE MainTableNoOnAfterInput@19047063(VAR Text@19047064 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE SubTableNoOnAfterInput@19065603(VAR Text@19065604 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE RunCodeunitNoOnAfterInput@19017510(VAR Text@19017511 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputObjectNo(5, Text);
    END;

    LOCAL PROCEDURE MainTableNoOnFormat@19079044(Text@19015475 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Main Table No.");
    END;

    LOCAL PROCEDURE SubTableNoOnFormat@19052089(Text@19075565 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Sub Table No.");
    END;

    LOCAL PROCEDURE RunCodeunitNoOnFormat@19054474(Text@19073072 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatObjectNo(5, Text, "Run Codeunit No.");
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117076 CI - Excel Import Subform
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Excel Import Subform;
               NLD=Excel Importdefinitiesubform];
    SourceTable=Table11148592;
    SourceTableView=SORTING(Import Definition,Line No.);
    PageType=ListPart;
    OnInit=BEGIN
             "New RecordEditable" := TRUE;
             "Existing RecordEditable" := TRUE;
             "Increment MethodEditable" := TRUE;
             LinktoTableTagNameEditable := TRUE;
             "Option TypeEditable" := TRUE;
             "Original ValueEditable" := TRUE;
             "Conversion CodeEditable" := TRUE;
             "Field No.Editable" := TRUE;
             "Table No.Editable" := TRUE;
           END;

    OnAfterGetRecord=BEGIN
                       "Option TypeHideValue" := FALSE;
                       "New RecordHideValue" := FALSE;
                       "Existing RecordHideValue" := FALSE;
                       "Tag NameIndent" := 0;
                       OnAfterGetCurrRecord;
                       TagNameOnFormat;
                       TableNoOnFormat(FORMAT("Table No."));
                       FieldNoOnFormat(FORMAT("Field No."));
                       ExistingRecordOnFormat;
                       NewRecordOnFormat;
                       OptionTypeOnFormat;
                     END;

    OnNewRecord=BEGIN
                  SetupNewLine(xRec, BelowxRec);
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1904677404;1 ;ActionGroup;
                      CaptionML=[ENU=&Import Def.;
                                 NLD=&Importdef.] }
      { 1903294104;2 ;Action    ;
                      ShortCutKey=Ctrl+L;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Link &Tables;
                                 NLD=Tabellen linken];
                      OnAction=BEGIN
                                 LinkTables;
                               END;
                                }
      { 1906522404;2 ;Action    ;
                      ShortCutKey=Ctrl+R;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Restrictions;
                                 NLD=Restricties];
                      OnAction=BEGIN
                                 _OpenRestrictions;
                               END;
                                }
      { 1000000007;1 ;Separator  }
      { 1000000006;1 ;Action    ;
                      Name=<Action1000000000>;
                      ShortCutKey=Shift+Ctrl+R;
                      CaptionML=[ENU=Right;
                                 NLD=Rechts];
                      Promoted=Yes;
                      OnAction=BEGIN
                                 Right;
                               END;
                                }
      { 1000000005;1 ;Action    ;
                      Name=<Action1000000001>;
                      ShortCutKey=Shift+Ctrl+L;
                      CaptionML=[ENU=Left;
                                 NLD=Links];
                      OnAction=BEGIN
                                 Left;
                               END;
                                }
      { 1000000003;1 ;Action    ;
                      Name=<Action1000000002>;
                      ShortCutKey=Shift+Ctrl+U;
                      CaptionML=[ENU=Up;
                                 NLD=Omhoog];
                      OnAction=BEGIN
                                 Up;
                               END;
                                }
      { 1000000001;1 ;Action    ;
                      Name=<Action1000000003>;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Down;
                                 NLD=Omlaag];
                      OnAction=BEGIN
                                 Down;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                IndentationColumnName="Tag NameIndent";
                IndentationControls=Tag Name;
                GroupType=Repeater }

    { 1000011;2;Field     ;
                SourceExpr="Tag Name" }

    { 1000001;2;Field     ;
                SourceExpr=Type;
                ValuesAllowed=[Table;Value;Const;Variable;Skip];
                OnValidate=BEGIN
                             TypeOnAfterValidate;
                           END;
                            }

    { 1000031;2;Field     ;
                SourceExpr=Code }

    { 1100531000;2;Field  ;
                SourceExpr="No. of Functions" }

    { 1000005;2;Field     ;
                SourceExpr="Table No.";
                Editable="Table No.Editable";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           // IDYN EBK >>>>
                           IF Mgt.LookupTableNo(Text) THEN BEGIN
                             EVALUATE("Table No.",Text);
                             VALIDATE("Table No.");
                           END;
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //EXIT(Mgt.LookupTableNo(Text));
                           // IDYN EBK <<<<
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.AssistTableNo("Table No.");
                             END;
                              }

    { 1000000012;2;Field  ;
                Name=Table Name;
                SourceExpr="Table Name" }

    { 1000009;2;Field     ;
                SourceExpr="Field No.";
                Editable="Field No.Editable";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           // IDYN EBK >>>>
                           IF Mgt.LookupFieldNo("Table No.",Text,TRUE) THEN BEGIN
                             EVALUATE("Field No.",Text);
                             VALIDATE("Field No.");
                           END;
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //EXIT(Mgt.LookupFieldNo("Table No.", Text, TRUE));
                           // IDYN EBK <<<<
                         END;
                          }

    { 1000000013;2;Field  ;
                Name=Field Name;
                SourceExpr="Field Name" }

    { 1000037;2;Field     ;
                SourceExpr=Identifier }

    { 1000029;2;Field     ;
                SourceExpr="Original Value";
                Visible=FALSE;
                Editable="Original ValueEditable" }

    { 1000023;2;Field     ;
                SourceExpr="Link to Table (Tag Name)";
                Editable=LinktoTableTagNameEditable;
                OnAssistEdit=BEGIN
                               SetupLinkToTable;
                             END;
                              }

    { 1000041;2;Field     ;
                SourceExpr="Existing Record";
                Editable="Existing RecordEditable";
                HideValue="Existing RecordHideValue" }

    { 1000000004;2;Field  ;
                SourceExpr="Error No. Existing Record";
                Visible=FALSE }

    { 1000043;2;Field     ;
                SourceExpr="New Record";
                Editable="New RecordEditable";
                HideValue="New RecordHideValue" }

    { 1000000002;2;Field  ;
                SourceExpr="Error No. New Record";
                Visible=FALSE }

    { 1000035;2;Field     ;
                SourceExpr="No. of Restrictions" }

    { 1000007;2;Field     ;
                SourceExpr="Increment Method";
                Visible=FALSE;
                Editable="Increment MethodEditable" }

    { 1000021;2;Field     ;
                SourceExpr="Conversion Code";
                Editable="Conversion CodeEditable" }

    { 1000027;2;Field     ;
                SourceExpr="Dest. Variable";
                Visible=FALSE }

    { 1000015;2;Field     ;
                SourceExpr="Validate Field";
                Visible=FALSE }

    { 1000013;2;Field     ;
                SourceExpr="Skip If Empty";
                Visible=FALSE }

    { 1000025;2;Field     ;
                SourceExpr="Save Record";
                Visible=FALSE }

    { 1000017;2;Field     ;
                SourceExpr="Data Format";
                Visible=FALSE }

    { 1000000008;2;Field  ;
                SourceExpr="Custom Date Order";
                Visible=False }

    { 1000000009;2;Field  ;
                SourceExpr="Custom Date Separator";
                Visible=False }

    { 1000033;2;Field     ;
                SourceExpr="Option Type";
                Visible=FALSE;
                Editable="Option TypeEditable";
                HideValue="Option TypeHideValue" }

    { 1000039;2;Field     ;
                SourceExpr=Mandatory;
                Visible=FALSE }

    { 1000000000;2;Field  ;
                SourceExpr="Error No. Field Mandatory";
                Visible=FALSE }

  }
  CODE
  {
    VAR
      FileFormat@1000000 : 'XML,CSV,FixedWidth,Excel';
      "Tag NameIndent"@19056250 : Integer INDATASET;
      "Existing RecordHideValue"@19025366 : Boolean INDATASET;
      "New RecordHideValue"@19012537 : Boolean INDATASET;
      "Option TypeHideValue"@19002310 : Boolean INDATASET;
      "Table No.Editable"@19076806 : Boolean INDATASET;
      "Field No.Editable"@19022826 : Boolean INDATASET;
      "Conversion CodeEditable"@19074872 : Boolean INDATASET;
      "Original ValueEditable"@19060489 : Boolean INDATASET;
      "Option TypeEditable"@19019138 : Boolean INDATASET;
      LinktoTableTagNameEditable@19004008 : Boolean INDATASET;
      "Increment MethodEditable"@19041957 : Boolean INDATASET;
      "Existing RecordEditable"@19014716 : Boolean INDATASET;
      "New RecordEditable"@19061505 : Boolean INDATASET;

    PROCEDURE Left@1000000();
    VAR
      ImportDefinitionLine@1100512000 : Record 11148592;
    BEGIN
      CurrPage.SETSELECTIONFILTER(ImportDefinitionLine);
      IF ImportDefinitionLine.FINDSET THEN
        REPEAT
          IF ImportDefinitionLine."Entry No." <> 0 THEN
            IF ImportDefinitionLine.Indent > 0 THEN BEGIN
              ImportDefinitionLine.Indent -= 1;
              ImportDefinitionLine.MODIFY;
            END;
        UNTIL ImportDefinitionLine.NEXT = 0;
    END;

    PROCEDURE Right@1000001();
    VAR
      ImportDefinitionLine@1100512000 : Record 11148592;
    BEGIN
      CurrPage.SETSELECTIONFILTER(ImportDefinitionLine);
      IF ImportDefinitionLine.FINDSET THEN
        REPEAT
          IF ImportDefinitionLine."Entry No." <> 0 THEN BEGIN
            ImportDefinitionLine.Indent += 1;
            ImportDefinitionLine.MODIFY;
          END;
        UNTIL ImportDefinitionLine.NEXT = 0;
    END;

    PROCEDURE Up@1000004();
    VAR
      CurrLine@1000004 : Record 11148592;
      ImportDefinitionLine@1000000 : Record 11148592;
      SelectedLine@1000002 : Record 11148592;
      LineNo@1000001 : Integer;
    BEGIN
      CurrLine := Rec;

      CurrPage.SETSELECTIONFILTER(SelectedLine);
      IF SelectedLine.COUNT = 0 THEN BEGIN
        SelectedLine.RESET;
        SelectedLine := Rec;
        SelectedLine.SETRECFILTER;
      END;

      IF SelectedLine.FINDSET THEN
        REPEAT
          ImportDefinitionLine.SETCURRENTKEY("Import Definition", "Line No.");
          ImportDefinitionLine.SETRANGE("Import Definition", "Import Definition");
          ImportDefinitionLine := SelectedLine;
          IF ImportDefinitionLine.NEXT(-1) <> 0 THEN BEGIN
            LineNo := ImportDefinitionLine."Line No.";
            ImportDefinitionLine."Line No." := SelectedLine."Line No.";
            ImportDefinitionLine.MODIFY;
            SelectedLine."Line No." := LineNo;
            SelectedLine.MODIFY;
          END;
        UNTIL SelectedLine.NEXT = 0;

      GET(CurrLine."Import Definition", CurrLine."Entry No.");
    END;

    PROCEDURE Down@1000005();
    VAR
      CurrLine@1000001 : Record 11148592;
      ImportDefinitionLine@1000003 : Record 11148592;
      SelectedLine@1000002 : Record 11148592;
      LineNo@1000000 : Integer;
    BEGIN
      CurrLine := Rec;

      CurrPage.SETSELECTIONFILTER(SelectedLine);
      IF SelectedLine.COUNT = 0 THEN BEGIN
        SelectedLine.RESET;
        SelectedLine := Rec;
        SelectedLine.SETRECFILTER;
      END;

      IF SelectedLine.FINDLAST THEN
        REPEAT
          ImportDefinitionLine.SETCURRENTKEY("Import Definition", "Line No.");
          ImportDefinitionLine.SETRANGE("Import Definition", "Import Definition");
          ImportDefinitionLine := SelectedLine;
          IF ImportDefinitionLine.NEXT(1) <> 0 THEN BEGIN
            LineNo := ImportDefinitionLine."Line No.";
            ImportDefinitionLine."Line No." := SelectedLine."Line No.";
            ImportDefinitionLine.MODIFY;
            SelectedLine."Line No." := LineNo;
            SelectedLine.MODIFY;
          END;
        UNTIL SelectedLine.NEXT(-1) = 0;

      GET(CurrLine."Import Definition", CurrLine."Entry No.");
    END;

    PROCEDURE LinkTables@1000002();
    BEGIN
      SetupLinkToTable;
    END;

    PROCEDURE UpdateForm@1000003();
    BEGIN
      CurrPage.UPDATE(FALSE);
    END;

    PROCEDURE _OpenRestrictions@19068975();
    BEGIN
      OpenRestrictions;
    END;

    PROCEDURE OpenRestrictions@1000006();
    BEGIN
      OpenRestrictions;
    END;

    PROCEDURE SetFileFormat@1000008(NewValue@1000000 : Option);
    BEGIN
      FileFormat := NewValue;
    END;

    LOCAL PROCEDURE SetFieldsEditable@1000009();
    BEGIN
      "Table No.Editable" := (Type IN [Type::Table, Type::Value, Type::Const, Type::Variable, Type::Skip]);
      "Field No.Editable" := (Type IN [Type::Value, Type::Const, Type::Variable, Type::Skip]);
      "Conversion CodeEditable" := (Type IN [Type::Value, Type::Const, Type::Variable]);
      "Original ValueEditable" := (Type IN [Type::Value, Type::Const, Type::Variable]);
      "Option TypeEditable" := (Type IN [Type::Value, Type::Const, Type::Variable]);
      LinktoTableTagNameEditable := (Type = Type::Table);
      "Increment MethodEditable" := (Type IN [Type::Value, Type::Const, Type::Variable]);
      "Existing RecordEditable" := (Type = Type::Table);
      "New RecordEditable" := (Type = Type::Table);
    END;

    LOCAL PROCEDURE TypeOnAfterValidate@19069045();
    BEGIN
      SetFieldsEditable;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      SetFieldsEditable;
    END;

    LOCAL PROCEDURE TableNoOnAfterInput@19060375(VAR Text@19060376 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE FieldNoOnAfterInput@19063566(VAR Text@19063567 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFieldNo(Text, "Table No.", TRUE);
    END;

    LOCAL PROCEDURE TagNameOnFormat@19023679();
    BEGIN
      "Tag NameIndent" := Indent;
    END;

    LOCAL PROCEDURE TableNoOnFormat@19071785(Text@19016339 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Table No.");
    END;

    LOCAL PROCEDURE FieldNoOnFormat@19075355(Text@19041114 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatFieldNo(Text, "Table No.", "Field No.");
    END;

    LOCAL PROCEDURE ExistingRecordOnFormat@19009624();
    BEGIN
      IF FileFormat = FileFormat::XML THEN BEGIN
        IF Type <> Type::Table THEN
          "Existing RecordHideValue" := TRUE;
      END ELSE
        IF NOT (Type IN [Type::Table, Type::Value]) THEN
          "Existing RecordHideValue" := TRUE;
    END;

    LOCAL PROCEDURE NewRecordOnFormat@19036900();
    BEGIN
      IF FileFormat = FileFormat::XML THEN BEGIN
        IF Type <> Type::Table THEN
          "New RecordHideValue" := TRUE;
      END ELSE
        IF NOT (Type IN [Type::Table, Type::Value]) THEN
          "New RecordHideValue" := TRUE;
    END;

    LOCAL PROCEDURE OptionTypeOnFormat@19077341();
    BEGIN
      IF NOT (Type IN [Type::Value, Type::Const, Type::Variable, Type::Skip]) THEN
        "Option TypeHideValue" := TRUE;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117077 CI - ADO Import Card
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=ADO Import Card;
               NLD=ADO Importdefinitie];
    SourceTable=Table11148591;
    SourceTableView=WHERE(File Format=CONST(ADO));
    PageType=Card;
    OnInit=BEGIN
             RightEnable := TRUE;
             LeftEnable := TRUE;
             "SQL StringEnable" := TRUE;
             "Connection StringEnable" := TRUE;
             "Run TaskEditable" := TRUE;
             "Monitor ModificationsEditable" := TRUE;
             LinesEditable := TRUE;
             "Project CodeEditable" := TRUE;
             ErrorNotificEMailAddressEditab := TRUE;
             "Main Table No.Editable" := TRUE;
             "Company NameEditable" := TRUE;
             "Run Codeunit No.Editable" := TRUE;
             "File FormatEditable" := TRUE;
             DescriptionEditable := TRUE;
             CodeEditable := TRUE;
           END;

    OnOpenPage=VAR
                 Initialize@1000001 : Codeunit 11148625;
               BEGIN
                 Initialize.CheckInitialize;
               END;

    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                       MainTableNoOnFormat(FORMAT("Main Table No."));
                       RunCodeunitNoOnFormat(FORMAT("Run Codeunit No."));
                     END;

    OnNewRecord=VAR
                  Setup@1000000 : Record 11148589;
                BEGIN
                  Setup.GET;
                  VALIDATE(Location, Setup."Default Import Location");

                  "File Format" := "File Format"::ADO;
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000016 ;1   ;ActionGroup;
                      CaptionML=[ENU=&Import Def.;
                                 NLD=&Importdef.] }
      { 1000029 ;2   ;Separator  }
      { 1100531001;2 ;Action    ;
                      ShortCutKey=Ctrl+Alt+V;
                      CaptionML=[ENU=Versions;
                                 NLD=Versies];
                      RunObject=Page 11117095;
                      RunPageView=SORTING(Code,Version No.);
                      RunPageLink=Code=FIELD(Code) }
      { 1100531000;2 ;Action    ;
                      ShortCutKey=Ctrl+S;
                      CaptionML=[ENU=Save as New Version;
                                 NLD=Op&slaan als nieuwe versie];
                      OnAction=BEGIN
                                 SaveNewVersion;
                               END;
                                }
      { 1100531004;2 ;Separator  }
      { 1000063 ;2   ;Action    ;
                      ShortCutKey=Ctrl+F5;
                      CaptionML=[ENU=Messages;
                                 NLD=Berichten];
                      RunObject=Page 11117032;
                      RunPageView=SORTING(Type,Code);
                      RunPageLink=Type=CONST(Import),
                                  Code=FIELD(Code) }
      { 1000062 ;2   ;Action    ;
                      CaptionML=[ENU=History;
                                 NLD=Historie];
                      RunObject=Page 11117034;
                      RunPageView=SORTING(Type,Code)
                                  WHERE(Type=CONST(Import));
                      RunPageLink=Code=FIELD(Code) }
      { 1000009 ;2   ;Action    ;
                      CaptionML=[ENU=Message Hist. &Comments;
                                 NLD=Bericht hist. op&merkingen];
                      RunObject=Page 11117035;
                      RunPageView=SORTING(Type,Code);
                      RunPageLink=Type=CONST(Import),
                                  Code=FIELD(Code) }
      { 1000021 ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NLD=F&uncties] }
      { 1000049 ;2   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Process;
                                 NLD=Verwerken];
                      OnAction=VAR
                                 Setup@1100512001 : Record 11148589;
                                 ProcessImportDef@1000001 : Codeunit 11148592;
                                 Progressbar@1000002 : Codeunit 11148624;
                                 ErrorMgt@1000006 : Codeunit 11148630;
                                 FileImported@1000003 : Boolean;
                                 ctImportCancelled@1000004 : TextConst 'ENU=Import cancelled.;NLD=Importeren afgebroken.';
                               BEGIN
                                 ErrorMgt.ClearError;

                                 Progressbar.Open(2);

                                 Setup.GET;
                                 IF Setup."Use Error Handling" THEN
                                   FileImported := ProcessImportDef.RUN(Rec)
                                 ELSE BEGIN
                                   ProcessImportDef.RUN(Rec);
                                   FileImported := TRUE;
                                 END;

                                 Progressbar.Close;

                                 IF NOT FileImported THEN
                                   IF ErrorMgt.GetError = '' THEN
                                     MESSAGE(ctImportCancelled)
                                   ELSE
                                     MESSAGE(ErrorMgt.GetError);
                               END;
                                }
      { 1000000002;2 ;Action    ;
                      CaptionML=[ENU=Copy;
                                 NLD=Kopiren];
                      OnAction=BEGIN
                                 Copy;
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1000000001;2 ;Action    ;
                      Name=<Action1000000000>;
                      CaptionML=[ENU=Copy To;
                                 NLD=Kopiren naar];
                      OnAction=BEGIN
                                 CopyTo;
                               END;
                                }
      { 1000040 ;2   ;Action    ;
                      CaptionML=[ENU=Renumber Lines;
                                 NLD=Regels hernummeren];
                      OnAction=BEGIN
                                 RenumberLines;
                               END;
                                }
      { 1000045 ;2   ;Action    ;
                      CaptionML=[ENU=Reversed Data &Mapping;
                                 NLD=Reversed data&mapping];
                      OnAction=BEGIN
                                 ReversedDataMapping;
                               END;
                                }
      { 1000086 ;2   ;Separator  }
      { 1000071 ;2   ;Action    ;
                      CaptionML=[ENU=Pri&nt;
                                 NLD=Afdrukken];
                      OnAction=VAR
                                 ImportDefinition@1000000 : Record 11148591;
                               BEGIN
                                 ImportDefinition := Rec;
                                 ImportDefinition.SETRECFILTER;
                                 REPORT.RUN(REPORT::"CI - Import Definitions", TRUE, FALSE, ImportDefinition);
                               END;
                                }
      { 1000088 ;2   ;Separator  }
      { 1000083 ;2   ;Action    ;
                      CaptionML=[ENU=Export Definition to &XML;
                                 NLD=Definitie exporteren naar &XML];
                      OnAction=VAR
                                 ExportDefinitionToXML@1000000 : Codeunit 11148634;
                               BEGIN
                                 ExportDefinitionToXML.ExportImportDefinition(Rec);
                               END;
                                }
      { 1000087 ;2   ;Action    ;
                      CaptionML=[ENU=Import Definition from XML;
                                 NLD=XML-Definitie &importeren];
                      OnAction=VAR
                                 ImportXMLDefinition@1000000 : Codeunit 11148636;
                               BEGIN
                                 ImportXMLDefinition.ImportImportDefinition(Rec);
                               END;
                                }
      { 1000070 ;2   ;Separator  }
      { 1000075 ;2   ;Action    ;
                      CaptionML=[ENU=Test File;
                                 NLD=Bestand controleren];
                      OnAction=BEGIN
                                 TestFile;
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000050 ;1   ;Action    ;
                      Name=Left;
                      Promoted=Yes;
                      Enabled=LeftEnable;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+L');
                               END;
                                }
      { 1000048 ;1   ;Action    ;
                      Name=Right;
                      Promoted=Yes;
                      Enabled=RightEnable;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+R');
                               END;
                                }
      { 1000047 ;1   ;Action    ;
                      Name=<Action1000047>;
                      CaptionML=[ENU=Up;
                                 NLD=Omhoog];
                      Promoted=Yes;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+U');
                               END;
                                }
      { 1000028 ;1   ;Action    ;
                      Name=<Action1000028>;
                      CaptionML=[ENU=Down;
                                 NLD=Omlaag];
                      Promoted=Yes;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+D');
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                CaptionML=[ENU=General;
                           NLD=Algemeen] }

    { 1000001;2;Field     ;
                SourceExpr=Code;
                Editable=CodeEditable }

    { 1000003;2;Field     ;
                SourceExpr=Description;
                Editable=DescriptionEditable }

    { 1000041;2;Field     ;
                SourceExpr="Connection String";
                Enabled="Connection StringEnable" }

    { 1000043;2;Field     ;
                SourceExpr="SQL String";
                Enabled="SQL StringEnable" }

    { 1000011;2;Field     ;
                SourceExpr=Status;
                ValuesAllowed=[Edit;Manual;Automated;Blocked];
                OnValidate=BEGIN
                             StatusOnAfterValidate;
                           END;
                            }

    { 1000024;1;Part      ;
                Name=Lines;
                SubPageLink=Import Definition=FIELD(Code);
                PagePartID=Page11117078;
                Editable=LinesEditable }

    { 1905328801;1;Group  ;
                CaptionML=[ENU=Field Selection;
                           NLD=Veldselectie] }

    { 1000010;2;Field     ;
                SourceExpr="Main Table No.";
                Editable="Main Table No.Editable";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           // IDYN EBK >>>>
                           IF Mgt.LookupTableNo(Text) THEN BEGIN
                             EVALUATE("Main Table No.",Text);
                             VALIDATE("Main Table No.");
                           END;
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //EXIT(Mgt.LookupTableNo(Text));
                           // IDYN EBK <<<<
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.AssistTableNo("Main Table No.");
                             END;
                              }

    { 1000031;2;Field     ;
                DrillDown=No;
                SourceExpr="Main Table No. of Fields";
                OnAssistEdit=VAR
                               TmpFld@1000000 : TEMPORARY Record 2000000041;
                               SelectFields@1000001 : Page 11148589;
                             BEGIN
                               TESTFIELD("Main Table No.");
                               SelectFields.SetImportDefinition(TRUE, Rec);
                               SelectFields.SetFormBlocked(Status <> Status::Edit);

                               IF SelectFields.RUNMODAL = ACTION::OK THEN BEGIN
                                 SelectFields.GetSelectedFields(TmpFld);
                                 UpdateTableFields(TRUE, "Main Table No.", TmpFld);
                                 CurrPage.UPDATE(TRUE);
                               END;
                             END;
                              }

    { 1903121901;1;Group  ;
                CaptionML=[ENU=Options;
                           NLD=Opties] }

    { 1000078;2;Field     ;
                SourceExpr="Project Code";
                Editable="Project CodeEditable" }

    { 1000076;2;Field     ;
                SourceExpr="Company Name";
                Editable="Company NameEditable" }

    { 1000068;2;Field     ;
                SourceExpr="Error Notific. E-Mail Address";
                Editable=ErrorNotificEMailAddressEditab }

    { 1100512000;2;Field  ;
                SourceExpr="Run Codeunit No.";
                Visible=FALSE;
                Editable="Run Codeunit No.Editable";
                OnLookup=VAR
                           Mgt@1100512000 : Codeunit 11148589;
                         BEGIN
                           EXIT(Mgt.LookupObjectNo(5, Text));
                         END;
                          }

    { 1000005;2;Field     ;
                SourceExpr="Monitor Modifications";
                Editable="Monitor ModificationsEditable" }

    { 1000014;2;Field     ;
                SourceExpr="Run Task";
                Editable="Run TaskEditable" }

  }
  CODE
  {
    VAR
      INMgt@1000000000 : Codeunit 11148589;
      CodeEditable@19001698 : Boolean INDATASET;
      DescriptionEditable@19061412 : Boolean INDATASET;
      "File FormatEditable"@19047526 : Boolean INDATASET;
      "Run Codeunit No.Editable"@19055664 : Boolean INDATASET;
      "Company NameEditable"@19027413 : Boolean INDATASET;
      "Main Table No.Editable"@19066361 : Boolean INDATASET;
      ErrorNotificEMailAddressEditab@19034665 : Boolean INDATASET;
      "Project CodeEditable"@19062497 : Boolean INDATASET;
      LinesEditable@19010511 : Boolean INDATASET;
      "Monitor ModificationsEditable"@19075968 : Boolean INDATASET;
      "Run TaskEditable"@19005185 : Boolean INDATASET;
      "Connection StringEnable"@19076131 : Boolean INDATASET;
      "SQL StringEnable"@19077671 : Boolean INDATASET;
      LeftEnable@19065291 : Boolean INDATASET;
      RightEnable@19037326 : Boolean INDATASET;

    LOCAL PROCEDURE EnableFields@1000000();
    BEGIN
      "Connection StringEnable" := "File Format" = "File Format"::ADO;
      "SQL StringEnable" := "File Format" = "File Format"::ADO;

      LeftEnable := "File Format" <> "File Format"::ADO;
      RightEnable := "File Format" <> "File Format"::ADO;
    END;

    LOCAL PROCEDURE SetFileFormatToLines@1000002();
    BEGIN
      CurrPage.Lines.PAGE.SetFileFormat("File Format");
    END;

    LOCAL PROCEDURE SetEditable@1000003();
    BEGIN
      CodeEditable := (Status = Status::Edit);
      DescriptionEditable := (Status = Status::Edit);
      "File FormatEditable" := (Status = Status::Edit);
      "Run Codeunit No.Editable" := (Status = Status::Edit);
      "Company NameEditable" := (Status = Status::Edit);
      "Main Table No.Editable" := (Status = Status::Edit);
      ErrorNotificEMailAddressEditab := (Status = Status::Edit);
      "Project CodeEditable" := (Status = Status::Edit);
      LinesEditable := (Status = Status::Edit);
      "Monitor ModificationsEditable" := (Status = Status::Edit);
      "Run TaskEditable" := (Status = Status::Edit);
    END;

    LOCAL PROCEDURE StatusOnAfterValidate@19072689();
    BEGIN
      SetEditable;
    END;

    LOCAL PROCEDURE FileFormatOnAfterValidate@19065317();
    BEGIN
      EnableFields;
      SetFileFormatToLines;
      CurrPage.Lines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      EnableFields;

      SetFileFormatToLines;

      SetEditable;
    END;

    LOCAL PROCEDURE MainTableNoOnAfterInput@19047063(VAR Text@19047064 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE RunCodeunitNoOnAfterInput@19017510(VAR Text@19017511 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputObjectNo(5, Text);
    END;

    LOCAL PROCEDURE MainTableNoOnFormat@19079044(Text@19015475 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Main Table No.");
    END;

    LOCAL PROCEDURE RunCodeunitNoOnFormat@19054474(Text@19073072 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatObjectNo(5, Text, "Run Codeunit No.");
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117078 CI - ADO Import Subform
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=ADO Import Subform;
               NLD=ADO Importdefinitiesubform];
    SourceTable=Table11148592;
    SourceTableView=SORTING(Import Definition,Line No.);
    PageType=ListPart;
    OnInit=BEGIN
             "New RecordEditable" := TRUE;
             "Existing RecordEditable" := TRUE;
             "Increment MethodEditable" := TRUE;
             LinktoTableTagNameEditable := TRUE;
             "Option TypeEditable" := TRUE;
             "Original ValueEditable" := TRUE;
             "Conversion CodeEditable" := TRUE;
             "Field No.Editable" := TRUE;
             "Table No.Editable" := TRUE;
           END;

    OnAfterGetRecord=BEGIN
                       "Option TypeHideValue" := FALSE;
                       "New RecordHideValue" := FALSE;
                       "Existing RecordHideValue" := FALSE;
                       "Tag NameIndent" := 0;
                       OnAfterGetCurrRecord;
                       TagNameOnFormat;
                       TableNoOnFormat(FORMAT("Table No."));
                       FieldNoOnFormat(FORMAT("Field No."));
                       ExistingRecordOnFormat;
                       NewRecordOnFormat;
                       OptionTypeOnFormat;
                     END;

    OnNewRecord=BEGIN
                  SetupNewLine(xRec, BelowxRec);
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1904677404;1 ;ActionGroup;
                      CaptionML=[ENU=&Import Def.;
                                 NLD=&Importdef.] }
      { 1903294104;2 ;Action    ;
                      ShortCutKey=Ctrl+L;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Link &Tables;
                                 NLD=Tabellen linken];
                      OnAction=BEGIN
                                 LinkTables;
                               END;
                                }
      { 1906522404;2 ;Action    ;
                      ShortCutKey=Ctrl+R;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Restrictions;
                                 NLD=Restricties];
                      OnAction=BEGIN
                                 _OpenRestrictions;
                               END;
                                }
      { 1000000007;1 ;Separator  }
      { 1000000006;1 ;Action    ;
                      Name=<Action1000000000>;
                      ShortCutKey=Shift+Ctrl+R;
                      CaptionML=[ENU=Right;
                                 NLD=Rechts];
                      Promoted=Yes;
                      OnAction=BEGIN
                                 Right;
                               END;
                                }
      { 1000000005;1 ;Action    ;
                      Name=<Action1000000001>;
                      ShortCutKey=Shift+Ctrl+L;
                      CaptionML=[ENU=Left;
                                 NLD=Links];
                      OnAction=BEGIN
                                 Left;
                               END;
                                }
      { 1000000003;1 ;Action    ;
                      Name=<Action1000000002>;
                      ShortCutKey=Shift+Ctrl+U;
                      CaptionML=[ENU=Up;
                                 NLD=Omhoog];
                      OnAction=BEGIN
                                 Up;
                               END;
                                }
      { 1000000001;1 ;Action    ;
                      Name=<Action1000000003>;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Down;
                                 NLD=Omlaag];
                      OnAction=BEGIN
                                 Down;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                IndentationColumnName="Tag NameIndent";
                IndentationControls=Tag Name;
                GroupType=Repeater }

    { 1000011;2;Field     ;
                SourceExpr="Tag Name" }

    { 1000001;2;Field     ;
                SourceExpr=Type;
                OnValidate=BEGIN
                             TypeOnAfterValidate;
                           END;
                            }

    { 1000031;2;Field     ;
                SourceExpr=Code }

    { 1100531000;2;Field  ;
                SourceExpr="No. of Functions" }

    { 1000005;2;Field     ;
                SourceExpr="Table No.";
                Editable="Table No.Editable";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           // IDYN EBK >>>>
                           IF Mgt.LookupTableNo(Text) THEN BEGIN
                             EVALUATE("Table No.",Text);
                             VALIDATE("Table No.");
                           END;
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //EXIT(Mgt.LookupTableNo(Text));
                           // IDYN EBK <<<<
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.AssistTableNo("Table No.");
                             END;
                              }

    { 1000000012;2;Field  ;
                Name=Table Name;
                SourceExpr="Table Name" }

    { 1000009;2;Field     ;
                SourceExpr="Field No.";
                Editable="Field No.Editable";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           // IDYN EBK >>>>
                           IF Mgt.LookupFieldNo("Table No.",Text,TRUE) THEN BEGIN
                             EVALUATE("Field No.",Text);
                             VALIDATE("Field No.");
                           END;
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //EXIT(Mgt.LookupFieldNo("Table No.", Text, TRUE));
                           // IDYN EBK <<<<
                         END;
                          }

    { 1000000013;2;Field  ;
                Name=Field Name;
                SourceExpr="Field Name" }

    { 1000029;2;Field     ;
                SourceExpr="Original Value";
                Visible=FALSE;
                Editable="Original ValueEditable" }

    { 1000023;2;Field     ;
                SourceExpr="Link to Table (Tag Name)";
                Editable=LinktoTableTagNameEditable;
                OnAssistEdit=BEGIN
                               SetupLinkToTable;
                             END;
                              }

    { 1000041;2;Field     ;
                SourceExpr="Existing Record";
                Editable="Existing RecordEditable";
                HideValue="Existing RecordHideValue" }

    { 1000000004;2;Field  ;
                SourceExpr="Error No. Existing Record";
                Visible=FALSE }

    { 1000043;2;Field     ;
                SourceExpr="New Record";
                Editable="New RecordEditable";
                HideValue="New RecordHideValue" }

    { 1000000002;2;Field  ;
                SourceExpr="Error No. New Record";
                Visible=FALSE }

    { 1000035;2;Field     ;
                SourceExpr="No. of Restrictions" }

    { 1000007;2;Field     ;
                SourceExpr="Increment Method";
                Visible=FALSE;
                Editable="Increment MethodEditable" }

    { 1000021;2;Field     ;
                SourceExpr="Conversion Code";
                Editable="Conversion CodeEditable" }

    { 1000027;2;Field     ;
                SourceExpr="Dest. Variable";
                Visible=FALSE }

    { 1000015;2;Field     ;
                SourceExpr="Validate Field";
                Visible=FALSE }

    { 1000013;2;Field     ;
                SourceExpr="Skip If Empty";
                Visible=FALSE }

    { 1000025;2;Field     ;
                SourceExpr="Save Record";
                Visible=FALSE }

    { 1000017;2;Field     ;
                SourceExpr="Data Format";
                Visible=FALSE }

    { 1000000008;2;Field  ;
                SourceExpr="Custom Date Order";
                Visible=False }

    { 1000000009;2;Field  ;
                SourceExpr="Custom Date Separator";
                Visible=false }

    { 1000033;2;Field     ;
                SourceExpr="Option Type";
                Visible=FALSE;
                Editable="Option TypeEditable";
                HideValue="Option TypeHideValue" }

    { 1000039;2;Field     ;
                SourceExpr=Mandatory;
                Visible=FALSE }

    { 1000000000;2;Field  ;
                SourceExpr="Error No. Field Mandatory";
                Visible=FALSE }

  }
  CODE
  {
    VAR
      FileFormat@1000000 : 'XML,CSV,FixedWidth,Excel';
      "Tag NameIndent"@19056250 : Integer INDATASET;
      "Existing RecordHideValue"@19025366 : Boolean INDATASET;
      "New RecordHideValue"@19012537 : Boolean INDATASET;
      "Option TypeHideValue"@19002310 : Boolean INDATASET;
      "Table No.Editable"@19076806 : Boolean INDATASET;
      "Field No.Editable"@19022826 : Boolean INDATASET;
      "Conversion CodeEditable"@19074872 : Boolean INDATASET;
      "Original ValueEditable"@19060489 : Boolean INDATASET;
      "Option TypeEditable"@19019138 : Boolean INDATASET;
      LinktoTableTagNameEditable@19004008 : Boolean INDATASET;
      "Increment MethodEditable"@19041957 : Boolean INDATASET;
      "Existing RecordEditable"@19014716 : Boolean INDATASET;
      "New RecordEditable"@19061505 : Boolean INDATASET;

    PROCEDURE Left@1000000();
    VAR
      ImportDefinitionLine@1100512000 : Record 11148592;
    BEGIN
      CurrPage.SETSELECTIONFILTER(ImportDefinitionLine);
      IF ImportDefinitionLine.FINDSET THEN
        REPEAT
          IF ImportDefinitionLine."Entry No." <> 0 THEN
            IF ImportDefinitionLine.Indent > 0 THEN BEGIN
              ImportDefinitionLine.Indent -= 1;
              ImportDefinitionLine.MODIFY;
            END;
        UNTIL ImportDefinitionLine.NEXT = 0;
    END;

    PROCEDURE Right@1000001();
    VAR
      ImportDefinitionLine@1100512000 : Record 11148592;
    BEGIN
      CurrPage.SETSELECTIONFILTER(ImportDefinitionLine);
      IF ImportDefinitionLine.FINDSET THEN
        REPEAT
          IF ImportDefinitionLine."Entry No." <> 0 THEN BEGIN
            ImportDefinitionLine.Indent += 1;
            ImportDefinitionLine.MODIFY;
          END;
        UNTIL ImportDefinitionLine.NEXT = 0;
    END;

    PROCEDURE Up@1000004();
    VAR
      CurrLine@1000004 : Record 11148592;
      ImportDefinitionLine@1000000 : Record 11148592;
      SelectedLine@1000002 : Record 11148592;
      LineNo@1000001 : Integer;
    BEGIN
      CurrLine := Rec;

      CurrPage.SETSELECTIONFILTER(SelectedLine);
      IF SelectedLine.COUNT = 0 THEN BEGIN
        SelectedLine.RESET;
        SelectedLine := Rec;
        SelectedLine.SETRECFILTER;
      END;

      IF SelectedLine.FINDSET THEN
        REPEAT
          ImportDefinitionLine.SETCURRENTKEY("Import Definition", "Line No.");
          ImportDefinitionLine.SETRANGE("Import Definition", "Import Definition");
          ImportDefinitionLine := SelectedLine;
          IF ImportDefinitionLine.NEXT(-1) <> 0 THEN BEGIN
            LineNo := ImportDefinitionLine."Line No.";
            ImportDefinitionLine."Line No." := SelectedLine."Line No.";
            ImportDefinitionLine.MODIFY;
            SelectedLine."Line No." := LineNo;
            SelectedLine.MODIFY;
          END;
        UNTIL SelectedLine.NEXT = 0;

      GET(CurrLine."Import Definition", CurrLine."Entry No.");
    END;

    PROCEDURE Down@1000005();
    VAR
      CurrLine@1000001 : Record 11148592;
      ImportDefinitionLine@1000003 : Record 11148592;
      SelectedLine@1000002 : Record 11148592;
      LineNo@1000000 : Integer;
    BEGIN
      CurrLine := Rec;

      CurrPage.SETSELECTIONFILTER(SelectedLine);
      IF SelectedLine.COUNT = 0 THEN BEGIN
        SelectedLine.RESET;
        SelectedLine := Rec;
        SelectedLine.SETRECFILTER;
      END;

      IF SelectedLine.FINDLAST THEN
        REPEAT
          ImportDefinitionLine.SETCURRENTKEY("Import Definition", "Line No.");
          ImportDefinitionLine.SETRANGE("Import Definition", "Import Definition");
          ImportDefinitionLine := SelectedLine;
          IF ImportDefinitionLine.NEXT(1) <> 0 THEN BEGIN
            LineNo := ImportDefinitionLine."Line No.";
            ImportDefinitionLine."Line No." := SelectedLine."Line No.";
            ImportDefinitionLine.MODIFY;
            SelectedLine."Line No." := LineNo;
            SelectedLine.MODIFY;
          END;
        UNTIL SelectedLine.NEXT(-1) = 0;

      GET(CurrLine."Import Definition", CurrLine."Entry No.");
    END;

    PROCEDURE LinkTables@1000002();
    BEGIN
      SetupLinkToTable;
    END;

    PROCEDURE UpdateForm@1000003();
    BEGIN
      CurrPage.UPDATE(FALSE);
    END;

    PROCEDURE _OpenRestrictions@19068975();
    BEGIN
      OpenRestrictions;
    END;

    PROCEDURE OpenRestrictions@1000006();
    BEGIN
      OpenRestrictions;
    END;

    PROCEDURE SetFileFormat@1000008(NewValue@1000000 : Option);
    BEGIN
      FileFormat := NewValue;
    END;

    LOCAL PROCEDURE SetFieldsEditable@1000009();
    BEGIN
      "Table No.Editable" := (Type IN [Type::Table, Type::Value, Type::Const, Type::Variable, Type::Skip]);
      "Field No.Editable" := (Type IN [Type::Value, Type::Const, Type::Variable, Type::Skip]);
      "Conversion CodeEditable" := (Type IN [Type::Value, Type::Const, Type::Variable]);
      "Original ValueEditable" := (Type IN [Type::Value, Type::Const, Type::Variable]);
      "Option TypeEditable" := (Type IN [Type::Value, Type::Const, Type::Variable]);

      IF FileFormat = FileFormat::XML THEN BEGIN
        LinktoTableTagNameEditable := (Type = Type::Table);
        "Increment MethodEditable" := (Type IN [Type::Value, Type::Const, Type::Variable]);
        "Existing RecordEditable" := (Type = Type::Table);
        "New RecordEditable" := (Type = Type::Table);
      END ELSE BEGIN
        LinktoTableTagNameEditable := (FALSE);
        "Increment MethodEditable" := (TRUE);
        "Existing RecordEditable" := (Type IN [Type::Table, Type::Value]);
        "New RecordEditable" := (Type IN [Type::Table, Type::Value]);
      END;
    END;

    LOCAL PROCEDURE TypeOnAfterValidate@19069045();
    BEGIN
      SetFieldsEditable;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      SetFieldsEditable;
    END;

    LOCAL PROCEDURE TableNoOnAfterInput@19060375(VAR Text@19060376 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE FieldNoOnAfterInput@19063566(VAR Text@19063567 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFieldNo(Text, "Table No.", TRUE);
    END;

    LOCAL PROCEDURE TagNameOnFormat@19023679();
    BEGIN
      "Tag NameIndent" := Indent;
    END;

    LOCAL PROCEDURE TableNoOnFormat@19071785(Text@19016339 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Table No.");
    END;

    LOCAL PROCEDURE FieldNoOnFormat@19075355(Text@19041114 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatFieldNo(Text, "Table No.", "Field No.");
    END;

    LOCAL PROCEDURE ExistingRecordOnFormat@19009624();
    BEGIN
      IF FileFormat = FileFormat::XML THEN BEGIN
        IF Type <> Type::Table THEN
          "Existing RecordHideValue" := TRUE;
      END ELSE
        IF NOT (Type IN [Type::Table, Type::Value]) THEN
          "Existing RecordHideValue" := TRUE;
    END;

    LOCAL PROCEDURE NewRecordOnFormat@19036900();
    BEGIN
      IF FileFormat = FileFormat::XML THEN BEGIN
        IF Type <> Type::Table THEN
          "New RecordHideValue" := TRUE;
      END ELSE
        IF NOT (Type IN [Type::Table, Type::Value]) THEN
          "New RecordHideValue" := TRUE;
    END;

    LOCAL PROCEDURE OptionTypeOnFormat@19077341();
    BEGIN
      IF NOT (Type IN [Type::Value, Type::Const, Type::Variable, Type::Skip]) THEN
        "Option TypeHideValue" := TRUE;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117079 CI - XML Export Card
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=XML Export Card;
               NLD=XML Exportdefinitie];
    SourceTable=Table11148599;
    SourceTableView=WHERE(File Format=CONST(XML));
    PageType=Card;
    OnInit=BEGIN
             RightEnable := TRUE;
             LeftEnable := TRUE;
             "Sub Table No. of FieldsEnable" := TRUE;
             "Sub Table FilterEnable" := TRUE;
             "Sub Table No.Enable" := TRUE;
             "Save to MessagesEnable" := TRUE;
             "Filename TypeEnable" := TRUE;
             FilenameEnable := TRUE;
             LocationEnable := TRUE;
             "Use InboxEnable" := TRUE;
             "Import CodeEnable" := TRUE;
             "Destination CompanyEnable" := TRUE;
             SynchronizeEnable := TRUE;
             "XML DeclarationEnable" := TRUE;
             "One File per RecordEnable" := TRUE;
             LinesEditable := TRUE;
             "Project CodeEditable" := TRUE;
             SynchronizeEditable := TRUE;
             "Use InboxEditable" := TRUE;
             "Import CodeEditable" := TRUE;
             "Destination CompanyEditable" := TRUE;
             "Sub Table No.Editable" := TRUE;
             "Sub Table FilterEditable" := TRUE;
             "Main Table FilterEditable" := TRUE;
             "Main Table No.Editable" := TRUE;
             "Run TaskEditable" := TRUE;
             "Run Codeunit No.Editable" := TRUE;
             "XML DeclarationEditable" := TRUE;
             "One File per RecordEditable" := TRUE;
             "Save to MessagesEditable" := TRUE;
             "File FormatEditable" := TRUE;
             FilenameEditable := TRUE;
             "Filename TypeEditable" := TRUE;
             LocationEditable := TRUE;
             DescriptionEditable := TRUE;
             CodeEditable := TRUE;
           END;

    OnOpenPage=VAR
                 Initialize@1000001 : Codeunit 11148625;
               BEGIN
                 Initialize.CheckInitialize;
               END;

    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                       MainTableNoOnFormat(FORMAT("Main Table No."));
                       MainTableFilterOnFormat(FORMAT("Main Table Filter"));
                       SubTableFilterOnFormat(FORMAT("Sub Table Filter"));
                       SubTableNoOnFormat(FORMAT("Sub Table No."));
                       RunCodeunitNoOnFormat(FORMAT("Run Codeunit No."));
                       DestinationCompanyOnFormat(FORMAT("Destination Company"));
                     END;

    OnNewRecord=VAR
                  Setup@1000000 : Record 11148589;
                BEGIN
                  Setup.GET;
                  "XML Declaration" := Setup."XML Declaration";
                  Location := Setup."Default Export Location";

                  "File Format" := "File Format"::XML;
                  OnAfterGetCurrRecord;
                END;

    OnModifyRecord=BEGIN
                     VALIDATE("Main Table Filter");
                     VALIDATE("Sub Table Filter");

                     EXIT(TRUE);
                   END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000049 ;1   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Process;
                                 NLD=Verwerken];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Setup@1100512001 : Record 11148589;
                                 ProcessExportDef@1000002 : Codeunit 11148606;
                                 Progressbar@1000001 : Codeunit 11148624;
                                 ErrorMgt@1000006 : Codeunit 11148630;
                                 FileExported@1000004 : Boolean;
                                 ctDataExported@1000007 : TextConst 'ENU=Data exported;NLD=Data gexporteerd.';
                                 ctExportCancelled@1000005 : TextConst 'ENU=Export cancelled.;NLD=Exporteren afgebroken.';
                                 ctFileCreated@1000003 : TextConst 'ENU=Export processed.;NLD=Export verwerkt.';
                               BEGIN
                                 ErrorMgt.ClearError;

                                 TestRecordSet;

                                 Progressbar.Open(1);

                                 Setup.GET;
                                 IF Setup."Use Error Handling" THEN
                                   FileExported := ProcessExportDef.RUN(Rec)
                                 ELSE BEGIN
                                   ProcessExportDef.RUN(Rec);
                                   FileExported := TRUE;
                                 END;

                                 Progressbar.Close;

                                 IF FileExported THEN
                                   IF "File Format" = "File Format"::ADO THEN
                                     MESSAGE(ctDataExported)
                                   ELSE
                                     MESSAGE(ctFileCreated)
                                 ELSE BEGIN
                                   AddTraceEntry(TRUE, ErrorMgt.GetError, 0);
                                   IF ErrorMgt.GetError = '' THEN
                                     MESSAGE(ctExportCancelled)
                                   ELSE
                                     MESSAGE(ErrorMgt.GetError);
                                 END;
                               END;
                                }
      { 1000072 ;1   ;Action    ;
                      CaptionML=[ENU=Copy;
                                 NLD=Kopiren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Copy;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Copy;
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1000000001;1 ;Action    ;
                      Name=<Action1000000000>;
                      CaptionML=[ENU=Copy To;
                                 NLD=Kopiren naar];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Copy;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CopyTo;
                               END;
                                }
      { 1000000002;1 ;ActionGroup;
                      CaptionML=[ENU=Move;
                                 NLD=Verplaatsen] }
      { 1000050 ;2   ;Action    ;
                      Name=Left;
                      Promoted=Yes;
                      Enabled=LeftEnable;
                      PromotedIsBig=Yes;
                      Image=PreviousSet;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+L');
                               END;
                                }
      { 1000048 ;2   ;Action    ;
                      Name=Right;
                      Promoted=Yes;
                      Enabled=RightEnable;
                      PromotedIsBig=Yes;
                      Image=NextSet;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+R');
                               END;
                                }
      { 1000047 ;2   ;Action    ;
                      Name=<Action1000047>;
                      CaptionML=[ENU=Up;
                                 NLD=Omhoog];
                      Promoted=Yes;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+U');
                               END;
                                }
      { 1000028 ;2   ;Action    ;
                      Name=<Action1000028>;
                      CaptionML=[ENU=Down;
                                 NLD=Omlaag];
                      Promoted=Yes;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+D');
                               END;
                                }
      { 1000000003;1 ;ActionGroup;
                      CaptionML=[ENU=Messages and History;
                                 NLD=Berichten en historie] }
      { 1000056 ;2   ;Action    ;
                      ShortCutKey=Ctrl+F5;
                      CaptionML=[ENU=Messages;
                                 NLD=Berichten];
                      RunObject=Page 11117032;
                      RunPageView=SORTING(Entry No.);
                      RunPageLink=Type=CONST(Export),
                                  Code=FIELD(Code);
                      Promoted=Yes;
                      Image=Note;
                      PromotedCategory=Process }
      { 1000057 ;2   ;Action    ;
                      CaptionML=[ENU=History;
                                 NLD=Historie];
                      RunObject=Page 11117034;
                      RunPageView=SORTING(Type,Code);
                      RunPageLink=Type=CONST(Export),
                                  Code=FIELD(Code);
                      Image=History }
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000016 ;1   ;ActionGroup;
                      CaptionML=[ENU=Export &Def.;
                                 NLD=&Exportdef.] }
      { 1100531001;2 ;Action    ;
                      ShortCutKey=Ctrl+Alt+V;
                      CaptionML=[ENU=Versions;
                                 NLD=Versies];
                      RunObject=Page 11117096;
                      RunPageView=SORTING(Code,Version No.);
                      RunPageLink=Code=FIELD(Code) }
      { 1100531000;2 ;Action    ;
                      ShortCutKey=Ctrl+S;
                      CaptionML=[ENU=Save as New Version;
                                 NLD=Op&slaan als nieuwe versie];
                      OnAction=BEGIN
                                 SaveNewVersion;
                               END;
                                }
      { 1000000000;2 ;Separator  }
      { 1000044 ;2   ;Action    ;
                      CaptionML=[ENU=M&onitoring Setup;
                                 NLD=Monitoringinstellingen];
                      RunObject=Page 11117027;
                      RunPageView=SORTING(Export Definition);
                      RunPageLink=Export Definition=FIELD(Code) }
      { 1000045 ;2   ;Action    ;
                      CaptionML=[ENU=Export Jobs;
                                 NLD=E&xporteeropdrachten];
                      RunObject=Page 11117028;
                      RunPageView=SORTING(Status,Export Definition);
                      RunPageLink=Export Definition=FIELD(Code) }
      { 1000021 ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NLD=F&uncties] }
      { 1000046 ;2   ;Action    ;
                      CaptionML=[ENU=Renumber Lines;
                                 NLD=Regels hernummeren];
                      OnAction=BEGIN
                                 RenumberLines;
                               END;
                                }
      { 1000095 ;2   ;Action    ;
                      CaptionML=[ENU=Reversed Data &Mapping;
                                 NLD=Lees definitie van bestand];
                      OnAction=BEGIN
                                 ReversedDataMapping;
                               END;
                                }
      { 1000071 ;2   ;Separator  }
      { 1000070 ;2   ;Action    ;
                      CaptionML=[ENU=Pri&nt;
                                 NLD=Afdrukken];
                      OnAction=VAR
                                 ExportDefinition@1000000 : Record 11148599;
                               BEGIN
                                 ExportDefinition := Rec;
                                 ExportDefinition.SETRECFILTER;
                                 REPORT.RUN(REPORT::"CI - Export Definitions", TRUE, FALSE, ExportDefinition);
                               END;
                                }
      { 1000089 ;2   ;Separator  }
      { 1000090 ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Import Definition from XML;
                                 NLD=XML-Definitie &importeren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Import;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ImportXMLDefinition@1000000 : Codeunit 11148636;
                               BEGIN
                                 ImportXMLDefinition.ImportExportDefinition(Rec);
                               END;
                                }
      { 1000088 ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Export Definition to &XML;
                                 NLD=Definitie exporteren naar &XML];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Export;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ExportDefinitionToXML@1000000 : Codeunit 11148634;
                               BEGIN
                                 ExportDefinitionToXML.ExportExportDefinition(Rec);
                               END;
                                }
      { 1000068 ;2   ;Separator  }
      { 1000069 ;2   ;Action    ;
                      CaptionML=[ENU=Create M&onitoring Line;
                                 NLD=Monitorregel aanmaken];
                      OnAction=BEGIN
                                 CreateMonitoringLine;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                CaptionML=[ENU=General;
                           NLD=Algemeen] }

    { 1000001;2;Field     ;
                SourceExpr=Code;
                Editable=CodeEditable }

    { 1000003;2;Field     ;
                SourceExpr=Description;
                Editable=DescriptionEditable }

    { 1000005;2;Field     ;
                SourceExpr=Location;
                Enabled=LocationEnable;
                Editable=LocationEditable;
                OnValidate=VAR
                             Mgt@1000000000 : Codeunit 11148589;
                           BEGIN
                             Mgt.AfterInputFolder(Location);
                           END;

                OnLookup=VAR
                           Mgt@1000001 : Codeunit 11148589;
                           NewFolder@1000000 : Text[1024];
                         BEGIN
                           NewFolder := Mgt.BrowseForFolder('', '');
                           IF NewFolder <> '' THEN
                             Location := NewFolder;
                         END;

                OnAssistEdit=VAR
                               Mgt@1000001 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder(Location);
                             END;
                              }

    { 1000014;2;Field     ;
                SourceExpr=Filename;
                Enabled=FilenameEnable;
                Editable=FilenameEditable }

    { 1000083;2;Field     ;
                SourceExpr="Filename Type";
                Enabled="Filename TypeEnable";
                Editable="Filename TypeEditable" }

    { 1000011;2;Field     ;
                SourceExpr=Status;
                OnValidate=BEGIN
                             StatusOnAfterValidate;
                           END;
                            }

    { 1000052;2;Field     ;
                SourceExpr="Save to Messages";
                Enabled="Save to MessagesEnable";
                Editable="Save to MessagesEditable" }

    { 1000039;2;Field     ;
                SourceExpr="No. of Monitoring Lines" }

    { 1000041;2;Field     ;
                SourceExpr="No. of Export Jobs" }

    { 1000024;1;Part      ;
                Name=Lines;
                SubPageLink=Export Definition=FIELD(Code);
                PagePartID=Page11117080;
                Editable=LinesEditable }

    { 1905328801;1;Group  ;
                CaptionML=[ENU=Field Selection;
                           NLD=Veldselectie] }

    { 1000010;2;Field     ;
                SourceExpr="Main Table No.";
                Editable="Main Table No.Editable";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           // IDYN EBK >>>>
                           IF Mgt.LookupTableNo(Text) THEN BEGIN
                             EVALUATE("Main Table No.",Text);
                             VALIDATE("Main Table No.");
                           END;
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //EXIT(Mgt.LookupTableNo(Text));
                           // IDYN EBK <<<<
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.AssistTableNo("Main Table No.");
                             END;
                              }

    { 1000035;2;Field     ;
                AssistEdit=Yes;
                SourceExpr="Main Table Filter";
                Editable="Main Table FilterEditable";
                OnAssistEdit=BEGIN
                               EVALUATE("Main Table Filter",INMgt.SetTableFilter("Main Table No.",FORMAT("Main Table Filter")));
                             END;
                              }

    { 1000031;2;Field     ;
                DrillDown=No;
                SourceExpr="Main Table No. of Fields";
                OnAssistEdit=VAR
                               TmpFld@1000001 : TEMPORARY Record 2000000041;
                               SelectFields@1000000 : Page 11148589;
                             BEGIN
                               TESTFIELD("Main Table No.");

                               SelectFields.SetExportDefinition(TRUE, Rec);
                               SelectFields.SetFormBlocked(Status <> Status::Edit);
                               IF SelectFields.RUNMODAL = ACTION::OK THEN BEGIN
                                 SelectFields.GetSelectedFields(TmpFld);
                                 UpdateTableFields(TRUE, "Main Table No.", TmpFld);
                                 CurrPage.UPDATE(TRUE);
                               END;
                             END;
                              }

    { 1000025;2;Field     ;
                SourceExpr="Sub Table No.";
                Enabled="Sub Table No.Enable";
                Editable="Sub Table No.Editable";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           IF Mgt.LookupTableNo(Text) THEN BEGIN
                             EVALUATE("Sub Table No.",Text);
                             VALIDATE("Sub Table No.");
                           END;

                           // IDYN EBK >>>>
                           //Mgt.LookupRelatedTableNo("Main Table No.",Text);
                           //EVALUATE("Sub Table No.",Text);
                           //VALIDATE("Sub Table No.");
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //EXIT(Mgt.LookupRelatedTableNo("Main Table No.", Text));
                           // IDYN EBK <<<<
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.AssistTableNo("Main Table No.");
                             END;
                              }

    { 1000037;2;Field     ;
                AssistEdit=Yes;
                SourceExpr="Sub Table Filter";
                Enabled="Sub Table FilterEnable";
                Editable="Sub Table FilterEditable";
                OnAssistEdit=BEGIN
                               EVALUATE("Sub Table Filter",INMgt.SetTableFilter("Sub Table No.",FORMAT("Sub Table Filter")));
                             END;
                              }

    { 1000033;2;Field     ;
                DrillDown=No;
                SourceExpr="Sub Table No. of Fields";
                Enabled="Sub Table No. of FieldsEnable";
                OnAssistEdit=VAR
                               TmpFld@1000001 : TEMPORARY Record 2000000041;
                               SelectFields@1000000 : Page 11148589;
                             BEGIN
                               TESTFIELD("Sub Table No.");

                               SelectFields.SetExportDefinition(FALSE, Rec);
                               SelectFields.SetFormBlocked(Status <> Status::Edit);
                               IF SelectFields.RUNMODAL = ACTION::OK THEN BEGIN
                                 SelectFields.GetSelectedFields(TmpFld);
                                 UpdateTableFields(FALSE, "Sub Table No.", TmpFld);
                                 CurrPage.UPDATE(TRUE);
                               END;
                             END;
                              }

    { 1903121901;1;Group  ;
                CaptionML=[ENU=Options;
                           NLD=Opties] }

    { 1000073;2;Field     ;
                SourceExpr="Run Task";
                Editable="Run TaskEditable" }

    { 1000085;2;Field     ;
                SourceExpr="Project Code";
                Editable="Project CodeEditable" }

    { 1000009;2;Field     ;
                SourceExpr="Company Name" }

    { 1000060;2;Field     ;
                SourceExpr="XML Declaration";
                Enabled="XML DeclarationEnable";
                Editable="XML DeclarationEditable" }

    { 1100512000;2;Field  ;
                SourceExpr="Run Codeunit No.";
                Visible=FALSE;
                Editable="Run Codeunit No.Editable";
                OnLookup=VAR
                           Mgt@1100512000 : Codeunit 11148589;
                         BEGIN
                           EXIT(Mgt.LookupObjectNo(5, Text));
                         END;
                          }

    { 1000058;2;Field     ;
                SourceExpr="One File per Record";
                Enabled="One File per RecordEnable";
                Editable="One File per RecordEditable" }

    { 1903203501;1;Group  ;
                CaptionML=[ENU=Synchronization;
                           NLD=Synchronisatie] }

    { 1000081;2;Field     ;
                SourceExpr=Synchronize;
                Enabled=SynchronizeEnable;
                Editable=SynchronizeEditable }

    { 1000075;2;Field     ;
                SourceExpr="Destination Company";
                Enabled="Destination CompanyEnable";
                Editable="Destination CompanyEditable";
                OnLookup=BEGIN
                           EXIT(LookupCompanyName(Text));
                         END;
                          }

    { 1000077;2;Field     ;
                SourceExpr="Import Code";
                Enabled="Import CodeEnable";
                Editable="Import CodeEditable";
                OnLookup=BEGIN
                           EXIT(LookupImportCode(Text));
                         END;
                          }

    { 1000079;2;Field     ;
                SourceExpr="Use Inbox";
                Enabled="Use InboxEnable";
                Editable="Use InboxEditable" }

  }
  CODE
  {
    VAR
      INMgt@1000000000 : Codeunit 11148589;
      CodeEditable@19001698 : Boolean INDATASET;
      DescriptionEditable@19061412 : Boolean INDATASET;
      LocationEditable@19035910 : Boolean INDATASET;
      "Filename TypeEditable"@19038575 : Boolean INDATASET;
      FilenameEditable@19007928 : Boolean INDATASET;
      "File FormatEditable"@19047526 : Boolean INDATASET;
      "Save to MessagesEditable"@19046008 : Boolean INDATASET;
      "One File per RecordEditable"@19079091 : Boolean INDATASET;
      "XML DeclarationEditable"@19065729 : Boolean INDATASET;
      "Run Codeunit No.Editable"@19055664 : Boolean INDATASET;
      "Run TaskEditable"@19005185 : Boolean INDATASET;
      "Main Table No.Editable"@19066361 : Boolean INDATASET;
      "Main Table FilterEditable"@19035070 : Boolean INDATASET;
      "Sub Table FilterEditable"@19045437 : Boolean INDATASET;
      "Sub Table No.Editable"@19054278 : Boolean INDATASET;
      "Destination CompanyEditable"@19019803 : Boolean INDATASET;
      "Import CodeEditable"@19076700 : Boolean INDATASET;
      "Use InboxEditable"@19076602 : Boolean INDATASET;
      SynchronizeEditable@19064614 : Boolean INDATASET;
      "Project CodeEditable"@19062497 : Boolean INDATASET;
      LinesEditable@19010511 : Boolean INDATASET;
      "One File per RecordEnable"@19061946 : Boolean INDATASET;
      "XML DeclarationEnable"@19065324 : Boolean INDATASET;
      SynchronizeEnable@19026225 : Boolean INDATASET;
      "Destination CompanyEnable"@19000449 : Boolean INDATASET;
      "Import CodeEnable"@19062516 : Boolean INDATASET;
      "Use InboxEnable"@19062506 : Boolean INDATASET;
      LocationEnable@19013618 : Boolean INDATASET;
      FilenameEnable@19043700 : Boolean INDATASET;
      "Filename TypeEnable"@19052158 : Boolean INDATASET;
      "Save to MessagesEnable"@19010110 : Boolean INDATASET;
      "Sub Table No.Enable"@19033464 : Boolean INDATASET;
      "Sub Table FilterEnable"@19073453 : Boolean INDATASET;
      "Sub Table No. of FieldsEnable"@19016380 : Boolean INDATASET;
      LeftEnable@19065291 : Boolean INDATASET;
      RightEnable@19037326 : Boolean INDATASET;

    LOCAL PROCEDURE EnableFields@1000000();
    BEGIN
      LocationEnable := "File Format" <> "File Format"::ADO;
      FilenameEnable := "File Format" <> "File Format"::ADO;
      "Filename TypeEnable" := "File Format" <> "File Format"::ADO;
      "Save to MessagesEnable" := "File Format" <> "File Format"::ADO;

      "Sub Table No.Enable" := "File Format" <> "File Format"::ADO;
      "Sub Table FilterEnable" := "File Format" <> "File Format"::ADO;
      "Sub Table No. of FieldsEnable" := "File Format" <> "File Format"::ADO;

      "One File per RecordEnable" := "File Format" = "File Format"::XML;
      "XML DeclarationEnable" := "File Format" = "File Format"::XML;

      SynchronizeEnable := "File Format" = "File Format"::XML;
      "Destination CompanyEnable" := "File Format" = "File Format"::XML;
      "Import CodeEnable" := "File Format" = "File Format"::XML;
      "Use InboxEnable" := "File Format" = "File Format"::XML;

      LeftEnable := "File Format" <> "File Format"::ADO;
      RightEnable := "File Format" <> "File Format"::ADO;
    END;

    LOCAL PROCEDURE SetFileFormatToLines@1000002();
    BEGIN
      CurrPage.Lines.PAGE.SetFileFormat("File Format");
    END;

    LOCAL PROCEDURE SetEditable@1000003();
    BEGIN
      CodeEditable := (Status = Status::Edit);
      DescriptionEditable := (Status = Status::Edit);
      LocationEditable := (Status = Status::Edit);
      "Filename TypeEditable" := (Status = Status::Edit);
      FilenameEditable := (Status = Status::Edit);
      "File FormatEditable" := (Status = Status::Edit);
      "Save to MessagesEditable" := (Status = Status::Edit);
      "One File per RecordEditable" := (Status = Status::Edit);
      "XML DeclarationEditable" := (Status = Status::Edit);
      "Run Codeunit No.Editable" := (Status = Status::Edit);
      "Run TaskEditable" := (Status = Status::Edit);
      "Main Table No.Editable" := (Status = Status::Edit);
      "Main Table FilterEditable" := (Status = Status::Edit);
      "Sub Table FilterEditable" := (Status = Status::Edit);
      "Sub Table No.Editable" := (Status = Status::Edit);
      "Destination CompanyEditable" := (Status = Status::Edit);
      "Import CodeEditable" := (Status = Status::Edit);
      "Use InboxEditable" := (Status = Status::Edit);
      SynchronizeEditable := (Status = Status::Edit);
      "Project CodeEditable" := (Status = Status::Edit);
      LinesEditable := (Status = Status::Edit);
    END;

    LOCAL PROCEDURE StatusOnAfterValidate@19072689();
    BEGIN
      SetEditable;
    END;

    LOCAL PROCEDURE FileFormatOnAfterValidate@19065317();
    BEGIN
      EnableFields;

      SetFileFormatToLines;
      CurrPage.Lines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      xRec := Rec;
      IF FORMAT("Main Table Filter") = '' THEN
        EVALUATE("Main Table Filter", Mgt.EmptyTableFilter("Main Table No."));

      IF FORMAT("Sub Table Filter") = '' THEN
        EVALUATE("Sub Table Filter", Mgt.EmptyTableFilter("Sub Table No."));

      EnableFields;
      SetEditable;

      SetFileFormatToLines;
    END;

    LOCAL PROCEDURE LocationOnAfterInput@19074197(VAR Text@19074198 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFolder(Text);
    END;

    LOCAL PROCEDURE MainTableNoOnAfterInput@19047063(VAR Text@19047064 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE MainTableFilterOnAfterInput@19078863(VAR Text@19078864 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableFilter(Text, "Main Table No.");
    END;

    LOCAL PROCEDURE SubTableFilterOnAfterInput@19008895(VAR Text@19008896 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableFilter(Text, "Sub Table No.");
    END;

    LOCAL PROCEDURE SubTableNoOnAfterInput@19065603(VAR Text@19065604 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE RunCodeunitNoOnAfterInput@19017510(VAR Text@19017511 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputObjectNo(5, Text);
    END;

    LOCAL PROCEDURE DestinationCompanyOnAfterInput@19042812(VAR Text@19042813 : Text[1024]);
    BEGIN
      AfterInputCompanyName(Text);
    END;

    LOCAL PROCEDURE MainTableNoOnFormat@19079044(Text@19015475 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Main Table No.");
    END;

    LOCAL PROCEDURE MainTableFilterOnFormat@19021213(Text@19073443 : Text[1024]);
    VAR
      Mgt@1000002 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableFilter(Text, "Main Table No.");
    END;

    LOCAL PROCEDURE SubTableFilterOnFormat@19007760(Text@19036173 : Text[1024]);
    VAR
      Mgt@1000002 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableFilter(Text, "Sub Table No.");
    END;

    LOCAL PROCEDURE SubTableNoOnFormat@19052089(Text@19075565 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Sub Table No.");
    END;

    LOCAL PROCEDURE RunCodeunitNoOnFormat@19054474(Text@19073072 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatObjectNo(5, Text, "Run Codeunit No.");
    END;

    LOCAL PROCEDURE DestinationCompanyOnFormat@19068245(Text@19003057 : Text[1024]);
    BEGIN
      FormatCompanyName(Text);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117080 CI - XML Export Subform
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=XML Export Subform;
               NLD=XML Exportdefinitiesubform];
    SourceTable=Table11148600;
    SourceTableView=SORTING(Export Definition,Line No.);
    PageType=ListPart;
    OnInit=BEGIN
             "Option TypeEditable" := TRUE;
             CodeEditable := TRUE;
             "Conversion CodeEditable" := TRUE;
             LinktoTableTagNameEditable := TRUE;
             "Skip If EmptyEditable" := TRUE;
             "As AttributeEditable" := TRUE;
             "Table FilterEditable" := TRUE;
             "Field No.Editable" := TRUE;
             "Table No.Editable" := TRUE;
           END;

    OnAfterGetRecord=VAR
                       Mgt@1000000 : Codeunit 11148589;
                     BEGIN
                       "Option TypeHideValue" := FALSE;
                       "Tag NameIndent" := 0;
                       IF SYSTEM.FORMAT("Table Filter") = '' THEN
                         EVALUATE("Table Filter", Mgt.EmptyTableFilter("Table No."));
                       OnAfterGetCurrRecord;
                       TagNameOnFormat;
                       TableNoOnFormat(FORMAT("Table No."));
                       FieldNoOnFormat(FORMAT("Field No."));
                       TableFilterOnFormat(FORMAT("Table Filter"));
                       OptionTypeOnFormat;
                     END;

    OnNewRecord=BEGIN
                  SetupNewLine(xRec, BelowxRec);
                  OnAfterGetCurrRecord;
                END;

    OnModifyRecord=BEGIN
                     IF SYSTEM.FORMAT("Table Filter") <> '' THEN
                       VALIDATE("Table Filter");

                     EXIT(TRUE);
                   END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1902311204;1 ;ActionGroup;
                      CaptionML=[ENU=Export &Def.;
                                 NLD=&Exportdef.] }
      { 1903294104;2 ;Action    ;
                      ShortCutKey=Ctrl+L;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Link &Tables;
                                 NLD=Tabellen linken];
                      OnAction=BEGIN
                                 LinkTables;
                               END;
                                }
      { 1906069704;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+V;
                      CaptionML=[ENU=Set &Filter With Variables;
                                 NLD=Zet filter met variabelen];
                      OnAction=BEGIN
                                 _SetFilterWithVariables;
                               END;
                                }
      { 1000000004;1 ;Separator  }
      { 1000000000;1 ;Action    ;
                      Name=<Action1000000000>;
                      ShortCutKey=Shift+Ctrl+R;
                      CaptionML=[ENU=Right;
                                 NLD=Rechts];
                      Promoted=Yes;
                      OnAction=BEGIN
                                 Right;
                               END;
                                }
      { 1000000001;1 ;Action    ;
                      ShortCutKey=Shift+Ctrl+L;
                      CaptionML=[ENU=Left;
                                 NLD=Links];
                      OnAction=BEGIN
                                 Left;
                               END;
                                }
      { 1000000002;1 ;Action    ;
                      Name=<Action1000000002>;
                      ShortCutKey=Shift+Ctrl+U;
                      CaptionML=[ENU=Up;
                                 NLD=Omhoog];
                      OnAction=BEGIN
                                 Up;
                               END;
                                }
      { 1000000003;1 ;Action    ;
                      Name=<Action1000000003>;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Down;
                                 NLD=Omlaag];
                      OnAction=BEGIN
                                 Down;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                IndentationColumnName="Tag NameIndent";
                IndentationControls=Tag Name;
                GroupType=Repeater }

    { 1000011;2;Field     ;
                SourceExpr="Tag Name" }

    { 1000001;2;Field     ;
                SourceExpr=Type;
                OnValidate=BEGIN
                             TypeOnAfterValidate;
                           END;
                            }

    { 1000013;2;Field     ;
                SourceExpr=Code;
                Editable=CodeEditable }

    { 1000000010;2;Field  ;
                SourceExpr="Table No.";
                Editable="Table No.Editable";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           // IDYN EBK >>>>
                           IF Mgt.LookupTableNo(Text) THEN BEGIN
                             EVALUATE("Table No.",Text);
                             VALIDATE("Table No.");
                           END;
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //EXIT(Mgt.LookupTableNo(Text));
                           // IDYN EBK <<<<
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.AssistTableNo("Table No.");
                             END;
                              }

    { 1000000009;2;Field  ;
                Name=Table Name;
                SourceExpr="Table Name" }

    { 1000000008;2;Field  ;
                SourceExpr="Field No.";
                Editable="Field No.Editable";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           // IDYN EBK >>>>
                           IF Mgt.LookupFieldNo("Table No.",Text,TRUE) THEN BEGIN
                             EVALUATE("Field No.",Text);
                             VALIDATE("Field No.");
                           END;
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //EXIT(Mgt.LookupFieldNo("Table No.", Text, TRUE));
                           // IDYN EBK <<<<
                         END;
                          }

    { 1000000007;2;Field  ;
                Name=Field Name;
                SourceExpr="Field Name" }

    { 1100531000;2;Field  ;
                SourceExpr="No. of Functions";
                Visible=FALSE }

    { 1000031;2;Field     ;
                SourceExpr="Original Value";
                Visible=FALSE }

    { 1000015;2;Field     ;
                AssistEdit=Yes;
                SourceExpr="Table Filter";
                Editable="Table FilterEditable";
                OnAssistEdit=VAR
                               InMgt@1000000000 : Codeunit 11148589;
                             BEGIN
                               EVALUATE("Table Filter", InMgt.SetTableFilter("Table No.", FORMAT("Table Filter"))); // CI-143
                             END;
                              }

    { 1000023;2;Field     ;
                SourceExpr="Link to Table (Tag Name)";
                Editable=LinktoTableTagNameEditable;
                OnAssistEdit=BEGIN
                               SetupLinkToTable;
                             END;
                              }

    { 1000021;2;Field     ;
                SourceExpr="Conversion Code";
                Editable="Conversion CodeEditable" }

    { 1000025;2;Field     ;
                SourceExpr="Dest. Variable";
                Visible=FALSE }

    { 1000003;2;Field     ;
                SourceExpr="As Attribute";
                Visible=FALSE;
                Editable="As AttributeEditable" }

    { 1000035;2;Field     ;
                SourceExpr="Skip If Empty";
                Visible=FALSE;
                Editable="Skip If EmptyEditable" }

    { 1000017;2;Field     ;
                SourceExpr="Data Format";
                Visible=FALSE }

    { 1000033;2;Field     ;
                SourceExpr="Option Type";
                Visible=FALSE;
                Editable="Option TypeEditable";
                HideValue="Option TypeHideValue" }

    { 1000007;2;Field     ;
                SourceExpr="Before Field";
                Visible=FALSE }

    { 1000019;2;Field     ;
                SourceExpr="After Field";
                Visible=FALSE }

    { 1   ;2   ;Field     ;
                SourceExpr=Skip }

    { 1000000005;2;Field  ;
                SourceExpr="XML Namespace";
                Visible=FALSE }

    { 1000000006;2;Field  ;
                SourceExpr="XML Namespace Prefix";
                Visible=FALSE }

  }
  CODE
  {
    VAR
      FileFormat@1000000 : 'XML,CSV,FixedWidth,Excel';
      "Tag NameIndent"@19056250 : Integer INDATASET;
      "Option TypeHideValue"@19002310 : Boolean INDATASET;
      "Table No.Editable"@19076806 : Boolean INDATASET;
      "Field No.Editable"@19022826 : Boolean INDATASET;
      "Table FilterEditable"@19054732 : Boolean INDATASET;
      "As AttributeEditable"@19036675 : Boolean INDATASET;
      "Skip If EmptyEditable"@19053977 : Boolean INDATASET;
      LinktoTableTagNameEditable@19004008 : Boolean INDATASET;
      "Conversion CodeEditable"@19074872 : Boolean INDATASET;
      CodeEditable@19001698 : Boolean INDATASET;
      "Option TypeEditable"@19019138 : Boolean INDATASET;

    PROCEDURE Left@1000000();
    VAR
      ExportDefLine@1100512000 : Record 11148600;
    BEGIN
      CurrPage.SETSELECTIONFILTER(ExportDefLine);
      IF ExportDefLine.FINDSET THEN
        REPEAT
          IF ExportDefLine."Entry No." <> 0 THEN
            IF ExportDefLine.Indent > 0 THEN BEGIN
              ExportDefLine.Indent -= 1;
              ExportDefLine.MODIFY;
            END;
        UNTIL ExportDefLine.NEXT = 0;
    END;

    PROCEDURE Right@1000001();
    VAR
      ExportDefLine@1100512000 : Record 11148600;
    BEGIN
      CurrPage.SETSELECTIONFILTER(ExportDefLine);
      IF ExportDefLine.FINDSET THEN
        REPEAT
          IF ExportDefLine."Entry No." <> 0 THEN BEGIN
            ExportDefLine.Indent += 1;
            ExportDefLine.MODIFY;
            CurrPage.SETSELECTIONFILTER(ExportDefLine);
          END;
        UNTIL ExportDefLine.NEXT = 0;
    END;

    PROCEDURE Up@1000011();
    VAR
      CurrLine@1000004 : Record 11148600;
      ExportDefinitionLine@1000000 : Record 11148600;
      SelectedLine@1000002 : Record 11148600;
      LineNo@1000001 : Integer;
    BEGIN
      CurrLine := Rec;

      CurrPage.SETSELECTIONFILTER(SelectedLine);
      IF SelectedLine.COUNT = 0 THEN BEGIN
        SelectedLine.RESET;
        SelectedLine := Rec;
        SelectedLine.SETRECFILTER;
      END;

      IF SelectedLine.FINDSET THEN
        REPEAT
          ExportDefinitionLine.SETCURRENTKEY("Export Definition", "Line No.");
          ExportDefinitionLine.SETRANGE("Export Definition", "Export Definition");
          ExportDefinitionLine := SelectedLine;
          IF ExportDefinitionLine.NEXT(-1) <> 0 THEN BEGIN
            LineNo := ExportDefinitionLine."Line No.";
            ExportDefinitionLine."Line No." := SelectedLine."Line No.";
            ExportDefinitionLine.MODIFY;
            SelectedLine."Line No." := LineNo;
            SelectedLine.MODIFY;
          END;
        UNTIL SelectedLine.NEXT = 0;

      GET(CurrLine."Export Definition", CurrLine."Entry No.");
    END;

    PROCEDURE Down@1000010();
    VAR
      CurrLine@1000004 : Record 11148600;
      ExportDefinitionLine@1000006 : Record 11148600;
      SelectedLine@1000005 : Record 11148600;
      LineNo@1000000 : Integer;
    BEGIN
      CurrLine := Rec;

      CurrPage.SETSELECTIONFILTER(SelectedLine);
      IF SelectedLine.COUNT = 0 THEN BEGIN
        SelectedLine.RESET;
        SelectedLine := Rec;
        SelectedLine.SETRECFILTER;
      END;

      IF SelectedLine.FINDLAST THEN
        REPEAT
          ExportDefinitionLine.SETCURRENTKEY("Export Definition", "Line No.");
          ExportDefinitionLine.SETRANGE("Export Definition", "Export Definition");
          ExportDefinitionLine := SelectedLine;
          IF ExportDefinitionLine.NEXT(1) <> 0 THEN BEGIN
            LineNo := ExportDefinitionLine."Line No.";
            ExportDefinitionLine."Line No." := SelectedLine."Line No.";
            ExportDefinitionLine.MODIFY;
            SelectedLine."Line No." := LineNo;
            SelectedLine.MODIFY;
          END;
        UNTIL SelectedLine.NEXT(-1) = 0;

      GET(CurrLine."Export Definition", CurrLine."Entry No.");
    END;

    PROCEDURE LinkTables@1000002();
    BEGIN
      SetupLinkToTable;
    END;

    PROCEDURE UpdateForm@1000003();
    BEGIN
      CurrPage.UPDATE(FALSE);
    END;

    PROCEDURE SetFileFormat@1000008(NewValue@1000000 : Option);
    BEGIN
      FileFormat := NewValue;
    END;

    LOCAL PROCEDURE SetFieldEditable@1000007();
    BEGIN
      "Table No.Editable" := (Type IN [Type::Field, Type::Table, Type::Const]);

      IF FileFormat = FileFormat::XML THEN BEGIN
        "Field No.Editable" := (Type = Type::Field);
        "Table FilterEditable" := (Type = Type::Table);
        "As AttributeEditable" := (TRUE);
        "Skip If EmptyEditable" := (TRUE);
      END ELSE BEGIN
        "Field No.Editable" := (Type IN [Type::Field, Type::Table, Type::Const]);
        "Table FilterEditable" := (Type IN [Type::Table, Type::Field, Type::Const]);
        "As AttributeEditable" := (FALSE);
        "Skip If EmptyEditable" := (FALSE);
      END;

      LinktoTableTagNameEditable := (
        ((FileFormat = FileFormat::XML) AND (Type = Type::Table)) OR
        (FileFormat <> FileFormat::XML));
      "Conversion CodeEditable" := (Type IN [Type::Field, Type::Table, Type::Const]);

      CodeEditable := (Type IN [Type::Const, Type::Variable, Type::"6"]);
      "Option TypeEditable" := (Type = Type::Field);
    END;

    PROCEDURE _SetFilterWithVariables@19012358();
    BEGIN
      SetFilterWithVariables;
    END;

    PROCEDURE SetFilterWithVariables@1000009();
    BEGIN
      SetFilterWithVariables;
    END;

    LOCAL PROCEDURE TypeOnAfterValidate@19069045();
    BEGIN
      SetFieldEditable;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      SetFieldEditable;
    END;

    LOCAL PROCEDURE TableNoOnAfterInput@19060375(VAR Text@19060376 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE FieldNoOnAfterInput@19063566(VAR Text@19063567 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFieldNo(Text, "Table No.", FALSE);
    END;

    LOCAL PROCEDURE TableFilterOnAfterInput@19072298(VAR Text@19072299 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableFilter(Text, "Table No.");
    END;

    LOCAL PROCEDURE TagNameOnFormat@19023679();
    BEGIN
      "Tag NameIndent" := Indent;
    END;

    LOCAL PROCEDURE TableNoOnFormat@19071785(Text@19016339 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Table No.");
    END;

    LOCAL PROCEDURE FieldNoOnFormat@19075355(Text@19041114 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatFieldNo(Text, "Table No.", "Field No.");
    END;

    LOCAL PROCEDURE TableFilterOnFormat@19013929(Text@19048068 : Text[1024]);
    VAR
      Mgt@1000002 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableFilter(Text, "Table No.");
    END;

    LOCAL PROCEDURE OptionTypeOnFormat@19077341();
    BEGIN
      IF Type <> Type::Field THEN
        "Option TypeHideValue" := TRUE;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117081 CI - CSV Export Card
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=CSV Export Card;
               NLD=CSV Exportdefinitie];
    SourceTable=Table11148599;
    SourceTableView=WHERE(File Format=CONST(CSV));
    PageType=Card;
    OnInit=BEGIN
             RightEnable := TRUE;
             LeftEnable := TRUE;
             "Sub Table No. of FieldsEnable" := TRUE;
             "Sub Table FilterEnable" := TRUE;
             "Sub Table No.Enable" := TRUE;
             "Save to MessagesEnable" := TRUE;
             "Filename TypeEnable" := TRUE;
             FilenameEnable := TRUE;
             LocationEnable := TRUE;
             "Field SeparatorEnable" := TRUE;
             "Field DelimiterEnable" := TRUE;
             LinesEditable := TRUE;
             "Project CodeEditable" := TRUE;
             "Sub Table No.Editable" := TRUE;
             "Sub Table FilterEditable" := TRUE;
             "Main Table FilterEditable" := TRUE;
             "Main Table No.Editable" := TRUE;
             "Run TaskEditable" := TRUE;
             "Run Codeunit No.Editable" := TRUE;
             "Field SeparatorEditable" := TRUE;
             "Field DelimiterEditable" := TRUE;
             "Save to MessagesEditable" := TRUE;
             HeadersEditable := TRUE;
             "File FormatEditable" := TRUE;
             FilenameEditable := TRUE;
             "Filename TypeEditable" := TRUE;
             LocationEditable := TRUE;
             DescriptionEditable := TRUE;
             CodeEditable := TRUE;
           END;

    OnOpenPage=VAR
                 Initialize@1000001 : Codeunit 11148625;
               BEGIN
                 Initialize.CheckInitialize;
               END;

    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                       MainTableNoOnFormat(FORMAT("Main Table No."));
                       MainTableFilterOnFormat(FORMAT("Main Table Filter"));
                       SubTableFilterOnFormat(FORMAT("Sub Table Filter"));
                       SubTableNoOnFormat(FORMAT("Sub Table No."));
                       RunCodeunitNoOnFormat(FORMAT("Run Codeunit No."));
                     END;

    OnNewRecord=VAR
                  Setup@1000000 : Record 11148589;
                BEGIN
                  Setup.GET;
                  "XML Declaration" := Setup."XML Declaration";
                  Location := Setup."Default Export Location";

                  "File Format" := "File Format"::CSV;
                  OnAfterGetCurrRecord;
                END;

    OnModifyRecord=BEGIN
                     VALIDATE("Main Table Filter");
                     VALIDATE("Sub Table Filter");

                     EXIT(TRUE);
                   END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000049 ;1   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Process;
                                 NLD=Verwerken];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Setup@1100512001 : Record 11148589;
                                 ProcessExportDef@1000002 : Codeunit 11148606;
                                 Progressbar@1000001 : Codeunit 11148624;
                                 ErrorMgt@1000006 : Codeunit 11148630;
                                 FileExported@1000004 : Boolean;
                                 ctDataExported@1000007 : TextConst 'ENU=Data exported;NLD=Data gexporteerd.';
                                 ctExportCancelled@1000005 : TextConst 'ENU=Export cancelled.;NLD=Exporteren afgebroken.';
                                 ctFileCreated@1000003 : TextConst 'ENU=Export processed.;NLD=Export verwerkt.';
                               BEGIN
                                 ErrorMgt.ClearError;

                                 TestRecordSet;

                                 Progressbar.Open(1);

                                 Setup.GET;
                                 IF Setup."Use Error Handling" THEN
                                   FileExported := ProcessExportDef.RUN(Rec)
                                 ELSE BEGIN
                                   ProcessExportDef.RUN(Rec);
                                   FileExported := TRUE;
                                 END;

                                 Progressbar.Close;

                                 IF FileExported THEN
                                   IF "File Format" = "File Format"::ADO THEN
                                     MESSAGE(ctDataExported)
                                   ELSE
                                     MESSAGE(ctFileCreated)
                                 ELSE BEGIN
                                   AddTraceEntry(TRUE, ErrorMgt.GetError, 0);
                                   IF ErrorMgt.GetError = '' THEN
                                     MESSAGE(ctExportCancelled)
                                   ELSE
                                     MESSAGE(ErrorMgt.GetError);
                                 END;
                               END;
                                }
      { 1000072 ;1   ;Action    ;
                      CaptionML=[ENU=Copy;
                                 NLD=Kopiren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Copy;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Copy;
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1000000001;1 ;Action    ;
                      Name=<Action1000000000>;
                      CaptionML=[ENU=Copy To;
                                 NLD=Kopiren naar];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Copy;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CopyTo;
                               END;
                                }
      { 1000000000;1 ;ActionGroup;
                      CaptionML=[ENU=Move;
                                 NLD=Verplaatsen] }
      { 1000050 ;2   ;Action    ;
                      Name=Left;
                      Promoted=Yes;
                      Enabled=LeftEnable;
                      PromotedIsBig=Yes;
                      Image=PreviousSet;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+L');
                               END;
                                }
      { 1000048 ;2   ;Action    ;
                      Name=Right;
                      Promoted=Yes;
                      Enabled=RightEnable;
                      PromotedIsBig=Yes;
                      Image=NextSet;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+R');
                               END;
                                }
      { 1000047 ;2   ;Action    ;
                      Name=<Action1000047>;
                      CaptionML=[ENU=Up;
                                 NLD=Omhoog];
                      Promoted=Yes;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+U');
                               END;
                                }
      { 1000028 ;2   ;Action    ;
                      Name=<Action1000028>;
                      CaptionML=[ENU=Down;
                                 NLD=Omlaag];
                      Promoted=Yes;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+D');
                               END;
                                }
      { 1000000002;1 ;ActionGroup;
                      CaptionML=[ENU=Messages and History;
                                 NLD=Berichten en historie] }
      { 1000056 ;2   ;Action    ;
                      ShortCutKey=Ctrl+F5;
                      CaptionML=[ENU=Messages;
                                 NLD=Berichten];
                      RunObject=Page 11117032;
                      RunPageView=SORTING(Entry No.);
                      RunPageLink=Type=CONST(Export),
                                  Code=FIELD(Code);
                      Promoted=Yes;
                      Image=Note;
                      PromotedCategory=Process }
      { 1000057 ;2   ;Action    ;
                      CaptionML=[ENU=History;
                                 NLD=Historie];
                      RunObject=Page 11117034;
                      RunPageView=SORTING(Type,Code);
                      RunPageLink=Type=CONST(Export),
                                  Code=FIELD(Code);
                      Image=History }
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000016 ;1   ;ActionGroup;
                      CaptionML=[ENU=Export &Def.;
                                 NLD=&Exportdef.] }
      { 1100531001;2 ;Action    ;
                      ShortCutKey=Ctrl+Alt+V;
                      CaptionML=[ENU=Versions;
                                 NLD=Versies];
                      RunObject=Page 11117096;
                      RunPageView=SORTING(Code,Version No.);
                      RunPageLink=Code=FIELD(Code) }
      { 1100531000;2 ;Action    ;
                      ShortCutKey=Ctrl+S;
                      CaptionML=[ENU=Save as New Version;
                                 NLD=Op&slaan als nieuwe versie];
                      OnAction=BEGIN
                                 SaveNewVersion;
                               END;
                                }
      { 1000043 ;2   ;Separator  }
      { 1000044 ;2   ;Action    ;
                      CaptionML=[ENU=M&onitoring Setup;
                                 NLD=Monitoringinstellingen];
                      RunObject=Page 11117027;
                      RunPageView=SORTING(Export Definition);
                      RunPageLink=Export Definition=FIELD(Code) }
      { 1000045 ;2   ;Action    ;
                      CaptionML=[ENU=Export Jobs;
                                 NLD=E&xporteeropdrachten];
                      RunObject=Page 11117028;
                      RunPageView=SORTING(Status,Export Definition);
                      RunPageLink=Export Definition=FIELD(Code) }
      { 1000021 ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NLD=F&uncties] }
      { 1000046 ;2   ;Action    ;
                      CaptionML=[ENU=Renumber Lines;
                                 NLD=Regels hernummeren];
                      OnAction=BEGIN
                                 RenumberLines;
                               END;
                                }
      { 1000095 ;2   ;Action    ;
                      CaptionML=[ENU=Reversed Data &Mapping;
                                 NLD=Reversed data&mapping];
                      OnAction=BEGIN
                                 ReversedDataMapping;
                               END;
                                }
      { 1000071 ;2   ;Separator  }
      { 1000070 ;2   ;Action    ;
                      CaptionML=[ENU=Pri&nt;
                                 NLD=Afdrukken];
                      OnAction=VAR
                                 ExportDefinition@1000000 : Record 11148599;
                               BEGIN
                                 ExportDefinition := Rec;
                                 ExportDefinition.SETRECFILTER;
                                 REPORT.RUN(REPORT::"CI - Export Definitions", TRUE, FALSE, ExportDefinition);
                               END;
                                }
      { 1000089 ;2   ;Separator  }
      { 1000090 ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Import Definition from XML;
                                 NLD=XML-Definitie &importeren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Import;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ImportXMLDefinition@1000000 : Codeunit 11148636;
                               BEGIN
                                 ImportXMLDefinition.ImportExportDefinition(Rec);
                               END;
                                }
      { 1000088 ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Export Definition to &XML;
                                 NLD=Definitie exporteren naar &XML];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Export;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ExportDefinitionToXML@1000000 : Codeunit 11148634;
                               BEGIN
                                 ExportDefinitionToXML.ExportExportDefinition(Rec);
                               END;
                                }
      { 1000068 ;2   ;Separator  }
      { 1000069 ;2   ;Action    ;
                      CaptionML=[ENU=Create M&onitoring Line;
                                 NLD=M&onitorregel aanmaken];
                      OnAction=BEGIN
                                 CreateMonitoringLine;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                CaptionML=[ENU=General;
                           NLD=Algemeen] }

    { 1000001;2;Field     ;
                SourceExpr=Code;
                Editable=CodeEditable }

    { 1000003;2;Field     ;
                SourceExpr=Description;
                Editable=DescriptionEditable }

    { 1000005;2;Field     ;
                SourceExpr=Location;
                Enabled=LocationEnable;
                Editable=LocationEditable;
                OnValidate=VAR
                             Mgt@1000000000 : Codeunit 11148589;
                           BEGIN
                             Mgt.AfterInputFolder(Location);
                           END;

                OnLookup=VAR
                           Mgt@1000001 : Codeunit 11148589;
                           NewFolder@1000000 : Text[1024];
                         BEGIN
                           NewFolder := Mgt.BrowseForFolder('', '');
                           IF NewFolder <> '' THEN
                             Location := NewFolder;
                         END;

                OnAssistEdit=VAR
                               Mgt@1000001 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder(Location);
                             END;
                              }

    { 1000014;2;Field     ;
                SourceExpr=Filename;
                Enabled=FilenameEnable;
                Editable=FilenameEditable }

    { 1000083;2;Field     ;
                SourceExpr="Filename Type";
                Enabled="Filename TypeEnable";
                Editable="Filename TypeEditable" }

    { 1000011;2;Field     ;
                SourceExpr=Status;
                ValuesAllowed=[Edit;Manual;Automated;Blocked];
                OnValidate=BEGIN
                             StatusOnAfterValidate;
                           END;
                            }

    { 1000052;2;Field     ;
                SourceExpr="Save to Messages";
                Enabled="Save to MessagesEnable";
                Editable="Save to MessagesEditable" }

    { 1000039;2;Field     ;
                SourceExpr="No. of Monitoring Lines" }

    { 1000041;2;Field     ;
                SourceExpr="No. of Export Jobs" }

    { 1000024;1;Part      ;
                Name=Lines;
                SubPageLink=Export Definition=FIELD(Code);
                PagePartID=Page11117082;
                Editable=LinesEditable }

    { 1905328801;1;Group  ;
                CaptionML=[ENU=Field Selection;
                           NLD=Veldselectie] }

    { 1000010;2;Field     ;
                SourceExpr="Main Table No.";
                Editable="Main Table No.Editable";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           // IDYN EBK >>>>
                           IF Mgt.LookupTableNo(Text) THEN BEGIN
                             EVALUATE("Main Table No.",Text);
                             VALIDATE("Main Table No.");
                           END;
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //EXIT(Mgt.LookupTableNo(Text));
                           // IDYN EBK <<<<
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.AssistTableNo("Main Table No.");
                             END;
                              }

    { 1000035;2;Field     ;
                AssistEdit=Yes;
                SourceExpr="Main Table Filter";
                Editable="Main Table FilterEditable";
                OnAssistEdit=BEGIN
                               EVALUATE("Main Table Filter",INMgt.SetTableFilter("Main Table No.",FORMAT("Main Table Filter")));
                             END;
                              }

    { 1000031;2;Field     ;
                DrillDown=No;
                SourceExpr="Main Table No. of Fields";
                OnAssistEdit=VAR
                               TmpFld@1000001 : TEMPORARY Record 2000000041;
                               SelectFields@1000000 : Page 11148589;
                             BEGIN
                               TESTFIELD("Main Table No.");

                               SelectFields.SetExportDefinition(TRUE, Rec);
                               SelectFields.SetFormBlocked(Status <> Status::Edit);
                               IF SelectFields.RUNMODAL = ACTION::OK THEN BEGIN
                                 SelectFields.GetSelectedFields(TmpFld);
                                 UpdateTableFields(TRUE, "Main Table No.", TmpFld);
                                 CurrPage.UPDATE(TRUE);
                               END;
                             END;
                              }

    { 1000025;2;Field     ;
                SourceExpr="Sub Table No.";
                Enabled="Sub Table No.Enable";
                Editable="Sub Table No.Editable";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           IF Mgt.LookupTableNo(Text) THEN BEGIN
                             EVALUATE("Sub Table No.",Text);
                             VALIDATE("Sub Table No.");
                           END;

                           // IDYN EBK >>>>
                           //Mgt.LookupRelatedTableNo("Main Table No.",Text);
                           //EVALUATE("Sub Table No.",Text);
                           //VALIDATE("Sub Table No.");
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //EXIT(Mgt.LookupRelatedTableNo("Main Table No.", Text));
                           // IDYN EBK <<<<
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.AssistTableNo("Main Table No.");
                             END;
                              }

    { 1000037;2;Field     ;
                AssistEdit=Yes;
                SourceExpr="Sub Table Filter";
                Enabled="Sub Table FilterEnable";
                Editable="Sub Table FilterEditable";
                OnAssistEdit=BEGIN
                               EVALUATE("Sub Table Filter",INMgt.SetTableFilter("Sub Table No.",FORMAT("Sub Table Filter")));
                             END;
                              }

    { 1000033;2;Field     ;
                DrillDown=No;
                SourceExpr="Sub Table No. of Fields";
                Enabled="Sub Table No. of FieldsEnable";
                OnAssistEdit=VAR
                               TmpFld@1000001 : TEMPORARY Record 2000000041;
                               SelectFields@1000000 : Page 11148589;
                             BEGIN
                               TESTFIELD("Sub Table No.");

                               SelectFields.SetExportDefinition(FALSE, Rec);
                               SelectFields.SetFormBlocked(Status <> Status::Edit);
                               IF SelectFields.RUNMODAL = ACTION::OK THEN BEGIN
                                 SelectFields.GetSelectedFields(TmpFld);
                                 UpdateTableFields(FALSE, "Sub Table No.", TmpFld);
                                 CurrPage.UPDATE(TRUE);
                               END;
                             END;
                              }

    { 1903121901;1;Group  ;
                CaptionML=[ENU=Options;
                           NLD=Opties] }

    { 1000073;2;Field     ;
                SourceExpr="Run Task";
                Editable="Run TaskEditable" }

    { 1000085;2;Field     ;
                SourceExpr="Project Code";
                Editable="Project CodeEditable" }

    { 1000009;2;Field     ;
                SourceExpr="Company Name" }

    { 1000062;2;Field     ;
                SourceExpr="Field Delimiter";
                Enabled="Field DelimiterEnable";
                Editable="Field DelimiterEditable" }

    { 1000000003;2;Field  ;
                SourceExpr="Delimiter Method";
                Enabled="Field DelimiterEditable";
                Editable="Field DelimiterEditable" }

    { 1000064;2;Field     ;
                SourceExpr="Field Separator";
                Enabled="Field SeparatorEnable";
                Editable="Field SeparatorEditable" }

    { 1000027;2;Field     ;
                SourceExpr=Headers;
                Enabled=HeadersEnable;
                Editable=HeadersEditable }

    { 1100512000;2;Field  ;
                SourceExpr="Run Codeunit No.";
                Visible=FALSE;
                Editable="Run Codeunit No.Editable";
                OnLookup=VAR
                           Mgt@1100512000 : Codeunit 11148589;
                         BEGIN
                           EXIT(Mgt.LookupObjectNo(5, Text));
                         END;
                          }

  }
  CODE
  {
    VAR
      INMgt@1000000001 : Codeunit 11148589;
      CodeEditable@19001698 : Boolean INDATASET;
      DescriptionEditable@19061412 : Boolean INDATASET;
      LocationEditable@19035910 : Boolean INDATASET;
      "Filename TypeEditable"@19038575 : Boolean INDATASET;
      FilenameEditable@19007928 : Boolean INDATASET;
      "File FormatEditable"@19047526 : Boolean INDATASET;
      HeadersEditable@19062436 : Boolean INDATASET;
      "Save to MessagesEditable"@19046008 : Boolean INDATASET;
      "Field DelimiterEditable"@19049277 : Boolean INDATASET;
      "Field SeparatorEditable"@19009402 : Boolean INDATASET;
      "Run Codeunit No.Editable"@19055664 : Boolean INDATASET;
      "Run TaskEditable"@19005185 : Boolean INDATASET;
      "Main Table No.Editable"@19066361 : Boolean INDATASET;
      "Main Table FilterEditable"@19035070 : Boolean INDATASET;
      "Sub Table FilterEditable"@19045437 : Boolean INDATASET;
      "Sub Table No.Editable"@19054278 : Boolean INDATASET;
      "Project CodeEditable"@19062497 : Boolean INDATASET;
      LinesEditable@19010511 : Boolean INDATASET;
      "Field DelimiterEnable"@19000188 : Boolean INDATASET;
      "Field SeparatorEnable"@19035090 : Boolean INDATASET;
      LocationEnable@19013618 : Boolean INDATASET;
      FilenameEnable@19043700 : Boolean INDATASET;
      "Filename TypeEnable"@19052158 : Boolean INDATASET;
      "Save to MessagesEnable"@19010110 : Boolean INDATASET;
      "Sub Table No.Enable"@19033464 : Boolean INDATASET;
      "Sub Table FilterEnable"@19073453 : Boolean INDATASET;
      "Sub Table No. of FieldsEnable"@19016380 : Boolean INDATASET;
      LeftEnable@19065291 : Boolean INDATASET;
      RightEnable@19037326 : Boolean INDATASET;
      HeadersEnable@1000000000 : Boolean INDATASET;

    LOCAL PROCEDURE EnableFields@1000000();
    BEGIN
      LocationEnable := "File Format" <> "File Format"::ADO;
      FilenameEnable := "File Format" <> "File Format"::ADO;
      "Filename TypeEnable" := "File Format" <> "File Format"::ADO;
      "Save to MessagesEnable" := "File Format" <> "File Format"::ADO;

      "Sub Table No.Enable" := "File Format" <> "File Format"::ADO;
      "Sub Table FilterEnable" := "File Format" <> "File Format"::ADO;
      "Sub Table No. of FieldsEnable" := "File Format" <> "File Format"::ADO;

      HeadersEnable := "File Format" IN ["File Format"::CSV, "File Format"::"Fixed Width", "File Format"::Excel];
      "Field DelimiterEnable" := "File Format" = "File Format"::CSV;
      "Field SeparatorEnable" := "File Format" = "File Format"::CSV;

      LeftEnable := "File Format" <> "File Format"::ADO;
      RightEnable := "File Format" <> "File Format"::ADO;
    END;

    LOCAL PROCEDURE SetFileFormatToLines@1000002();
    BEGIN
      CurrPage.Lines.PAGE.SetFileFormat("File Format");
    END;

    LOCAL PROCEDURE SetEditable@1000003();
    BEGIN
      CodeEditable := (Status = Status::Edit);
      DescriptionEditable := (Status = Status::Edit);
      LocationEditable := (Status = Status::Edit);
      "Filename TypeEditable" := (Status = Status::Edit);
      FilenameEditable := (Status = Status::Edit);
      "File FormatEditable" := (Status = Status::Edit);
      HeadersEditable := (Status = Status::Edit);
      "Save to MessagesEditable" := (Status = Status::Edit);
      "Field DelimiterEditable" := (Status = Status::Edit);
      "Field SeparatorEditable" := (Status = Status::Edit);
      "Run Codeunit No.Editable" := (Status = Status::Edit);
      "Run TaskEditable" := (Status = Status::Edit);
      "Main Table No.Editable" := (Status = Status::Edit);
      "Main Table FilterEditable" := (Status = Status::Edit);
      "Sub Table FilterEditable" := (Status = Status::Edit);
      "Sub Table No.Editable" := (Status = Status::Edit);
      "Project CodeEditable" := (Status = Status::Edit);
      LinesEditable := (Status = Status::Edit);
    END;

    LOCAL PROCEDURE StatusOnAfterValidate@19072689();
    BEGIN
      SetEditable;
    END;

    LOCAL PROCEDURE FileFormatOnAfterValidate@19065317();
    BEGIN
      EnableFields;

      SetFileFormatToLines;
      CurrPage.Lines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      xRec := Rec;
      IF FORMAT("Main Table Filter") = '' THEN
        EVALUATE("Main Table Filter", Mgt.EmptyTableFilter("Main Table No."));

      IF FORMAT("Sub Table Filter") = '' THEN
        EVALUATE("Sub Table Filter", Mgt.EmptyTableFilter("Sub Table No."));

      EnableFields;
      SetEditable;

      SetFileFormatToLines;
    END;

    LOCAL PROCEDURE LocationOnAfterInput@19074197(VAR Text@19074198 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFolder(Text);
    END;

    LOCAL PROCEDURE MainTableNoOnAfterInput@19047063(VAR Text@19047064 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE MainTableFilterOnAfterInput@19078863(VAR Text@19078864 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableFilter(Text, "Main Table No.");
    END;

    LOCAL PROCEDURE SubTableFilterOnAfterInput@19008895(VAR Text@19008896 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableFilter(Text, "Sub Table No.");
    END;

    LOCAL PROCEDURE SubTableNoOnAfterInput@19065603(VAR Text@19065604 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE RunCodeunitNoOnAfterInput@19017510(VAR Text@19017511 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputObjectNo(5, Text);
    END;

    LOCAL PROCEDURE MainTableNoOnFormat@19079044(Text@19015475 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Main Table No.");
    END;

    LOCAL PROCEDURE MainTableFilterOnFormat@19021213(Text@19073443 : Text[1024]);
    VAR
      Mgt@1000002 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableFilter(Text, "Main Table No.");
    END;

    LOCAL PROCEDURE SubTableFilterOnFormat@19007760(Text@19036173 : Text[1024]);
    VAR
      Mgt@1000002 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableFilter(Text, "Sub Table No.");
    END;

    LOCAL PROCEDURE SubTableNoOnFormat@19052089(Text@19075565 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Sub Table No.");
    END;

    LOCAL PROCEDURE RunCodeunitNoOnFormat@19054474(Text@19073072 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatObjectNo(5, Text, "Run Codeunit No.");
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117082 CI - CSV Export Subform
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=CSV Export Subform;
               NLD=CSV Exportdefinitiesubform];
    SourceTable=Table11148600;
    SourceTableView=SORTING(Export Definition,Line No.);
    PageType=ListPart;
    OnInit=BEGIN
             "Option TypeEditable" := TRUE;
             CodeEditable := TRUE;
             "Conversion CodeEditable" := TRUE;
             LinktoTableTagNameEditable := TRUE;
             "Skip If EmptyEditable" := TRUE;
             "Table FilterEditable" := TRUE;
             "Field No.Editable" := TRUE;
             "Table No.Editable" := TRUE;
           END;

    OnAfterGetRecord=VAR
                       Mgt@1000000 : Codeunit 11148589;
                     BEGIN
                       "Option TypeHideValue" := FALSE;
                       "Tag NameIndent" := 0;
                       IF SYSTEM.FORMAT("Table Filter") = '' THEN
                         EVALUATE("Table Filter", Mgt.EmptyTableFilter("Table No."));
                       OnAfterGetCurrRecord;
                       TagNameOnFormat;
                       TableNoOnFormat(FORMAT("Table No."));
                       FieldNoOnFormat(FORMAT("Field No."));
                       TableFilterOnFormat(FORMAT("Table Filter"));
                       OptionTypeOnFormat;
                     END;

    OnNewRecord=BEGIN
                  SetupNewLine(xRec, BelowxRec);
                  OnAfterGetCurrRecord;
                END;

    OnModifyRecord=BEGIN
                     IF SYSTEM.FORMAT("Table Filter") <> '' THEN
                       VALIDATE("Table Filter");

                     EXIT(TRUE);
                   END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1902311204;1 ;ActionGroup;
                      CaptionML=[ENU=Export &Def.;
                                 NLD=&Exportdef.] }
      { 1903294104;2 ;Action    ;
                      ShortCutKey=Ctrl+L;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Link &Tables;
                                 NLD=Tabellen linken];
                      OnAction=BEGIN
                                 LinkTables;
                               END;
                                }
      { 1906069704;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+V;
                      CaptionML=[ENU=Set &Filter With Variables;
                                 NLD=Zet filter met variabelen];
                      OnAction=BEGIN
                                 _SetFilterWithVariables;
                               END;
                                }
      { 1000000005;1 ;Separator  }
      { 1000000003;1 ;Action    ;
                      Name=<Action1000000000>;
                      ShortCutKey=Shift+Ctrl+R;
                      CaptionML=[ENU=Right;
                                 NLD=Rechts];
                      Promoted=Yes;
                      OnAction=BEGIN
                                 Right;
                               END;
                                }
      { 1000000002;1 ;Action    ;
                      Name=<Action1000000001>;
                      ShortCutKey=Shift+Ctrl+L;
                      CaptionML=[ENU=Left;
                                 NLD=Links];
                      OnAction=BEGIN
                                 Left;
                               END;
                                }
      { 1000000001;1 ;Action    ;
                      Name=<Action1000000002>;
                      ShortCutKey=Shift+Ctrl+U;
                      CaptionML=[ENU=Up;
                                 NLD=Omhoog];
                      OnAction=BEGIN
                                 Up;
                               END;
                                }
      { 1000000000;1 ;Action    ;
                      Name=<Action1000000003>;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Down;
                                 NLD=Omlaag];
                      OnAction=BEGIN
                                 Down;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                IndentationColumnName="Tag NameIndent";
                IndentationControls=Tag Name;
                GroupType=Repeater }

    { 1000011;2;Field     ;
                SourceExpr="Tag Name" }

    { 1000001;2;Field     ;
                SourceExpr=Type;
                ValuesAllowed=[Table;Field;Const;Variable];
                OnValidate=BEGIN
                             TypeOnAfterValidate;
                           END;
                            }

    { 1000013;2;Field     ;
                SourceExpr=Code;
                Editable=CodeEditable }

    { 1000000008;2;Field  ;
                SourceExpr="Table No.";
                Editable="Table No.Editable";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           // IDYN EBK >>>>
                           IF Mgt.LookupTableNo(Text) THEN BEGIN
                             EVALUATE("Table No.",Text);
                             VALIDATE("Table No.");
                           END;
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //EXIT(Mgt.LookupTableNo(Text));
                           // IDYN EBK <<<<
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.AssistTableNo("Table No.");
                             END;
                              }

    { 1000000007;2;Field  ;
                Name=Table Name;
                SourceExpr="Table Name" }

    { 1000000006;2;Field  ;
                SourceExpr="Field No.";
                Editable="Field No.Editable";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           // IDYN EBK >>>>
                           IF Mgt.LookupFieldNo("Table No.",Text,TRUE) THEN BEGIN
                             EVALUATE("Field No.",Text);
                             VALIDATE("Field No.");
                           END;
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //EXIT(Mgt.LookupFieldNo("Table No.", Text, TRUE));
                           // IDYN EBK <<<<
                         END;
                          }

    { 1000000004;2;Field  ;
                Name=Field Name;
                SourceExpr="Field Name" }

    { 1100531000;2;Field  ;
                SourceExpr="No. of Functions";
                Visible=FALSE }

    { 1000031;2;Field     ;
                SourceExpr="Original Value";
                Visible=FALSE }

    { 1000015;2;Field     ;
                AssistEdit=Yes;
                SourceExpr="Table Filter";
                Editable="Table FilterEditable";
                OnAssistEdit=VAR
                               INMgt@1000000000 : Codeunit 11148589;
                             BEGIN
                               EVALUATE("Table Filter", INMgt.SetTableFilter("Table No.", FORMAT("Table Filter"))); // CI-143
                             END;
                              }

    { 1000023;2;Field     ;
                SourceExpr="Link to Table (Tag Name)";
                Editable=LinktoTableTagNameEditable;
                OnAssistEdit=BEGIN
                               SetupLinkToTable;
                             END;
                              }

    { 1000021;2;Field     ;
                SourceExpr="Conversion Code";
                Editable="Conversion CodeEditable" }

    { 1000025;2;Field     ;
                SourceExpr="Dest. Variable";
                Visible=FALSE }

    { 1000035;2;Field     ;
                SourceExpr="Skip If Empty";
                Visible=FALSE;
                Editable="Skip If EmptyEditable" }

    { 1000017;2;Field     ;
                SourceExpr="Data Format";
                Visible=FALSE }

    { 1000033;2;Field     ;
                SourceExpr="Option Type";
                Visible=FALSE;
                Editable="Option TypeEditable";
                HideValue="Option TypeHideValue" }

    { 1000007;2;Field     ;
                SourceExpr="Before Field";
                Visible=FALSE }

    { 1000019;2;Field     ;
                SourceExpr="After Field";
                Visible=FALSE }

  }
  CODE
  {
    VAR
      FileFormat@1000000 : 'XML,CSV,FixedWidth,Excel';
      "Tag NameIndent"@19056250 : Integer INDATASET;
      "Option TypeHideValue"@19002310 : Boolean INDATASET;
      "Table No.Editable"@19076806 : Boolean INDATASET;
      "Field No.Editable"@19022826 : Boolean INDATASET;
      "Table FilterEditable"@19054732 : Boolean INDATASET;
      "Skip If EmptyEditable"@19053977 : Boolean INDATASET;
      LinktoTableTagNameEditable@19004008 : Boolean INDATASET;
      "Conversion CodeEditable"@19074872 : Boolean INDATASET;
      CodeEditable@19001698 : Boolean INDATASET;
      "Option TypeEditable"@19019138 : Boolean INDATASET;

    PROCEDURE Left@1000000();
    VAR
      ExportDefLine@1100512000 : Record 11148600;
    BEGIN
      CurrPage.SETSELECTIONFILTER(ExportDefLine);
      IF ExportDefLine.FINDSET THEN
        REPEAT
          IF ExportDefLine."Entry No." <> 0 THEN
            IF ExportDefLine.Indent > 0 THEN BEGIN
              ExportDefLine.Indent -= 1;
              ExportDefLine.MODIFY;
            END;
        UNTIL ExportDefLine.NEXT = 0;
    END;

    PROCEDURE Right@1000001();
    VAR
      ExportDefLine@1100512000 : Record 11148600;
    BEGIN
      CurrPage.SETSELECTIONFILTER(ExportDefLine);
      IF ExportDefLine.FINDSET THEN
        REPEAT
          IF ExportDefLine."Entry No." <> 0 THEN BEGIN
            ExportDefLine.Indent += 1;
            ExportDefLine.MODIFY;
          END;
        UNTIL ExportDefLine.NEXT = 0;
    END;

    PROCEDURE Up@1000011();
    VAR
      CurrLine@1000004 : Record 11148600;
      ExportDefinitionLine@1000000 : Record 11148600;
      SelectedLine@1000002 : Record 11148600;
      LineNo@1000001 : Integer;
    BEGIN
      CurrLine := Rec;

      CurrPage.SETSELECTIONFILTER(SelectedLine);
      IF SelectedLine.COUNT = 0 THEN BEGIN
        SelectedLine.RESET;
        SelectedLine := Rec;
        SelectedLine.SETRECFILTER;
      END;

      IF SelectedLine.FINDSET THEN
        REPEAT
          ExportDefinitionLine.SETCURRENTKEY("Export Definition", "Line No.");
          ExportDefinitionLine.SETRANGE("Export Definition", "Export Definition");
          ExportDefinitionLine := SelectedLine;
          IF ExportDefinitionLine.NEXT(-1) <> 0 THEN BEGIN
            LineNo := ExportDefinitionLine."Line No.";
            ExportDefinitionLine."Line No." := SelectedLine."Line No.";
            ExportDefinitionLine.MODIFY;
            SelectedLine."Line No." := LineNo;
            SelectedLine.MODIFY;
          END;
        UNTIL SelectedLine.NEXT = 0;

      GET(CurrLine."Export Definition", CurrLine."Entry No.");
    END;

    PROCEDURE Down@1000010();
    VAR
      CurrLine@1000004 : Record 11148600;
      ExportDefinitionLine@1000006 : Record 11148600;
      SelectedLine@1000005 : Record 11148600;
      LineNo@1000000 : Integer;
    BEGIN
      CurrLine := Rec;

      CurrPage.SETSELECTIONFILTER(SelectedLine);
      IF SelectedLine.COUNT = 0 THEN BEGIN
        SelectedLine.RESET;
        SelectedLine := Rec;
        SelectedLine.SETRECFILTER;
      END;

      IF SelectedLine.FINDLAST THEN
        REPEAT
          ExportDefinitionLine.SETCURRENTKEY("Export Definition", "Line No.");
          ExportDefinitionLine.SETRANGE("Export Definition", "Export Definition");
          ExportDefinitionLine := SelectedLine;
          IF ExportDefinitionLine.NEXT(1) <> 0 THEN BEGIN
            LineNo := ExportDefinitionLine."Line No.";
            ExportDefinitionLine."Line No." := SelectedLine."Line No.";
            ExportDefinitionLine.MODIFY;
            SelectedLine."Line No." := LineNo;
            SelectedLine.MODIFY;
          END;
        UNTIL SelectedLine.NEXT(-1) = 0;

      GET(CurrLine."Export Definition", CurrLine."Entry No.");
    END;

    PROCEDURE LinkTables@1000002();
    BEGIN
      SetupLinkToTable;
    END;

    PROCEDURE UpdateForm@1000003();
    BEGIN
      CurrPage.UPDATE(FALSE);
    END;

    PROCEDURE SetFileFormat@1000008(NewValue@1000000 : Option);
    BEGIN
      FileFormat := NewValue;
    END;

    LOCAL PROCEDURE SetFieldEditable@1000007();
    BEGIN
      "Table No.Editable" := (Type IN [Type::Field, Type::Table]);
      "Field No.Editable" := (Type = Type::Field);
      "Table FilterEditable" := (Type = Type::Table);
      "Skip If EmptyEditable" := (TRUE);

      LinktoTableTagNameEditable := (Type = Type::Table);
      "Conversion CodeEditable" := (Type IN [Type::Field, Type::Variable, Type::Const]);

      CodeEditable := (Type IN [Type::Const, Type::Variable, Type::Table]);
      "Option TypeEditable" := (Type = Type::Field);
    END;

    PROCEDURE _SetFilterWithVariables@19012358();
    BEGIN
      SetFilterWithVariables;
    END;

    PROCEDURE SetFilterWithVariables@1000009();
    BEGIN
      SetFilterWithVariables;
    END;

    LOCAL PROCEDURE TypeOnAfterValidate@19069045();
    BEGIN
      SetFieldEditable;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      SetFieldEditable;
    END;

    LOCAL PROCEDURE TableNoOnAfterInput@19060375(VAR Text@19060376 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE FieldNoOnAfterInput@19063566(VAR Text@19063567 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFieldNo(Text, "Table No.", FALSE);
    END;

    LOCAL PROCEDURE TableFilterOnAfterInput@19072298(VAR Text@19072299 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableFilter(Text, "Table No.");
    END;

    LOCAL PROCEDURE TagNameOnFormat@19023679();
    BEGIN
      "Tag NameIndent" := Indent;
    END;

    LOCAL PROCEDURE TableNoOnFormat@19071785(Text@19016339 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Table No.");
    END;

    LOCAL PROCEDURE FieldNoOnFormat@19075355(Text@19041114 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatFieldNo(Text, "Table No.", "Field No.");
    END;

    LOCAL PROCEDURE TableFilterOnFormat@19013929(Text@19048068 : Text[1024]);
    VAR
      Mgt@1000002 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableFilter(Text, "Table No.");
    END;

    LOCAL PROCEDURE OptionTypeOnFormat@19077341();
    BEGIN
      IF Type <> Type::Field THEN
        "Option TypeHideValue" := TRUE;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117083 CI - Fixed Width Export Card
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Fixed Width Export Card;
               NLD=Fixed With Exportdefinitie];
    SourceTable=Table11148599;
    SourceTableView=WHERE(File Format=CONST(Fixed Width));
    PageType=Card;
    OnInit=BEGIN
             RightEnable := TRUE;
             LeftEnable := TRUE;
             "Sub Table No. of FieldsEnable" := TRUE;
             "Sub Table FilterEnable" := TRUE;
             "Sub Table No.Enable" := TRUE;
             "Save to MessagesEnable" := TRUE;
             "Filename TypeEnable" := TRUE;
             FilenameEnable := TRUE;
             LocationEnable := TRUE;
             LinesEditable := TRUE;
             "Project CodeEditable" := TRUE;
             "Sub Table No.Editable" := TRUE;
             "Sub Table FilterEditable" := TRUE;
             "Main Table FilterEditable" := TRUE;
             "Main Table No.Editable" := TRUE;
             "Run TaskEditable" := TRUE;
             "Run Codeunit No.Editable" := TRUE;
             "Save to MessagesEditable" := TRUE;
             HeadersEditable := TRUE;
             "File FormatEditable" := TRUE;
             FilenameEditable := TRUE;
             "Filename TypeEditable" := TRUE;
             LocationEditable := TRUE;
             DescriptionEditable := TRUE;
             CodeEditable := TRUE;
           END;

    OnOpenPage=VAR
                 Initialize@1000001 : Codeunit 11148625;
               BEGIN
                 Initialize.CheckInitialize;
               END;

    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                       MainTableNoOnFormat(FORMAT("Main Table No."));
                       MainTableFilterOnFormat(FORMAT("Main Table Filter"));
                       SubTableFilterOnFormat(FORMAT("Sub Table Filter"));
                       SubTableNoOnFormat(FORMAT("Sub Table No."));
                       RunCodeunitNoOnFormat(FORMAT("Run Codeunit No."));
                     END;

    OnNewRecord=VAR
                  Setup@1000000 : Record 11148589;
                BEGIN
                  Setup.GET;
                  "XML Declaration" := Setup."XML Declaration";
                  Location := Setup."Default Export Location";

                  "File Format" := "File Format"::"Fixed Width";
                  OnAfterGetCurrRecord;
                END;

    OnModifyRecord=BEGIN
                     VALIDATE("Main Table Filter");
                     VALIDATE("Sub Table Filter");

                     EXIT(TRUE);
                   END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000049 ;1   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Process;
                                 NLD=Verwerken];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Setup@1100512001 : Record 11148589;
                                 ProcessExportDef@1000002 : Codeunit 11148606;
                                 Progressbar@1000001 : Codeunit 11148624;
                                 ErrorMgt@1000006 : Codeunit 11148630;
                                 FileExported@1000004 : Boolean;
                                 ctDataExported@1000007 : TextConst 'ENU=Data exported;NLD=Data gexporteerd.';
                                 ctExportCancelled@1000005 : TextConst 'ENU=Export cancelled.;NLD=Exporteren afgebroken.';
                                 ctFileCreated@1000003 : TextConst 'ENU=Export processed.;NLD=Export verwerkt.';
                               BEGIN
                                 ErrorMgt.ClearError;

                                 TestRecordSet;

                                 Progressbar.Open(1);

                                 Setup.GET;
                                 IF Setup."Use Error Handling" THEN
                                   FileExported := ProcessExportDef.RUN(Rec)
                                 ELSE BEGIN
                                   ProcessExportDef.RUN(Rec);
                                   FileExported := TRUE;
                                 END;

                                 Progressbar.Close;

                                 IF FileExported THEN
                                   IF "File Format" = "File Format"::ADO THEN
                                     MESSAGE(ctDataExported)
                                   ELSE
                                     MESSAGE(ctFileCreated)
                                 ELSE BEGIN
                                   AddTraceEntry(TRUE, ErrorMgt.GetError, 0);
                                   IF ErrorMgt.GetError = '' THEN
                                     MESSAGE(ctExportCancelled)
                                   ELSE
                                     MESSAGE(ErrorMgt.GetError);
                                 END;
                               END;
                                }
      { 1000072 ;1   ;Action    ;
                      CaptionML=[ENU=Copy;
                                 NLD=Kopiren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Copy;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Copy;
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1000000001;1 ;Action    ;
                      Name=<Action1000000000>;
                      CaptionML=[ENU=Copy To;
                                 NLD=Kopiren naar];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Copy;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CopyTo;
                               END;
                                }
      { 1000000000;1 ;ActionGroup;
                      CaptionML=[ENU=Move;
                                 NLD=Verplaatsen] }
      { 1000050 ;2   ;Action    ;
                      Name=Left;
                      Promoted=Yes;
                      Enabled=LeftEnable;
                      PromotedIsBig=Yes;
                      Image=PreviousSet;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+L');
                               END;
                                }
      { 1000048 ;2   ;Action    ;
                      Name=Right;
                      Promoted=Yes;
                      Enabled=RightEnable;
                      PromotedIsBig=Yes;
                      Image=NextSet;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+R');
                               END;
                                }
      { 1000047 ;2   ;Action    ;
                      Name=<Action1000047>;
                      CaptionML=[ENU=Up;
                                 NLD=Omhoog];
                      Promoted=Yes;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+U');
                               END;
                                }
      { 1000028 ;2   ;Action    ;
                      Name=<Action1000028>;
                      CaptionML=[ENU=Down;
                                 NLD=Omlaag];
                      Promoted=Yes;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+D');
                               END;
                                }
      { 1000000002;1 ;ActionGroup;
                      CaptionML=[ENU=Messages and History;
                                 NLD=Berichten en historie] }
      { 1000056 ;2   ;Action    ;
                      ShortCutKey=Ctrl+F5;
                      CaptionML=[ENU=Messages;
                                 NLD=Berichten];
                      RunObject=Page 11117032;
                      RunPageView=SORTING(Entry No.);
                      RunPageLink=Type=CONST(Export),
                                  Code=FIELD(Code);
                      Promoted=Yes;
                      Image=Note;
                      PromotedCategory=Process }
      { 1000057 ;2   ;Action    ;
                      CaptionML=[ENU=History;
                                 NLD=Historie];
                      RunObject=Page 11117034;
                      RunPageView=SORTING(Type,Code);
                      RunPageLink=Type=CONST(Export),
                                  Code=FIELD(Code);
                      Image=History }
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000016 ;1   ;ActionGroup;
                      CaptionML=[ENU=Export &Def.;
                                 NLD=&Exportdef.] }
      { 1100531001;2 ;Action    ;
                      ShortCutKey=Ctrl+Alt+V;
                      CaptionML=[ENU=Versions;
                                 NLD=Versies];
                      RunObject=Page 11117096;
                      RunPageView=SORTING(Code,Version No.);
                      RunPageLink=Code=FIELD(Code) }
      { 1100531000;2 ;Action    ;
                      ShortCutKey=Ctrl+S;
                      CaptionML=[ENU=Save as New Version;
                                 NLD=Op&slaan als nieuwe versie];
                      OnAction=BEGIN
                                 SaveNewVersion;
                               END;
                                }
      { 1100531004;2 ;Separator  }
      { 1000044 ;2   ;Action    ;
                      CaptionML=[ENU=M&onitoring Setup;
                                 NLD=Monitoringinstellingen];
                      RunObject=Page 11117027;
                      RunPageView=SORTING(Export Definition);
                      RunPageLink=Export Definition=FIELD(Code) }
      { 1000045 ;2   ;Action    ;
                      CaptionML=[ENU=Export Jobs;
                                 NLD=E&xporteeropdrachten];
                      RunObject=Page 11117028;
                      RunPageView=SORTING(Status,Export Definition);
                      RunPageLink=Export Definition=FIELD(Code) }
      { 1000021 ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NLD=F&uncties] }
      { 1000046 ;2   ;Action    ;
                      CaptionML=[ENU=Renumber Lines;
                                 NLD=Regels hernummeren];
                      OnAction=BEGIN
                                 RenumberLines;
                               END;
                                }
      { 1000071 ;2   ;Separator  }
      { 1000070 ;2   ;Action    ;
                      CaptionML=[ENU=Pri&nt;
                                 NLD=Afdrukken];
                      OnAction=VAR
                                 ExportDefinition@1000000 : Record 11148599;
                               BEGIN
                                 ExportDefinition := Rec;
                                 ExportDefinition.SETRECFILTER;
                                 REPORT.RUN(REPORT::"CI - Export Definitions", TRUE, FALSE, ExportDefinition);
                               END;
                                }
      { 1000089 ;2   ;Separator  }
      { 1000090 ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Import Definition from XML;
                                 NLD=XML-Definitie &importeren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Import;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ImportXMLDefinition@1000000 : Codeunit 11148636;
                               BEGIN
                                 ImportXMLDefinition.ImportExportDefinition(Rec);
                               END;
                                }
      { 1000088 ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Export Definition to &XML;
                                 NLD=Definitie exporteren naar &XML];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Export;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ExportDefinitionToXML@1000000 : Codeunit 11148634;
                               BEGIN
                                 ExportDefinitionToXML.ExportExportDefinition(Rec);
                               END;
                                }
      { 1000068 ;2   ;Separator  }
      { 1000069 ;2   ;Action    ;
                      CaptionML=[ENU=Create &Monitoring Line;
                                 NLD=Monitorregel aanmaken];
                      OnAction=BEGIN
                                 CreateMonitoringLine;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                CaptionML=[ENU=General;
                           NLD=Algemeen] }

    { 1000001;2;Field     ;
                SourceExpr=Code;
                Editable=CodeEditable }

    { 1000003;2;Field     ;
                SourceExpr=Description;
                Editable=DescriptionEditable }

    { 1000005;2;Field     ;
                SourceExpr=Location;
                Enabled=LocationEnable;
                Editable=LocationEditable;
                OnValidate=VAR
                             Mgt@1000000000 : Codeunit 11148589;
                           BEGIN
                             Mgt.AfterInputFolder(Location);
                           END;

                OnLookup=VAR
                           Mgt@1000001 : Codeunit 11148589;
                           NewFolder@1000000 : Text[1024];
                         BEGIN
                           NewFolder := Mgt.BrowseForFolder('', '');
                           IF NewFolder <> '' THEN
                             Location := NewFolder;
                         END;

                OnAssistEdit=VAR
                               Mgt@1000001 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder(Location);
                             END;
                              }

    { 1000014;2;Field     ;
                SourceExpr=Filename;
                Enabled=FilenameEnable;
                Editable=FilenameEditable }

    { 1000083;2;Field     ;
                SourceExpr="Filename Type";
                Enabled="Filename TypeEnable";
                Editable="Filename TypeEditable" }

    { 1000011;2;Field     ;
                SourceExpr=Status;
                ValuesAllowed=[Edit;Manual;Automated;Blocked];
                OnValidate=BEGIN
                             StatusOnAfterValidate;
                           END;
                            }

    { 1000052;2;Field     ;
                SourceExpr="Save to Messages";
                Enabled="Save to MessagesEnable";
                Editable="Save to MessagesEditable" }

    { 1000039;2;Field     ;
                SourceExpr="No. of Monitoring Lines" }

    { 1000041;2;Field     ;
                SourceExpr="No. of Export Jobs" }

    { 1000024;1;Part      ;
                Name=Lines;
                SubPageLink=Export Definition=FIELD(Code);
                PagePartID=Page11117084;
                Editable=LinesEditable }

    { 1905328801;1;Group  ;
                CaptionML=[ENU=Field Selection;
                           NLD=Veldselectie] }

    { 1000010;2;Field     ;
                SourceExpr="Main Table No.";
                Editable="Main Table No.Editable";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           // IDYN EBK >>>>
                           IF Mgt.LookupTableNo(Text) THEN BEGIN
                             EVALUATE("Main Table No.",Text);
                             VALIDATE("Main Table No.");
                           END;
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           // EXIT(Mgt.LookupTableNo(Text));
                           // IDYN EBK <<<<
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.AssistTableNo("Main Table No.");
                             END;
                              }

    { 1000035;2;Field     ;
                AssistEdit=Yes;
                SourceExpr="Main Table Filter";
                Editable="Main Table FilterEditable";
                OnAssistEdit=BEGIN
                               EVALUATE("Main Table Filter",INMgt.SetTableFilter("Main Table No.",FORMAT("Main Table Filter")));
                             END;
                              }

    { 1000031;2;Field     ;
                DrillDown=No;
                SourceExpr="Main Table No. of Fields";
                OnAssistEdit=VAR
                               TmpFld@1000001 : TEMPORARY Record 2000000041;
                               SelectFields@1000000 : Page 11148589;
                             BEGIN
                               TESTFIELD("Main Table No.");

                               SelectFields.SetExportDefinition(TRUE, Rec);
                               SelectFields.SetFormBlocked(Status <> Status::Edit);
                               IF SelectFields.RUNMODAL = ACTION::OK THEN BEGIN
                                 SelectFields.GetSelectedFields(TmpFld);
                                 UpdateTableFields(TRUE, "Main Table No.", TmpFld);
                                 CurrPage.UPDATE(TRUE);
                               END;
                             END;
                              }

    { 1000025;2;Field     ;
                SourceExpr="Sub Table No.";
                Enabled="Sub Table No.Enable";
                Editable="Sub Table No.Editable";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           IF Mgt.LookupTableNo(Text) THEN BEGIN
                             EVALUATE("Sub Table No.",Text);
                             VALIDATE("Sub Table No.");
                           END;

                           // IDYN EBK >>>>
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           // Mgt.LookupRelatedTableNo("Main Table No.",Text);
                           // EVALUATE("Sub Table No.",Text);
                           // VALIDATE("Sub Table No.");
                           // EXIT(Mgt.LookupRelatedTableNo("Main Table No.", Text));
                           // IDYN EBK <<<<
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.AssistTableNo("Main Table No.");
                             END;
                              }

    { 1000037;2;Field     ;
                AssistEdit=Yes;
                SourceExpr="Sub Table Filter";
                Enabled="Sub Table FilterEnable";
                Editable="Sub Table FilterEditable";
                OnAssistEdit=BEGIN
                               EVALUATE("Sub Table Filter",INMgt.SetTableFilter("Sub Table No.",FORMAT("Sub Table Filter")));
                             END;
                              }

    { 1000033;2;Field     ;
                DrillDown=No;
                SourceExpr="Sub Table No. of Fields";
                Enabled="Sub Table No. of FieldsEnable";
                OnAssistEdit=VAR
                               TmpFld@1000001 : TEMPORARY Record 2000000041;
                               SelectFields@1000000 : Page 11148589;
                             BEGIN
                               TESTFIELD("Sub Table No.");

                               SelectFields.SetExportDefinition(FALSE, Rec);
                               SelectFields.SetFormBlocked(Status <> Status::Edit);
                               IF SelectFields.RUNMODAL = ACTION::OK THEN BEGIN
                                 SelectFields.GetSelectedFields(TmpFld);
                                 UpdateTableFields(FALSE, "Sub Table No.", TmpFld);
                                 CurrPage.UPDATE(TRUE);
                               END;
                             END;
                              }

    { 1903121901;1;Group  ;
                CaptionML=[ENU=Options;
                           NLD=Opties] }

    { 1000073;2;Field     ;
                SourceExpr="Run Task";
                Editable="Run TaskEditable" }

    { 1000085;2;Field     ;
                SourceExpr="Project Code";
                Editable="Project CodeEditable" }

    { 1000009;2;Field     ;
                SourceExpr="Company Name" }

    { 1000027;2;Field     ;
                SourceExpr=Headers;
                Enabled=HeadersEnable;
                Editable=HeadersEditable }

    { 1100512000;2;Field  ;
                SourceExpr="Run Codeunit No.";
                Visible=FALSE;
                Editable="Run Codeunit No.Editable";
                OnLookup=VAR
                           Mgt@1100512000 : Codeunit 11148589;
                         BEGIN
                           EXIT(Mgt.LookupObjectNo(5, Text));
                         END;
                          }

  }
  CODE
  {
    VAR
      INMgt@1000000001 : Codeunit 11148589;
      CodeEditable@19001698 : Boolean INDATASET;
      DescriptionEditable@19061412 : Boolean INDATASET;
      LocationEditable@19035910 : Boolean INDATASET;
      "Filename TypeEditable"@19038575 : Boolean INDATASET;
      FilenameEditable@19007928 : Boolean INDATASET;
      "File FormatEditable"@19047526 : Boolean INDATASET;
      HeadersEditable@19062436 : Boolean INDATASET;
      "Save to MessagesEditable"@19046008 : Boolean INDATASET;
      "Run Codeunit No.Editable"@19055664 : Boolean INDATASET;
      "Run TaskEditable"@19005185 : Boolean INDATASET;
      "Main Table No.Editable"@19066361 : Boolean INDATASET;
      "Main Table FilterEditable"@19035070 : Boolean INDATASET;
      "Sub Table FilterEditable"@19045437 : Boolean INDATASET;
      "Sub Table No.Editable"@19054278 : Boolean INDATASET;
      "Project CodeEditable"@19062497 : Boolean INDATASET;
      LinesEditable@19010511 : Boolean INDATASET;
      LocationEnable@19013618 : Boolean INDATASET;
      FilenameEnable@19043700 : Boolean INDATASET;
      "Filename TypeEnable"@19052158 : Boolean INDATASET;
      "Save to MessagesEnable"@19010110 : Boolean INDATASET;
      "Sub Table No.Enable"@19033464 : Boolean INDATASET;
      "Sub Table FilterEnable"@19073453 : Boolean INDATASET;
      "Sub Table No. of FieldsEnable"@19016380 : Boolean INDATASET;
      LeftEnable@19065291 : Boolean INDATASET;
      RightEnable@19037326 : Boolean INDATASET;
      HeadersEnable@1000000000 : Boolean INDATASET;

    LOCAL PROCEDURE EnableFields@1000000();
    BEGIN
      LocationEnable := "File Format" <> "File Format"::ADO;
      FilenameEnable := "File Format" <> "File Format"::ADO;
      "Filename TypeEnable" := "File Format" <> "File Format"::ADO;
      "Save to MessagesEnable" := "File Format" <> "File Format"::ADO;

      "Sub Table No.Enable" := "File Format" <> "File Format"::ADO;
      "Sub Table FilterEnable" := "File Format" <> "File Format"::ADO;
      "Sub Table No. of FieldsEnable" := "File Format" <> "File Format"::ADO;

      HeadersEnable := "File Format" IN ["File Format"::CSV, "File Format"::"Fixed Width", "File Format"::Excel];
      LeftEnable := "File Format" <> "File Format"::ADO;
      RightEnable := "File Format" <> "File Format"::ADO;
    END;

    LOCAL PROCEDURE SetFileFormatToLines@1000002();
    BEGIN
      CurrPage.Lines.PAGE.SetFileFormat("File Format");
    END;

    LOCAL PROCEDURE SetEditable@1000003();
    BEGIN
      CodeEditable := (Status = Status::Edit);
      DescriptionEditable := (Status = Status::Edit);
      LocationEditable := (Status = Status::Edit);
      "Filename TypeEditable" := (Status = Status::Edit);
      FilenameEditable := (Status = Status::Edit);
      "File FormatEditable" := (Status = Status::Edit);
      HeadersEditable := (Status = Status::Edit);
      "Save to MessagesEditable" := (Status = Status::Edit);
      "Run Codeunit No.Editable" := (Status = Status::Edit);
      "Run TaskEditable" := (Status = Status::Edit);
      "Main Table No.Editable" := (Status = Status::Edit);
      "Main Table FilterEditable" := (Status = Status::Edit);
      "Sub Table FilterEditable" := (Status = Status::Edit);
      "Sub Table No.Editable" := (Status = Status::Edit);
      "Project CodeEditable" := (Status = Status::Edit);
      LinesEditable := (Status = Status::Edit);
    END;

    LOCAL PROCEDURE StatusOnAfterValidate@19072689();
    BEGIN
      SetEditable;
    END;

    LOCAL PROCEDURE FileFormatOnAfterValidate@19065317();
    BEGIN
      EnableFields;

      SetFileFormatToLines;
      CurrPage.Lines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      xRec := Rec;
      IF FORMAT("Main Table Filter") = '' THEN
        EVALUATE("Main Table Filter", Mgt.EmptyTableFilter("Main Table No."));

      IF FORMAT("Sub Table Filter") = '' THEN
        EVALUATE("Sub Table Filter", Mgt.EmptyTableFilter("Sub Table No."));

      EnableFields;
      SetEditable;

      SetFileFormatToLines;
    END;

    LOCAL PROCEDURE LocationOnAfterInput@19074197(VAR Text@19074198 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFolder(Text);
    END;

    LOCAL PROCEDURE MainTableNoOnAfterInput@19047063(VAR Text@19047064 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE MainTableFilterOnAfterInput@19078863(VAR Text@19078864 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableFilter(Text, "Main Table No.");
    END;

    LOCAL PROCEDURE SubTableFilterOnAfterInput@19008895(VAR Text@19008896 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableFilter(Text, "Sub Table No.");
    END;

    LOCAL PROCEDURE SubTableNoOnAfterInput@19065603(VAR Text@19065604 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE RunCodeunitNoOnAfterInput@19017510(VAR Text@19017511 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputObjectNo(5, Text);
    END;

    LOCAL PROCEDURE MainTableNoOnFormat@19079044(Text@19015475 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Main Table No.");
    END;

    LOCAL PROCEDURE MainTableFilterOnFormat@19021213(Text@19073443 : Text[1024]);
    VAR
      Mgt@1000002 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableFilter(Text, "Main Table No.");
    END;

    LOCAL PROCEDURE SubTableFilterOnFormat@19007760(Text@19036173 : Text[1024]);
    VAR
      Mgt@1000002 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableFilter(Text, "Sub Table No.");
    END;

    LOCAL PROCEDURE SubTableNoOnFormat@19052089(Text@19075565 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Sub Table No.");
    END;

    LOCAL PROCEDURE RunCodeunitNoOnFormat@19054474(Text@19073072 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatObjectNo(5, Text, "Run Codeunit No.");
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117084 CI - Fixed Width Exp. Subform
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Fixed Width Exp. Subform;
               NLD=Fixed Width Exportdefinitiesubform];
    SourceTable=Table11148600;
    SourceTableView=SORTING(Export Definition,Line No.);
    PageType=ListPart;
    OnInit=BEGIN
             "Option TypeEditable" := TRUE;
             CodeEditable := TRUE;
             "Conversion CodeEditable" := TRUE;
             LinktoTableTagNameEditable := TRUE;
             "Skip If EmptyEditable" := TRUE;
             "Table FilterEditable" := TRUE;
             "Field No.Editable" := TRUE;
             "Table No.Editable" := TRUE;
           END;

    OnAfterGetRecord=VAR
                       Mgt@1000000 : Codeunit 11148589;
                     BEGIN
                       "Option TypeHideValue" := FALSE;
                       "Tag NameIndent" := 0;
                       IF SYSTEM.FORMAT("Table Filter") = '' THEN
                         EVALUATE("Table Filter", Mgt.EmptyTableFilter("Table No."));
                       OnAfterGetCurrRecord;
                       TagNameOnFormat;
                       TableNoOnFormat(FORMAT("Table No."));
                       FieldNoOnFormat(FORMAT("Field No."));
                       TableFilterOnFormat(FORMAT("Table Filter"));
                       OptionTypeOnFormat;
                     END;

    OnNewRecord=BEGIN
                  SetupNewLine(xRec, BelowxRec);
                  OnAfterGetCurrRecord;
                END;

    OnModifyRecord=BEGIN
                     IF SYSTEM.FORMAT("Table Filter") <> '' THEN
                       VALIDATE("Table Filter");

                     EXIT(TRUE);
                   END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1902311204;1 ;ActionGroup;
                      CaptionML=[ENU=Export &Def.;
                                 NLD=&Exportdef.] }
      { 1903294104;2 ;Action    ;
                      ShortCutKey=Ctrl+L;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Link &Tables;
                                 NLD=Tabellen linken];
                      OnAction=BEGIN
                                 LinkTables;
                               END;
                                }
      { 1906069704;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+V;
                      CaptionML=[ENU=Set &Filter With Variables;
                                 NLD=Zet filter met variabelen];
                      OnAction=BEGIN
                                 _SetFilterWithVariables;
                               END;
                                }
      { 1000000005;1 ;Separator  }
      { 1000000003;1 ;Action    ;
                      Name=<Action1000000000>;
                      ShortCutKey=Shift+Ctrl+R;
                      CaptionML=[ENU=Right;
                                 NLD=Rechts];
                      Promoted=Yes;
                      OnAction=BEGIN
                                 Right;
                               END;
                                }
      { 1000000002;1 ;Action    ;
                      Name=<Action1000000001>;
                      ShortCutKey=Shift+Ctrl+L;
                      CaptionML=[ENU=Left;
                                 NLD=Links];
                      OnAction=BEGIN
                                 Left;
                               END;
                                }
      { 1000000001;1 ;Action    ;
                      Name=<Action1000000002>;
                      ShortCutKey=Shift+Ctrl+U;
                      CaptionML=[ENU=Up;
                                 NLD=Omhoog];
                      OnAction=BEGIN
                                 Up;
                               END;
                                }
      { 1000000000;1 ;Action    ;
                      Name=<Action1000000003>;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Down;
                                 NLD=Omlaag];
                      OnAction=BEGIN
                                 Down;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                IndentationColumnName="Tag NameIndent";
                IndentationControls=Tag Name;
                GroupType=Repeater }

    { 1000011;2;Field     ;
                SourceExpr="Tag Name" }

    { 1000001;2;Field     ;
                SourceExpr=Type;
                ValuesAllowed=[Table;Field;Const;Variable];
                OnValidate=BEGIN
                             TypeOnAfterValidate;
                           END;
                            }

    { 1000013;2;Field     ;
                SourceExpr=Code;
                Editable=CodeEditable }

    { 1000000008;2;Field  ;
                SourceExpr="Table No.";
                Editable="Table No.Editable";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           // IDYN EBK >>>>
                           IF Mgt.LookupTableNo(Text) THEN BEGIN
                             EVALUATE("Table No.",Text);
                             VALIDATE("Table No.");
                           END;
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //EXIT(Mgt.LookupTableNo(Text));
                           // IDYN EBK <<<<
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.AssistTableNo("Table No.");
                             END;
                              }

    { 1000000007;2;Field  ;
                Name=Table Name;
                SourceExpr="Table Name" }

    { 1000000006;2;Field  ;
                SourceExpr="Field No.";
                Editable="Field No.Editable";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           // IDYN EBK >>>>
                           IF Mgt.LookupFieldNo("Table No.",Text,TRUE) THEN BEGIN
                             EVALUATE("Field No.",Text);
                             VALIDATE("Field No.");
                           END;
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //EXIT(Mgt.LookupFieldNo("Table No.", Text, TRUE));
                           // IDYN EBK <<<<
                         END;
                          }

    { 1000000004;2;Field  ;
                Name=Field Name;
                SourceExpr="Field Name" }

    { 1100531000;2;Field  ;
                SourceExpr="No. of Functions";
                Visible=FALSE }

    { 1000027;2;Field     ;
                SourceExpr=Width }

    { 1000029;2;Field     ;
                SourceExpr=Alignment }

    { 1000031;2;Field     ;
                SourceExpr="Original Value";
                Visible=FALSE }

    { 1000015;2;Field     ;
                AssistEdit=Yes;
                SourceExpr="Table Filter";
                Editable="Table FilterEditable";
                OnAssistEdit=VAR
                               INMgt@1000000000 : Codeunit 11148589;
                             BEGIN
                               EVALUATE("Table Filter", INMgt.SetTableFilter("Table No.", FORMAT("Table Filter"))); // CI-143
                             END;
                              }

    { 1000023;2;Field     ;
                SourceExpr="Link to Table (Tag Name)";
                Editable=LinktoTableTagNameEditable;
                OnAssistEdit=BEGIN
                               SetupLinkToTable;
                             END;
                              }

    { 1000021;2;Field     ;
                SourceExpr="Conversion Code";
                Editable="Conversion CodeEditable" }

    { 1000025;2;Field     ;
                SourceExpr="Dest. Variable";
                Visible=FALSE }

    { 1000035;2;Field     ;
                SourceExpr="Skip If Empty";
                Visible=FALSE;
                Editable="Skip If EmptyEditable" }

    { 1000017;2;Field     ;
                SourceExpr="Data Format";
                Visible=FALSE }

    { 1000033;2;Field     ;
                SourceExpr="Option Type";
                Visible=FALSE;
                Editable="Option TypeEditable";
                HideValue="Option TypeHideValue" }

    { 1000007;2;Field     ;
                SourceExpr="Before Field";
                Visible=FALSE }

    { 1000019;2;Field     ;
                SourceExpr="After Field";
                Visible=FALSE }

  }
  CODE
  {
    VAR
      FileFormat@1000000 : 'XML,CSV,FixedWidth,Excel';
      "Tag NameIndent"@19056250 : Integer INDATASET;
      "Option TypeHideValue"@19002310 : Boolean INDATASET;
      "Table No.Editable"@19076806 : Boolean INDATASET;
      "Field No.Editable"@19022826 : Boolean INDATASET;
      "Table FilterEditable"@19054732 : Boolean INDATASET;
      "Skip If EmptyEditable"@19053977 : Boolean INDATASET;
      LinktoTableTagNameEditable@19004008 : Boolean INDATASET;
      "Conversion CodeEditable"@19074872 : Boolean INDATASET;
      CodeEditable@19001698 : Boolean INDATASET;
      "Option TypeEditable"@19019138 : Boolean INDATASET;

    PROCEDURE Left@1000000();
    VAR
      ExportDefLine@1100512000 : Record 11148600;
    BEGIN
      CurrPage.SETSELECTIONFILTER(ExportDefLine);
      IF ExportDefLine.FINDSET THEN
        REPEAT
          IF ExportDefLine."Entry No." <> 0 THEN
            IF ExportDefLine.Indent > 0 THEN BEGIN
              ExportDefLine.Indent -= 1;
              ExportDefLine.MODIFY;
            END;
        UNTIL ExportDefLine.NEXT = 0;
    END;

    PROCEDURE Right@1000001();
    VAR
      ExportDefLine@1100512000 : Record 11148600;
    BEGIN
      CurrPage.SETSELECTIONFILTER(ExportDefLine);
      IF ExportDefLine.FINDSET THEN
        REPEAT
          IF ExportDefLine."Entry No." <> 0 THEN BEGIN
            ExportDefLine.Indent += 1;
            ExportDefLine.MODIFY;
          END;
        UNTIL ExportDefLine.NEXT = 0;
    END;

    PROCEDURE Up@1000011();
    VAR
      CurrLine@1000004 : Record 11148600;
      ExportDefinitionLine@1000000 : Record 11148600;
      SelectedLine@1000002 : Record 11148600;
      LineNo@1000001 : Integer;
    BEGIN
      CurrLine := Rec;

      CurrPage.SETSELECTIONFILTER(SelectedLine);
      IF SelectedLine.COUNT = 0 THEN BEGIN
        SelectedLine.RESET;
        SelectedLine := Rec;
        SelectedLine.SETRECFILTER;
      END;

      IF SelectedLine.FINDSET THEN
        REPEAT
          ExportDefinitionLine.SETCURRENTKEY("Export Definition", "Line No.");
          ExportDefinitionLine.SETRANGE("Export Definition", "Export Definition");
          ExportDefinitionLine := SelectedLine;
          IF ExportDefinitionLine.NEXT(-1) <> 0 THEN BEGIN
            LineNo := ExportDefinitionLine."Line No.";
            ExportDefinitionLine."Line No." := SelectedLine."Line No.";
            ExportDefinitionLine.MODIFY;
            SelectedLine."Line No." := LineNo;
            SelectedLine.MODIFY;
          END;
        UNTIL SelectedLine.NEXT = 0;

      GET(CurrLine."Export Definition", CurrLine."Entry No.");
    END;

    PROCEDURE Down@1000010();
    VAR
      CurrLine@1000004 : Record 11148600;
      ExportDefinitionLine@1000006 : Record 11148600;
      SelectedLine@1000005 : Record 11148600;
      LineNo@1000000 : Integer;
    BEGIN
      CurrLine := Rec;

      CurrPage.SETSELECTIONFILTER(SelectedLine);
      IF SelectedLine.COUNT = 0 THEN BEGIN
        SelectedLine.RESET;
        SelectedLine := Rec;
        SelectedLine.SETRECFILTER;
      END;

      IF SelectedLine.FINDLAST THEN
        REPEAT
          ExportDefinitionLine.SETCURRENTKEY("Export Definition", "Line No.");
          ExportDefinitionLine.SETRANGE("Export Definition", "Export Definition");
          ExportDefinitionLine := SelectedLine;
          IF ExportDefinitionLine.NEXT(1) <> 0 THEN BEGIN
            LineNo := ExportDefinitionLine."Line No.";
            ExportDefinitionLine."Line No." := SelectedLine."Line No.";
            ExportDefinitionLine.MODIFY;
            SelectedLine."Line No." := LineNo;
            SelectedLine.MODIFY;
          END;
        UNTIL SelectedLine.NEXT(-1) = 0;

      GET(CurrLine."Export Definition", CurrLine."Entry No.");
    END;

    PROCEDURE LinkTables@1000002();
    BEGIN
      SetupLinkToTable;
    END;

    PROCEDURE UpdateForm@1000003();
    BEGIN
      CurrPage.UPDATE(FALSE);
    END;

    PROCEDURE SetFileFormat@1000008(NewValue@1000000 : Option);
    BEGIN
      FileFormat := NewValue;
    END;

    LOCAL PROCEDURE SetFieldEditable@1000007();
    BEGIN
      "Table No.Editable" := (Type IN [Type::Field, Type::Table]);
      "Field No.Editable" := (Type = Type::Field);
      "Table FilterEditable" := (Type = Type::Table);
      "Skip If EmptyEditable" := (TRUE);

      LinktoTableTagNameEditable := (Type = Type::Table);
      "Conversion CodeEditable" := (Type IN [Type::Field, Type::Variable, Type::Const]);

      CodeEditable := (Type IN [Type::Const, Type::Variable, Type::Table]);
      "Option TypeEditable" := (Type = Type::Field);
    END;

    PROCEDURE _SetFilterWithVariables@19012358();
    BEGIN
      SetFilterWithVariables;
    END;

    PROCEDURE SetFilterWithVariables@1000009();
    BEGIN
      SetFilterWithVariables;
    END;

    LOCAL PROCEDURE TypeOnAfterValidate@19069045();
    BEGIN
      SetFieldEditable;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      SetFieldEditable;
    END;

    LOCAL PROCEDURE TableNoOnAfterInput@19060375(VAR Text@19060376 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE FieldNoOnAfterInput@19063566(VAR Text@19063567 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFieldNo(Text, "Table No.", FALSE);
    END;

    LOCAL PROCEDURE TableFilterOnAfterInput@19072298(VAR Text@19072299 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableFilter(Text, "Table No.");
    END;

    LOCAL PROCEDURE TagNameOnFormat@19023679();
    BEGIN
      "Tag NameIndent" := Indent;
    END;

    LOCAL PROCEDURE TableNoOnFormat@19071785(Text@19016339 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Table No.");
    END;

    LOCAL PROCEDURE FieldNoOnFormat@19075355(Text@19041114 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatFieldNo(Text, "Table No.", "Field No.");
    END;

    LOCAL PROCEDURE TableFilterOnFormat@19013929(Text@19048068 : Text[1024]);
    VAR
      Mgt@1000002 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableFilter(Text, "Table No.");
    END;

    LOCAL PROCEDURE OptionTypeOnFormat@19077341();
    BEGIN
      IF Type <> Type::Field THEN
        "Option TypeHideValue" := TRUE;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117085 CI - Excel Export Card
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Excel Export Card;
               NLD=Excel Exportdefinitie];
    SourceTable=Table11148599;
    SourceTableView=WHERE(File Format=CONST(Excel));
    PageType=Card;
    OnInit=BEGIN
             RightEnable := TRUE;
             LeftEnable := TRUE;
             "Sub Table No. of FieldsEnable" := TRUE;
             "Sub Table FilterEnable" := TRUE;
             "Sub Table No.Enable" := TRUE;
             "Save to MessagesEnable" := TRUE;
             "Filename TypeEnable" := TRUE;
             FilenameEnable := TRUE;
             LocationEnable := TRUE;
             LinesEditable := TRUE;
             "Project CodeEditable" := TRUE;
             "Sub Table No.Editable" := TRUE;
             "Sub Table FilterEditable" := TRUE;
             "Main Table FilterEditable" := TRUE;
             "Main Table No.Editable" := TRUE;
             "Run TaskEditable" := TRUE;
             "Run Codeunit No.Editable" := TRUE;
             "Save to MessagesEditable" := TRUE;
             HeadersEditable := TRUE;
             "File FormatEditable" := TRUE;
             FilenameEditable := TRUE;
             "Filename TypeEditable" := TRUE;
             LocationEditable := TRUE;
             DescriptionEditable := TRUE;
             CodeEditable := TRUE;
           END;

    OnOpenPage=VAR
                 Initialize@1000001 : Codeunit 11148625;
               BEGIN
                 Initialize.CheckInitialize;
               END;

    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                       MainTableNoOnFormat(FORMAT("Main Table No."));
                       MainTableFilterOnFormat(FORMAT("Main Table Filter"));
                       SubTableFilterOnFormat(FORMAT("Sub Table Filter"));
                       SubTableNoOnFormat(FORMAT("Sub Table No."));
                       RunCodeunitNoOnFormat(FORMAT("Run Codeunit No."));
                     END;

    OnNewRecord=VAR
                  Setup@1000000 : Record 11148589;
                BEGIN
                  Setup.GET;
                  "XML Declaration" := Setup."XML Declaration";
                  Location := Setup."Default Export Location";

                  "File Format" := "File Format"::Excel;
                  OnAfterGetCurrRecord;
                END;

    OnModifyRecord=BEGIN
                     VALIDATE("Main Table Filter");
                     VALIDATE("Sub Table Filter");

                     EXIT(TRUE);
                   END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000049 ;1   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Process;
                                 NLD=Verwerken];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Setup@1100512001 : Record 11148589;
                                 ProcessExportDef@1000002 : Codeunit 11148606;
                                 Progressbar@1000001 : Codeunit 11148624;
                                 ErrorMgt@1000006 : Codeunit 11148630;
                                 FileExported@1000004 : Boolean;
                                 ctDataExported@1000007 : TextConst 'ENU=Data exported;NLD=Data gexporteerd.';
                                 ctExportCancelled@1000005 : TextConst 'ENU=Export cancelled.;NLD=Exporteren afgebroken.';
                                 ctFileCreated@1000003 : TextConst 'ENU=Export processed.;NLD=Export verwerkt.';
                               BEGIN
                                 ErrorMgt.ClearError;

                                 TestRecordSet;

                                 Progressbar.Open(1);

                                 Setup.GET;
                                 IF Setup."Use Error Handling" THEN
                                   FileExported := ProcessExportDef.RUN(Rec)
                                 ELSE BEGIN
                                   ProcessExportDef.RUN(Rec);
                                   FileExported := TRUE;
                                 END;

                                 Progressbar.Close;

                                 IF FileExported THEN
                                   IF "File Format" = "File Format"::ADO THEN
                                     MESSAGE(ctDataExported)
                                   ELSE
                                     MESSAGE(ctFileCreated)
                                 ELSE BEGIN
                                   AddTraceEntry(TRUE, ErrorMgt.GetError, 0);
                                   IF ErrorMgt.GetError = '' THEN
                                     MESSAGE(ctExportCancelled)
                                   ELSE
                                     MESSAGE(ErrorMgt.GetError);
                                 END;
                               END;
                                }
      { 1000072 ;1   ;Action    ;
                      CaptionML=[ENU=Copy;
                                 NLD=Kopiren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Copy;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Copy;
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1000000001;1 ;Action    ;
                      Name=<Action1000000000>;
                      CaptionML=[ENU=Copy To;
                                 NLD=Kopiren naar];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Copy;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CopyTo;
                               END;
                                }
      { 1000000000;1 ;ActionGroup;
                      CaptionML=[ENU=Move;
                                 NLD=Verplaatsen] }
      { 1000050 ;2   ;Action    ;
                      Name=Left;
                      Promoted=Yes;
                      Enabled=LeftEnable;
                      PromotedIsBig=Yes;
                      Image=PreviousSet;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+L');
                               END;
                                }
      { 1000048 ;2   ;Action    ;
                      Name=Right;
                      Promoted=Yes;
                      Enabled=RightEnable;
                      PromotedIsBig=Yes;
                      Image=NextSet;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+R');
                               END;
                                }
      { 1000047 ;2   ;Action    ;
                      Name=<Action1000047>;
                      CaptionML=[ENU=Up;
                                 NLD=Omhoog];
                      Promoted=Yes;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+U');
                               END;
                                }
      { 1000028 ;2   ;Action    ;
                      Name=<Action1000028>;
                      CaptionML=[ENU=Down;
                                 NLD=Omlaag];
                      Promoted=Yes;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+D');
                               END;
                                }
      { 1000000002;1 ;ActionGroup;
                      CaptionML=[ENU=Messages and History;
                                 NLD=Berichten en historie] }
      { 1000056 ;2   ;Action    ;
                      ShortCutKey=Ctrl+F5;
                      CaptionML=[ENU=Messages;
                                 NLD=Berichten];
                      RunObject=Page 11117032;
                      RunPageView=SORTING(Entry No.);
                      RunPageLink=Type=CONST(Export),
                                  Code=FIELD(Code);
                      Promoted=Yes;
                      Image=Note;
                      PromotedCategory=Process }
      { 1000057 ;2   ;Action    ;
                      CaptionML=[ENU=History;
                                 NLD=Historie];
                      RunObject=Page 11117034;
                      RunPageView=SORTING(Type,Code);
                      RunPageLink=Type=CONST(Export),
                                  Code=FIELD(Code);
                      Image=History }
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000016 ;1   ;ActionGroup;
                      CaptionML=[ENU=Export &Def.;
                                 NLD=&Exportdef.] }
      { 1100531001;2 ;Action    ;
                      ShortCutKey=Ctrl+Alt+V;
                      CaptionML=[ENU=Versions;
                                 NLD=Versies];
                      RunObject=Page 11117096;
                      RunPageView=SORTING(Code,Version No.);
                      RunPageLink=Code=FIELD(Code) }
      { 1100531000;2 ;Action    ;
                      ShortCutKey=Ctrl+S;
                      CaptionML=[ENU=Save as New Version;
                                 NLD=Op&slaan als nieuwe versie];
                      OnAction=BEGIN
                                 SaveNewVersion;
                               END;
                                }
      { 1000043 ;2   ;Separator  }
      { 1000044 ;2   ;Action    ;
                      CaptionML=[ENU=M&onitoring Setup;
                                 NLD=Monitoringinstellingen];
                      RunObject=Page 11117027;
                      RunPageView=SORTING(Export Definition);
                      RunPageLink=Export Definition=FIELD(Code) }
      { 1000045 ;2   ;Action    ;
                      CaptionML=[ENU=Export Jobs;
                                 NLD=E&xporteeropdrachten];
                      RunObject=Page 11117028;
                      RunPageView=SORTING(Status,Export Definition);
                      RunPageLink=Export Definition=FIELD(Code) }
      { 1000021 ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NLD=F&uncties] }
      { 1000046 ;2   ;Action    ;
                      CaptionML=[ENU=Renumber Lines;
                                 NLD=Regels hernummeren];
                      OnAction=BEGIN
                                 RenumberLines;
                               END;
                                }
      { 1000095 ;2   ;Action    ;
                      CaptionML=[ENU=Reversed Data &Mapping;
                                 NLD=Reversed data&mapping];
                      OnAction=BEGIN
                                 ReversedDataMapping;
                               END;
                                }
      { 1000071 ;2   ;Separator  }
      { 1000070 ;2   ;Action    ;
                      CaptionML=[ENU=Pri&nt;
                                 NLD=Afdrukken];
                      OnAction=VAR
                                 ExportDefinition@1000000 : Record 11148599;
                               BEGIN
                                 ExportDefinition := Rec;
                                 ExportDefinition.SETRECFILTER;
                                 REPORT.RUN(REPORT::"CI - Export Definitions", TRUE, FALSE, ExportDefinition);
                               END;
                                }
      { 1000089 ;2   ;Separator  }
      { 1000090 ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Import Definition from XML;
                                 NLD=XML-Definitie &importeren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Import;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ImportXMLDefinition@1000000 : Codeunit 11148636;
                               BEGIN
                                 ImportXMLDefinition.ImportExportDefinition(Rec);
                               END;
                                }
      { 1000088 ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Export Definition to &XML;
                                 NLD=Definitie exporteren naar &XML];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Export;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ExportDefinitionToXML@1000000 : Codeunit 11148634;
                               BEGIN
                                 ExportDefinitionToXML.ExportExportDefinition(Rec);
                               END;
                                }
      { 1000068 ;2   ;Separator  }
      { 1000069 ;2   ;Action    ;
                      CaptionML=[ENU=Create M&onitoring Line;
                                 NLD=M&onitorregel aanmaken];
                      OnAction=BEGIN
                                 CreateMonitoringLine;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                CaptionML=[ENU=General;
                           NLD=Algemeen] }

    { 1000001;2;Field     ;
                SourceExpr=Code;
                Editable=CodeEditable }

    { 1000003;2;Field     ;
                SourceExpr=Description;
                Editable=DescriptionEditable }

    { 1000005;2;Field     ;
                SourceExpr=Location;
                Enabled=LocationEnable;
                Editable=LocationEditable;
                OnValidate=VAR
                             Mgt@1000000000 : Codeunit 11148589;
                           BEGIN
                             Mgt.AfterInputFolder(Location);
                           END;

                OnLookup=VAR
                           Mgt@1000001 : Codeunit 11148589;
                           NewFolder@1000000 : Text[1024];
                         BEGIN
                           NewFolder := Mgt.BrowseForFolder('', '');
                           IF NewFolder <> '' THEN
                             Location := NewFolder;
                         END;

                OnAssistEdit=VAR
                               Mgt@1000001 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder(Location);
                             END;
                              }

    { 1000014;2;Field     ;
                SourceExpr=Filename;
                Enabled=FilenameEnable;
                Editable=FilenameEditable }

    { 1000083;2;Field     ;
                SourceExpr="Filename Type";
                Enabled="Filename TypeEnable";
                Editable="Filename TypeEditable" }

    { 1000011;2;Field     ;
                SourceExpr=Status;
                ValuesAllowed=[Edit;Manual;Automated;Blocked];
                OnValidate=BEGIN
                             StatusOnAfterValidate;
                           END;
                            }

    { 1000052;2;Field     ;
                SourceExpr="Save to Messages";
                Enabled="Save to MessagesEnable";
                Editable="Save to MessagesEditable" }

    { 1000039;2;Field     ;
                SourceExpr="No. of Monitoring Lines" }

    { 1000041;2;Field     ;
                SourceExpr="No. of Export Jobs" }

    { 1000024;1;Part      ;
                Name=Lines;
                SubPageLink=Export Definition=FIELD(Code);
                PagePartID=Page11117086;
                Editable=LinesEditable }

    { 1905328801;1;Group  ;
                CaptionML=[ENU=Field Selection;
                           NLD=Veldselectie] }

    { 1000010;2;Field     ;
                SourceExpr="Main Table No.";
                Editable="Main Table No.Editable";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           // IDYN EBK >>>>
                           IF Mgt.LookupTableNo(Text) THEN BEGIN
                             EVALUATE("Main Table No.",Text);
                             VALIDATE("Main Table No.");
                           END;
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //EXIT(Mgt.LookupTableNo(Text));
                           // IDYN EBK <<<<
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.AssistTableNo("Main Table No.");
                             END;
                              }

    { 1000035;2;Field     ;
                AssistEdit=Yes;
                SourceExpr="Main Table Filter";
                Editable="Main Table FilterEditable";
                OnAssistEdit=BEGIN
                               EVALUATE("Main Table Filter",INMgt.SetTableFilter("Main Table No.",FORMAT("Main Table Filter")));
                             END;
                              }

    { 1000031;2;Field     ;
                DrillDown=No;
                SourceExpr="Main Table No. of Fields";
                OnAssistEdit=VAR
                               TmpFld@1000001 : TEMPORARY Record 2000000041;
                               SelectFields@1000000 : Page 11148589;
                             BEGIN
                               TESTFIELD("Main Table No.");

                               SelectFields.SetExportDefinition(TRUE, Rec);
                               SelectFields.SetFormBlocked(Status <> Status::Edit);
                               IF SelectFields.RUNMODAL = ACTION::OK THEN BEGIN
                                 SelectFields.GetSelectedFields(TmpFld);
                                 UpdateTableFields(TRUE, "Main Table No.", TmpFld);
                                 CurrPage.UPDATE(TRUE);
                               END;
                             END;
                              }

    { 1000025;2;Field     ;
                SourceExpr="Sub Table No.";
                Enabled="Sub Table No.Enable";
                Editable="Sub Table No.Editable";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           IF Mgt.LookupTableNo(Text) THEN BEGIN
                             EVALUATE("Sub Table No.",Text);
                             VALIDATE("Sub Table No.");
                           END;

                           // IDYN EBK >>>>
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //Mgt.LookupRelatedTableNo("Main Table No.",Text);
                           //EVALUATE("Sub Table No.",Text);
                           //VALIDATE("Sub Table No.");
                           //EXIT(Mgt.LookupRelatedTableNo("Main Table No.", Text));
                           // IDYN EBK <<<<
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.AssistTableNo("Main Table No.");
                             END;
                              }

    { 1000037;2;Field     ;
                AssistEdit=Yes;
                SourceExpr="Sub Table Filter";
                Enabled="Sub Table FilterEnable";
                Editable="Sub Table FilterEditable";
                OnAssistEdit=BEGIN
                               EVALUATE("Sub Table Filter",INMgt.SetTableFilter("Sub Table No.",FORMAT("Sub Table Filter")));
                             END;
                              }

    { 1000033;2;Field     ;
                DrillDown=No;
                SourceExpr="Sub Table No. of Fields";
                Enabled="Sub Table No. of FieldsEnable";
                OnAssistEdit=VAR
                               TmpFld@1000001 : TEMPORARY Record 2000000041;
                               SelectFields@1000000 : Page 11148589;
                             BEGIN
                               TESTFIELD("Sub Table No.");

                               SelectFields.SetExportDefinition(FALSE, Rec);
                               SelectFields.SetFormBlocked(Status <> Status::Edit);
                               IF SelectFields.RUNMODAL = ACTION::OK THEN BEGIN
                                 SelectFields.GetSelectedFields(TmpFld);
                                 UpdateTableFields(FALSE, "Sub Table No.", TmpFld);
                                 CurrPage.UPDATE(TRUE);
                               END;
                             END;
                              }

    { 1903121901;1;Group  ;
                CaptionML=[ENU=Options;
                           NLD=Opties] }

    { 1000073;2;Field     ;
                SourceExpr="Run Task";
                Editable="Run TaskEditable" }

    { 1000085;2;Field     ;
                SourceExpr="Project Code";
                Editable="Project CodeEditable" }

    { 1000009;2;Field     ;
                SourceExpr="Company Name" }

    { 1000027;2;Field     ;
                SourceExpr=Headers;
                Enabled=HeadersEnable;
                Editable=HeadersEditable }

    { 1000000003;2;Field  ;
                SourceExpr="Worksheet Name" }

    { 1100512000;2;Field  ;
                SourceExpr="Run Codeunit No.";
                Visible=FALSE;
                Editable="Run Codeunit No.Editable";
                OnLookup=VAR
                           Mgt@1100512000 : Codeunit 11148589;
                         BEGIN
                           EXIT(Mgt.LookupObjectNo(5, Text));
                         END;
                          }

  }
  CODE
  {
    VAR
      INMgt@1000000001 : Codeunit 11148589;
      CodeEditable@19001698 : Boolean INDATASET;
      DescriptionEditable@19061412 : Boolean INDATASET;
      LocationEditable@19035910 : Boolean INDATASET;
      "Filename TypeEditable"@19038575 : Boolean INDATASET;
      FilenameEditable@19007928 : Boolean INDATASET;
      "File FormatEditable"@19047526 : Boolean INDATASET;
      HeadersEditable@19062436 : Boolean INDATASET;
      "Save to MessagesEditable"@19046008 : Boolean INDATASET;
      "Run Codeunit No.Editable"@19055664 : Boolean INDATASET;
      "Run TaskEditable"@19005185 : Boolean INDATASET;
      "Main Table No.Editable"@19066361 : Boolean INDATASET;
      "Main Table FilterEditable"@19035070 : Boolean INDATASET;
      "Sub Table FilterEditable"@19045437 : Boolean INDATASET;
      "Sub Table No.Editable"@19054278 : Boolean INDATASET;
      "Project CodeEditable"@19062497 : Boolean INDATASET;
      LinesEditable@19010511 : Boolean INDATASET;
      LocationEnable@19013618 : Boolean INDATASET;
      FilenameEnable@19043700 : Boolean INDATASET;
      "Filename TypeEnable"@19052158 : Boolean INDATASET;
      "Save to MessagesEnable"@19010110 : Boolean INDATASET;
      "Sub Table No.Enable"@19033464 : Boolean INDATASET;
      "Sub Table FilterEnable"@19073453 : Boolean INDATASET;
      "Sub Table No. of FieldsEnable"@19016380 : Boolean INDATASET;
      LeftEnable@19065291 : Boolean INDATASET;
      RightEnable@19037326 : Boolean INDATASET;
      HeadersEnable@1000000000 : Boolean INDATASET;

    LOCAL PROCEDURE EnableFields@1000000();
    BEGIN
      LocationEnable := "File Format" <> "File Format"::ADO;
      FilenameEnable := "File Format" <> "File Format"::ADO;
      "Filename TypeEnable" := "File Format" <> "File Format"::ADO;
      "Save to MessagesEnable" := "File Format" <> "File Format"::ADO;

      "Sub Table No.Enable" := "File Format" <> "File Format"::ADO;
      "Sub Table FilterEnable" := "File Format" <> "File Format"::ADO;
      "Sub Table No. of FieldsEnable" := "File Format" <> "File Format"::ADO;

      HeadersEnable := "File Format" IN ["File Format"::CSV, "File Format"::"Fixed Width", "File Format"::Excel];
      LeftEnable := "File Format" <> "File Format"::ADO;
      RightEnable := "File Format" <> "File Format"::ADO;
    END;

    LOCAL PROCEDURE SetFileFormatToLines@1000002();
    BEGIN
      CurrPage.Lines.PAGE.SetFileFormat("File Format");
    END;

    LOCAL PROCEDURE SetEditable@1000003();
    BEGIN
      CodeEditable := (Status = Status::Edit);
      DescriptionEditable := (Status = Status::Edit);
      LocationEditable := (Status = Status::Edit);
      "Filename TypeEditable" := (Status = Status::Edit);
      FilenameEditable := (Status = Status::Edit);
      "File FormatEditable" := (Status = Status::Edit);
      HeadersEditable := (Status = Status::Edit);
      "Save to MessagesEditable" := (Status = Status::Edit);
      "Run Codeunit No.Editable" := (Status = Status::Edit);
      "Run TaskEditable" := (Status = Status::Edit);
      "Main Table No.Editable" := (Status = Status::Edit);
      "Main Table FilterEditable" := (Status = Status::Edit);
      "Sub Table FilterEditable" := (Status = Status::Edit);
      "Sub Table No.Editable" := (Status = Status::Edit);
      "Project CodeEditable" := (Status = Status::Edit);
      LinesEditable := (Status = Status::Edit);
    END;

    LOCAL PROCEDURE StatusOnAfterValidate@19072689();
    BEGIN
      SetEditable;
    END;

    LOCAL PROCEDURE FileFormatOnAfterValidate@19065317();
    BEGIN
      EnableFields;

      SetFileFormatToLines;
      CurrPage.Lines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      xRec := Rec;
      IF FORMAT("Main Table Filter") = '' THEN
        EVALUATE("Main Table Filter", Mgt.EmptyTableFilter("Main Table No."));

      IF FORMAT("Sub Table Filter") = '' THEN
        EVALUATE("Sub Table Filter", Mgt.EmptyTableFilter("Sub Table No."));

      EnableFields;
      SetEditable;

      SetFileFormatToLines;
    END;

    LOCAL PROCEDURE LocationOnAfterInput@19074197(VAR Text@19074198 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFolder(Text);
    END;

    LOCAL PROCEDURE MainTableNoOnAfterInput@19047063(VAR Text@19047064 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE MainTableFilterOnAfterInput@19078863(VAR Text@19078864 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableFilter(Text, "Main Table No.");
    END;

    LOCAL PROCEDURE SubTableFilterOnAfterInput@19008895(VAR Text@19008896 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableFilter(Text, "Sub Table No.");
    END;

    LOCAL PROCEDURE SubTableNoOnAfterInput@19065603(VAR Text@19065604 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE RunCodeunitNoOnAfterInput@19017510(VAR Text@19017511 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputObjectNo(5, Text);
    END;

    LOCAL PROCEDURE MainTableNoOnFormat@19079044(Text@19015475 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Main Table No.");
    END;

    LOCAL PROCEDURE MainTableFilterOnFormat@19021213(Text@19073443 : Text[1024]);
    VAR
      Mgt@1000002 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableFilter(Text, "Main Table No.");
    END;

    LOCAL PROCEDURE SubTableFilterOnFormat@19007760(Text@19036173 : Text[1024]);
    VAR
      Mgt@1000002 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableFilter(Text, "Sub Table No.");
    END;

    LOCAL PROCEDURE SubTableNoOnFormat@19052089(Text@19075565 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Sub Table No.");
    END;

    LOCAL PROCEDURE RunCodeunitNoOnFormat@19054474(Text@19073072 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatObjectNo(5, Text, "Run Codeunit No.");
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117086 CI - Excel Export Subform
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Excel Export Subform;
               NLD=Excel Exportdefinitiesubform];
    SourceTable=Table11148600;
    SourceTableView=SORTING(Export Definition,Line No.);
    PageType=ListPart;
    OnInit=BEGIN
             "Option TypeEditable" := TRUE;
             CodeEditable := TRUE;
             "Conversion CodeEditable" := TRUE;
             LinktoTableTagNameEditable := TRUE;
             "Skip If EmptyEditable" := TRUE;
             "Table FilterEditable" := TRUE;
             "Field No.Editable" := TRUE;
             "Table No.Editable" := TRUE;
           END;

    OnAfterGetRecord=VAR
                       Mgt@1000000 : Codeunit 11148589;
                     BEGIN
                       "Option TypeHideValue" := FALSE;
                       "Tag NameIndent" := 0;
                       IF SYSTEM.FORMAT("Table Filter") = '' THEN
                         EVALUATE("Table Filter", Mgt.EmptyTableFilter("Table No."));
                       OnAfterGetCurrRecord;
                       TagNameOnFormat;
                       TableNoOnFormat(FORMAT("Table No."));
                       FieldNoOnFormat(FORMAT("Field No."));
                       TableFilterOnFormat(FORMAT("Table Filter"));
                       OptionTypeOnFormat;
                     END;

    OnNewRecord=BEGIN
                  SetupNewLine(xRec, BelowxRec);
                  OnAfterGetCurrRecord;
                END;

    OnModifyRecord=BEGIN
                     IF SYSTEM.FORMAT("Table Filter") <> '' THEN
                       VALIDATE("Table Filter");

                     EXIT(TRUE);
                   END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1902311204;1 ;ActionGroup;
                      CaptionML=[ENU=Export &Def.;
                                 NLD=&Exportdef.] }
      { 1903294104;2 ;Action    ;
                      ShortCutKey=Ctrl+L;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Link &Tables;
                                 NLD=Tabellen linken];
                      OnAction=BEGIN
                                 LinkTables;
                               END;
                                }
      { 1906069704;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+V;
                      CaptionML=[ENU=Set &Filter With Variables;
                                 NLD=Zet filter met variabelen];
                      OnAction=BEGIN
                                 _SetFilterWithVariables;
                               END;
                                }
      { 1000000005;1 ;Separator  }
      { 1000000003;1 ;Action    ;
                      Name=<Action1000000000>;
                      ShortCutKey=Shift+Ctrl+R;
                      CaptionML=[ENU=Right;
                                 NLD=Rechts];
                      Promoted=Yes;
                      OnAction=BEGIN
                                 Right;
                               END;
                                }
      { 1000000002;1 ;Action    ;
                      Name=<Action1000000001>;
                      ShortCutKey=Shift+Ctrl+L;
                      CaptionML=[ENU=Left;
                                 NLD=Links];
                      OnAction=BEGIN
                                 Left;
                               END;
                                }
      { 1000000001;1 ;Action    ;
                      Name=<Action1000000002>;
                      ShortCutKey=Shift+Ctrl+U;
                      CaptionML=[ENU=Up;
                                 NLD=Omhoog];
                      OnAction=BEGIN
                                 Up;
                               END;
                                }
      { 1000000000;1 ;Action    ;
                      Name=<Action1000000003>;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Down;
                                 NLD=Omlaag];
                      OnAction=BEGIN
                                 Down;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                IndentationColumnName="Tag NameIndent";
                IndentationControls=Tag Name;
                GroupType=Repeater }

    { 1000011;2;Field     ;
                SourceExpr="Tag Name" }

    { 1000001;2;Field     ;
                SourceExpr=Type;
                ValuesAllowed=[Table;Field;Const;Variable];
                OnValidate=BEGIN
                             TypeOnAfterValidate;
                           END;
                            }

    { 1000013;2;Field     ;
                SourceExpr=Code;
                Editable=CodeEditable }

    { 1000000008;2;Field  ;
                SourceExpr="Table No.";
                Editable="Table No.Editable";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           // IDYN EBK >>>>
                           IF Mgt.LookupTableNo(Text) THEN BEGIN
                             EVALUATE("Table No.",Text);
                             VALIDATE("Table No.");
                           END;
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //EXIT(Mgt.LookupTableNo(Text));
                           // IDYN EBK <<<<
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.AssistTableNo("Table No.");
                             END;
                              }

    { 1000000007;2;Field  ;
                Name=Table Name;
                SourceExpr="Table Name" }

    { 1000000006;2;Field  ;
                SourceExpr="Field No.";
                Editable="Field No.Editable";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           // IDYN EBK >>>>
                           IF Mgt.LookupFieldNo("Table No.",Text,TRUE) THEN BEGIN
                             EVALUATE("Field No.",Text);
                             VALIDATE("Field No.");
                           END;
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //EXIT(Mgt.LookupFieldNo("Table No.", Text, TRUE));
                           // IDYN EBK <<<<
                         END;
                          }

    { 1000000004;2;Field  ;
                Name=Field Name;
                SourceExpr="Field Name" }

    { 1100531000;2;Field  ;
                SourceExpr="No. of Functions";
                Visible=FALSE }

    { 1000031;2;Field     ;
                SourceExpr="Original Value";
                Visible=FALSE }

    { 1000015;2;Field     ;
                AssistEdit=Yes;
                SourceExpr="Table Filter";
                Editable="Table FilterEditable";
                OnAssistEdit=VAR
                               INMgt@1000000000 : Codeunit 11148589;
                             BEGIN
                               EVALUATE("Table Filter", INMgt.SetTableFilter("Table No.", FORMAT("Table Filter"))); // CI-143
                             END;
                              }

    { 1000023;2;Field     ;
                SourceExpr="Link to Table (Tag Name)";
                Editable=LinktoTableTagNameEditable;
                OnAssistEdit=BEGIN
                               SetupLinkToTable;
                             END;
                              }

    { 1000021;2;Field     ;
                SourceExpr="Conversion Code";
                Editable="Conversion CodeEditable" }

    { 1000025;2;Field     ;
                SourceExpr="Dest. Variable";
                Visible=FALSE }

    { 1000035;2;Field     ;
                SourceExpr="Skip If Empty";
                Visible=FALSE;
                Editable="Skip If EmptyEditable" }

    { 1000017;2;Field     ;
                SourceExpr="Data Format";
                Visible=FALSE }

    { 1000033;2;Field     ;
                SourceExpr="Option Type";
                Visible=FALSE;
                Editable="Option TypeEditable";
                HideValue="Option TypeHideValue" }

    { 1000007;2;Field     ;
                SourceExpr="Before Field";
                Visible=FALSE }

    { 1000019;2;Field     ;
                SourceExpr="After Field";
                Visible=FALSE }

  }
  CODE
  {
    VAR
      FileFormat@1000000 : 'XML,CSV,FixedWidth,Excel';
      "Tag NameIndent"@19056250 : Integer INDATASET;
      "Option TypeHideValue"@19002310 : Boolean INDATASET;
      "Table No.Editable"@19076806 : Boolean INDATASET;
      "Field No.Editable"@19022826 : Boolean INDATASET;
      "Table FilterEditable"@19054732 : Boolean INDATASET;
      "Skip If EmptyEditable"@19053977 : Boolean INDATASET;
      LinktoTableTagNameEditable@19004008 : Boolean INDATASET;
      "Conversion CodeEditable"@19074872 : Boolean INDATASET;
      CodeEditable@19001698 : Boolean INDATASET;
      "Option TypeEditable"@19019138 : Boolean INDATASET;

    PROCEDURE Left@1000000();
    VAR
      ExportDefLine@1100512000 : Record 11148600;
    BEGIN
      CurrPage.SETSELECTIONFILTER(ExportDefLine);
      IF ExportDefLine.FINDSET THEN
        REPEAT
          IF ExportDefLine."Entry No." <> 0 THEN
            IF ExportDefLine.Indent > 0 THEN BEGIN
              ExportDefLine.Indent -= 1;
              ExportDefLine.MODIFY;
            END;
        UNTIL ExportDefLine.NEXT = 0;
    END;

    PROCEDURE Right@1000001();
    VAR
      ExportDefLine@1100512000 : Record 11148600;
    BEGIN
      CurrPage.SETSELECTIONFILTER(ExportDefLine);
      IF ExportDefLine.FINDSET THEN
        REPEAT
          IF ExportDefLine."Entry No." <> 0 THEN BEGIN
            ExportDefLine.Indent += 1;
            ExportDefLine.MODIFY;
          END;
        UNTIL ExportDefLine.NEXT = 0;
    END;

    PROCEDURE Up@1000011();
    VAR
      CurrLine@1000004 : Record 11148600;
      ExportDefinitionLine@1000000 : Record 11148600;
      SelectedLine@1000002 : Record 11148600;
      LineNo@1000001 : Integer;
    BEGIN
      CurrLine := Rec;

      CurrPage.SETSELECTIONFILTER(SelectedLine);
      IF SelectedLine.COUNT = 0 THEN BEGIN
        SelectedLine.RESET;
        SelectedLine := Rec;
        SelectedLine.SETRECFILTER;
      END;

      IF SelectedLine.FINDSET THEN
        REPEAT
          ExportDefinitionLine.SETCURRENTKEY("Export Definition", "Line No.");
          ExportDefinitionLine.SETRANGE("Export Definition", "Export Definition");
          ExportDefinitionLine := SelectedLine;
          IF ExportDefinitionLine.NEXT(-1) <> 0 THEN BEGIN
            LineNo := ExportDefinitionLine."Line No.";
            ExportDefinitionLine."Line No." := SelectedLine."Line No.";
            ExportDefinitionLine.MODIFY;
            SelectedLine."Line No." := LineNo;
            SelectedLine.MODIFY;
          END;
        UNTIL SelectedLine.NEXT = 0;

      GET(CurrLine."Export Definition", CurrLine."Entry No.");
    END;

    PROCEDURE Down@1000010();
    VAR
      CurrLine@1000004 : Record 11148600;
      ExportDefinitionLine@1000006 : Record 11148600;
      SelectedLine@1000005 : Record 11148600;
      LineNo@1000000 : Integer;
    BEGIN
      CurrLine := Rec;

      CurrPage.SETSELECTIONFILTER(SelectedLine);
      IF SelectedLine.COUNT = 0 THEN BEGIN
        SelectedLine.RESET;
        SelectedLine := Rec;
        SelectedLine.SETRECFILTER;
      END;

      IF SelectedLine.FINDLAST THEN
        REPEAT
          ExportDefinitionLine.SETCURRENTKEY("Export Definition", "Line No.");
          ExportDefinitionLine.SETRANGE("Export Definition", "Export Definition");
          ExportDefinitionLine := SelectedLine;
          IF ExportDefinitionLine.NEXT(1) <> 0 THEN BEGIN
            LineNo := ExportDefinitionLine."Line No.";
            ExportDefinitionLine."Line No." := SelectedLine."Line No.";
            ExportDefinitionLine.MODIFY;
            SelectedLine."Line No." := LineNo;
            SelectedLine.MODIFY;
          END;
        UNTIL SelectedLine.NEXT(-1) = 0;

      GET(CurrLine."Export Definition", CurrLine."Entry No.");
    END;

    PROCEDURE LinkTables@1000002();
    BEGIN
      SetupLinkToTable;
    END;

    PROCEDURE UpdateForm@1000003();
    BEGIN
      CurrPage.UPDATE(FALSE);
    END;

    PROCEDURE SetFileFormat@1000008(NewValue@1000000 : Option);
    BEGIN
      FileFormat := NewValue;
    END;

    LOCAL PROCEDURE SetFieldEditable@1000007();
    BEGIN
      "Table No.Editable" := (Type IN [Type::Field, Type::Table]);
      "Field No.Editable" := (Type = Type::Field);
      "Table FilterEditable" := (Type = Type::Table);
      "Skip If EmptyEditable" := (TRUE);

      LinktoTableTagNameEditable := (Type = Type::Table);
      "Conversion CodeEditable" := (Type IN [Type::Field, Type::Variable, Type::Const]);

      CodeEditable := (Type IN [Type::Const, Type::Variable, Type::Table]);
      "Option TypeEditable" := (Type = Type::Field);
    END;

    PROCEDURE _SetFilterWithVariables@19012358();
    BEGIN
      SetFilterWithVariables;
    END;

    PROCEDURE SetFilterWithVariables@1000009();
    BEGIN
      SetFilterWithVariables;
    END;

    LOCAL PROCEDURE TypeOnAfterValidate@19069045();
    BEGIN
      SetFieldEditable;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      SetFieldEditable;
    END;

    LOCAL PROCEDURE TableNoOnAfterInput@19060375(VAR Text@19060376 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE FieldNoOnAfterInput@19063566(VAR Text@19063567 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFieldNo(Text, "Table No.", FALSE);
    END;

    LOCAL PROCEDURE TableFilterOnAfterInput@19072298(VAR Text@19072299 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableFilter(Text, "Table No.");
    END;

    LOCAL PROCEDURE TagNameOnFormat@19023679();
    BEGIN
      "Tag NameIndent" := Indent;
    END;

    LOCAL PROCEDURE TableNoOnFormat@19071785(Text@19016339 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Table No.");
    END;

    LOCAL PROCEDURE FieldNoOnFormat@19075355(Text@19041114 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatFieldNo(Text, "Table No.", "Field No.");
    END;

    LOCAL PROCEDURE TableFilterOnFormat@19013929(Text@19048068 : Text[1024]);
    VAR
      Mgt@1000002 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableFilter(Text, "Table No.");
    END;

    LOCAL PROCEDURE OptionTypeOnFormat@19077341();
    BEGIN
      IF Type <> Type::Field THEN
        "Option TypeHideValue" := TRUE;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117087 CI - ADO Export Card
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=ADO Export Card;
               NLD=ADO Exportdefinitie];
    SourceTable=Table11148599;
    SourceTableView=WHERE(File Format=CONST(ADO));
    PageType=Card;
    OnInit=BEGIN
             RightEnable := TRUE;
             LeftEnable := TRUE;
             "SQL StringEnable" := TRUE;
             "Connection StringEnable" := TRUE;
             LinesEditable := TRUE;
             "Project CodeEditable" := TRUE;
             "Main Table FilterEditable" := TRUE;
             "Main Table No.Editable" := TRUE;
             "Run TaskEditable" := TRUE;
             "File FormatEditable" := TRUE;
             DescriptionEditable := TRUE;
             CodeEditable := TRUE;
           END;

    OnOpenPage=VAR
                 Initialize@1000001 : Codeunit 11148625;
               BEGIN
                 Initialize.CheckInitialize;
               END;

    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                       MainTableNoOnFormat(FORMAT("Main Table No."));
                       MainTableFilterOnFormat(FORMAT("Main Table Filter"));
                     END;

    OnNewRecord=VAR
                  Setup@1000000 : Record 11148589;
                BEGIN
                  Setup.GET;
                  "XML Declaration" := Setup."XML Declaration";
                  Location := Setup."Default Export Location";

                  "File Format" := "File Format"::ADO;
                  OnAfterGetCurrRecord;
                END;

    OnModifyRecord=BEGIN
                     VALIDATE("Main Table Filter");
                     VALIDATE("Sub Table Filter");

                     EXIT(TRUE);
                   END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000016 ;1   ;ActionGroup;
                      CaptionML=[ENU=Export &Def.;
                                 NLD=&Exportdef.] }
      { 1000029 ;2   ;Separator  }
      { 1100531001;2 ;Action    ;
                      ShortCutKey=Ctrl+Alt+V;
                      CaptionML=[ENU=Versions;
                                 NLD=Versies];
                      RunObject=Page 11117096;
                      RunPageView=SORTING(Code,Version No.);
                      RunPageLink=Code=FIELD(Code) }
      { 1100531000;2 ;Action    ;
                      ShortCutKey=Ctrl+S;
                      CaptionML=[ENU=Save as New Version;
                                 NLD=Op&slaan als nieuwe versie];
                      OnAction=BEGIN
                                 SaveNewVersion;
                               END;
                                }
      { 1100531004;2 ;Separator  }
      { 1000056 ;2   ;Action    ;
                      ShortCutKey=Ctrl+F5;
                      CaptionML=[ENU=Messages;
                                 NLD=Berichten];
                      RunObject=Page 11117032;
                      RunPageView=SORTING(Entry No.);
                      RunPageLink=Type=CONST(Export),
                                  Code=FIELD(Code) }
      { 1000057 ;2   ;Action    ;
                      CaptionML=[ENU=History;
                                 NLD=Historie];
                      RunObject=Page 11117034;
                      RunPageView=SORTING(Type,Code);
                      RunPageLink=Type=CONST(Export),
                                  Code=FIELD(Code) }
      { 1000043 ;2   ;Separator  }
      { 1000044 ;2   ;Action    ;
                      CaptionML=[ENU=M&onitoring Setup;
                                 NLD=Monitoring&instellingen];
                      RunObject=Page 11117027;
                      RunPageView=SORTING(Export Definition);
                      RunPageLink=Export Definition=FIELD(Code) }
      { 1000045 ;2   ;Action    ;
                      CaptionML=[ENU=Export Jobs;
                                 NLD=E&xporteeropdrachten];
                      RunObject=Page 11117028;
                      RunPageView=SORTING(Status,Export Definition);
                      RunPageLink=Export Definition=FIELD(Code) }
      { 1000021 ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NLD=F&uncties] }
      { 1000049 ;2   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Process;
                                 NLD=Verwerken];
                      OnAction=VAR
                                 Setup@1100512001 : Record 11148589;
                                 ProcessExportDef@1000002 : Codeunit 11148606;
                                 Progressbar@1000001 : Codeunit 11148624;
                                 ErrorMgt@1000006 : Codeunit 11148630;
                                 FileExported@1000004 : Boolean;
                                 ctDataExported@1000007 : TextConst 'ENU=Data exported;NLD=Data gexporteerd.';
                                 ctExportCancelled@1000005 : TextConst 'ENU=Export cancelled.;NLD=Exporteren afgebroken.';
                                 ctFileCreated@1000003 : TextConst 'ENU=Export processed.;NLD=Export verwerkt.';
                               BEGIN
                                 ErrorMgt.ClearError;

                                 TestRecordSet;

                                 Progressbar.Open(1);

                                 Setup.GET;
                                 IF Setup."Use Error Handling" THEN
                                   FileExported := ProcessExportDef.RUN(Rec)
                                 ELSE BEGIN
                                   ProcessExportDef.RUN(Rec);
                                   FileExported := TRUE;
                                 END;

                                 Progressbar.Close;

                                 IF FileExported THEN
                                   IF "File Format" = "File Format"::ADO THEN
                                     MESSAGE(ctDataExported)
                                   ELSE
                                     MESSAGE(ctFileCreated)
                                 ELSE BEGIN
                                   AddTraceEntry(TRUE, ErrorMgt.GetError, 0);
                                   IF ErrorMgt.GetError = '' THEN
                                     MESSAGE(ctExportCancelled)
                                   ELSE
                                     MESSAGE(ErrorMgt.GetError);
                                 END;
                               END;
                                }
      { 1000072 ;2   ;Action    ;
                      CaptionML=[ENU=Copy;
                                 NLD=Kopiren];
                      OnAction=BEGIN
                                 Copy;
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1000000001;2 ;Action    ;
                      Name=<Action1000000000>;
                      CaptionML=[ENU=Copy To;
                                 NLD=Kopiren naar];
                      OnAction=BEGIN
                                 CopyTo;
                               END;
                                }
      { 1000046 ;2   ;Action    ;
                      CaptionML=[ENU=Renumber Lines;
                                 NLD=Regels hernummeren];
                      OnAction=BEGIN
                                 RenumberLines;
                               END;
                                }
      { 1000095 ;2   ;Action    ;
                      CaptionML=[ENU=Reversed Data &Mapping;
                                 NLD=Reversed data&mapping];
                      OnAction=BEGIN
                                 ReversedDataMapping;
                               END;
                                }
      { 1000071 ;2   ;Separator  }
      { 1000070 ;2   ;Action    ;
                      CaptionML=[ENU=Pri&nt;
                                 NLD=Afdrukken];
                      OnAction=VAR
                                 ExportDefinition@1000000 : Record 11148599;
                               BEGIN
                                 ExportDefinition := Rec;
                                 ExportDefinition.SETRECFILTER;
                                 REPORT.RUN(REPORT::"CI - Export Definitions", TRUE, FALSE, ExportDefinition);
                               END;
                                }
      { 1000089 ;2   ;Separator  }
      { 1000088 ;2   ;Action    ;
                      CaptionML=[ENU=Export Definition to &XML;
                                 NLD=Definitie exporteren naar &XML];
                      OnAction=VAR
                                 ExportDefinitionToXML@1000000 : Codeunit 11148634;
                               BEGIN
                                 ExportDefinitionToXML.ExportExportDefinition(Rec);
                               END;
                                }
      { 1000090 ;2   ;Action    ;
                      CaptionML=[ENU=Import Definition from XML;
                                 NLD=XML-Definitie &importeren];
                      OnAction=VAR
                                 ImportXMLDefinition@1000000 : Codeunit 11148636;
                               BEGIN
                                 ImportXMLDefinition.ImportExportDefinition(Rec);
                               END;
                                }
      { 1000068 ;2   ;Separator  }
      { 1000069 ;2   ;Action    ;
                      CaptionML=[ENU=Create M&onitoring Line;
                                 NLD=M&onitorregel aanmaken];
                      OnAction=BEGIN
                                 CreateMonitoringLine;
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000050 ;1   ;Action    ;
                      Name=Left;
                      Promoted=Yes;
                      Enabled=LeftEnable;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+L');
                               END;
                                }
      { 1000048 ;1   ;Action    ;
                      Name=Right;
                      Promoted=Yes;
                      Enabled=RightEnable;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+R');
                               END;
                                }
      { 1000047 ;1   ;Action    ;
                      Name=<Action1000047>;
                      CaptionML=[ENU=Up;
                                 NLD=Omhoog];
                      Promoted=Yes;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+U');
                               END;
                                }
      { 1000028 ;1   ;Action    ;
                      Name=<Action1000028>;
                      CaptionML=[ENU=Down;
                                 NLD=Omlaag];
                      Promoted=Yes;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 INMgt.SendKeys('^+D');
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                CaptionML=[ENU=General;
                           NLD=Algemeen] }

    { 1000001;2;Field     ;
                SourceExpr=Code;
                Editable=CodeEditable }

    { 1000003;2;Field     ;
                SourceExpr=Description;
                Editable=DescriptionEditable }

    { 1000091;2;Field     ;
                SourceExpr="Connection String";
                Enabled="Connection StringEnable" }

    { 1000093;2;Field     ;
                SourceExpr="SQL String";
                Enabled="SQL StringEnable" }

    { 1000005;2;Field     ;
                SourceExpr="Execute in ADO Database" }

    { 1000011;2;Field     ;
                SourceExpr=Status;
                ValuesAllowed=[Edit;Manual;Automated;Blocked];
                OnValidate=BEGIN
                             StatusOnAfterValidate;
                           END;
                            }

    { 1000015;2;Field     ;
                SourceExpr="No. of Monitoring Lines" }

    { 1000014;2;Field     ;
                SourceExpr="No. of Export Jobs" }

    { 1000024;1;Part      ;
                Name=Lines;
                SubPageLink=Export Definition=FIELD(Code);
                PagePartID=Page11117088;
                Editable=LinesEditable }

    { 1905328801;1;Group  ;
                CaptionML=[ENU=Field Selection;
                           NLD=Veldselectie] }

    { 1000010;2;Field     ;
                SourceExpr="Main Table No.";
                Editable="Main Table No.Editable";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           // IDYN EBK >>>>
                           IF Mgt.LookupTableNo(Text) THEN BEGIN
                             EVALUATE("Main Table No.",Text);
                             VALIDATE("Main Table No.");
                           END;
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //EXIT(Mgt.LookupTableNo(Text));
                           // IDYN EBK <<<<
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.AssistTableNo("Main Table No.");
                             END;
                              }

    { 1000035;2;Field     ;
                AssistEdit=Yes;
                SourceExpr="Main Table Filter";
                Editable="Main Table FilterEditable";
                OnAssistEdit=BEGIN
                               EVALUATE("Main Table Filter",INMgt.SetTableFilter("Main Table No.",FORMAT("Main Table Filter")));
                             END;
                              }

    { 1000031;2;Field     ;
                DrillDown=No;
                SourceExpr="Main Table No. of Fields";
                OnAssistEdit=VAR
                               TmpFld@1000001 : TEMPORARY Record 2000000041;
                               SelectFields@1000000 : Page 11148589;
                             BEGIN
                               TESTFIELD("Main Table No.");

                               SelectFields.SetExportDefinition(TRUE, Rec);
                               SelectFields.SetFormBlocked(Status <> Status::Edit);
                               IF SelectFields.RUNMODAL = ACTION::OK THEN BEGIN
                                 SelectFields.GetSelectedFields(TmpFld);
                                 UpdateTableFields(TRUE, "Main Table No.", TmpFld);
                                 CurrPage.UPDATE(TRUE);
                               END;
                             END;
                              }

    { 1903121901;1;Group  ;
                CaptionML=[ENU=Options;
                           NLD=Opties] }

    { 1000073;2;Field     ;
                SourceExpr="Run Task";
                Editable="Run TaskEditable" }

    { 1000085;2;Field     ;
                SourceExpr="Project Code";
                Editable="Project CodeEditable" }

    { 1000009;2;Field     ;
                SourceExpr="Company Name" }

  }
  CODE
  {
    VAR
      INMgt@1000000000 : Codeunit 11148589;
      CodeEditable@19001698 : Boolean INDATASET;
      DescriptionEditable@19061412 : Boolean INDATASET;
      "File FormatEditable"@19047526 : Boolean INDATASET;
      "Run TaskEditable"@19005185 : Boolean INDATASET;
      "Main Table No.Editable"@19066361 : Boolean INDATASET;
      "Main Table FilterEditable"@19035070 : Boolean INDATASET;
      "Project CodeEditable"@19062497 : Boolean INDATASET;
      LinesEditable@19010511 : Boolean INDATASET;
      "Connection StringEnable"@19076131 : Boolean INDATASET;
      "SQL StringEnable"@19077671 : Boolean INDATASET;
      LeftEnable@19065291 : Boolean INDATASET;
      RightEnable@19037326 : Boolean INDATASET;

    LOCAL PROCEDURE EnableFields@1000000();
    BEGIN
      "Connection StringEnable" := "File Format" = "File Format"::ADO;
      "SQL StringEnable" := "File Format" = "File Format"::ADO;

      LeftEnable := "File Format" <> "File Format"::ADO;
      RightEnable := "File Format" <> "File Format"::ADO;
    END;

    LOCAL PROCEDURE SetFileFormatToLines@1000002();
    BEGIN
      CurrPage.Lines.PAGE.SetFileFormat("File Format");
    END;

    LOCAL PROCEDURE SetEditable@1000003();
    BEGIN
      CodeEditable := (Status = Status::Edit);
      DescriptionEditable := (Status = Status::Edit);
      "File FormatEditable" := (Status = Status::Edit);
      "Run TaskEditable" := (Status = Status::Edit);
      "Main Table No.Editable" := (Status = Status::Edit);
      "Main Table FilterEditable" := (Status = Status::Edit);
      "Project CodeEditable" := (Status = Status::Edit);
      LinesEditable := (Status = Status::Edit);
    END;

    LOCAL PROCEDURE StatusOnAfterValidate@19072689();
    BEGIN
      SetEditable;
    END;

    LOCAL PROCEDURE FileFormatOnAfterValidate@19065317();
    BEGIN
      EnableFields;

      SetFileFormatToLines;
      CurrPage.Lines.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      xRec := Rec;
      IF FORMAT("Main Table Filter") = '' THEN
        EVALUATE("Main Table Filter", Mgt.EmptyTableFilter("Main Table No."));

      IF FORMAT("Sub Table Filter") = '' THEN
        EVALUATE("Sub Table Filter", Mgt.EmptyTableFilter("Sub Table No."));

      EnableFields;
      SetEditable;

      SetFileFormatToLines;
    END;

    LOCAL PROCEDURE MainTableNoOnAfterInput@19047063(VAR Text@19047064 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE MainTableFilterOnAfterInput@19078863(VAR Text@19078864 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableFilter(Text, "Main Table No.");
    END;

    LOCAL PROCEDURE MainTableNoOnFormat@19079044(Text@19015475 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Main Table No.");
    END;

    LOCAL PROCEDURE MainTableFilterOnFormat@19021213(Text@19073443 : Text[1024]);
    VAR
      Mgt@1000002 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableFilter(Text, "Main Table No.");
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117088 CI - ADO Export Subform
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=ADO Export Subform;
               NLD=ADO Exportdefinitiesubform];
    SourceTable=Table11148600;
    SourceTableView=SORTING(Export Definition,Line No.);
    PageType=ListPart;
    OnInit=BEGIN
             "Option TypeEditable" := TRUE;
             CodeEditable := TRUE;
             "Conversion CodeEditable" := TRUE;
             LinktoTableTagNameEditable := TRUE;
             "Skip If EmptyEditable" := TRUE;
             "Table FilterEditable" := TRUE;
             "Field No.Editable" := TRUE;
             "Table No.Editable" := TRUE;
           END;

    OnAfterGetRecord=VAR
                       Mgt@1000000 : Codeunit 11148589;
                     BEGIN
                       "Option TypeHideValue" := FALSE;
                       "Tag NameIndent" := 0;
                       IF SYSTEM.FORMAT("Table Filter") = '' THEN
                         EVALUATE("Table Filter", Mgt.EmptyTableFilter("Table No."));
                       OnAfterGetCurrRecord;
                       TagNameOnFormat;
                       TableNoOnFormat(FORMAT("Table No."));
                       FieldNoOnFormat(FORMAT("Field No."));
                       TableFilterOnFormat(FORMAT("Table Filter"));
                       OptionTypeOnFormat;
                     END;

    OnNewRecord=BEGIN
                  SetupNewLine(xRec, BelowxRec);
                  OnAfterGetCurrRecord;
                END;

    OnModifyRecord=BEGIN
                     IF SYSTEM.FORMAT("Table Filter") <> '' THEN
                       VALIDATE("Table Filter");

                     EXIT(TRUE);
                   END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1902311204;1 ;ActionGroup;
                      CaptionML=[ENU=Export &Def.;
                                 NLD=&Exportdef.] }
      { 1903294104;2 ;Action    ;
                      ShortCutKey=Ctrl+L;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Link &Tables;
                                 NLD=Tabellen linken];
                      OnAction=BEGIN
                                 LinkTables;
                               END;
                                }
      { 1906069704;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+V;
                      CaptionML=[ENU=Set &Filter With Variables;
                                 NLD=Zet filter met variabelen];
                      OnAction=BEGIN
                                 _SetFilterWithVariables;
                               END;
                                }
      { 1000000005;1 ;Separator  }
      { 1000000003;1 ;Action    ;
                      Name=<Action1000000000>;
                      ShortCutKey=Shift+Ctrl+R;
                      CaptionML=[ENU=Right;
                                 NLD=Rechts];
                      Promoted=Yes;
                      OnAction=BEGIN
                                 Right;
                               END;
                                }
      { 1000000002;1 ;Action    ;
                      Name=<Action1000000001>;
                      ShortCutKey=Shift+Ctrl+L;
                      CaptionML=[ENU=Left;
                                 NLD=Links];
                      OnAction=BEGIN
                                 Left;
                               END;
                                }
      { 1000000001;1 ;Action    ;
                      Name=<Action1000000002>;
                      ShortCutKey=Shift+Ctrl+U;
                      CaptionML=[ENU=Up;
                                 NLD=Omhoog];
                      OnAction=BEGIN
                                 Up;
                               END;
                                }
      { 1000000000;1 ;Action    ;
                      Name=<Action1000000003>;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Down;
                                 NLD=Omlaag];
                      OnAction=BEGIN
                                 Down;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                IndentationColumnName="Tag NameIndent";
                IndentationControls=Tag Name;
                GroupType=Repeater }

    { 1000011;2;Field     ;
                SourceExpr="Tag Name" }

    { 1000001;2;Field     ;
                SourceExpr=Type;
                OnValidate=BEGIN
                             TypeOnAfterValidate;
                           END;
                            }

    { 1000013;2;Field     ;
                SourceExpr=Code;
                Editable=CodeEditable }

    { 1000000008;2;Field  ;
                SourceExpr="Table No.";
                Editable="Table No.Editable";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           // IDYN EBK >>>>
                           IF Mgt.LookupTableNo(Text) THEN BEGIN
                             EVALUATE("Table No.",Text);
                             VALIDATE("Table No.");
                           END;
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //EXIT(Mgt.LookupTableNo(Text));
                           // IDYN EBK <<<<
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.AssistTableNo("Table No.");
                             END;
                              }

    { 1000000007;2;Field  ;
                Name=Table Name;
                SourceExpr="Table Name" }

    { 1000000006;2;Field  ;
                SourceExpr="Field No.";
                Editable="Field No.Editable";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           // IDYN EBK >>>>
                           IF Mgt.LookupFieldNo("Table No.",Text,TRUE) THEN BEGIN
                             EVALUATE("Field No.",Text);
                             VALIDATE("Field No.");
                           END;
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //EXIT(Mgt.LookupFieldNo("Table No.", Text, TRUE));
                           // IDYN EBK <<<<
                         END;
                          }

    { 1000000004;2;Field  ;
                Name=Field Name;
                SourceExpr="Field Name" }

    { 1100531000;2;Field  ;
                SourceExpr="No. of Functions";
                Visible=FALSE }

    { 1000031;2;Field     ;
                SourceExpr="Original Value";
                Visible=FALSE }

    { 1000015;2;Field     ;
                AssistEdit=Yes;
                SourceExpr="Table Filter";
                Editable="Table FilterEditable";
                OnAssistEdit=VAR
                               INMgt@1000000000 : Codeunit 11148589;
                             BEGIN
                               EVALUATE("Table Filter", INMgt.SetTableFilter("Table No.", FORMAT("Table Filter"))); // CI-143
                             END;
                              }

    { 1000023;2;Field     ;
                SourceExpr="Link to Table (Tag Name)";
                Editable=LinktoTableTagNameEditable;
                OnAssistEdit=BEGIN
                               SetupLinkToTable;
                             END;
                              }

    { 1000021;2;Field     ;
                SourceExpr="Conversion Code";
                Editable="Conversion CodeEditable" }

    { 1000025;2;Field     ;
                SourceExpr="Dest. Variable";
                Visible=FALSE }

    { 1000035;2;Field     ;
                SourceExpr="Skip If Empty";
                Visible=FALSE;
                Editable="Skip If EmptyEditable" }

    { 1000017;2;Field     ;
                SourceExpr="Data Format";
                Visible=FALSE }

    { 1000033;2;Field     ;
                SourceExpr="Option Type";
                Visible=FALSE;
                Editable="Option TypeEditable";
                HideValue="Option TypeHideValue" }

    { 1000007;2;Field     ;
                SourceExpr="Before Field";
                Visible=FALSE }

    { 1000019;2;Field     ;
                SourceExpr="After Field";
                Visible=FALSE }

  }
  CODE
  {
    VAR
      FileFormat@1000000 : 'XML,CSV,FixedWidth,Excel';
      "Tag NameIndent"@19056250 : Integer INDATASET;
      "Option TypeHideValue"@19002310 : Boolean INDATASET;
      "Table No.Editable"@19076806 : Boolean INDATASET;
      "Field No.Editable"@19022826 : Boolean INDATASET;
      "Table FilterEditable"@19054732 : Boolean INDATASET;
      "Skip If EmptyEditable"@19053977 : Boolean INDATASET;
      LinktoTableTagNameEditable@19004008 : Boolean INDATASET;
      "Conversion CodeEditable"@19074872 : Boolean INDATASET;
      CodeEditable@19001698 : Boolean INDATASET;
      "Option TypeEditable"@19019138 : Boolean INDATASET;

    PROCEDURE Left@1000000();
    VAR
      ExportDefLine@1100512000 : Record 11148600;
    BEGIN
      CurrPage.SETSELECTIONFILTER(ExportDefLine);
      IF ExportDefLine.FINDSET THEN
        REPEAT
          IF ExportDefLine."Entry No." <> 0 THEN
            IF ExportDefLine.Indent > 0 THEN BEGIN
              ExportDefLine.Indent -= 1;
              ExportDefLine.MODIFY;
            END;
        UNTIL ExportDefLine.NEXT = 0;
    END;

    PROCEDURE Right@1000001();
    VAR
      ExportDefLine@1100512000 : Record 11148600;
    BEGIN
      CurrPage.SETSELECTIONFILTER(ExportDefLine);
      IF ExportDefLine.FINDSET THEN
        REPEAT
          IF ExportDefLine."Entry No." <> 0 THEN BEGIN
            ExportDefLine.Indent += 1;
            ExportDefLine.MODIFY;
          END;
        UNTIL ExportDefLine.NEXT = 0;
    END;

    PROCEDURE Up@1000011();
    VAR
      CurrLine@1000004 : Record 11148600;
      ExportDefinitionLine@1000000 : Record 11148600;
      SelectedLine@1000002 : Record 11148600;
      LineNo@1000001 : Integer;
    BEGIN
      CurrLine := Rec;

      CurrPage.SETSELECTIONFILTER(SelectedLine);
      IF SelectedLine.COUNT = 0 THEN BEGIN
        SelectedLine.RESET;
        SelectedLine := Rec;
        SelectedLine.SETRECFILTER;
      END;

      IF SelectedLine.FINDSET THEN
        REPEAT
          ExportDefinitionLine.SETCURRENTKEY("Export Definition", "Line No.");
          ExportDefinitionLine.SETRANGE("Export Definition", "Export Definition");
          ExportDefinitionLine := SelectedLine;
          IF ExportDefinitionLine.NEXT(-1) <> 0 THEN BEGIN
            LineNo := ExportDefinitionLine."Line No.";
            ExportDefinitionLine."Line No." := SelectedLine."Line No.";
            ExportDefinitionLine.MODIFY;
            SelectedLine."Line No." := LineNo;
            SelectedLine.MODIFY;
          END;
        UNTIL SelectedLine.NEXT = 0;

      GET(CurrLine."Export Definition", CurrLine."Entry No.");
    END;

    PROCEDURE Down@1000010();
    VAR
      CurrLine@1000004 : Record 11148600;
      ExportDefinitionLine@1000006 : Record 11148600;
      SelectedLine@1000005 : Record 11148600;
      LineNo@1000000 : Integer;
    BEGIN
      CurrLine := Rec;

      CurrPage.SETSELECTIONFILTER(SelectedLine);
      IF SelectedLine.COUNT = 0 THEN BEGIN
        SelectedLine.RESET;
        SelectedLine := Rec;
        SelectedLine.SETRECFILTER;
      END;

      IF SelectedLine.FINDLAST THEN
        REPEAT
          ExportDefinitionLine.SETCURRENTKEY("Export Definition", "Line No.");
          ExportDefinitionLine.SETRANGE("Export Definition", "Export Definition");
          ExportDefinitionLine := SelectedLine;
          IF ExportDefinitionLine.NEXT(1) <> 0 THEN BEGIN
            LineNo := ExportDefinitionLine."Line No.";
            ExportDefinitionLine."Line No." := SelectedLine."Line No.";
            ExportDefinitionLine.MODIFY;
            SelectedLine."Line No." := LineNo;
            SelectedLine.MODIFY;
          END;
        UNTIL SelectedLine.NEXT(-1) = 0;

      GET(CurrLine."Export Definition", CurrLine."Entry No.");
    END;

    PROCEDURE LinkTables@1000002();
    BEGIN
      SetupLinkToTable;
    END;

    PROCEDURE UpdateForm@1000003();
    BEGIN
      CurrPage.UPDATE(FALSE);
    END;

    PROCEDURE SetFileFormat@1000008(NewValue@1000000 : Option);
    BEGIN
      FileFormat := NewValue;
    END;

    LOCAL PROCEDURE SetFieldEditable@1000007();
    BEGIN
      "Table No.Editable" := (Type IN [Type::Field, Type::Table, Type::Const]);

      IF FileFormat = FileFormat::XML THEN BEGIN
        "Field No.Editable" := (Type = Type::Field);
        "Table FilterEditable" := (Type = Type::Table);
        "Skip If EmptyEditable" := (TRUE);
      END ELSE BEGIN
        "Field No.Editable" := (Type IN [Type::Field, Type::Table, Type::Const]);
        "Table FilterEditable" := (Type IN [Type::Table, Type::Field, Type::Const]);
        "Skip If EmptyEditable" := (FALSE);
      END;

      LinktoTableTagNameEditable := (
        ((FileFormat = FileFormat::XML) AND (Type = Type::Table)) OR
        (FileFormat <> FileFormat::XML));
      "Conversion CodeEditable" := (Type IN [Type::Field, Type::Table, Type::Const]);

      CodeEditable := (Type IN [Type::Const, Type::Variable, Type::"6"]);
      "Option TypeEditable" := (Type = Type::Field);
    END;

    PROCEDURE _SetFilterWithVariables@19012358();
    BEGIN
      SetFilterWithVariables;
    END;

    PROCEDURE SetFilterWithVariables@1000009();
    BEGIN
      SetFilterWithVariables;
    END;

    LOCAL PROCEDURE TypeOnAfterValidate@19069045();
    BEGIN
      SetFieldEditable;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      SetFieldEditable;
    END;

    LOCAL PROCEDURE TableNoOnAfterInput@19060375(VAR Text@19060376 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE FieldNoOnAfterInput@19063566(VAR Text@19063567 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFieldNo(Text, "Table No.", FALSE);
    END;

    LOCAL PROCEDURE TableFilterOnAfterInput@19072298(VAR Text@19072299 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableFilter(Text, "Table No.");
    END;

    LOCAL PROCEDURE TagNameOnFormat@19023679();
    BEGIN
      "Tag NameIndent" := Indent;
    END;

    LOCAL PROCEDURE TableNoOnFormat@19071785(Text@19016339 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Table No.");
    END;

    LOCAL PROCEDURE FieldNoOnFormat@19075355(Text@19041114 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatFieldNo(Text, "Table No.", "Field No.");
    END;

    LOCAL PROCEDURE TableFilterOnFormat@19013929(Text@19048068 : Text[1024]);
    VAR
      Mgt@1000002 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableFilter(Text, "Table No.");
    END;

    LOCAL PROCEDURE OptionTypeOnFormat@19077341();
    BEGIN
      IF Type <> Type::Field THEN
        "Option TypeHideValue" := TRUE;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117089 CI - Port Connector Card
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Port Connector Card;
               NLD=Poortconnecter];
    SourceTable=Table11148623;
    SourceTableView=SORTING(Code)
                    WHERE(Type=CONST(Port Connector));
    PageType=Card;
    OnInit=BEGIN
             StatusEditable := TRUE;
           END;

    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  Type := Type::"Port Connector";
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000012 ;1   ;ActionGroup;
                      CaptionML=[ENU=&Connector;
                                 NLD=&Connecter] }
      { 1000014 ;2   ;Separator  }
      { 1000015 ;2   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Start;
                                 NLD=Start];
                      OnAction=BEGIN
                                 Start;
                               END;
                                }
      { 1000016 ;2   ;Action    ;
                      ShortCutKey=Shift+F11;
                      CaptionML=[ENU=S&top;
                                 NLD=S&top];
                      OnAction=BEGIN
                                 Stop;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                CaptionML=[ENU=General;
                           NLD=Algemeen] }

    { 1000001;2;Field     ;
                SourceExpr=Code;
                Editable=codeeditable }

    { 1000003;2;Field     ;
                SourceExpr=Description;
                Editable=descriptioneditable }

    { 1000008;2;Field     ;
                SourceExpr=Port;
                Editable=porteditable }

    { 1000005;2;Field     ;
                SourceExpr=Status;
                Editable=StatusEditable;
                OnValidate=BEGIN
                             StatusOnAfterValidate;
                           END;
                            }

    { 1000018;2;Field     ;
                CaptionML=[ENU=Active;
                           NLD=Aktief];
                SourceExpr=IsActive }

    { 1000022;2;Field     ;
                SourceExpr="Run Import Def.";
                Editable=runimportdefeditable }

    { 1000035;2;Field     ;
                SourceExpr="Run Task";
                Editable=runtaskeditable }

    { 1000017;2;Field     ;
                SourceExpr="Run Export Def. Ok";
                Editable=RunExportDefokEditable }

    { 1000024;2;Field     ;
                SourceExpr="Run Export Def. Error";
                Editable=RunExportDefErrorEditable }

    { 1000026;1;Part      ;
                Name=Lines;
                SubPageLink=Connector Code=FIELD(Code);
                PagePartID=Page11117090;
                Editable=lineseditable }

    { 1902793001;1;Group  ;
                CaptionML=[ENU=Project;
                           NLD=Project] }

    { 1000037;2;Field     ;
                SourceExpr="Project Code" }

  }
  CODE
  {
    VAR
      StatusEditable@19074876 : Boolean INDATASET;
      CodeEditable@1000000006 : Boolean INDATASET;
      DescriptionEditable@1000000005 : Boolean INDATASET;
      RunImportDefEditable@1000000004 : Boolean INDATASET;
      RunExportDefOkEditable@1000000003 : Boolean INDATASET;
      RunExportDefErrorEditable@1000000002 : Boolean INDATASET;
      RunTaskEditable@1000000001 : Boolean INDATASET;
      LinesEditable@1000000000 : Boolean INDATASET;
      PortEditable@1000000008 : Boolean INDATASET;

    LOCAL PROCEDURE SetEditable@1000003();
    VAR
      IsActive2@1000000 : Boolean;
    BEGIN
      IsActive2 := IsActive;

      CodeEditable := (Status = Status::Edit) AND NOT IsActive2;
      DescriptionEditable := (Status = Status::Edit) AND NOT IsActive2;
      StatusEditable := (NOT IsActive2);
      PortEditable := (NOT IsActive2);
      RunImportDefEditable := (Status = Status::Edit) AND NOT IsActive2;
      RunExportDefOkEditable := (Status = Status::Edit) AND NOT IsActive2;
      RunExportDefErrorEditable := (Status = Status::Edit) AND NOT IsActive2;
      RunTaskEditable := (Status = Status::Edit) AND NOT IsActive2;

      LinesEditable := (Status = Status::Edit) AND NOT IsActive2;
    END;

    LOCAL PROCEDURE StatusOnAfterValidate@19072689();
    BEGIN
      SetEditable;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      SetEditable;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117090 CI - Port Connector Subform
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Port Connector Subform;
               NLD=Poortconnecter subform];
    SourceTable=Table11148624;
    PageType=ListPart;
    AutoSplitKey=Yes;
    OnNewRecord=BEGIN
                  Type := Type::"Element Value";
                END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr=Type }

    { 1000003;2;Field     ;
                SourceExpr=Element }

    { 1000005;2;Field     ;
                SourceExpr=Value }

    { 1000007;2;Field     ;
                SourceExpr="Run Import Def." }

    { 1000009;2;Field     ;
                SourceExpr="Run Export Def. Ok" }

    { 1000011;2;Field     ;
                SourceExpr="Run Export Def. Error" }

    { 1000013;2;Field     ;
                SourceExpr="Run Task" }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117091 CI - Transport FTP Download
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Transport FTP Download;
               NLD=Transport FTP Download];
    SourceTable=Table11148590;
    SourceTableView=WHERE(Type=CONST(FTP Download));
    PageType=List;
    OnInit=BEGIN
             "Archive add YYYYMMDDEditable" := TRUE;
             "Transfer ModeEditable" := TRUE;
             "Archive LocationEditable" := TRUE;
             "To LocationEditable" := TRUE;
             FilenameEditable := TRUE;
             "From LocationEditable" := TRUE;
             PasswordEditable := TRUE;
             AccountEditable := TRUE;
             AddressEditable := TRUE;
             "FTP TypeEditable" := TRUE;
             DescriptionEditable := TRUE;
             CodeEditable := TRUE;
           END;

    OnOpenPage=VAR
                 Initialize@1000000 : Codeunit 11148625;
               BEGIN
                 Initialize.CheckInitialize;
               END;

    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  Type := Type::"FTP Download";
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000003;  ;ActionContainer;
                      Name=<Action1900000003>;
                      ActionContainerType=ActionItems }
      { 1000013 ;1   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Process;
                                 NLD=Verwerken];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Process(TRUE);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                CaptionML=[ENU=General;
                           NLD=Algemeen] }

    { 1000001;2;Field     ;
                SourceExpr=Code;
                Editable=CodeEditable }

    { 1000003;2;Field     ;
                SourceExpr=Description;
                Editable=DescriptionEditable }

    { 1000038;2;Field     ;
                SourceExpr="FTP Type";
                Editable="FTP TypeEditable" }

    { 1000036;2;Field     ;
                SourceExpr="Transfer Mode";
                Editable="Transfer ModeEditable" }

    { 1000024;2;Field     ;
                SourceExpr=Address;
                Editable=AddressEditable }

    { 1   ;2   ;Field     ;
                SourceExpr="Custom Port" }

    { 1000026;2;Field     ;
                SourceExpr=Account;
                Editable=AccountEditable }

    { 1000028;2;Field     ;
                ExtendedDatatype=Masked;
                SourceExpr=Password;
                Editable=PasswordEditable }

    { 1000030;2;Field     ;
                SourceExpr="From Location";
                Editable="From LocationEditable";
                OnLookup=VAR
                           Mgt@1000001 : Codeunit 11148589;
                           NewFolder@1000000 : Text[1024];
                         BEGIN
                           IF Type = Type::"FTP Upload" THEN BEGIN
                             NewFolder := Mgt.BrowseForFolder('', '');
                             IF NewFolder <> '' THEN
                               "Archive Location" := NewFolder;
                           END;
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               IF Type = Type::"FTP Upload" THEN
                                 Mgt.OpenFolder("From Location");
                             END;
                              }

    { 1000016;2;Field     ;
                SourceExpr=Filename;
                Editable=FilenameEditable }

    { 1000032;2;Field     ;
                SourceExpr="To Location";
                Editable="To LocationEditable";
                OnLookup=VAR
                           Mgt@1000001 : Codeunit 11148589;
                           NewFolder@1000000 : Text[1024];
                         BEGIN
                           IF Type = Type::"FTP Download" THEN BEGIN
                             NewFolder := Mgt.BrowseForFolder('', '');
                             IF NewFolder <> '' THEN
                               "Archive Location" := NewFolder;
                           END;
                         END;

                OnAssistEdit=VAR
                               Mgt@1000001 : Codeunit 11148589;
                             BEGIN
                               IF Type = Type::"FTP Download" THEN
                                 Mgt.OpenFolder("To Location");
                             END;
                              }

    { 1000034;2;Field     ;
                SourceExpr="Archive Location";
                Editable="Archive LocationEditable";
                OnLookup=VAR
                           Mgt@1000001 : Codeunit 11148589;
                           NewFolder@1000000 : Text[1024];
                         BEGIN
                           NewFolder := Mgt.BrowseForFolder('', '');
                           IF NewFolder <> '' THEN
                             "Archive Location" := NewFolder;
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder("Archive Location");
                             END;
                              }

    { 1000005;2;Field     ;
                SourceExpr=Status;
                OnValidate=BEGIN
                             StatusOnAfterValidate;
                           END;
                            }

    { 1000022;2;Field     ;
                SourceExpr="Archive add YYYYMMDD";
                Editable="Archive add YYYYMMDDEditable" }

    { 1902793001;1;Group  ;
                CaptionML=[ENU=Project;
                           NLD=Project] }

    { 1000020;2;Field     ;
                SourceExpr="Project Code" }

  }
  CODE
  {
    VAR
      CodeEditable@19001698 : Boolean INDATASET;
      DescriptionEditable@19061412 : Boolean INDATASET;
      "FTP TypeEditable"@19022006 : Boolean INDATASET;
      AddressEditable@19025954 : Boolean INDATASET;
      AccountEditable@19067028 : Boolean INDATASET;
      PasswordEditable@19030527 : Boolean INDATASET;
      "From LocationEditable"@19002432 : Boolean INDATASET;
      FilenameEditable@19007928 : Boolean INDATASET;
      "To LocationEditable"@19031161 : Boolean INDATASET;
      "Archive LocationEditable"@19002479 : Boolean INDATASET;
      "Transfer ModeEditable"@19067917 : Boolean INDATASET;
      "Archive add YYYYMMDDEditable"@19050215 : Boolean INDATASET;

    LOCAL PROCEDURE SetEditable@1000003();
    BEGIN
      CodeEditable := (Status = Status::Edit);
      DescriptionEditable := (Status = Status::Edit);
      "FTP TypeEditable" := (Status = Status::Edit);
      AddressEditable := (Status = Status::Edit);
      AccountEditable := (Status = Status::Edit);
      PasswordEditable := (Status = Status::Edit);
      "From LocationEditable" := (Status = Status::Edit);
      FilenameEditable := (Status = Status::Edit);
      "To LocationEditable" := (Status = Status::Edit);
      "Archive LocationEditable" := (Status = Status::Edit);
      "Transfer ModeEditable" := (Status = Status::Edit);
      "Archive add YYYYMMDDEditable" := (Status = Status::Edit);
    END;

    LOCAL PROCEDURE StatusOnAfterValidate@19072689();
    BEGIN
      SetEditable;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      SetEditable;
    END;

    LOCAL PROCEDURE FromLocationOnAfterInput@19000170(VAR Text@19000171 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      CASE Type OF

        Type::"FTP Upload" :
          Mgt.AfterInputFolder(Text);

        Type::"FTP Download" :
          IF Text[STRLEN(Text)] = '/' THEN
            Text := COPYSTR(Text, 1, STRLEN(Text) - 1);
      END;
    END;

    LOCAL PROCEDURE ToLocationOnAfterInput@19057277(VAR Text@19057278 : Text[1024]);
    VAR
      Mgt@1000001 : Codeunit 11148589;
    BEGIN
      CASE Type OF

        Type::"FTP Download" :
          Mgt.AfterInputFolder(Text);

        Type::"FTP Upload" :
          IF Text[STRLEN(Text)] = '/' THEN
            Text := COPYSTR(Text, 1, STRLEN(Text) - 1);
      END;
    END;

    LOCAL PROCEDURE ArchiveLocationOnAfterInput@19024665(VAR Text@19024666 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      CASE Type OF

        Type::"FTP Upload" :
          Mgt.AfterInputFolder(Text);

        Type::"FTP Download" :
          IF Text[STRLEN(Text)] = '/' THEN
            Text := COPYSTR(Text, 1, STRLEN(Text) - 1);
      END;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117092 CI - Transport FTP Upload
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Transport FTP Upload;
               NLD=Transport FTP Upload];
    SourceTable=Table11148590;
    SourceTableView=WHERE(Type=CONST(FTP Upload));
    PageType=List;
    OnInit=BEGIN
             "Archive add YYYYMMDDEditable" := TRUE;
             "Transfer ModeEditable" := TRUE;
             "Archive LocationEditable" := TRUE;
             "To LocationEditable" := TRUE;
             FilenameEditable := TRUE;
             "From LocationEditable" := TRUE;
             PasswordEditable := TRUE;
             AccountEditable := TRUE;
             AddressEditable := TRUE;
             "FTP TypeEditable" := TRUE;
             DescriptionEditable := TRUE;
             CodeEditable := TRUE;
           END;

    OnOpenPage=VAR
                 Initialize@1000000 : Codeunit 11148625;
               BEGIN
                 Initialize.CheckInitialize;
               END;

    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  Type := Type::"FTP Upload";
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000003;  ;ActionContainer;
                      Name=<Action1900000003>;
                      ActionContainerType=ActionItems }
      { 1000013 ;1   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Process;
                                 NLD=Verwerken];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Process(TRUE);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                CaptionML=[ENU=General;
                           NLD=Algemeen] }

    { 1000001;2;Field     ;
                SourceExpr=Code;
                Editable=CodeEditable }

    { 1000003;2;Field     ;
                SourceExpr=Description;
                Editable=DescriptionEditable }

    { 1000038;2;Field     ;
                SourceExpr="FTP Type";
                Editable="FTP TypeEditable" }

    { 1000036;2;Field     ;
                SourceExpr="Transfer Mode";
                Editable="Transfer ModeEditable" }

    { 1000024;2;Field     ;
                SourceExpr=Address;
                Editable=AddressEditable }

    { 1   ;2   ;Field     ;
                SourceExpr="Custom Port" }

    { 1000026;2;Field     ;
                SourceExpr=Account;
                Editable=AccountEditable }

    { 1000028;2;Field     ;
                ExtendedDatatype=Masked;
                SourceExpr=Password;
                Editable=PasswordEditable }

    { 1000030;2;Field     ;
                SourceExpr="From Location";
                Editable="From LocationEditable";
                OnLookup=VAR
                           Mgt@1000001 : Codeunit 11148589;
                           NewFolder@1000000 : Text[1024];
                         BEGIN
                           IF Type = Type::"FTP Upload" THEN BEGIN
                             NewFolder := Mgt.BrowseForFolder('', '');
                             IF NewFolder <> '' THEN
                               "Archive Location" := NewFolder;
                           END;
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               IF Type = Type::"FTP Upload" THEN
                                 Mgt.OpenFolder("From Location");
                             END;
                              }

    { 1000016;2;Field     ;
                SourceExpr=Filename;
                Editable=FilenameEditable }

    { 1000032;2;Field     ;
                SourceExpr="To Location";
                Editable="To LocationEditable";
                OnLookup=VAR
                           Mgt@1000001 : Codeunit 11148589;
                           NewFolder@1000000 : Text[1024];
                         BEGIN
                           IF Type = Type::"FTP Download" THEN BEGIN
                             NewFolder := Mgt.BrowseForFolder('', '');
                             IF NewFolder <> '' THEN
                               "Archive Location" := NewFolder;
                           END;
                         END;

                OnAssistEdit=VAR
                               Mgt@1000001 : Codeunit 11148589;
                             BEGIN
                               IF Type = Type::"FTP Download" THEN
                                 Mgt.OpenFolder("To Location");
                             END;
                              }

    { 1000034;2;Field     ;
                SourceExpr="Archive Location";
                Editable="Archive LocationEditable";
                OnLookup=VAR
                           Mgt@1000001 : Codeunit 11148589;
                           NewFolder@1000000 : Text[1024];
                         BEGIN
                           NewFolder := Mgt.BrowseForFolder('', '');
                           IF NewFolder <> '' THEN
                             "Archive Location" := NewFolder;
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.OpenFolder("Archive Location");
                             END;
                              }

    { 1000005;2;Field     ;
                SourceExpr=Status;
                OnValidate=BEGIN
                             StatusOnAfterValidate;
                           END;
                            }

    { 1000022;2;Field     ;
                SourceExpr="Archive add YYYYMMDD";
                Editable="Archive add YYYYMMDDEditable" }

    { 1902793001;1;Group  ;
                CaptionML=[ENU=Project;
                           NLD=Project] }

    { 1000020;2;Field     ;
                SourceExpr="Project Code" }

  }
  CODE
  {
    VAR
      CodeEditable@19001698 : Boolean INDATASET;
      DescriptionEditable@19061412 : Boolean INDATASET;
      "FTP TypeEditable"@19022006 : Boolean INDATASET;
      AddressEditable@19025954 : Boolean INDATASET;
      AccountEditable@19067028 : Boolean INDATASET;
      PasswordEditable@19030527 : Boolean INDATASET;
      "From LocationEditable"@19002432 : Boolean INDATASET;
      FilenameEditable@19007928 : Boolean INDATASET;
      "To LocationEditable"@19031161 : Boolean INDATASET;
      "Archive LocationEditable"@19002479 : Boolean INDATASET;
      "Transfer ModeEditable"@19067917 : Boolean INDATASET;
      "Archive add YYYYMMDDEditable"@19050215 : Boolean INDATASET;

    LOCAL PROCEDURE SetEditable@1000003();
    BEGIN
      CodeEditable := (Status = Status::Edit);
      DescriptionEditable := (Status = Status::Edit);
      "FTP TypeEditable" := (Status = Status::Edit);
      AddressEditable := (Status = Status::Edit);
      AccountEditable := (Status = Status::Edit);
      PasswordEditable := (Status = Status::Edit);
      "From LocationEditable" := (Status = Status::Edit);
      FilenameEditable := (Status = Status::Edit);
      "To LocationEditable" := (Status = Status::Edit);
      "Archive LocationEditable" := (Status = Status::Edit);
      "Transfer ModeEditable" := (Status = Status::Edit);
      "Archive add YYYYMMDDEditable" := (Status = Status::Edit);
    END;

    LOCAL PROCEDURE StatusOnAfterValidate@19072689();
    BEGIN
      SetEditable;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      SetEditable;
    END;

    LOCAL PROCEDURE FromLocationOnAfterInput@19000170(VAR Text@19000171 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      CASE Type OF

        Type::"FTP Upload" :
          Mgt.AfterInputFolder(Text);

        Type::"FTP Download" :
          IF Text[STRLEN(Text)] = '/' THEN
            Text := COPYSTR(Text, 1, STRLEN(Text) - 1);
      END;
    END;

    LOCAL PROCEDURE ToLocationOnAfterInput@19057277(VAR Text@19057278 : Text[1024]);
    VAR
      Mgt@1000001 : Codeunit 11148589;
    BEGIN
      CASE Type OF

        Type::"FTP Download" :
          Mgt.AfterInputFolder(Text);

        Type::"FTP Upload" :
          IF Text[STRLEN(Text)] = '/' THEN
            Text := COPYSTR(Text, 1, STRLEN(Text) - 1);
      END;
    END;

    LOCAL PROCEDURE ArchiveLocationOnAfterInput@19024665(VAR Text@19024666 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      CASE Type OF

        Type::"FTP Upload" :
          Mgt.AfterInputFolder(Text);

        Type::"FTP Download" :
          IF Text[STRLEN(Text)] = '/' THEN
            Text := COPYSTR(Text, 1, STRLEN(Text) - 1);
      END;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117093 CI - Transport Movement
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Transport Movement;
               NLD=Transport verplaatsing];
    SourceTable=Table11148590;
    SourceTableView=WHERE(Type=CONST(Move));
    PageType=List;
    OnInit=BEGIN
             "Archive add YYYYMMDDEditable" := TRUE;
             "To LocationEditable" := TRUE;
             FilenameEditable := TRUE;
             "From LocationEditable" := TRUE;
             DescriptionEditable := TRUE;
             CodeEditable := TRUE;
           END;

    OnOpenPage=VAR
                 Initialize@1000000 : Codeunit 11148625;
               BEGIN
                 Initialize.CheckInitialize;
               END;

    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  Type := Type::Move;
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000003;  ;ActionContainer;
                      Name=<Action1900000003>;
                      ActionContainerType=ActionItems }
      { 1000013 ;1   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Process;
                                 NLD=Verwerken];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Process(TRUE);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                CaptionML=[ENU=General;
                           NLD=Algemeen] }

    { 1000001;2;Field     ;
                SourceExpr=Code;
                Editable=CodeEditable }

    { 1000003;2;Field     ;
                SourceExpr=Description;
                Editable=DescriptionEditable }

    { 1000030;2;Field     ;
                SourceExpr="From Location";
                Editable="From LocationEditable";
                OnLookup=VAR
                           Mgt@1000001 : Codeunit 11148589;
                           NewFolder@1000000 : Text[1024];
                         BEGIN
                           IF Type = Type::"FTP Upload" THEN BEGIN
                             NewFolder := Mgt.BrowseForFolder('', '');
                             IF NewFolder <> '' THEN
                               "Archive Location" := NewFolder;
                           END;
                         END;

                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               IF Type = Type::"FTP Upload" THEN
                                 Mgt.OpenFolder("From Location");
                             END;
                              }

    { 1000016;2;Field     ;
                SourceExpr=Filename;
                Editable=FilenameEditable }

    { 1000032;2;Field     ;
                SourceExpr="To Location";
                Editable="To LocationEditable";
                OnLookup=VAR
                           Mgt@1000001 : Codeunit 11148589;
                           NewFolder@1000000 : Text[1024];
                         BEGIN
                           IF Type = Type::"FTP Download" THEN BEGIN
                             NewFolder := Mgt.BrowseForFolder('', '');
                             IF NewFolder <> '' THEN
                               "Archive Location" := NewFolder;
                           END;
                         END;

                OnAssistEdit=VAR
                               Mgt@1000001 : Codeunit 11148589;
                             BEGIN
                               IF Type = Type::"FTP Download" THEN
                                 Mgt.OpenFolder("To Location");
                             END;
                              }

    { 1000005;2;Field     ;
                SourceExpr=Status;
                OnValidate=BEGIN
                             StatusOnAfterValidate;
                           END;
                            }

    { 1000022;2;Field     ;
                SourceExpr="Archive add YYYYMMDD";
                Editable="Archive add YYYYMMDDEditable" }

    { 1902793001;1;Group  ;
                CaptionML=[ENU=Project;
                           NLD=Project] }

    { 1000020;2;Field     ;
                SourceExpr="Project Code" }

  }
  CODE
  {
    VAR
      CodeEditable@19001698 : Boolean INDATASET;
      DescriptionEditable@19061412 : Boolean INDATASET;
      "From LocationEditable"@19002432 : Boolean INDATASET;
      FilenameEditable@19007928 : Boolean INDATASET;
      "To LocationEditable"@19031161 : Boolean INDATASET;
      "Archive add YYYYMMDDEditable"@19050215 : Boolean INDATASET;

    LOCAL PROCEDURE SetEditable@1000003();
    BEGIN
      CodeEditable := (Status = Status::Edit);
      DescriptionEditable := (Status = Status::Edit);
      "From LocationEditable" := (Status = Status::Edit);
      FilenameEditable := (Status = Status::Edit);
      "To LocationEditable" := (Status = Status::Edit);
      "Archive add YYYYMMDDEditable" := (Status = Status::Edit);
    END;

    LOCAL PROCEDURE StatusOnAfterValidate@19072689();
    BEGIN
      SetEditable;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      SetEditable;
    END;

    LOCAL PROCEDURE FromLocationOnAfterInput@19000170(VAR Text@19000171 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      CASE Type OF

        Type::"FTP Upload" :
          Mgt.AfterInputFolder(Text);

        Type::"FTP Download" :
          IF Text[STRLEN(Text)] = '/' THEN
            Text := COPYSTR(Text, 1, STRLEN(Text) - 1);
      END;
    END;

    LOCAL PROCEDURE ToLocationOnAfterInput@19057277(VAR Text@19057278 : Text[1024]);
    VAR
      Mgt@1000001 : Codeunit 11148589;
    BEGIN
      CASE Type OF

        Type::"FTP Download" :
          Mgt.AfterInputFolder(Text);

        Type::"FTP Upload" :
          IF Text[STRLEN(Text)] = '/' THEN
            Text := COPYSTR(Text, 1, STRLEN(Text) - 1);
      END;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117094 CI - Transport Executable
{
  OBJECT-PROPERTIES
  {
    Date=09-11-12;
    Time=12:00:00;
    Version List=IDYN-CI5.00.1;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Transport Executable;
               NLD=Transport executable];
    SourceTable=Table11148590;
    SourceTableView=WHERE(Type=CONST(Executable));
    PageType=List;
    OnInit=BEGIN
             "Archive add YYYYMMDDEditable" := TRUE;
             ExecutableEditable := TRUE;
             DescriptionEditable := TRUE;
             CodeEditable := TRUE;
           END;

    OnOpenPage=VAR
                 Initialize@1000000 : Codeunit 11148625;
               BEGIN
                 Initialize.CheckInitialize;
               END;

    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  Type := Type::Executable;
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000003;  ;ActionContainer;
                      Name=<Action1900000003>;
                      ActionContainerType=ActionItems }
      { 1000013 ;1   ;Action    ;
                      ShortCutKey=F11;
                      CaptionML=[ENU=Process;
                                 NLD=Verwerken];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Process(TRUE);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                CaptionML=[ENU=General;
                           NLD=Algemeen] }

    { 1000001;2;Field     ;
                SourceExpr=Code;
                Editable=CodeEditable }

    { 1000003;2;Field     ;
                SourceExpr=Description;
                Editable=DescriptionEditable }

    { 1000014;2;Field     ;
                SourceExpr=Executable;
                Editable=ExecutableEditable }

    { 1000005;2;Field     ;
                SourceExpr=Status;
                OnValidate=BEGIN
                             StatusOnAfterValidate;
                           END;
                            }

    { 1902793001;1;Group  ;
                CaptionML=[ENU=Project;
                           NLD=Project] }

    { 1000020;2;Field     ;
                SourceExpr="Project Code" }

  }
  CODE
  {
    VAR
      CodeEditable@19001698 : Boolean INDATASET;
      DescriptionEditable@19061412 : Boolean INDATASET;
      ExecutableEditable@19069097 : Boolean INDATASET;
      "Archive add YYYYMMDDEditable"@19050215 : Boolean INDATASET;

    LOCAL PROCEDURE SetEditable@1000003();
    BEGIN
      CodeEditable := (Status = Status::Edit);
      DescriptionEditable := (Status = Status::Edit);
      ExecutableEditable := (Status = Status::Edit);
      "Archive add YYYYMMDDEditable" := (Status = Status::Edit);
    END;

    LOCAL PROCEDURE StatusOnAfterValidate@19072689();
    BEGIN
      SetEditable;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      SetEditable;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117095 CI - Import Def. Version List
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Import Definition Version List;
               NLD=Importdefinitieversieoverzicht];
    SourceTable=Table11148631;
    PageType=List;
    ActionList=ACTIONS
    {
      { 1000000001;  ;ActionContainer;
                      Name=<Action1000000000>;
                      ActionContainerType=ActionItems }
      { 1000000000;1 ;Action    ;
                      Name=<Action1000000001>;
                      CaptionML=[ENU=&Restore;
                                 NLD=Te&rugzetten];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=History;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 VersionMgt.ImportRestoreVersion(Rec);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1100531000;1;Group  ;
                GroupType=Repeater }

    { 1100531001;2;Field  ;
                SourceExpr=Code }

    { 1100531003;2;Field  ;
                SourceExpr=Description }

    { 1100531005;2;Field  ;
                SourceExpr="Version No." }

    { 1100531007;2;Field  ;
                SourceExpr="Version Date" }

    { 1100531009;2;Field  ;
                SourceExpr="Version Time" }

  }
  CODE
  {
    VAR
      VersionMgt@1000000000 : Codeunit 11148644;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11117096 CI - Export Def. Version List
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CI5.60.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Export Definition Version List;
               NLD=Exportdefinitieversieoverzicht];
    SourceTable=Table11148634;
    PageType=List;
    ActionList=ACTIONS
    {
      { 1000000000;  ;ActionContainer;
                      Name=<Action1000000000>;
                      ActionContainerType=ActionItems }
      { 1000000001;1 ;Action    ;
                      CaptionML=[ENU=&Restore;
                                 NLD=Te&rugzetten];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=History;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 VersionMgt.ExportRestoreVersion(Rec);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1100531000;1;Group  ;
                GroupType=Repeater }

    { 1100531001;2;Field  ;
                SourceExpr=Code }

    { 1100531003;2;Field  ;
                SourceExpr=Description }

    { 1100531005;2;Field  ;
                SourceExpr="Version No." }

    { 1100531007;2;Field  ;
                SourceExpr="Version Date" }

    { 1100531009;2;Field  ;
                SourceExpr="Version Time" }

  }
  CODE
  {
    VAR
      VersionMgt@1000000000 : Codeunit 11148644;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11148589 IN - Select Fields
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Select Fields;
               NLD=Velden selecteren];
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table2000000001;
    DataCaptionExpr=DataCaption;
    SourceTableView=SORTING(Type,Company Name,ID)
                    WHERE(Type=CONST(Table),
                          Company Name=FILTER(''));
    PageType=Worksheet;
    OnOpenPage=BEGIN
                 CASE SelectFieldsType OF
                   SelectFieldsType::Import :
                     CurrPage.Fields.PAGE.SetImportDefinition(gMainTable, gImportDefinition);
                   SelectFieldsType::Export :
                     CurrPage.Fields.PAGE.SetExportDefinition(gMainTable, gExportDefinition);
                 END;

                 IF FormBlocked THEN
                   CurrPage.EDITABLE(FALSE);

                 CurrPage.Fields.PAGE.FormUpdate;
               END;

    OnAfterGetRecord=BEGIN
                       IF (GETFILTER(Type) <> '') AND (GETFILTER(ID) <> '') THEN;
                     END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                CaptionML=[ENU=General;
                           NLD=Algemeen] }

    { 1000000002;2;Group  ;
                GroupType=Group }

    { 1000005;3;Field     ;
                CaptionML=[ENU=No.;
                           NLD=Nr.];
                SourceExpr=ID;
                Editable=FALSE }

    { 1000001;3;Field     ;
                CaptionML=[ENU=Name;
                           NLD=Naam];
                SourceExpr=Name;
                Editable=FALSE }

    { 1000010;3;Field     ;
                CaptionML=[ENU=Version List;
                           NLD=Versielijst];
                SourceExpr="Version List";
                Editable=FALSE }

    { 1000012;3;Field     ;
                DrillDown=No;
                CaptionML=[ENU=Caption;
                           NLD=Caption];
                SourceExpr=Caption;
                Editable=FALSE }

    { 1000023;3;Field     ;
                CaptionML=[ENU=Selected Filter;
                           NLD=Geselecteerdfilter];
                OptionCaptionML=[ENU=" ,Selected,Not selected,Key fields";
                                 NLD=" ,Geselecteerd,Niet geselecteerd,Sleutelvelden"];
                SourceExpr=SelectionFilter;
                OnValidate=BEGIN
                             SelectionFilterOnAfterValidate;
                           END;
                            }

    { 1000000001;2;Group  ;
                GroupType=Group }

    { 1000007;3;Field     ;
                CaptionML=[ENU=Date;
                           NLD=Datum];
                SourceExpr=Date;
                Editable=FALSE }

    { 1000003;3;Field     ;
                CaptionML=[ENU=Time;
                           NLD=Tijd];
                SourceExpr=Time;
                Editable=FALSE }

    { 1000014;3;Field     ;
                CaptionML=[ENU=Modified;
                           NLD=Gewijzigd];
                SourceExpr=Modified;
                Editable=FALSE }

    { 1000016;3;Field     ;
                CaptionML=[ENU=Compiled;
                           NLD=Gecompileerd];
                SourceExpr=Compiled;
                Editable=FALSE }

    { 1000000000;1;Part   ;
                Name=Fields;
                CaptionML=[ENU=Fields;
                           NLD=Velden];
                SubPageView=SORTING(TableNo,No.);
                SubPageLink=TableNo=FIELD(ID);
                PagePartID=Page11148590;
                PartType=Page }

  }
  CODE
  {
    VAR
      gImportDefinition@1000000 : Record 11148591;
      gExportDefinition@1000003 : Record 11148599;
      SelectFieldsType@1000001 : ' ,Import,Export';
      SelectionFilter@1000005 : ' ,Selected,Not selected,Key fields';
      FormBlocked@1000004 : Boolean;
      gMainTable@1000002 : Boolean;

    LOCAL PROCEDURE DataCaption@1000000() : Text[1024];
    BEGIN
      EXIT(FORMAT(ID) + ' - ' + Name);
    END;

    PROCEDURE SetImportDefinition@1000002(MainTable@1000000 : Boolean;VAR ImportDefinition@1000001 : Record 11148591);
    BEGIN
      FILTERGROUP(10);
      gMainTable := MainTable;
      IF MainTable THEN
        SETRANGE(ID, ImportDefinition."Main Table No.")
      ELSE
        SETRANGE(ID, ImportDefinition."Sub Table No.");
      FILTERGROUP(0);

      SelectFieldsType := SelectFieldsType::Import;
      gImportDefinition := ImportDefinition;
    END;

    PROCEDURE SetExportDefinition@1000003(MainTable@1000000 : Boolean;VAR ExportDefinition@1000001 : Record 11148599);
    BEGIN
      FILTERGROUP(10);
      gMainTable := MainTable;
      IF MainTable THEN
        SETRANGE(ID, ExportDefinition."Main Table No.")
      ELSE
        SETRANGE(ID, ExportDefinition."Sub Table No.");
      FILTERGROUP(0);

      SelectFieldsType := SelectFieldsType::Export;
      gExportDefinition := ExportDefinition;
    END;

    PROCEDURE GetSelectedFields@1000001(VAR Fld@1000000 : Record 2000000041);
    BEGIN
      CurrPage.Fields.PAGE.GetSelectedFields(Fld);
    END;

    PROCEDURE SetFormBlocked@1000004(NewValue@1000000 : Boolean);
    BEGIN
      FormBlocked := NewValue;
    END;

    LOCAL PROCEDURE SelectionFilterOnAfterValidate@19033692();
    BEGIN
      CurrPage.Fields.PAGE.SetSelectionFilterFunc(SelectionFilter);
      CurrPage.Fields.PAGE.FormUpdate;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11148590 IN - Select Fields Subform
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Select Fields Subform;
               NLD=Velden selecteren subform];
    MultipleNewLines=Yes;
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table2000000041;
    SourceTableView=WHERE(Enabled=CONST(Yes));
    PageType=ListPart;
    OnFindRecord=VAR
                   ExitValue@1000001 : Boolean;
                 BEGIN
                   CASE SelectionFilter OF
                     SelectionFilter::" " :
                       EXIT(FIND(Which));

                     SelectionFilter::Selected :
                       BEGIN
                         TmpSelectedField := Rec;
                         TmpSelectedField.SETVIEW(GETVIEW);
                         ExitValue := TmpSelectedField.FIND(Which);
                         IF ExitValue THEN BEGIN
                           Rec := TmpSelectedField;
                           GET(TableNo, "No.");
                         END;
                         TmpSelectedField.RESET;
                         EXIT(ExitValue);
                       END;

                     SelectionFilter::"Not selected" :
                       BEGIN
                         TmpNotSelectedField := Rec;
                         TmpNotSelectedField.SETVIEW(GETVIEW);
                         ExitValue := TmpNotSelectedField.FIND(Which);
                         IF ExitValue THEN BEGIN
                           Rec := TmpNotSelectedField;
                           GET(TableNo, "No.");
                         END;
                         TmpNotSelectedField.RESET;
                         EXIT(ExitValue);
                       END;

                     SelectionFilter::"Key fields" :
                       BEGIN
                         TmpKeyField := Rec;
                         TmpKeyField.SETVIEW(GETVIEW);
                         ExitValue := TmpKeyField.FIND(Which);
                         IF ExitValue THEN BEGIN
                           Rec := TmpKeyField;
                           GET(TableNo, "No.");
                         END;
                         TmpKeyField.RESET;
                         EXIT(ExitValue);
                       END;

                   END;
                 END;

    OnNextRecord=VAR
                   ExitValue@1000001 : Integer;
                 BEGIN
                   CASE SelectionFilter OF
                     SelectionFilter::" " :
                       EXIT(NEXT(Steps));

                     SelectionFilter::Selected :
                       BEGIN
                         TmpSelectedField := Rec;
                         TmpSelectedField.SETVIEW(GETVIEW);
                         ExitValue := TmpSelectedField.NEXT(Steps);
                         IF ExitValue <> 0 THEN BEGIN
                           Rec := TmpSelectedField;
                           GET(TableNo, "No.");
                         END;
                         TmpSelectedField.RESET;
                         EXIT(ExitValue);
                       END;

                     SelectionFilter::"Not selected" :
                       BEGIN
                         TmpNotSelectedField := Rec;
                         TmpNotSelectedField.SETVIEW(GETVIEW);
                         ExitValue := TmpNotSelectedField.NEXT(Steps);
                         IF ExitValue <> 0 THEN BEGIN
                           Rec := TmpNotSelectedField;
                           GET(TableNo, "No.");
                         END;
                         TmpNotSelectedField.RESET;
                         EXIT(ExitValue);
                       END;

                     SelectionFilter::"Key fields" :
                       BEGIN
                         TmpKeyField := Rec;
                         TmpKeyField.SETVIEW(GETVIEW);
                         ExitValue := TmpKeyField.NEXT(Steps);
                         IF ExitValue <> 0 THEN BEGIN
                           Rec := TmpKeyField;
                           GET(TableNo, "No.");
                         END;
                         TmpKeyField.RESET;
                         EXIT(ExitValue);
                       END;

                   END;
                 END;

    OnAfterGetRecord=BEGIN
                       ClassHideValue := FALSE;
                       NoOnFormat;
                       FieldNameText := FORMAT(FieldName);
                       FieldNameTextOnFormat(FieldNameText);
                       TypeNameOnFormat;
                       ClassOnFormat;
                       RelationTableNoText := FORMAT(RelationTableNo);
                       RelationTableNoTextOnFormat(RelationTableNoText);
                       RelationFieldNoText := FORMAT(RelationFieldNo);
                       RelationFieldNoTextOnFormat(RelationFieldNoText);

                       FieldSelectedValue := FieldSelected;
                     END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1905514704;1 ;ActionGroup;
                      CaptionML=[ENU=&Selection;
                                 NLD=&Selectie] }
      { 1905076004;2 ;Action    ;
                      ShortCutKey=Ctrl+S;
                      CaptionML=[ENU=Select selection;
                                 NLD=Selectie selecteren];
                      OnAction=BEGIN
                                 SelectFields;
                               END;
                                }
      { 1905528704;2 ;Action    ;
                      ShortCutKey=Ctrl+D;
                      CaptionML=[ENU=Deselect selection;
                                 NLD=Selectie &deselecteren];
                      OnAction=BEGIN
                                 DeselectFields;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                GroupType=Repeater }

    { 1000005;2;Field     ;
                CaptionML=[ENU=Selected;
                           NLD=Geselecteerd];
                SourceExpr=FieldSelectedValue;
                OnValidate=BEGIN
                             TmpSelectedField := Rec;

                             IF FieldSelected THEN BEGIN
                               IF TmpSelectedField.DELETE THEN
                                 ;
                             END ELSE
                               IF CanBeSelected THEN BEGIN
                                 TmpSelectedField := Rec;
                                 IF TmpSelectedField.INSERT THEN
                                   ;
                               END;

                             BuildNotSelectedRecord;
                           END;
                            }

    { 1000001;2;Field     ;
                CaptionML=[ENU=No.;
                           NLD=Nr.];
                SourceExpr="No.";
                Editable=FALSE;
                StyleExpr="No.Emphasize" }

    { 1000003;2;Field     ;
                CaptionML=[ENU=Field Name;
                           NLD=Veldnaam];
                SourceExpr=FieldNameText;
                CaptionClass=FIELDCAPTION(FieldName);
                Editable=FALSE;
                StyleExpr=FieldNameEmphasize }

    { 1000013;2;Field     ;
                CaptionML=[ENU=Type Name;
                           NLD=Typenaam];
                SourceExpr="Type Name";
                Editable=FALSE;
                StyleExpr="Type NameEmphasize" }

    { 1000009;2;Field     ;
                CaptionML=[ENU=Class;
                           NLD=Class];
                SourceExpr=Class;
                Editable=FALSE;
                HideValue=ClassHideValue;
                StyleExpr=ClassEmphasize }

    { 1000011;2;Field     ;
                CaptionML=[ENU=Enabled;
                           NLD=Ingeschakeld];
                SourceExpr=Enabled;
                Editable=FALSE }

    { 1000017;2;Field     ;
                CaptionML=[ENU=Relation Table;
                           NLD=Relatietabel];
                SourceExpr=RelationTableNoText;
                CaptionClass=FIELDCAPTION(RelationTableNo);
                Editable=FALSE;
                StyleExpr=RelationTableNoEmphasize;
                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.AssistTableNo(RelationTableNo);
                             END;
                              }

    { 1000019;2;Field     ;
                CaptionML=[ENU=Relation Field;
                           NLD=Relatieveld];
                SourceExpr=RelationFieldNoText;
                CaptionClass=FIELDCAPTION(RelationFieldNo);
                Editable=FALSE;
                StyleExpr=RelationFieldNoEmphasize }

  }
  CODE
  {
    VAR
      TmpKeyField@1100531000 : TEMPORARY Record 2000000041;
      TmpNotSelectedField@1000004 : TEMPORARY Record 2000000041;
      TmpSelectedField@1000001 : TEMPORARY Record 2000000041;
      TableNo@1000003 : Integer;
      SelectionFilter@1000002 : ' ,Selected,Not selected,Key fields';
      ViewType@1000000 : 'Info,Export,Import';
      "No.Emphasize"@19074284 : Boolean INDATASET;
      FieldNameEmphasize@19018884 : Boolean INDATASET;
      FieldNameText@19049269 : Text[1024] INDATASET;
      "Type NameEmphasize"@19030063 : Boolean INDATASET;
      ClassHideValue@19029842 : Boolean INDATASET;
      ClassEmphasize@19027001 : Boolean INDATASET;
      RelationTableNoEmphasize@19020710 : Boolean INDATASET;
      RelationTableNoText@19061642 : Text[1024] INDATASET;
      RelationFieldNoEmphasize@19047340 : Boolean INDATASET;
      RelationFieldNoText@19015870 : Text[1024] INDATASET;
      FieldSelectedValue@1000000000 : Boolean;

    PROCEDURE SetImportDefinition@1000002(MainTable@1000000 : Boolean;ImportDefinition@1000001 : Record 11148591);
    VAR
      ImportDefinitionLine@1000002 : Record 11148592;
      Fld@1000003 : Record 2000000041;
    BEGIN
      IF MainTable THEN
        TableNo := ImportDefinition."Main Table No."
      ELSE
        TableNo := ImportDefinition."Sub Table No.";

      ImportDefinitionLine.SETRANGE("Import Definition", ImportDefinition.Code);
      ImportDefinitionLine.SETRANGE("Table No.", TableNo);
      ImportDefinitionLine.SETFILTER("Field No.", '<>%1', 0);

      IF ImportDefinitionLine.FINDSET THEN
        REPEAT
          IF Fld.GET(TableNo, ImportDefinitionLine."Field No.") THEN BEGIN
            TmpSelectedField := Fld;
            IF NOT TmpSelectedField.INSERT THEN
              ;
          END;
        UNTIL ImportDefinitionLine.NEXT = 0;

      ViewType := ViewType::Import;

      BuildNotSelectedRecord;
    END;

    PROCEDURE SetExportDefinition@1000006(MainTable@1000000 : Boolean;ExportDefinition@1000001 : Record 11148599);
    VAR
      ExportDefinitionLine@1000002 : Record 11148600;
      Fld@1000003 : Record 2000000041;
    BEGIN
      IF MainTable THEN
        TableNo := ExportDefinition."Main Table No."
      ELSE
        TableNo := ExportDefinition."Sub Table No.";

      ExportDefinitionLine.SETRANGE("Export Definition", ExportDefinition.Code);
      ExportDefinitionLine.SETRANGE("Table No.", TableNo);
      ExportDefinitionLine.SETFILTER("Field No.", '<>%1', 0);

      IF ExportDefinitionLine.FINDSET THEN
        REPEAT
          IF Fld.GET(TableNo, ExportDefinitionLine."Field No.") THEN BEGIN
            TmpSelectedField := Fld;
            IF NOT TmpSelectedField.INSERT THEN
              ;
          END;

        UNTIL ExportDefinitionLine.NEXT = 0;

      ViewType := ViewType::Export;

      BuildNotSelectedRecord;
    END;

    PROCEDURE GetSelectedFields@1000000(VAR Fld@1000000 : Record 2000000041);
    BEGIN
      IF TmpSelectedField.FINDSET THEN
        REPEAT
          Fld := TmpSelectedField;
          Fld.INSERT;
        UNTIL TmpSelectedField.NEXT = 0;
    END;

    LOCAL PROCEDURE FieldSelected@1000001() : Boolean;
    BEGIN
      EXIT(TmpSelectedField.GET(TableNo, "No."));
    END;

    LOCAL PROCEDURE IsKeyField@1000003(VAR Fld@1100531000 : Record 2000000041) : Boolean;
    VAR
      RecRef@1000003 : RecordRef;
      FldRef@1000001 : FieldRef;
      KeyRef@1000002 : KeyRef;
      i@1000000 : Integer;
    BEGIN
      RecRef.OPEN(Fld.TableNo);
      KeyRef := RecRef.KEYINDEX(1);
      FOR i := 1 TO KeyRef.FIELDCOUNT DO BEGIN
        FldRef := KeyRef.FIELDINDEX(i);
        IF FldRef.NUMBER = Fld."No." THEN
          EXIT(TRUE);
      END;
    END;

    LOCAL PROCEDURE PrintColor@1000004() : Integer;
    BEGIN
      IF NOT CanBeSelected THEN
        EXIT(8421504);
    END;

    LOCAL PROCEDURE CanBeSelected@1000005() : Boolean;
    BEGIN
      CASE ViewType OF
        ViewType::Import :
          BEGIN
            IF Class <> Class::Normal THEN
              EXIT(FALSE);
            IF NOT
               (Type IN
                 [Type::RecordID, Type::Text, Type::Code, Type::GUID, Type::Date, Type::Time, Type::DateFormula, Type::Decimal,
                 Type::Integer, Type::Option, Type::Boolean, Type::BigInteger, Type::Duration, Type::DateTime])
            THEN
              EXIT(FALSE);
          END;

        ViewType::Export :
          BEGIN
            IF Class = Class::FlowFilter THEN
              EXIT(FALSE);
            IF NOT
               (Type IN
                 [Type::RecordID, Type::Text, Type::Code, Type::GUID, Type::Date, Type::Time, Type::DateFormula, Type::Decimal,
                 Type::Integer, Type::Option, Type::Boolean, Type::BigInteger, Type::Duration, Type::DateTime])
            THEN
              EXIT(FALSE);
          END;

      END;

      EXIT(TRUE);
    END;

    PROCEDURE SelectFields@1000008();
    VAR
      Fld@1000000 : Record 2000000041;
    BEGIN
      Fld := Rec;
      Fld.COPYFILTERS(Rec);

      CurrPage.SETSELECTIONFILTER(Rec);
      IF FINDSET THEN
        REPEAT

          IF CanBeSelected THEN BEGIN
            TmpSelectedField := Rec;
            IF TmpSelectedField.INSERT THEN
              ;
          END;

        UNTIL NEXT = 0;

      CLEARMARKS;
      MARKEDONLY(FALSE);
      COPYFILTERS(Fld);
      Rec := Fld;

      BuildNotSelectedRecord;
    END;

    PROCEDURE DeselectFields@1000009();
    VAR
      Fld@1000000 : Record 2000000041;
    BEGIN
      Fld := Rec;
      Fld.COPYFILTERS(Rec);

      CurrPage.SETSELECTIONFILTER(Rec);
      IF FINDSET THEN
        REPEAT

          TmpSelectedField := Rec;
          IF TmpSelectedField.DELETE THEN
            ;

        UNTIL NEXT = 0;

      CLEARMARKS;
      MARKEDONLY(FALSE);
      COPYFILTERS(Fld);
      Rec := Fld;

      BuildNotSelectedRecord;
    END;

    PROCEDURE SetSelectionFilterFunc@1000007(NewValue@1000001 : ' ,Selected,Not selected');
    BEGIN
      SelectionFilter := NewValue;
    END;

    PROCEDURE FormUpdate@1000010();
    BEGIN
      CurrPage.UPDATE(FALSE);
    END;

    LOCAL PROCEDURE BuildNotSelectedRecord@1000011();
    VAR
      Fld@1000000 : Record 2000000041;
    BEGIN
      TmpNotSelectedField.RESET;
      TmpNotSelectedField.DELETEALL;
      TmpKeyField.DELETEALL;
      Fld.SETRANGE(TableNo, TableNo);
      Fld.SETRANGE(Enabled, TRUE);
      IF Fld.FINDSET THEN
        REPEAT
          IF NOT TmpSelectedField.GET(Fld.TableNo, Fld."No.") THEN BEGIN
            TmpNotSelectedField := Fld;
            TmpNotSelectedField.INSERT;
          END;
          IF IsKeyField(Fld) THEN BEGIN
            TmpKeyField := Fld;
            TmpKeyField.INSERT;
          END;
        UNTIL Fld.NEXT = 0;
    END;

    LOCAL PROCEDURE NoOnFormat@19031395();
    BEGIN
      "No.Emphasize" := (IsKeyField(Rec));
    END;

    LOCAL PROCEDURE FieldNameTextOnFormat@19027030(VAR Text@19000932 : Text[1024]);
    VAR
      Mgt@1000002 : Codeunit 11148589;
    BEGIN
      FieldNameEmphasize := (IsKeyField(Rec));

      Mgt.FormatFieldNo(Text, TableNo, "No.");
    END;

    LOCAL PROCEDURE TypeNameOnFormat@19074332();
    BEGIN
      "Type NameEmphasize" := (IsKeyField(Rec));
    END;

    LOCAL PROCEDURE ClassOnFormat@19044472();
    BEGIN
      ClassEmphasize := (IsKeyField(Rec));

      IF Class = Class::Normal THEN
        ClassHideValue := TRUE;
    END;

    LOCAL PROCEDURE RelationTableNoTextOnFormat@19055629(VAR Text@19038676 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, RelationTableNo);

      RelationTableNoEmphasize := (IsKeyField(Rec));
    END;

    LOCAL PROCEDURE RelationFieldNoTextOnFormat@19027917(VAR Text@19004300 : Text[1024]);
    VAR
      Object@1100531002 : Record 2000000001;
      Mgt@1000000 : Codeunit 11148589;
      RecRef@1000006 : RecordRef;
      FldRef@1000004 : FieldRef;
      KeyRef@1000005 : KeyRef;
      RelationFieldNo2@1000003 : Integer;
    BEGIN
      IF RelationTableNo <> 0 THEN
        IF RelationFieldNo = 0 THEN
          IF Object.GET(Object.Type::Table, '', RelationTableNo) THEN BEGIN
            RecRef.OPEN(RelationTableNo);
            KeyRef := RecRef.KEYINDEX(1);
            FldRef := KeyRef.FIELDINDEX(1);
            RelationFieldNo2 := FldRef.NUMBER;
          END ELSE
            RelationFieldNo2 := RelationFieldNo;

      Mgt.FormatFieldNo(Text, RelationTableNo, RelationFieldNo2);
      RelationFieldNoEmphasize := (IsKeyField(Rec));
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11148591 IN - Function List
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Function List;
               NLD=Functieoverzicht];
    SourceTable=Table11148595;
    PageType=List;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Setup;
                                NLD=Nieuw,Verwerken,Lijst,Instellingen];
    OnOpenPage=BEGIN
                 CurrPage.EDITABLE(NOT CurrPage.LOOKUPMODE);
               END;

    ActionList=ACTIONS
    {
      { 1900000003;  ;ActionContainer;
                      Name=<Action1900000003>;
                      ActionContainerType=ActionItems }
      { 1100531016;1 ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NLD=F&uncties] }
      { 1100531018;2 ;Action    ;
                      CaptionML=[ENU=Initialize;
                                 NLD=Initialiseren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=SetupList;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 FunctionMgt@1100531000 : Codeunit 11148593;
                               BEGIN
                                 FunctionMgt.Initialize;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1100531000;1;Group  ;
                GroupType=Repeater }

    { 1100531001;2;Field  ;
                SourceExpr=Code }

    { 1100531003;2;Field  ;
                SourceExpr=Description }

    { 1100531005;2;Field  ;
                SourceExpr="Description 2" }

    { 1100531007;2;Field  ;
                SourceExpr="Parameter 1" }

    { 1100531009;2;Field  ;
                SourceExpr="Parameter 2" }

    { 1100531011;2;Field  ;
                SourceExpr="Parameter 3" }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11148595 IN - Variables
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Variables;
               NLD=Variabelen];
    SourceTable=Table11148604;
    PageType=List;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr=Code }

    { 1000003;2;Field     ;
                SourceExpr=Description }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11148596 IN - Conversions
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Conversions;
               NLD=Conversies];
    SourceTable=Table11148605;
    PageType=List;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Setup;
                                NLD=Nieuw,Verwerken,Lijst,Instellingen];
    OnOpenPage=VAR
                 Initialize@1000000 : Codeunit 11148625;
               BEGIN
                 Initialize.CheckInitialize;
               END;

    ActionList=ACTIONS
    {
      { 1900000003;  ;ActionContainer;
                      Name=<Action1900000003>;
                      ActionContainerType=ActionItems }
      { 1000008 ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 NLD=F&uncties] }
      { 1000010 ;2   ;Action    ;
                      ShortCutKey=Shift+F5;
                      CaptionML=[ENU=Setup;
                                 NLD=Instellen];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Setup;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ConversionLines@1000000 : Page 11148597;
                               BEGIN
                                 TESTFIELD(Code);

                                 ConversionLines.SetConversionCode(Code);
                                 ConversionLines.RUN;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr=Code }

    { 1000003;2;Field     ;
                SourceExpr=Description }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11148597 IN - Conversion Lines
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Conversion Lines;
               NLD=Conversieregels];
    SourceTable=Table11148606;
    DelayedInsert=Yes;
    PageType=Document;
    OnOpenPage=BEGIN
                 ValidateConversionCode;
               END;

    OnNewRecord=BEGIN
                  "Entry No." := GetNewEntryNo;
                END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000000;1;Group  ;
                GroupType=Group }

    { 1000008;2;Field     ;
                CaptionML=[ENU=Conversion Code;
                           NLD=Conversie];
                SourceExpr=ConversionCode;
                TableRelation="IN - Conversion";
                OnValidate=BEGIN
                             ValidateConversionCode;
                               ConversionCodeOnAfterValidate;
                           END;
                            }

    { 1000000;1;Group     ;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr="NAV Value" }

    { 1000003;2;Field     ;
                SourceExpr="Extern Value" }

  }
  CODE
  {
    VAR
      ConversionCode@1000000 : Code[20];

    PROCEDURE SetConversionCode@1000000(NewConversionCode@1000000 : Code[20]);
    BEGIN
      ConversionCode := NewConversionCode;
    END;

    LOCAL PROCEDURE ValidateConversionCode@1000001();
    VAR
      Conversion@1000000 : Record 11148605;
    BEGIN
      Conversion.GET(ConversionCode);
      FILTERGROUP(10);
      SETRANGE("Conversion Code", ConversionCode);
      FILTERGROUP(0);
    END;

    LOCAL PROCEDURE ConversionCodeOnAfterValidate@19046569();
    BEGIN
      CurrPage.UPDATE(FALSE);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11148598 IN - Tables
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Tables;
               NLD=Tabellen];
    SourceTable=Table2000000001;
    SourceTableView=SORTING(Type,Company Name,ID)
                    WHERE(Type=CONST(Table),
                          Company Name=CONST());
    PageType=List;
    OnInit=BEGIN
             CurrPage.LOOKUPMODE := TRUE;
           END;

    OnAfterGetRecord=BEGIN
                       IDOnFormat;
                       NameOnFormat;
                       CaptionOnFormat;
                     END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr=ID;
                StyleExpr=IDEmphasize }

    { 1000003;2;Field     ;
                SourceExpr=Name;
                Visible=FALSE;
                StyleExpr=NameEmphasize }

    { 1000008;2;Field     ;
                SourceExpr=Caption;
                StyleExpr=CaptionEmphasize }

  }
  CODE
  {
    VAR
      TmpObjectBold@1100531000 : TEMPORARY Record 2000000001;
      IDEmphasize@19018170 : Boolean INDATASET;
      NameEmphasize@19018670 : Boolean INDATASET;
      CaptionEmphasize@19038422 : Boolean INDATASET;

    PROCEDURE MarkRecord@1100531000(VAR Object@1100531000 : Record 2000000001);
    BEGIN
      Rec := Object;
      MARK(TRUE);
    END;

    PROCEDURE SetBold@1100531002(VAR Object@1100531000 : Record 2000000001);
    BEGIN
      TmpObjectBold := Object;
      IF TmpObjectBold.INSERT THEN
        ;
    END;

    PROCEDURE SetMarkedOnly@1100531001();
    BEGIN
      MARKEDONLY(TRUE);
    END;

    LOCAL PROCEDURE IDOnFormat@19056045();
    BEGIN
      TmpObjectBold := Rec;
      IDEmphasize := (TmpObjectBold.FIND('='));
    END;

    LOCAL PROCEDURE NameOnFormat@19039177();
    BEGIN
      TmpObjectBold := Rec;
      NameEmphasize := (TmpObjectBold.FIND('='));
    END;

    LOCAL PROCEDURE CaptionOnFormat@19049906();
    BEGIN
      TmpObjectBold := Rec;
      CaptionEmphasize := (TmpObjectBold.FIND('='));
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11148599 IN - Objects
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Objects;
               NLD=Objecten];
    SourceTable=Table2000000001;
    SourceTableView=SORTING(Type,Company Name,ID);
    PageType=List;
    OnInit=BEGIN
             CurrPage.LOOKUPMODE := TRUE;
           END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr=ID }

    { 1000003;2;Field     ;
                SourceExpr=Name;
                Visible=FALSE }

    { 1000008;2;Field     ;
                SourceExpr=Caption }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11148600 IN - Fields
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Fields;
               NLD=Velden];
    SourceTable=Table2000000041;
    DataCaptionExpr=CurrTableName;
    PageType=List;
    OnInit=BEGIN
             CurrPage.LOOKUPMODE := TRUE;
           END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr="No." }

    { 1000003;2;Field     ;
                SourceExpr=FieldName;
                Visible=FALSE }

    { 1000008;2;Field     ;
                SourceExpr="Field Caption" }

  }
  CODE
  {

    LOCAL PROCEDURE CurrTableName@1000000() : Text[30];
    VAR
      Object@1000000 : Record 2000000001;
    BEGIN
      IF Object.GET(Object.Type::Table, '', TableNo) THEN BEGIN
        Object.CALCFIELDS(Caption);
        EXIT(Object.Caption);
      END;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11148601 IN - Record Values
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Record Values;
               NLD=Recordwaarden];
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table11148619;
    PageType=List;
    OnAfterGetRecord=BEGIN
                       FieldNoOnFormat(FORMAT("Field No."));
                     END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1100512000;1;Group  ;
                Editable=FALSE;
                GroupType=Repeater }

    { 1100512001;2;Field  ;
                Lookup=No;
                SourceExpr="Field No." }

    { 1100512003;2;Field  ;
                SourceExpr=Value;
                Visible=FALSE }

    { 1100512005;2;Field  ;
                SourceExpr="Original Value" }

  }
  CODE
  {

    LOCAL PROCEDURE FieldNoOnFormat@19075355(Text@19041114 : Text[1024]);
    VAR
      Mgt@1100512000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatFieldNo(Text, "Table No.", "Field No.");
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11148602 IN - Table Info
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Table Info;
               NLD=Tabelinfo];
    SourceTable=Table2000000001;
    DataCaptionExpr=DataCaption;
    SourceTableView=SORTING(Type,Company Name,ID)
                    WHERE(Type=CONST(Table),
                          Company Name=FILTER(''));
    PageType=List;
    OnAfterGetRecord=BEGIN
                       IF (GETFILTER(Type) <> '') AND (GETFILTER(ID) <> '') THEN;
                     END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                CaptionML=[ENU=General;
                           NLD=Algemeen] }

    { 1000005;2;Field     ;
                CaptionML=[ENU=No.;
                           NLD=Nr.];
                SourceExpr=ID }

    { 1000001;2;Field     ;
                CaptionML=[ENU=Name;
                           NLD=Naam];
                SourceExpr=Name }

    { 1000010;2;Field     ;
                CaptionML=[ENU=Version List;
                           NLD=Versielijst];
                SourceExpr="Version List" }

    { 1000012;2;Field     ;
                CaptionML=[ENU=Caption;
                           NLD=Caption];
                SourceExpr=Caption }

    { 1000007;2;Field     ;
                CaptionML=[ENU=Date;
                           NLD=Datum];
                SourceExpr=Date }

    { 1000003;2;Field     ;
                CaptionML=[ENU=Time;
                           NLD=Tijd];
                SourceExpr=Time }

    { 1000014;2;Field     ;
                CaptionML=[ENU=Modified;
                           NLD=Gewijzigd];
                SourceExpr=Modified }

    { 1000016;2;Field     ;
                CaptionML=[ENU=Compiled;
                           NLD=Gecompileerd];
                SourceExpr=Compiled }

    { 1000018;1;Part      ;
                SubPageView=SORTING(TableNo,No.);
                SubPageLink=TableNo=FIELD(ID);
                PagePartID=Page11148603 }

  }
  CODE
  {

    LOCAL PROCEDURE DataCaption@1000000() : Text[1024];
    BEGIN
      EXIT(FORMAT(ID) + ' - ' + Name);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11148603 IN - Table Info Subform
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Table Info Subform;
               NLD=Tabelinformatie subform];
    SourceTable=Table2000000041;
    PageType=ListPart;
    OnAfterGetRecord=VAR
                       RecRef@1000000 : RecordRef;
                       FldRef@1000002 : FieldRef;
                       KeyRef@1000001 : KeyRef;
                       i@1000003 : Integer;
                     BEGIN
                       ClassHideValue := FALSE;
                       PrintBold := FALSE;

                       RecRef.OPEN(TableNo);
                       KeyRef := RecRef.KEYINDEX(1);
                       FOR i := 1 TO KeyRef.FIELDCOUNT DO BEGIN
                         FldRef := KeyRef.FIELDINDEX(i);
                         IF FldRef.NUMBER = "No." THEN
                           PrintBold := TRUE;
                       END;
                       NoOnFormat;
                       FieldNameOnFormat;
                       FieldCaptionOnFormat;
                       TypeNameOnFormat;
                       ClassOnFormat;
                       RelationTableNoOnFormat(FORMAT(RelationTableNo));
                       RelationFieldNoOnFormat(FORMAT(RelationFieldNo));
                     END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                CaptionML=[ENU=No.;
                           NLD=Nr.];
                SourceExpr="No.";
                StyleExpr="No.Emphasize" }

    { 1000003;2;Field     ;
                CaptionML=[ENU=Field Name;
                           NLD=Veldnaam];
                SourceExpr=FieldName;
                StyleExpr=FieldNameEmphasize }

    { 1000015;2;Field     ;
                CaptionML=[ENU=Field Caption;
                           NLD=Veldcaption];
                SourceExpr="Field Caption";
                StyleExpr="Field CaptionEmphasize" }

    { 1000013;2;Field     ;
                CaptionML=[ENU=Type Name;
                           NLD=Typenaam];
                SourceExpr="Type Name";
                StyleExpr="Type NameEmphasize" }

    { 1000009;2;Field     ;
                CaptionML=[ENU=Class;
                           NLD=Class];
                SourceExpr=Class;
                HideValue=ClassHideValue;
                StyleExpr=ClassEmphasize }

    { 1000011;2;Field     ;
                CaptionML=[ENU=Enabled;
                           NLD=Ingeschakeld];
                SourceExpr=Enabled }

    { 1000005;2;Field     ;
                CaptionML=[ENU=Options;
                           NLD=Opties];
                SourceExpr=Options }

    { 1000017;2;Field     ;
                CaptionML=[ENU=Relation Table;
                           NLD=Relatietabel];
                SourceExpr=RelationTableNo;
                StyleExpr=RelationTableNoEmphasize;
                OnAssistEdit=VAR
                               Mgt@1000000 : Codeunit 11148589;
                             BEGIN
                               Mgt.AssistTableNo(RelationTableNo);
                             END;
                              }

    { 1000019;2;Field     ;
                CaptionML=[ENU=Relation Field;
                           NLD=Relatieveld];
                SourceExpr=RelationFieldNo;
                StyleExpr=RelationFieldNoEmphasize }

  }
  CODE
  {
    VAR
      PrintBold@1000000 : Boolean;
      "No.Emphasize"@19074284 : Boolean INDATASET;
      FieldNameEmphasize@19018884 : Boolean INDATASET;
      "Field CaptionEmphasize"@19074161 : Boolean INDATASET;
      "Type NameEmphasize"@19030063 : Boolean INDATASET;
      ClassHideValue@19029842 : Boolean INDATASET;
      ClassEmphasize@19027001 : Boolean INDATASET;
      RelationTableNoEmphasize@19020710 : Boolean INDATASET;
      RelationFieldNoEmphasize@19047340 : Boolean INDATASET;

    LOCAL PROCEDURE Options@1000000() : Text[1024];
    VAR
      RecRef@1000001 : RecordRef;
      FldRef@1000000 : FieldRef;
    BEGIN
      IF Type = Type::Option THEN BEGIN
        RecRef.OPEN(TableNo);
        FldRef := RecRef.FIELD("No.");
        EXIT(FldRef.OPTIONSTRING);
      END;
    END;

    LOCAL PROCEDURE NoOnFormat@19031395();
    BEGIN
      "No.Emphasize" := (PrintBold);
    END;

    LOCAL PROCEDURE FieldNameOnFormat@19012197();
    BEGIN
      FieldNameEmphasize := (PrintBold);
    END;

    LOCAL PROCEDURE FieldCaptionOnFormat@19019883();
    BEGIN
      "Field CaptionEmphasize" := (PrintBold);
    END;

    LOCAL PROCEDURE TypeNameOnFormat@19074332();
    BEGIN
      "Type NameEmphasize" := (PrintBold);
    END;

    LOCAL PROCEDURE ClassOnFormat@19044472();
    BEGIN
      ClassEmphasize := (PrintBold);

      IF Class = Class::Normal THEN
        ClassHideValue := TRUE;
    END;

    LOCAL PROCEDURE RelationTableNoOnFormat@19042442(Text@19072251 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, RelationTableNo);
      RelationTableNoEmphasize := (PrintBold);
    END;

    LOCAL PROCEDURE RelationFieldNoOnFormat@19042252(Text@19034454 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
      RecRef@1000006 : RecordRef;
      FldRef@1000004 : FieldRef;
      KeyRef@1000005 : KeyRef;
      RelationFieldNo2@1000003 : Integer;
    BEGIN
      IF RelationTableNo <> 0 THEN
        IF RelationFieldNo = 0 THEN BEGIN
          RecRef.OPEN(RelationTableNo);
          KeyRef := RecRef.KEYINDEX(1);
          FldRef := KeyRef.FIELDINDEX(1);
          RelationFieldNo2 := FldRef.NUMBER;
        END ELSE
          RelationFieldNo2 := RelationFieldNo;

      Mgt.FormatFieldNo(Text, RelationTableNo, RelationFieldNo2);
      RelationFieldNoEmphasize := (PrintBold);
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11148604 IN - Import Def. Table Link
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Import Def. Table Link;
               NLD=Importdefinitie tabellink];
    SourceTable=Table11148593;
    DataCaptionFields=Import Definition;
    PageType=List;
    OnAfterGetRecord=BEGIN
                       MainFieldNoOnFormat(FORMAT("Main Field No."));
                       SubFieldNoOnFormat(FORMAT("Sub Field No."));
                     END;

    OnNewRecord=BEGIN
                  IF ("Import Def. Entry No." <> 0) AND FromAdvancedView THEN BEGIN
                    "Main Table No." := MainImportDefinitionLine."Table No.";
                    "Sub Table No." := SubImportDefinitionLine."Table No.";
                  END;
                END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr="Main Field No.";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           EXIT(Mgt.LookupFieldNo("Main Table No.", Text, TRUE));
                         END;
                          }

    { 1000000000;2;Field  ;
                SourceExpr="Main Field Name" }

    { 1000005;2;Field     ;
                SourceExpr="Sub Field No.";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           EXIT(Mgt.LookupFieldNo("Sub Table No.", Text, TRUE));
                         END;
                          }

    { 1000000001;2;Field  ;
                SourceExpr="Sub Field Name" }

  }
  CODE
  {
    VAR
      MainImportDefinitionLine@1000000 : Record 11148592;
      SubImportDefinitionLine@1000001 : Record 11148592;
      FromAdvancedView@1000002 : Boolean;

    PROCEDURE SetMainTable@1000000(VAR ImportDefinitionLine@1000000 : Record 11148592);
    BEGIN
      FromAdvancedView := TRUE;

      FILTERGROUP(10);
      SETRANGE("Main Table No.", ImportDefinitionLine."Table No.");
      FILTERGROUP(0);

      MainImportDefinitionLine := ImportDefinitionLine;
    END;

    PROCEDURE SetSubTable@1000001(VAR ImportDefinitionLine@1000000 : Record 11148592);
    BEGIN
      FromAdvancedView := TRUE;

      FILTERGROUP(10);
      SETRANGE("Import Definition", ImportDefinitionLine."Import Definition");
      SETRANGE("Import Def. Entry No.", ImportDefinitionLine."Entry No.");
      SETRANGE("Sub Table No.", ImportDefinitionLine."Table No.");
      FILTERGROUP(0);

      SubImportDefinitionLine := ImportDefinitionLine;
    END;

    LOCAL PROCEDURE MainFieldNoOnAfterInput@19038643(VAR Text@19038644 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFieldNo(Text, "Main Table No.", TRUE);
    END;

    LOCAL PROCEDURE SubFieldNoOnAfterInput@19072949(VAR Text@19072950 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFieldNo(Text, "Sub Table No.", TRUE);
    END;

    LOCAL PROCEDURE MainFieldNoOnFormat@19059116(Text@19014935 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatFieldNo(Text, "Main Table No.", "Main Field No.");
    END;

    LOCAL PROCEDURE SubFieldNoOnFormat@19036367(Text@19001192 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatFieldNo(Text, "Sub Table No.", "Sub Field No.");
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11148605 IN - Export Def. Table Link
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Export Def. Table Link;
               NLD=Exportdefinitie tabellink];
    SourceTable=Table11148601;
    PageType=List;
    OnAfterGetRecord=BEGIN
                       MainFieldNoOnFormat(FORMAT("Main Field No."));
                       SubFieldNoOnFormat(FORMAT("Sub Field No."));
                     END;

    OnNewRecord=BEGIN
                  IF ("Export Def. Entry No." <> 0) AND FromAdvancedView THEN BEGIN
                    "Main Table No." := MainExportDefLine."Table No.";
                    "Sub Table No." := SubExportDefLine."Table No.";
                  END;
                END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr="Main Field No.";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           // IDYN EBK >>>>
                           IF Mgt.LookupFieldNo("Main Table No.",Text,FALSE) THEN BEGIN
                             EVALUATE("Main Field No.",Text);
                             VALIDATE("Main Field No.");
                           END;
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //EXIT(Mgt.LookupFieldNo("Main Table No.", Text, FALSE));
                           // IDYN EBK <<<<
                         END;
                          }

    { 1000005;2;Field     ;
                SourceExpr="Sub Field No.";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           // IDYN EBK >>>>
                           IF Mgt.LookupFieldNo("Sub Table No.",Text,FALSE) THEN BEGIN
                             EVALUATE("Sub Field No.",Text);
                             VALIDATE("Sub Field No.");
                           END;
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           //EXIT(Mgt.LookupFieldNo("Sub Table No.", Text, FALSE));
                           // IDYN EBK <<<<
                         END;
                          }

  }
  CODE
  {
    VAR
      MainExportDefLine@1000000 : Record 11148600;
      SubExportDefLine@1000001 : Record 11148600;
      FromAdvancedView@1000002 : Boolean;

    PROCEDURE SetMainTable@1000000(VAR ExportDefLine@1000000 : Record 11148600);
    BEGIN
      FromAdvancedView := TRUE;

      FILTERGROUP(10);
      SETRANGE("Main Table No.", ExportDefLine."Table No.");
      FILTERGROUP(0);

      MainExportDefLine := ExportDefLine;
    END;

    PROCEDURE SetSubTable@1000001(VAR ExportDefLine@1000000 : Record 11148600);
    BEGIN
      FromAdvancedView := TRUE;

      FILTERGROUP(10);
      SETRANGE("Export Definition", ExportDefLine."Export Definition");
      SETRANGE("Export Def. Entry No.", ExportDefLine."Entry No.");
      SETRANGE("Sub Table No.", ExportDefLine."Table No.");
      FILTERGROUP(0);

      SubExportDefLine := ExportDefLine;
    END;

    LOCAL PROCEDURE MainFieldNoOnAfterInput@19038643(VAR Text@19038644 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFieldNo(Text, "Main Table No.", FALSE);
    END;

    LOCAL PROCEDURE SubFieldNoOnAfterInput@19072949(VAR Text@19072950 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFieldNo(Text, "Sub Table No.", FALSE);
    END;

    LOCAL PROCEDURE MainFieldNoOnFormat@19059116(Text@19014935 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatFieldNo(Text, "Main Table No.", "Main Field No.");
    END;

    LOCAL PROCEDURE SubFieldNoOnFormat@19036367(Text@19001192 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatFieldNo(Text, "Sub Table No.", "Sub Field No.");
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11148606 IN - Import Restrictions
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Import Restrictions;
               NLD=Importrestricties];
    SourceTable=Table11148596;
    DataCaptionExpr=FormCaption;
    PageType=List;
    OnInit=BEGIN
             "Table FilterEditable" := TRUE;
             "Field No.Editable" := TRUE;
             "Table No.Editable" := TRUE;
           END;

    OnAfterGetRecord=VAR
                       Mgt@1000000 : Codeunit 11148589;
                     BEGIN
                       IF FORMAT("Table Filter") = '' THEN
                         EVALUATE("Table Filter", Mgt.EmptyTableFilter("Table No."));

                       SetFieldsEditable;
                       TableNoOnFormat(FORMAT("Table No."));
                       FieldNoOnFormat(FORMAT("Field No."));
                       TableFilterOnFormat(FORMAT("Table Filter"));
                     END;

    OnNewRecord=BEGIN
                  "Entry No." := GetNewEntryNo;
                  VALIDATE(Type);
                END;

    OnInsertRecord=BEGIN
                     IF NOT INSERT(TRUE) THEN
                       MODIFY(TRUE);

                     EXIT(FALSE);
                   END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000018 ;1   ;ActionGroup;
                      CaptionML=[ENU=&Restriction;
                                 NLD=&Restrictie] }
      { 1000019 ;2   ;Action    ;
                      ShortCutKey=Ctrl+W;
                      CaptionML=[ENU=Values;
                                 NLD=Waarden];
                      RunObject=Page 11117010;
                      RunPageLink=Import Definition=FIELD(Import Definition),
                                  Import Def. Entry No.=FIELD(Import Def. Entry No.),
                                  Import Restriction Entry No.=FIELD(Entry No.) }
      { 1000000002;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+V;
                      CaptionML=[ENU=Variable &Filters;
                                 NLD=Variabele filters];
                      RunObject=Page 11117011;
                      RunPageView=SORTING(Import Definition,Import Def. Entry No.,Import Restriction Entry No.,Field No.);
                      RunPageLink=Import Definition=FIELD(Import Definition),
                                  Import Def. Entry No.=FIELD(Import Def. Entry No.),
                                  Import Restriction Entry No.=FIELD(Entry No.) }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr=Type;
                OnValidate=BEGIN
                             TypeOnAfterValidate;
                           END;
                            }

    { 1000003;2;Field     ;
                SourceExpr="Table No.";
                Editable="Table No.Editable";
                OnLookup=VAR
                           Mgt@1000000 : Codeunit 11148589;
                         BEGIN
                           EXIT(Mgt.LookupTableNo(Text));
                         END;
                          }

    { 1000005;2;Field     ;
                SourceExpr="Field No.";
                Editable="Field No.Editable";
                OnLookup=VAR
                           Mgt@1000000 : Codeunit 11148589;
                         BEGIN
                           EXIT(Mgt.LookupFieldNo("Table No.", Text, TRUE));
                         END;
                          }

    { 1000014;2;Field     ;
                AssistEdit=Yes;
                SourceExpr="Table Filter";
                Editable="Table FilterEditable";
                OnAssistEdit=VAR
                               INMgt@1000000000 : Codeunit 11148589;
                             BEGIN
                               EVALUATE("Table Filter", INMgt.SetTableFilter("Table No.",FORMAT("Table Filter"))); // CI-143
                             END;
                              }

    { 1000000000;2;Field  ;
                SourceExpr="Error No.";
                Visible=FALSE }

    { 1000010;2;Field     ;
                SourceExpr="Alternative Value" }

    { 1000016;2;Field     ;
                SourceExpr="No. of Values";
                OnDrillDown=VAR
                              ImportRestrictionValue@1000000 : Record 11148597;
                              ImportRestrictionValues@1000001 : Page 11117010;
                            BEGIN
                              IF INSERT(TRUE) THEN
                                ;
                              COMMIT;

                              ImportRestrictionValue.FILTERGROUP(10);
                              ImportRestrictionValue.SETRANGE("Import Definition", "Import Definition");
                              ImportRestrictionValue.SETRANGE("Import Def. Entry No.", "Import Def. Entry No.");
                              ImportRestrictionValue.SETRANGE("Import Restriction Entry No.", "Entry No.");
                              ImportRestrictionValue.FILTERGROUP(0);

                              ImportRestrictionValues.SETTABLEVIEW(ImportRestrictionValue);
                              ImportRestrictionValues.RUNMODAL;
                            END;
                             }

    { 1000012;2;Field     ;
                SourceExpr="Max. Length" }

    { 1000020;2;Field     ;
                SourceExpr="Min. Value" }

    { 1000022;2;Field     ;
                SourceExpr="Max. Value" }

  }
  CODE
  {
    VAR
      "Table No.Editable"@19076806 : Boolean INDATASET;
      "Field No.Editable"@19022826 : Boolean INDATASET;
      "Table FilterEditable"@19054732 : Boolean INDATASET;

    LOCAL PROCEDURE SetFieldsEditable@1000000();
    BEGIN
      "Table No.Editable" := (Type = Type::"Table Relation");
      "Field No.Editable" := (Type = Type::"Table Relation");
      "Table FilterEditable" := (Type = Type::"Table Relation");
    END;

    LOCAL PROCEDURE FormCaption@1000001() : Text[1024];
    VAR
      ImportDefinitionLine@1000000 : Record 11148592;
    BEGIN
      IF ImportDefinitionLine.GET("Import Definition", "Import Def. Entry No.") THEN
        EXIT(STRSUBSTNO('%1 - %2', ImportDefinitionLine."Import Definition", ImportDefinitionLine."Tag Name"))
      ELSE
        EXIT(STRSUBSTNO('%1', "Import Definition"))
    END;

    LOCAL PROCEDURE TypeOnAfterValidate@19069045();
    BEGIN
      SetFieldsEditable;
    END;

    LOCAL PROCEDURE TableNoOnAfterInput@19060375(VAR Text@19060376 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableNo(Text);
    END;

    LOCAL PROCEDURE FieldNoOnAfterInput@19063566(VAR Text@19063567 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFieldNo(Text, "Table No.", TRUE);
    END;

    LOCAL PROCEDURE TableFilterOnAfterInput@19072298(VAR Text@19072299 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputTableFilter(Text, "Table No.");
    END;

    LOCAL PROCEDURE TableNoOnFormat@19071785(Text@19016339 : Text[1024]);
    VAR
      Mgt@1000002 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableNo(Text, "Table No.");
    END;

    LOCAL PROCEDURE FieldNoOnFormat@19075355(Text@19041114 : Text[1024]);
    VAR
      Mgt@1000002 : Codeunit 11148589;
    BEGIN
      Mgt.FormatFieldNo(Text, "Table No.", "Field No.");
    END;

    LOCAL PROCEDURE TableFilterOnFormat@19013929(Text@19048068 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatTableFilter(Text, "Table No.");
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11148607 IN - Export Def. Variable Filt
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Export Def. Variable Filters;
               NLD=Exportdefinitie variabelen tabelfilter];
    SourceTable=Table11148601;
    PageType=List;
    OnAfterGetRecord=BEGIN
                       MainFieldNoOnFormat(FORMAT("Main Field No."));
                     END;

    OnNewRecord=BEGIN
                  IF "Export Def. Entry No." <> 0 THEN
                    "Main Table No." := MainExportDefLine."Table No.";
                END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000;1;Group     ;
                GroupType=Repeater }

    { 1000001;2;Field     ;
                SourceExpr="Main Field No.";
                OnLookup=VAR
                           Mgt@1000002 : Codeunit 11148589;
                         BEGIN
                           // IDYN EBK >>>>
                           IF Mgt.LookupFieldNo("Main Table No.",Text,FALSE) THEN BEGIN
                             EVALUATE("Main Field No.",Text);
                             VALIDATE("Main Field No.");
                           END;
                           // The below crashes the 2013 RTC; 2013 FP1 is not affected
                           // EXIT(Mgt.LookupFieldNo("Main Table No.", Text, FALSE));
                           // IDYN EBK <<<<
                         END;
                          }

    { 1000003;2;Field     ;
                SourceExpr=Variable }

  }
  CODE
  {
    VAR
      MainExportDefLine@1000000 : Record 11148600;

    PROCEDURE SetSubTable@1000000(VAR ExportDefLine@1000000 : Record 11148600);
    BEGIN
      FILTERGROUP(10);
      SETRANGE("Export Definition", ExportDefLine."Export Definition");
      SETRANGE("Export Def. Entry No.", ExportDefLine."Entry No.");
      SETRANGE("Main Table No.", ExportDefLine."Table No.");
      SETRANGE("Sub Table No.", 0);
      FILTERGROUP(0);

      MainExportDefLine := ExportDefLine;
    END;

    LOCAL PROCEDURE MainFieldNoOnAfterInput@19038643(VAR Text@19038644 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.AfterInputFieldNo(Text, "Main Table No.", FALSE);
    END;

    LOCAL PROCEDURE MainFieldNoOnFormat@19059116(Text@19014935 : Text[1024]);
    VAR
      Mgt@1000000 : Codeunit 11148589;
    BEGIN
      Mgt.FormatFieldNo(Text, "Main Table No.", "Main Field No.");
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11148608 IN - Data Change Setup
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Data Change Setup;
               NLD=Wijzigingsmonitorinstellingen];
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table11148638;
    PageType=Card;
    OnOpenPage=BEGIN
                 RESET;
                 IF NOT GET THEN BEGIN
                   INIT;
                   INSERT;
                 END;
               END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 5       ;1   ;ActionGroup;
                      CaptionML=[ENU=&Setup;
                                 NLD=&Instellingen] }
      { 6       ;2   ;Action    ;
                      CaptionML=[ENU=Tables;
                                 NLD=&Tabellen];
                      OnAction=VAR
                                 DataChangeSetupList@1000 : Page 11148609;
                               BEGIN
                                 DataChangeSetupList.SetSource;
                                 DataChangeSetupList.RUNMODAL;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           NLD=Algemeen] }

    { 2   ;2   ;Field     ;
                SourceExpr="Data Change Activated" }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11148609 IN - Data Change Setup (Table)
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Data Change Setup (Table) List;
               NLD=Overz. wijzigingsmonitorinstellingen (Tabel)];
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table2000000058;
    PageType=List;
    SourceTableTemporary=Yes;
    OnOpenPage=BEGIN
                 FILTERGROUP(2);
                 SETRANGE("Object Type","Object Type"::Table);
                 SETRANGE("Object ID",0,2000000006);
                 FILTERGROUP(0);
               END;

    OnAfterGetRecord=BEGIN
                       GetRec;
                     END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 15  ;2   ;Field     ;
                CaptionML=[ENU=ID;
                           NLD=ID];
                SourceExpr="Object ID";
                Editable=FALSE }

    { 19  ;2   ;Field     ;
                CaptionML=[ENU=Name;
                           NLD=Naam];
                SourceExpr="Object Caption";
                Editable=FALSE }

    { 6   ;2   ;Field     ;
                CaptionML=[ENU=Log Insertion;
                           NLD=Gereg. invoeging];
                OptionCaptionML=[ENU=" ,Some Fields,All Fields";
                                 NLD=" ,Bepaalde velden,Alle velden"];
                SourceExpr=DataChangeSetupTable."Log Insertion";
                OnValidate=VAR
                             NewValue@1001 : Option;
                           BEGIN
                             IF DataChangeSetupTable."Table No." <> "Object ID" THEN
                             BEGIN
                               NewValue := DataChangeSetupTable."Log Insertion";
                               GetRec;
                               DataChangeSetupTable."Log Insertion" := NewValue;
                             END;

                             IF xDataChangeSetupTable.GET(DataChangeSetupTable."Table No.") THEN
                             BEGIN
                               IF (xDataChangeSetupTable."Log Insertion" = xDataChangeSetupTable."Log Insertion"::"Some Fields") AND
                                  (xDataChangeSetupTable."Log Insertion" <> DataChangeSetupTable."Log Insertion")
                               THEN
                                 IF CONFIRM(
                                   STRSUBSTNO(Text002,xDataChangeSetupTable.FIELDCAPTION("Log Insertion"),xDataChangeSetupTable."Log Insertion"),FALSE)
                                 THEN
                                   DataChangeSetupTable.DelChangeLogFields(0);
                             END;
                               DataChangeSetupTableLogInserti;
                           END;

                OnAssistEdit=BEGIN
                               WITH DataChangeSetupTable DO
                                 TESTFIELD("Log Insertion","Log Insertion"::"Some Fields");
                               AssistEdit;
                             END;
                              }

    { 8   ;2   ;Field     ;
                CaptionML=[ENU=Log Modification;
                           NLD=Gereg. wijziging];
                OptionCaptionML=[ENU=" ,Some Fields,All Fields";
                                 NLD=" ,Bepaalde velden,Alle velden"];
                SourceExpr=DataChangeSetupTable."Log Modification";
                OnValidate=VAR
                             NewValue@1001 : Option;
                           BEGIN
                             IF DataChangeSetupTable."Table No." <> "Object ID" THEN
                             BEGIN
                               NewValue := DataChangeSetupTable."Log Modification";
                               GetRec;
                               DataChangeSetupTable."Log Modification" := NewValue;
                             END;

                             IF xDataChangeSetupTable.GET(DataChangeSetupTable."Table No.") THEN
                             BEGIN
                               IF (xDataChangeSetupTable."Log Modification" = xDataChangeSetupTable."Log Modification"::"Some Fields") AND
                                  (xDataChangeSetupTable."Log Modification" <> DataChangeSetupTable."Log Modification")
                               THEN
                                 IF CONFIRM(
                                   STRSUBSTNO(Text002,xDataChangeSetupTable.FIELDCAPTION("Log Modification"),xDataChangeSetupTable."Log Modification"),FALSE)
                                 THEN
                                   DataChangeSetupTable.DelChangeLogFields(1);
                             END;
                               DataChangeSetupTableLogModific;
                           END;

                OnAssistEdit=BEGIN
                               WITH DataChangeSetupTable DO
                                 TESTFIELD("Log Modification","Log Modification"::"Some Fields");
                               AssistEdit;
                             END;
                              }

    { 10  ;2   ;Field     ;
                CaptionML=[ENU=Log Deletion;
                           NLD=Gereg. verwijdering];
                OptionCaptionML=[ENU=" ,Some Fields,All Fields";
                                 NLD=" ,Bepaalde velden,Alle velden"];
                SourceExpr=DataChangeSetupTable."Log Deletion";
                OnValidate=VAR
                             NewValue@1001 : Option;
                           BEGIN
                             IF DataChangeSetupTable."Table No." <> "Object ID" THEN
                             BEGIN
                               NewValue := DataChangeSetupTable."Log Deletion";
                               GetRec;
                               DataChangeSetupTable."Log Deletion" := NewValue;
                             END;

                             IF xDataChangeSetupTable.GET(DataChangeSetupTable."Table No.") THEN
                             BEGIN
                               IF (xDataChangeSetupTable."Log Deletion" = xDataChangeSetupTable."Log Deletion"::"Some Fields") AND
                                  (xDataChangeSetupTable."Log Deletion" <> DataChangeSetupTable."Log Deletion")
                               THEN
                                 IF CONFIRM(
                                   STRSUBSTNO(Text002,xDataChangeSetupTable.FIELDCAPTION("Log Deletion"),xDataChangeSetupTable."Log Deletion"),FALSE)
                                 THEN
                                   DataChangeSetupTable.DelChangeLogFields(2);
                             END;
                               DataChangeSetupTableLogDeletio;
                           END;

                OnAssistEdit=BEGIN
                               WITH DataChangeSetupTable DO
                                 TESTFIELD("Log Deletion","Log Deletion"::"Some Fields");
                               AssistEdit;
                             END;
                              }

  }
  CODE
  {
    VAR
      DataChangeSetupTable@1000 : Record 11148639;
      xDataChangeSetupTable@1002 : Record 11148639;
      Text002@1003 : TextConst 'ENU=You have changed the %1 field to no longer be %2. Do you want to remove the field selections?;NLD=U hebt het veld %1 gewijzigd waardoor de inhoud niet langer %2 is. Wilt u de veldselecties verwijderen?';

    LOCAL PROCEDURE AssistEdit@1();
    VAR
      Field@1001 : Record 2000000041;
      DataChangeSetupFieldList@1002 : Page 11148610;
    BEGIN
      Field.FILTERGROUP(2);
      Field.SETRANGE(TableNo,"Object ID");
      Field.FILTERGROUP(0);
      WITH DataChangeSetupTable DO
        DataChangeSetupFieldList.SelectColumn(
          "Log Insertion" = "Log Insertion"::"Some Fields",
          "Log Modification" = "Log Modification"::"Some Fields",
          "Log Deletion" = "Log Deletion"::"Some Fields");
      DataChangeSetupFieldList.SETTABLEVIEW(Field);
      DataChangeSetupFieldList.RUN;
    END;

    LOCAL PROCEDURE UpdateRec@18();
    VAR
      RecRef@1003 : RecordRef;
      xRecRef@1002 : RecordRef;
      ChangeLogMgt@1001 : Codeunit 11148655;
    BEGIN
      RecRef.GETTABLE(DataChangeSetupTable);
      xRecRef.GETTABLE(xDataChangeSetupTable);
      WITH DataChangeSetupTable DO
        IF ("Log Insertion" = "Log Insertion"::" ") AND ("Log Modification" = "Log Modification"::" ") AND
           ("Log Deletion" = "Log Deletion"::" ")
        THEN BEGIN
          IF DataChangeSetupTable.DELETE THEN
            ChangeLogMgt.LogDeletion(xRecRef);
        END ELSE
          IF DataChangeSetupTable.MODIFY THEN
            ChangeLogMgt.LogModification(RecRef, xRecRef)
          ELSE BEGIN
            DataChangeSetupTable.INSERT;
            ChangeLogMgt.LogInsertion(RecRef);
          END;
    END;

    LOCAL PROCEDURE GetRec@2();
    BEGIN
      IF NOT DataChangeSetupTable.GET("Object ID") THEN BEGIN
        DataChangeSetupTable.INIT;
        DataChangeSetupTable."Table No." := "Object ID";
      END;
    END;

    PROCEDURE SetSource@4();
    VAR
      AllObjWithCaption@1001 : Record 2000000058;
    BEGIN
      DELETEALL;

      AllObjWithCaption.SETCURRENTKEY("Object Type","Object ID");
      AllObjWithCaption.SETRANGE("Object Type","Object Type"::Table);
      AllObjWithCaption.SETRANGE("Object ID",0,2000000006);

      IF AllObjWithCaption.FINDSET THEN
        REPEAT
          IF TableHasReadPermission(AllObjWithCaption."Object ID") THEN BEGIN
            Rec := AllObjWithCaption;
            INSERT;
          END;
        UNTIL AllObjWithCaption.NEXT = 0;
    END;

    LOCAL PROCEDURE TableHasReadPermission@3(TableID@1001 : Integer) : Boolean;
    VAR
      RecRef@1002 : RecordRef;
    BEGIN
      RecRef.OPEN(TableID);
      IF NOT ISSERVICETIER THEN
        RecRef.SETPERMISSIONFILTER;
      IF NOT RecRef.READPERMISSION THEN
        EXIT(FALSE);

      EXIT(TRUE);
    END;

    LOCAL PROCEDURE DataChangeSetupTableLogInserti@19015420();
    BEGIN
      UpdateRec;
    END;

    LOCAL PROCEDURE DataChangeSetupTableLogModific@19053322();
    BEGIN
      UpdateRec;
    END;

    LOCAL PROCEDURE DataChangeSetupTableLogDeletio@19064665();
    BEGIN
      UpdateRec;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11148610 IN - Change Log Setup (Field)
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Data Change Setup (Field) List;
               NLD=Overz. wijzigingsmonitorinstellingen (Veld)];
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table2000000041;
    DataCaptionExpr=STRSUBSTNO(Text001,TableNo,TableName);
    PageType=List;
    OnInit=BEGIN
             "Log DeletionVisible" := TRUE;
             "Log ModificationVisible" := TRUE;
             "Log InsertionVisible" := TRUE;
           END;

    OnOpenPage=BEGIN
                 FILTERGROUP(2);
                 SETRANGE(Class,Class::Normal);
                 FILTERGROUP(0);
               END;

    OnAfterGetRecord=BEGIN
                       GetRec;
                       TransFromRec;
                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  OnAfterGetCurrRecord;
                END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                Lookup=No;
                CaptionML=[ENU=No.;
                           NLD=Nr.];
                SourceExpr="No.";
                Editable=FALSE }

    { 4   ;2   ;Field     ;
                DrillDown=No;
                CaptionML=[ENU=Field Caption;
                           NLD=Veldbijschrift];
                SourceExpr="Field Caption";
                Editable=FALSE }

    { 6   ;2   ;Field     ;
                Name=Log Insertion;
                CaptionML=[ENU=Log Insertion;
                           NLD=Gereg. invoeging];
                SourceExpr=LogIns;
                Visible="Log InsertionVisible";
                OnValidate=BEGIN
                             IF NOT InsVisible THEN BEGIN
                               "Log InsertionVisible" := FALSE;
                               ERROR(Text002);
                             END;
                             UpdateRec;
                           END;
                            }

    { 8   ;2   ;Field     ;
                Name=Log Modification;
                CaptionML=[ENU=Log Modification;
                           NLD=Gereg. wijziging];
                SourceExpr=LogMod;
                Visible="Log ModificationVisible";
                OnValidate=BEGIN
                             IF NOT ModVisible THEN BEGIN
                               "Log ModificationVisible" := FALSE;
                               ERROR(Text002);
                             END;
                             UpdateRec;
                           END;
                            }

    { 10  ;2   ;Field     ;
                Name=Log Deletion;
                CaptionML=[ENU=Log Deletion;
                           NLD=Gereg. verwijdering];
                SourceExpr=LogDel;
                Visible="Log DeletionVisible";
                OnValidate=BEGIN
                             IF NOT DelVisible THEN BEGIN
                               "Log DeletionVisible" := FALSE;
                               ERROR(Text002);
                             END;
                             UpdateRec;
                           END;
                            }

  }
  CODE
  {
    VAR
      DataChangeSetupField@1000 : Record 11148640;
      Text001@1002 : TextConst 'ENU=%1 %2;NLD=%1 %2';
      Text002@1004 : TextConst 'ENU=You can not change this column.;NLD=U kunt deze kolom niet wijzigen.';
      LogIns@1001 : Boolean;
      LogMod@1008 : Boolean;
      LogDel@1009 : Boolean;
      InsVisible@1006 : Boolean;
      ModVisible@1005 : Boolean;
      DelVisible@1003 : Boolean;
      "Log InsertionVisible"@19000347 : Boolean INDATASET;
      "Log ModificationVisible"@19032389 : Boolean INDATASET;
      "Log DeletionVisible"@19056880 : Boolean INDATASET;

    PROCEDURE SelectColumn@1(NewInsVisible@1000 : Boolean;NewModVisible@1001 : Boolean;NewDelVisible@1002 : Boolean);
    BEGIN
      InsVisible := NewInsVisible;
      ModVisible := NewModVisible;
      DelVisible := NewDelVisible;

      "Log InsertionVisible" := InsVisible;
      "Log ModificationVisible" := ModVisible;
      "Log DeletionVisible" := DelVisible;
    END;

    LOCAL PROCEDURE UpdateRec@18();
    VAR
      RecRef@1003 : RecordRef;
      xRecRef@1002 : RecordRef;
      ChangeLogMgt@1001 : Codeunit 11148655;
    BEGIN
      GetRec;
      xRecRef.GETTABLE(DataChangeSetupField);
      TransToRec;
      RecRef.GETTABLE(DataChangeSetupField);
      WITH DataChangeSetupField DO
        IF NOT ("Log Insertion" OR "Log Modification" OR "Log Deletion") THEN BEGIN
          IF DataChangeSetupField.DELETE THEN
            ChangeLogMgt.LogDeletion(xRecRef);
        END ELSE
          IF DataChangeSetupField.MODIFY THEN
            ChangeLogMgt.LogModification(RecRef, xRecRef)
          ELSE BEGIN
            DataChangeSetupField.INSERT;
            ChangeLogMgt.LogInsertion(RecRef);
          END;
    END;

    LOCAL PROCEDURE GetRec@2();
    BEGIN
      IF NOT DataChangeSetupField.GET(TableNo,"No.") THEN BEGIN
        DataChangeSetupField.INIT;
        DataChangeSetupField."Table No." := TableNo;
        DataChangeSetupField."Field No." := "No.";
      END;
    END;

    LOCAL PROCEDURE TransFromRec@5();
    BEGIN
      LogIns := DataChangeSetupField."Log Insertion";
      LogMod := DataChangeSetupField."Log Modification";
      LogDel := DataChangeSetupField."Log Deletion";
    END;

    LOCAL PROCEDURE TransToRec@6();
    BEGIN
      DataChangeSetupField."Log Insertion" := LogIns;
      DataChangeSetupField."Log Modification" := LogMod;
      DataChangeSetupField."Log Deletion" := LogDel;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      GetRec;
      TransFromRec;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11148611 IN - RTC Table Filter
{
  OBJECT-PROPERTIES
  {
    Date=07-05-14;
    Time=13:00:00;
    Version List=IDYN-CE5.60.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Table Filter;
               NLD=Tabelfilter];
    SourceTable=Table11148641;
    PageType=Worksheet;
    OnOpenPage=BEGIN
                 SetExistingFilter(CurrFilterTxt);
               END;

    OnNewRecord=BEGIN
                  "Table No." := GlobalTableNo;
                END;

  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                SourceExpr="Field Caption" }

    { 1000000003;2;Field  ;
                SourceExpr="Field Filter" }

  }
  CODE
  {
    VAR
      GlobalTableNo@1000000000 : Integer;
      CurrFilterTxt@1000000001 : Text[250];

    PROCEDURE ClearTable@1000000002();
    BEGIN
      RESET;
      DELETEALL;
    END;

    PROCEDURE SetTableNo@1000000000(_TableNo@1000000000 : Integer);
    BEGIN
      GlobalTableNo := _TableNo;
    END;

    PROCEDURE SetExistingFilter@1000000001(FilterTxt@1000000000 : Text[1024]);
    VAR
      Field@1000000003 : Record 2000000041;
      FieldName@1000000001 : Text[250];
      FieldFilter@1000000002 : Text[250];
    BEGIN
      ClearTable;

      IF STRPOS(FilterTxt,':') = 0 THEN
        EXIT;

      "Table No." := SetTableByName(COPYSTR(FilterTxt,1,STRPOS(FilterTxt,':') - 1));
      Field.SETRANGE(TableNo,"Table No.");

      FilterTxt := COPYSTR(FilterTxt,STRPOS(FilterTxt,':') + 2,STRLEN(FilterTxt));

      WHILE STRPOS(FilterTxt,',') <> 0 DO BEGIN
        FieldName := COPYSTR(FilterTxt,1,STRPOS(FilterTxt,'=') - 1);
        FilterTxt := COPYSTR(FilterTxt,STRPOS(FilterTxt,'=') + 1,STRLEN(FilterTxt));

        FieldFilter := COPYSTR(FilterTxt,1,STRPOS(FilterTxt,',') - 1);
        FilterTxt := COPYSTR(FilterTxt,STRPOS(FilterTxt,',') + 1,STRLEN(FilterTxt));

        // CI-122.begin
        // Field.SETRANGE(FieldName,FieldName);
        Field.SETRANGE("Field Caption", FieldName);
        // CI-122.end

        IF Field.FINDFIRST THEN
          "Field No." := Field."No.";
        "Field Caption" := FieldName;
        "Field Filter" := FieldFilter;
        INSERT;
      END;

      IF STRPOS(FilterTxt,'=') <> 0 THEN BEGIN
        FieldName := COPYSTR(FilterTxt,1,STRPOS(FilterTxt,'=') - 1);
        FilterTxt := COPYSTR(FilterTxt,STRPOS(FilterTxt,'=') + 1,STRLEN(FilterTxt));

        FieldFilter := FilterTxt;

        // CI-122.begin
        // Field.SETRANGE(FieldName,FieldName);
        Field.SETRANGE("Field Caption", FieldName);
        // CI-122.end

        IF Field.FINDFIRST THEN
          "Field No." := Field."No.";
        "Field Caption" := FieldName;
        "Field Filter" := FieldFilter;
        INSERT;
      END;
    END;

    PROCEDURE SetCurrentFilter@1000000006(_CurrFilter@1000000000 : Text[250]);
    BEGIN
      CurrFilterTxt := _CurrFilter;
    END;

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11148612 IN - Task Groups
{
  OBJECT-PROPERTIES
  {
    Date=03-09-12;
    Time=12:00:00;
    Version List=IDYN-CE5.00.0;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Task Groups;
               NLD=Taakgroepen];
    SourceTable=Table11148642;
    DelayedInsert=Yes;
    PageType=List;
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                SourceExpr=Code }

    { 1000000003;2;Field  ;
                SourceExpr=Description }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

OBJECT Page 11182710 CI - Copy Definitions
{
  OBJECT-PROPERTIES
  {
    Date=13-09-13;
    Time=13:22:18;
    Version List=IDYN-CI5.50.7;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Copy Definition to Companies;
               NLD=Definities naar bedrijven kopiren];
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table11148643;
    PageType=List;
    ActionList=ACTIONS
    {
      { 1000000017;  ;ActionContainer;
                      Name=<Action1000000017>;
                      ActionContainerType=ActionItems }
      { 1000000007;1 ;ActionGroup;
                      Name=<Action1000000007>;
                      CaptionML=[ENU=Copy;
                                 NLD=Kopieer];
                      ActionContainerType=ActionItems }
      { 1000000008;2 ;Action    ;
                      Name=<Action1000000008>;
                      CaptionML=[ENU=Copy;
                                 NLD=Kopieren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Copy;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"IN - Def. Copy Management", Rec);
                               END;
                                }
      { 1000000009;1 ;ActionGroup;
                      CaptionML=[ENU=Select;
                                 NLD=Selecteren];
                      Visible=TRUE }
      { 1000000010;2 ;Action    ;
                      CaptionML=[ENU=All;
                                 NLD=Alles];
                      ToolTipML=[ENU=Select All;
                                 NLD=Alles selecteren];
                      Promoted=Yes;
                      Image=Approve;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Select(0);
                               END;
                                }
      { 1000000011;2 ;Action    ;
                      CaptionML=[ENU=None;
                                 NLD=Geen];
                      ToolTipML=[ENU=Select None;
                                 NLD=Alles deselecteren];
                      Promoted=Yes;
                      Image=Reject;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Select(1);
                               END;
                                }
      { 1000000012;2 ;Action    ;
                      CaptionML=[ENU=Toggle;
                                 NLD=Inverteren];
                      ToolTipML=[ENU=Toggle Selection;
                                 NLD=Selectie inverteren];
                      Promoted=Yes;
                      Image=CheckRulesSyntax;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Select(2);
                               END;
                                }
      { 1000000016;1 ;ActionGroup;
                      Name=<Action1000000009>;
                      CaptionML=[ENU=Overwrite;
                                 NLD=Overschrijven];
                      Visible=TRUE }
      { 1000000015;2 ;Action    ;
                      CaptionML=[ENU=All;
                                 NLD=Alles];
                      ToolTipML=[ENU=Overwrite All;
                                 NLD=Alles overschrijven];
                      Promoted=Yes;
                      Image=Approve;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Overwrite(0);
                               END;
                                }
      { 1000000014;2 ;Action    ;
                      CaptionML=[ENU=None;
                                 NLD=Geen];
                      ToolTipML=[ENU=Overwrite None;
                                 NLD=Niets overschrijven];
                      Promoted=Yes;
                      Image=Reject;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Overwrite(1);
                               END;
                                }
      { 1000000013;2 ;Action    ;
                      CaptionML=[ENU=Toggle;
                                 NLD=Inverteren];
                      ToolTipML=[ENU=Toggle Overwrite;
                                 NLD=Overschrijven inverteren];
                      Promoted=Yes;
                      Image=CheckRulesSyntax;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Overwrite(2);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                ToolTipML=[ENU=Copy Definition;
                           NLD=Definitie kopiren];
                SourceExpr="Copy Definition" }

    { 1000000003;2;Field  ;
                SourceExpr="Definition Type";
                Visible=False;
                Editable=False }

    { 1000000004;2;Field  ;
                SourceExpr="Definition Code";
                Visible=False;
                Editable=False }

    { 1000000005;2;Field  ;
                SourceExpr="Company Name";
                Editable=False }

    { 1000000006;2;Field  ;
                SourceExpr="Overwrite Definition" }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2014 IDYN B.V.
    }
    END.
  }
}

